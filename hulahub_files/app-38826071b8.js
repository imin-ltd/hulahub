"use strict";function redirectToPage(env,url){window.location=env["public"]+("undefined"!=typeof url?url:"")}function addHttp(url){return/^(?:f|ht)tps?\:\/\//.test(url)||(url="http://"+url),url}function showHintPopup(title,message){bootbox.dialog({title:"<h2>"+title+"</h2>",message:message,closeButton:!0,onEscape:!0,backdrop:!0})}function showConfirm(title,message,yesCallback,noCallback){bootbox.dialog({title:"<h2>"+title+"</h2>",message:message,buttons:{ok:{label:"Yes",className:"btn-green btn-outline",callback:yesCallback},cancel:{label:"No",className:"btn-red btn-outline",callback:noCallback}}})}function showActivitySeriesConfirm(title,message,singleCallback,seriesCallback){bootbox.dialog({className:"activitySeriesModal",title:"<h2>"+title+"</h2>",message:message,buttons:{single:{label:"Just this activity",className:"btn-activities",callback:singleCallback},future:{label:"All future activities",className:"btn-activities",callback:seriesCallback},cancel:{label:"Cancel",className:"pull-left btn-red btn-outline"}}})}function showActivityEditConfirm(title,message,callBack){bootbox.dialog({className:"activitySeriesModal",title:"<h2>"+title+"</h2>",message:message,buttons:{single:{label:"Save",className:"btn-activities",callback:callBack},cancel:{label:"Cancel",className:"pull-left btn-red btn-outline"}}})}function closeOffCanvasNav(nav){$(window).width()<991&&($("#navBlackout").fadeOut(function(){$(this).remove().unbind("touchstart click")}),nav.stop().animate({right:nav.width()*-1},"fast").removeClass("open"))}function openAccordionSection(section,closeOnSecondClick){if(section.is(".active"))closeOnSecondClick&&(section.removeClass("active"),$(".accordionContent",section).slideUp());else{var active=$(".item.active");active.removeClass("active"),$(".accordionContent",active).slideUp(),section.addClass("active"),$(".accordionContent",section).slideDown()}}function setSelectionRange(input,selectionStart,selectionEnd){if(input.setSelectionRange)input.focus(),input.setSelectionRange(selectionStart,selectionEnd);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",selectionEnd),range.moveStart("character",selectionStart),range.select()}}function setCaretToPos(input,pos){setSelectionRange(input,pos,pos)}function scrollToElement(id){$("body,html").stop(!0,!0).animate({scrollTop:$("#"+id).offset().top-$(".navbar-fixed-top").outerHeight()},"slow")}function scrollToFirstError(){$("body,html").stop(!0,!0).animate({scrollTop:$(".has-error").eq(0).offset().top-$(".navbar-fixed-top").outerHeight()},"fast")}function scrollToTop(){$("body,html").stop(!0,!0).animate({scrollTop:0})}function jumpToTop(){$("html,body").scrollTop(0)}function jumpToElement(id){$("body,html").scrollTop($("#"+id).offset().top-$(".navbar-fixed-top").outerHeight())}angular.module("config",[]).constant("ENV",{name:"prod",domain:"hulahub.com",api:"https://api.hulahub.com",cms:"https://cms.hulahub.com","public":"https://www.hulahub.com",frontend:"https://app.hulahub.com",knowledgehub:"https://info.hulahub.com",gtmContainerId:"GTM-M5W2JS",stripeClientId:"ca_8KqhcyEccTWPpphsCY77lpoOj1pWTfh1",stripePublicKey:"pk_live_Bio4Rt8lEhye3nSFnwLCuEsX",premiumBenefitsURL:"https://hulahubsso.youatwork.com",intercomAppId:"bndty5k9",interestIndexName:"Interest_prod"}),String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},"undefined"!=typeof bootbox&&bootbox.setDefaults({closeButton:!1}),String.prototype.wordCount||Object.defineProperty(String.prototype,"wordCount",{value:function(){var s=this.replace(/(^\s*)|(\s*$)/gi,"");return s=s.replace(/[ ]{2,}/gi," "),s=s.replace(/\n /,"\n"),s.split(" ").length},enumerable:!1});var app=angular.module("hulahub",["config","ngCookies","ngMessages","ngTouch","ngSanitize","ngResource","ui.router","ui.router.default","ui.bootstrap","oc.lazyLoad","http-auth-interceptor","ngFacebook","angular-stripe","checklist-model","ngFileUpload","ngclipboard","hulahubShared"]);angular.module("hulahubShared",["ngAnimate","ngFileUpload","ngclipboard"]);var dataLayer=window.dataLayer=window.dataLayer||[];app.run(function($rootScope,$state,$location,$window,$uibModal,authService,ENV,AuthService,PollingService,AlertService,AnalyticsService,StorageService,appSettings,IntercomService,MouseflowService){function disableTab(e){9===e.which&&e.preventDefault()}AnalyticsService.run(),$rootScope.$state=$state,$rootScope._=_,$rootScope.moment=moment,$rootScope.$on("showLoading",function(){var $body=$("body");$body.is(".loading")||($(document).keydown(disableTab),$body.addClass("loading").append('<div class="pageLoadingSpinner loadingSpinner wink whiteBG"></div>'))}),$rootScope.$on("hideLoading",function(){$(document).unbind("keydown",disableTab),$("body").removeClass("loading"),$(".pageLoadingSpinner").remove()}),$rootScope.auth=AuthService,$rootScope.alert=AlertService,$rootScope.settings=appSettings,$rootScope.env=ENV,$rootScope.$watch(function(){return AuthService.currentUser},function(value){null!==value?PollingService.start():PollingService.stop()},!0),$rootScope.$on("$stateChangeStart",function(event,toState,toParams){var requireLogin=toState.data&&toState.data.requireLogin;requireLogin&&!AuthService.isLoggedIn&&(event.preventDefault(),"logout"!==toState.name&&($location.hash()&&(toParams["#"]=$location.hash()),StorageService.setItem("loginRedirectUrl",$state.href(toState.name,toParams))),"activities.viewExternal"===toState.name?$state.go("register"):$state.go("login"));var noAccessWhenLoggedIn=toState.data&&toState.data.noAccessWhenLoggedIn;if(noAccessWhenLoggedIn&&AuthService.isLoggedIn){event.preventDefault();var loginRedirectUrl=StorageService.getItem("loginRedirectUrl");null!==loginRedirectUrl?($window.location.href=loginRedirectUrl,StorageService.removeItem("loginRedirectUrl")):"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")}$(".pac-container").remove(),$(".navGroup.hovered").removeClass("hovered"),AuthService.currentUser&&AuthService.currentUser.missingProfileData&&"stripe.connect"!==toState.name&&"logout"!==toState.name&&"register.completeProfile"!==toState.name&&$state.go("register.completeProfile"),IntercomService.boot()}),$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){$rootScope.$previousState=fromState,$("html, body").scrollTop(0),closeOffCanvasNav($(".offCanvasNav"));var firstElement=$("head > :first");firstElement.is("style")&&".pac-container"===firstElement.html().substring(0,14)&&firstElement.remove(),toState.data.loadingOnlyState||$rootScope.$broadcast("hideLoading"),$rootScope.$broadcast("updateHeader"),MouseflowService.newPageView($location.path()),AnalyticsService.trigger("PageView"),$window.ga&&$window.ga("send","pageview",{page:$location.path()})}),$rootScope.$on("$stateChangeError",function(event){$state.go("pageNotFound")}),$rootScope.$on("event:auth-loginRequired",function(){AuthService.loginInProgress||AuthService.getAccessToken("/users/login",{grant_type:"refresh_token",token:AuthService.refreshToken},function(){AuthService.loginInProgress=!1,authService.loginConfirmed("success",function(config){return config.headers.Authorization="Bearer "+AuthService.accessToken,config})},function(){$rootScope.$broadcast("hideLoading"),$state.reload("login")})}),document.getElementById("facebook-jssdk")||!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/en_US/sdk.js",fjs.parentNode.insertBefore(js,fjs))}(document,"script","facebook-jssdk")}),app.config(function($facebookProvider,stripeProvider,ENV,$uibTooltipProvider){$facebookProvider.setAppId("1727725177448781"),$facebookProvider.setVersion("v2.12"),$facebookProvider.setPermissions(["email","user_location","user_birthday","user_friends"]),stripeProvider.setPublishableKey(ENV.stripePublicKey);var tooltipOpts={appendToBody:!0};$uibTooltipProvider.options(tooltipOpts)}),angular.module("hulahubShared").value("appSettings",{distanceUnit:"miles",distanceMultiplier:1609.34,currencyUnit:"Â£",currencyTLC:"GBP",vatPercentage:"20",budgetSliderValues:{min:[0,10],"11%":[10,15],"22%":[25,25],"33%":[50,50],"44%":[100,400],"55%":[500,500],"66%":[1e3,1500],"77%":[2500,2500],"88%":[5e3,2500],max:[7500]},months:["January","February","March","April","May","June","July","August","September","October","November","December"],mapStyles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}],defaultLocation:{latitude:51.509865,longitude:-.118092}}),iziToast.settings({position:"bottomCenter",timeout:5e3,layout:2,displayMode:2,closeOnClick:!0}),angular.module("hulahub").directive("footerDate",function(){return{restrict:"E",template:"{{ footer.date | date:footer.dateFormat }}",controller:function(){this.date=Date.now(),this.dateFormat="yyyy"},controllerAs:"footer"}}).directive("ratingControl",function(){return{restrict:"A",scope:{percentage:"="},template:'<div class="filled" style="width:{{percentage}}%;"></div>',link:function(scope,element){var startingPercent=scope.percentage;element.on("mouseenter",function(){startingPercent=scope.percentage}),element.on("mousemove",function(e){var percentOfMouse=e.offsetX/element[0].offsetWidth*100;element[0].children[0].style.width=10*Math.ceil(percentOfMouse/10)+"%"}),element.on("mouseleave",function(){element[0].children[0].style.width=startingPercent+"%"}),element.on("click",function(e){var percentOfMouse=e.offsetX/element[0].offsetWidth*100;startingPercent=10*Math.ceil(percentOfMouse/10),scope.$apply(function(){scope.percentage=startingPercent})})}}}).directive("sliderWithLabels",function(){return{restrict:"E",scope:{model:"="},template:'<div class="noUi-extended no-margins" ya-no-ui-slider="model" ya-no-ui-slider-disabled="!model.enabled" ng-disabled="!model.enabled" ya-no-ui-slider-events="model.eventHandlers"></div><ul class="list-unstyled sliderSteps row labelCount{{ model.labels.length}}"><li ng-repeat="label in model.labels" class="col-xs-4">{{ label }}</li></ul>'}}).directive("characterCount",function(){return{restrict:"E",scope:{min:"=",max:"=",text:"="},template:'<div class="characterCount text-right" ng-show="postText" ng-class="{\'contactsColour\': text.length >= 1 && postText == \'needed\'}">{{ characters }} character<span ng-if="characters !== 1">s</span> {{ postText }}</div>',link:function(scope){scope.$watch("text",function(v){null===v||void 0===v?scope.min?(scope.characters=scope.min,scope.postText="needed"):(scope.characters=scope.max,scope.postText="remaining"):v.length<scope.min?(scope.characters=scope.min-v.length,scope.postText="needed"):scope.max?(scope.characters=scope.max-v.length,scope.postText="remaining"):scope.postText=null})}}}).directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(scope,element,attributes,ngModel){ngModel.$validators.compareTo=function(modelValue){return modelValue==scope.otherModelValue},scope.$watch("otherModelValue",function(){ngModel.$validate()})}}}).directive("sectionHeader",function(){return{restrict:"E",scope:{text:"@",link:"@",type:"@",headingLevel:"@",draggable:"=",xsPadding:"="},transclude:!0,templateUrl:"core/partials/section-header.html",link:function(scope){void 0===scope.headingLevel&&(scope.headingLevel="h2")}}}).directive("profilePhoto",["AuthService",function(AuthService){return{restrict:"E",replace:!0,template:'<span class="circlePhoto" ng-class="{\'noPhoto\' : !avatar}" style="background-image:url({{ avatar }})"></span>',link:function(scope){scope.avatar=AuthService.currentUser?AuthService.currentUser.profile.avatarURL:null,scope.$watch(function(){return AuthService.currentUser&&AuthService.currentUser.profile.avatarURL||void 0},function(newVal,oldVal){newVal!==oldVal&&(scope.avatar=newVal)})}}}]).directive("dateRangeLabel",function(){return{restrict:"E",scope:{start:"=",end:"=",format:"@"},template:"{{ label }}",link:function(scope){var startDate=moment(scope.start),endDate=moment(scope.end);startDate.isSame(endDate,"day")?scope.label=startDate.format(scope.format):scope.label=startDate.format(scope.format)+" - "+endDate.format(scope.format)}}}).directive("timePicker",function(){return{restrict:"E",templateUrl:"core/partials/time-picker.html",scope:{value:"=",onChange:"&"},link:function(scope){scope.hours=_.map(_.range(0,24),function(n){var s=""+n;return s.length<2&&(s="0"+s),{id:n,value:s}}),scope.minutes=_.map(_.range(0,56,5),function(n){var s=""+n;return s.length<2&&(s="0"+s),{id:n,value:s}})}}}).directive("restrictToMaxTags",function(){var KEY_BACKSPACE=8,KEY_TAB=9;return{require:"ngModel",priority:-10,link:function($scope,$element,$attrs,ngModelController){var maxTags,getTags,checkTags,maxTagsReached,placeholder,tagsInputScope=$element.isolateScope(),input=$element.find("input");$attrs.$observe("maxTags",function(_maxTags){maxTags=_maxTags}),getTags=function(){return ngModelController.$modelValue},checkTags=function(){var tags=getTags();tags&&tags.length&&tags.length>=maxTags?maxTagsReached||(tagsInputScope.events.trigger("input-blur"),placeholder=input.attr("placeholder"),input.attr("placeholder",""),input.css("max-width","0"),maxTagsReached=!0):maxTagsReached&&(input.attr("placeholder",placeholder),input.css("max-width",""),maxTagsReached=!1)},$scope.$watchCollection(getTags,checkTags),input.on("keydown",function(event){maxTagsReached&&event.which!==KEY_BACKSPACE&&event.which!==KEY_TAB&&(event.stopImmediatePropagation(),event.preventDefault())}),input.on("focus",function(event){checkTags(),maxTagsReached&&(tagsInputScope.hasFocus=!0,event.stopImmediatePropagation())})}}}).directive("includeWithScope",function(){return{restrict:"AE",templateUrl:function(ele,attrs){return attrs.templatePath}}}).directive("convertToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(val){return parseInt(val,10)}),ngModel.$formatters.push(function(val){return""+val})}}}).directive("capitalizeInput",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){var capitalize=function(inputValue){void 0===inputValue&&(inputValue="");var capitalized=inputValue.toUpperCase();if(capitalized!==inputValue){var selection=element[0].selectionStart;modelCtrl.$setViewValue(capitalized),modelCtrl.$render(),element[0].selectionStart=selection,element[0].selectionEnd=selection}return capitalized};modelCtrl.$parsers.push(capitalize),capitalize(scope[attrs.ngModel])}}}),angular.module("hulahubShared").directive("compile",["$compile",function($compile){return function(scope,element,attrs){scope.$watch(function(scope){return scope.$eval(attrs.compile)},function(value){element.html(value),$compile(element.contents())(scope)})}}]).directive("sticky",function($rootScope,$timeout){return{restrict:"A",scope:{keepInParent:"="},link:function(scope,element){function init(){$header=$(".navbar-fixed-top"),headerHeight=$header.outerHeight(),$elementWidth=$element.outerWidth(),$elementTop=$element.offset().top,$elementLeft=$element.offset().left}var $header,headerHeight,$elementWidth,$elementTop,$elementLeft,$element=$(element);$rootScope.$on("recalcStickies",function(){$timeout(function(){init()},0)}),$timeout(function(){function positionSticky(){var $elementHeight=$element.outerHeight();if($(window).width()>=991){var bottomOfParent=$parent.offset().top+$parent.height()-$elementHeight-headerHeight;scope.keepInParent&&window.scrollY>=bottomOfParent?$elementHeight<$parent.height()&&element.removeClass("fixed").addClass("abs").css({bottom:0,right:0,top:"auto",left:"auto"}):window.scrollY+headerHeight>=$elementTop?element.removeClass("abs").addClass("fixed").css({top:headerHeight+"px",left:$elementLeft+"px",bottom:"auto",right:"auto",width:$elementWidth+"px"}):element.removeClass("abs").removeClass("fixed").css({top:"",left:"",bottom:"",right:"",width:""})}}init();var $parent=$element.parent();scope.keepInParent&&$parent.css("position","relative"),$(window).scroll(function(e){$element.is(":visible")&&positionSticky()}),$(window).resize(function(e){$element.is(":visible")&&(element.removeClass("abs").removeClass("fixed").css({top:"",left:"",bottom:"",right:"",width:""}),init(),positionSticky())})})}}}).directive("googleplace",function(GeocoderService){return{require:"ngModel",scope:{ngModel:"=",data:"=",allTypes:"=?",replace:"=?",basicReturn:"=?"},link:function(scope,element,attrs,model){angular.isUndefined(scope.replace)&&(scope.replace=!1),angular.isUndefined(scope.basicReturn)&&(scope.basicReturn=!1);var options={};scope.allTypes||(options.types=["geocode"]),scope.gPlace=new google.maps.places.Autocomplete(element[0],options),element.bind("keydown",function(e){13===e.which&&e.preventDefault()}),element.bind("keyup",function(e){8===e.which&&""===element.val()&&scope.$apply(function(){scope.data=null})}),google.maps.event.addListener(scope.gPlace,"place_changed",function(){var place=scope.gPlace.getPlace();if(place.geometry){var locText=GeocoderService.getLocationText(place);scope.$apply(function(){scope.data={latitude:place.geometry.location.lat(),longitude:place.geometry.location.lng(),name:scope.replace?locText:element.val(),locality:locText},scope.basicReturn||(scope.data.enabled=!0,scope.data.distance=10),scope.replace&&(model.$setViewValue(locText),model.$render())})}else""===element.val()&&scope.$apply(function(){scope.data=null})})}}}).directive("telephoneNumberInput",function(){return{restrict:"E",replace:!0,template:'<input type="text" class="form-control" ng-model="inputValue" name="{{ inputName }}" placeholder="{{ placeholder }}" ng-required="required" maxlength="20" ng-minlength="6" />',scope:{inputValue:"=",inputName:"@",placeholder:"@",required:"="},link:function(scope,element){var allowedChars=[32,40,41,43];element.on("keypress",function(e){allowedChars.indexOf(e.which)==-1&&(e.which<48||e.which>57)&&e.preventDefault()}),element.on("cut copy paste",function(event){event.preventDefault()})}}}).directive("numberOnlyInput",function(){return{link:function(scope,element){element.bind("keypress",function(event){(element.val().length>=7||32===event.which||47===event.which||event.which<46||event.which>57)&&event.preventDefault()}),element.bind("focus",function(){this.select()})}}}).directive("integerOnlyInput",function(){return{link:function(scope,element){element.bind("keypress",function(event){(event.which<48||event.which>57)&&event.preventDefault()}),element.bind("focus",function(){this.select()})}}}).directive("readMore",function(){return{restrict:"A",transclude:!0,replace:!0,template:"<div></div>",scope:{limit:"@",content:"@",linkClass:"@"},link:function(scope,elem,attr,ctrl,transclude){function readmore(text){var regex=/\s+/gi,wordCount=text.trim().replace(regex," ").split(" ").length,foundWords=text.split(/\s+/),markup=text,more="";foundWords.length>limit&&(text=foundWords.slice(0,limit).join(" "),more=foundWords.slice(limit,wordCount).join(" "),markup=text+'<span class="ellipsis">...</span> <a class="read-more underlineOnHover '+linkClass+'">Show more</a><span class="more-text">'+more+' <a class="read-less underlineOnHover '+linkClass+'">Show less</a></span>'),elem.append(markup),elem.find(".read-more").on("click",function(){$(this).hide(),elem.find(".more-text").addClass("show").slideDown(),elem.find(".ellipsis").hide()}),elem.find(".read-less").on("click",function(){elem.find(".read-more").show(),elem.find(".more-text").hide().removeClass("show"),elem.find(".ellipsis").show()})}var limit=angular.isUndefined(scope.limit)?150:scope.limit,linkClass=scope.linkClass;attr.$observe("content",function(str){readmore(str)})}}}).directive("interestSearch",function(){return{restrict:"E",template:'<div class="clearableInput"><angucomplete-alt id="{{ inputId }}" class="angucomplete-theme-{{ theme }}"                        input-class="form-control" placeholder="{{ placeholder }}"                        pause="400"                        selected-object="selectedInterest"                        input-changed="inputChanged"                        initial-value="data.name"                        remote-api-handler="searchInterests"                        title-field="name"                        focus-first="true"></angucomplete-alt><i class="fas fa-times-circle" ng-show="data !== null && data !== undefined" ng-click="clear()"></i></div>',scope:{data:"=",placeholder:"@",theme:"@",inputId:"@"},link:function(scope){angular.isUndefined(scope.theme)&&(scope.theme="wallet"),angular.isUndefined(scope.placeholder)&&(scope.placeholder="e.g. Golf, Yoga, Paintball...")},controller:function($scope,$q,InterestService){$scope.searchInterests=function(userInputString){var deferred=$q.defer();return InterestService.autoCompleteSearch(userInputString).then(function(r){deferred.resolve({data:r})}),deferred.promise},$scope.inputChanged=function($item){""===$item?($scope.data=null,$scope.showClearButton=!1):$scope.showClearButton=!0},$scope.selectedInterest=function($item){$item&&$item.originalObject&&0!==$item.originalObject.id&&($scope.data={id:$item.originalObject.id,name:$item.originalObject.name,slug:$item.originalObject.slug,tcActivities:$item.originalObject.tcActivities,tcLocJoin:$item.originalObject.tcLocJoin,level:$item.originalObject.level})},$scope.clear=function(){$scope.$broadcast("angucomplete-alt:clearInput"),$scope.showClearButton=!1,$scope.data=null}}}}).directive("locationSearch",function(){return{restrict:"E",template:'<div class="clearableInput iconInput defaultCursor">                <i class="ico ico-pin" ng-click="useCurrentLocation()"></i>                <input googleplace ng-model="searchBox.value" data="data" basic-return="true" placeholder="{{ placeholder }}" type="text" class="form-control" />                <i class="fas fa-times-circle" ng-show="searchBox.value!=null" ng-click="clear()"></i>            </div>',scope:{data:"=",placeholder:"@"},controller:function($scope,$log,GeocoderService){var defaultLocationPlaceholder=$scope.placeholder;$scope.searchBox={value:$scope.data?$scope.data.name:null},$scope.useCurrentLocation=function(){$scope.placeholder="Fetching location...",GeocoderService.requestLocation(function(location){$scope.$apply(function(){$scope.data=location,$scope.data.locality=location.name,$scope.placeholder=defaultLocationPlaceholder})},function(errorMessage){$log.error(errorMessage),$scope.$apply(function(){$scope.placeholder=defaultLocationPlaceholder})})},$scope.$watch("data",function(newVal,oldVal){newVal!==oldVal&&($scope.searchBox.value=newVal?newVal.name:null)}),$scope.clear=function(){$scope.searchBox.value=null,$scope.data=null}}}}).directive("collapsable",function(){return{restrict:"A",scope:{open:"="},link:function(scope,element){function toggleContent(){scope.open?element.addClass("open").removeClass("closed").next(".collapsableContent").show():element.removeClass("open").addClass("closed").next(".collapsableContent").hide()}$(element).on("click",function(e){e.stopPropagation(),e.preventDefault();var obj=$(this);obj.is(".closed")?(scope.open=!0,toggleContent()):(scope.open=!1,toggleContent())}),toggleContent()}}}).directive("plusMinusControl",function(){return{restrict:"E",scope:{value:"=",min:"@?",max:"=",onMinimum:"&?",onMaximum:"&?"},template:'<span class="plusMinusControl vAlignParent"><a ng-click="decrease()" class="vAlign" ng-class="{\'disabled\': value == min}"><i class="fas fa-minus-circle"></i></a><span class="vAlign">{{value}}</span><a ng-click="increase()" class="vAlign" ng-class="{\'disabled\': value == max}"><i class="fas fa-plus-circle"></i></a></span>',link:function(scope,element){angular.isUndefined(scope.min)&&(scope.min=1),scope.decrease=function(){scope.value>scope.min&&(scope.value--,angular.isDefined(scope.onMinimum)&&scope.value==scope.min&&scope.onMinimum())},scope.increase=function(){"Unlimited"===scope.max?scope.value++:scope.value<scope.max&&(scope.value++,angular.isDefined(scope.onMaximum)&&scope.value==scope.max&&scope.onMaximum())}}}}).directive("flexibleBookingForm",function(){return{restrict:"E",replace:!0,templateUrl:"booking-requests/views/flexible-booking-form.html"}}).directive("premiumLogosSlider",function(){return{restrict:"E",template:'<slick settings="slickConfig" class="logoSlider">                <div class="slide" ng-repeat="logo in logos"><img src="/img/retailers/{{logo}}" alt="{{logo}}" /></div>            </slick>',link:function(scope){scope.slickConfig={enabled:!0,infinite:!0,draggable:!1,autoplay:!0,autoplaySpeed:0,speed:4e3,cssEase:"linear",pauseOnFocus:!1,pauseOnHover:!1,slidesToShow:3,slidesToScroll:1,arrows:!1,mobileFirst:!0,responsive:[{breakpoint:410,settings:{slidesToShow:4}},{breakpoint:660,settings:{slidesToShow:5}},{breakpoint:767,settings:{slidesToShow:4}},{breakpoint:860,settings:{slidesToShow:5}},{breakpoint:1100,settings:{slidesToShow:6}}]},scope.logos=["amazon-logo.png","adidas-logo.png","apple-logo.png","mns-logo.png","alton-towers-logo.png","morrisons-logo.png","boots-logo.png","lonely-planet-logo.png","berghaus-logo.png","thorpe-park-logo.png","gap-logo.png","odeon-logo.png","fat-face-logo.png","hiscox-logo.png","garmin-logo.png","legoland-logo.png","evans-cycles-logo.png","buyagift-logo.png","tesco-logo.png","tk-maxx-logo.png","john-lewis-logo.png","confused-logo.png","sainsburys-logo.png","american-golf-logo.png","currys-logo.png","spafinder-logo.png"]}}}),angular.module("hulahub").filter("substringUntilChar",function(){return function(input,start,char){return input.substring(start,input.indexOf(char))}}),angular.module("hulahubShared").filter("dateFormat",function(){return function(timestamp,format){return moment(timestamp).format(format)}}),angular.module("hulahub").filter("wrapCharsInHTML",function(){return function(input,htmlElement){for(var inputString=input.toString(),r="",i=0;i<inputString.length;i++)r+="<"+htmlElement+">"+inputString.charAt(i)+"</"+htmlElement+">";return r}}),angular.module("hulahub").filter("hasEnabledItems",function(){return function(input){return!_.isEmpty(_.filter(input,"enabled"))}}),angular.module("hulahubShared").filter("capitalize",function(){return function(input){if(angular.isDefined(input))return null!=input&&(input=input.toLowerCase()),input.substring(0,1).toUpperCase()+input.substring(1)}}),angular.module("hulahubShared").filter("encodeURI",function(){return function(input){return input?window.encodeURIComponent(input):""}}),angular.module("hulahub").filter("nl2br",function($sce){return function(msg){if(msg)return $sce.trustAsHtml((msg+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2"))}}),angular.module("hulahub").filter("words",function(){return function(input,words){if(isNaN(words))return input;if(words<=0)return"";if(input){var inputWords=input.split(/\s+/);inputWords.length>words&&(input=inputWords.slice(0,words).join(" ")+"â¦")}return input}}),angular.module("hulahubShared").filter("genderDisplay",function(){return function(input,unknownText){return"f"===input?"Female":"m"===input?"Male":unknownText?unknownText:"Mixed"}}),angular.module("hulahubShared").filter("difficultyDisplay",function(){return function(input){var values=["Mixed","Beginner","Intermediate","Advanced"];return values[input]}}),angular.module("hulahub").filter("ageDisplay",function(){return function(min,max){return null!==max?min+"-"+max:min>0?min+"+":"Any"}}),angular.module("hulahub").filter("ageFromBirthday",function(){return function(date){if(date){var isoDate=new Date(date).toISOString();return moment().diff(isoDate,"years")}}}),angular.module("hulahub").filter("startFrom",function(){return function(input,start){return input?(start=+start,input.slice(start)):[]}});var currencyCodes={GBP:"Â£",EUR:"â¬",USD:"$"};angular.module("hulahubShared").filter("currencyDecode",function(){return function(currencyTLC){if(angular.isDefined(currencyTLC))return currencyCodes[currencyTLC]}}),angular.module("hulahubShared").filter("currencyDisplay",function($filter){return function(pennies,currencyTLC,includePennies,replaceFree,penniesWhenWhole){var decimalPlaces=2;angular.isDefined(includePennies)&&!includePennies&&(decimalPlaces=0),angular.isUndefined(replaceFree)&&(replaceFree=!0),angular.isUndefined(penniesWhenWhole)&&(penniesWhenWhole=!1);var isMinus=!1;if(pennies<0&&(isMinus=!0,pennies=Math.abs(pennies)),0===pennies&&replaceFree)return"Free";var pounds=pennies/100;penniesWhenWhole||pounds%1!==0||(decimalPlaces=0);var number=$filter("number")(pounds,decimalPlaces),result=currencyCodes[currencyTLC]+number;return isMinus?"-"+result:result}}),angular.module("hulahub").filter("sanitize",function($sce){return function(text){return $sce.getTrustedHtml(text)}}),angular.module("hulahub").filter("formatEmailMessage",function($sce){return function(text,allowTrustedHTML){return allowTrustedHTML?text:$sce.getTrustedHtml(text)}}),angular.module("hulahub").filter("possessive",function(){return function(properNoun){return null==properNoun?properNoun:"s"===properNoun.charAt(properNoun.length-1)||"S"===properNoun.charAt(properNoun.length-1)?properNoun+"'":properNoun+"'s"}}),angular.module("hulahub").config(function($stateProvider,$urlRouterProvider,$locationProvider,$ocLazyLoadProvider){$locationProvider.html5Mode(!0).hashPrefix("!"),$ocLazyLoadProvider.config({debug:!1,modules:[{name:"sortable",files:["js/jquery-ui.min.js","js/jquery.ui.touch-punch.min.js","js/lib/angular-ui-sortable/dist/sortable.min.js"]},{name:"interestSearch",files:["js/lib/angucomplete-alt/dist/angucomplete-alt.min.js"]},{name:"nouislider",files:["js/jquery.actual.min.js","js/lib/nouislider/distribute/nouislider.min.css","js/lib/nouislider/distribute/nouislider.js","js/lib/nouislider-angular/nouislider.js"]},{name:"daterangepicker",files:["js/lib/bootstrap-daterangepicker/daterangepicker.css","js/lib/bootstrap-daterangepicker/daterangepicker.js","js/lib/angular-daterangepicker/js/angular-daterangepicker.js"]},{name:"switches",files:["js/lib/angular-ui-switch/angular-ui-switch.min.css","js/lib/angular-ui-switch/angular-ui-switch.min.js"]},{name:"creditcards",files:["js/angular-credit-cards.js"]},{name:"tagInput",files:["js/lib/ng-tags-input/build/ng-tags-input.min.css","js/ng-tags-input.js"]},{name:"imageCrop",files:["js/lib/cropperjs/dist/cropper.min.css","js/lib/cropperjs/dist/cropper.min.js"]},{name:"slider",files:["js/lib/slick-carousel/slick/slick.css","js/lib/slick-carousel/slick/slick-theme.css","js/lib/slick-carousel/slick/slick.min.js","js/lib/angular-slick-carousel/dist/angular-slick.min.js"]},{name:"lightbox",files:["js/lib/simplelightbox/dist/simple-lightbox.min.js"]}]}),$stateProvider.state("appLanding",{url:"/",data:{loadingOnlyState:!0,noAccessWhenLoggedIn:!0},onEnter:function($injector){redirectToPage($injector.get("ENV"))}}),$urlRouterProvider.otherwise(function($injector){redirectToPage($injector.get("ENV"),"/404")})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("activities.hosted",{url:"/hosted",views:{"content@activities":{controller:"MyActivitiesController",templateUrl:"activities/views/hosted.html"}},data:{title:"My activities",view:"hosted",subNav:"hosted-activities"}}).state("activities.hosted.view",{"abstract":!0,"default":".info",url:"/view/:activityId",views:{"content@activities":{templateUrl:"activities/views/partials/single-layout.html",controller:function($scope,$rootScope,$stateParams,$timeout,ActivityService){$scope.loading=!0,ActivityService.getActivityPublic({id:$stateParams.activityId,isExternal:!1},function(activity){activity.host.accountClosed?$scope.notFound=!0:($scope.activity=activity,$scope.activity.flexible&&$scope.activity.joiners.length&&($scope.activity.flexible=!1,$scope.activity.confirmedFlexibleBooking=!0)),$scope.loading=!1},function(error){$scope.loading=!1,$scope.notFound=!0})}}}}).state("activities.hosted.view.info",{url:"/info",views:{"activityContent@activities.hosted.view":{controller:"ActivityInfoController",templateUrl:"activities/views/activity-info.html"
}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["slider","lightbox"])}}}).state("activities.hosted.view.discussion",{url:"/board",views:{"activityContent@activities.hosted.view":{controller:"DiscussionBoardController",templateUrl:"activities/views/discussion-board.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["js/lib/autosize/dist/autosize.min.js"])}}}).state("activities.hosted.share",{url:"/share/:activityId",views:{"content@activities":{controller:"ShareActivityController",templateUrl:"activities/views/share.html"}},params:{skipButton:!1},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput","js/lib/autosize/dist/autosize.min.js"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("activities.joined",{url:"/joined?partner&partnerBooking",views:{"content@activities":{controller:"MyActivitiesController",templateUrl:"activities/views/joined.html"}},params:{partner:null,partnerBooking:null},data:{title:"My activities",view:"joined"}}).state("activities.joined.viewExternal",{url:"/view/external/:activityId",views:{"content@activities":{controller:"ExternalActivityController",templateUrl:"activities/views/external-activity.html"}}}).state("activities.joined.view",{"abstract":!0,"default":".info",url:"/view/:activityId",views:{"content@activities":{templateUrl:"activities/views/partials/single-layout.html",controller:function($scope,$rootScope,$stateParams,$timeout,ActivityService){$scope.loading=!0,ActivityService.getActivityPublic({id:$stateParams.activityId,isExternal:!1},function(activity){!activity.alreadyJoined&&activity.host.accountClosed?$scope.notFound=!0:($scope.activity=activity,$scope.activity.flexible&&$scope.activity.joiners.length&&($scope.activity.flexible=!1,$scope.activity.confirmedFlexibleBooking=!0)),$scope.loading=!1},function(error){$scope.loading=!1,$scope.notFound=!0})}}}}).state("activities.joined.view.info",{url:"/info",views:{"activityContent@activities.joined.view":{controller:"ActivityInfoController",templateUrl:"activities/views/activity-info.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["slider","lightbox"])}}}).state("activities.joined.view.discussion",{url:"/board",views:{"activityContent@activities.joined.view":{controller:"DiscussionBoardController",templateUrl:"activities/views/discussion-board.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["js/lib/autosize/dist/autosize.min.js"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("activities",{"abstract":!0,url:"/activities",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{theme:"activities",requireLogin:!0}}).state("activities.find",{"abstract":!0,"default":".inspire",url:"/find",data:{title:"Find activities",subNav:"find-activities"}}).state("activities.find.inspire",{url:"/inspire-me",views:{"content@activities":{controller:"InspireMeController",templateUrl:"activities/views/inspire.html"}}}).state("activities.find.matches",{url:"/matches",views:{"content@activities":{controller:"MatchesActivitiesController",templateUrl:"activities/views/matches.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch"])}}}).state("activities.find.browse",{url:"/browse",views:{"content@activities":{controller:"BrowseActivitiesController",templateUrl:"activities/views/browse.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","daterangepicker"])}},params:{text:null,forceFeatured:!1}}).state("activities.viewExternal",{url:"/view/external/:activityId",views:{"content@activities":{controller:"ExternalActivityController",templateUrl:"activities/views/external-activity.html"}},data:{title:"Browse activities",subNav:"find-activities"}}).state("activities.view",{"abstract":!0,"default":".info",url:"/view/:activityId",views:{"content@activities":{templateUrl:"activities/views/partials/single-layout.html",controller:function($scope,$rootScope,$stateParams,$timeout,ActivityService){$scope.loading=!0,ActivityService.getActivityPublic({id:$stateParams.activityId,isExternal:!1},function(activity){!activity.alreadyJoined&&activity.host.accountClosed?$scope.notFound=!0:($scope.activity=activity,$scope.activity.flexible&&$scope.activity.joiners.length&&($scope.activity.flexible=!1,$scope.activity.confirmedFlexibleBooking=!0)),$scope.loading=!1},function(error){$scope.loading=!1,$scope.notFound=!0})}}},data:{title:"Browse activities"}}).state("activities.view.info",{url:"/info",views:{"activityContent@activities.view":{controller:"ActivityInfoController",templateUrl:"activities/views/activity-info.html"}},data:{subNav:"find-activities",hideMobileTabBar:!0,hasFloatingFooterBar:!0},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["slider","lightbox"])}}}).state("activities.join",{url:"/join/:seriesId/:activityId",views:{"content@activities":{controller:"JoinActivityController",templateUrl:"activities/views/join.html"}},params:{activityId:{value:null,squash:!0}},data:{requireLogin:!1},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards"])},activity:["$q","$state","$stateParams","ActivityService",function($q,$state,$stateParams,ActivityService){var deferred=$q.defer();return ActivityService.getSeries($stateParams.seriesId,$stateParams.activityId).then(function(response){deferred.resolve(response.data)},function(responseError){404===responseError.status?deferred.resolve(responseError):$state.go("pageNotFound")}),deferred.promise}]}}).state("activities.new",{url:"/new",views:{"layout@":{templateUrl:"activities/views/form-layout.html"},"content@activities.new":{controller:"NewActivityController",templateUrl:"activities/views/form.html"}},params:{copyFrom:null},resolve:{copyFrom:["$stateParams","ActivityService",function($stateParams,ActivityService){return $stateParams.copyFrom?ActivityService.getActivityForEditing($stateParams.copyFrom):null}],loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches","js/lib/autosize/dist/autosize.min.js","imageCrop","sortable"])}},data:{title:"Create an activity",hideMobileTabBar:!0,subNav:null}}).state("activities.edit",{url:"/edit/:activityId",views:{"layout@":{templateUrl:"activities/views/form-layout.html"},"content@activities.edit":{controller:"EditActivityController",templateUrl:"activities/views/form.html"}},resolve:{activity:["$stateParams","ActivityService",function($stateParams,ActivityService){return ActivityService.getActivityForEditing($stateParams.activityId)}],loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches","js/lib/autosize/dist/autosize.min.js","imageCrop","sortable"])}},data:{title:"Edit activity",hideMobileTabBar:!0,subNav:null}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("billing",{"abstract":!0,"default":".transactions",url:"/billing",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{title:"Billing & transactions",subNav:"billing",theme:"profile",requireLogin:!0}}).state("billing.transactions",{url:"/transactions",views:{"content@billing":{controller:"TransactionsController",templateUrl:"billing/views/transactions.html"}}}).state("billing.transactions.detail",{url:"/detail/:billingItemId",views:{"content@billing":{controller:"BillingItemDetailController",templateUrl:"billing/views/billing-item-detail.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards"])}}}).state("billing.subscriptionPlans",{url:"/subscription",views:{"content@billing":{controller:"SubscriptionPlansController",templateUrl:"billing/views/subscription-plans.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards","switches"])}}}).state("billing.subscriptionPlans.switch",{url:"/switch",views:{"content@billing":{controller:"SwitchPlanController",templateUrl:"billing/views/switch-plan.html"}},params:{plan:null,usingTrial:!1},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards"])}}}).state("billing.settings",{url:"/payment-settings",views:{"content@billing":{controller:"PaymentSettingsController",templateUrl:"billing/views/payment-settings.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards"])}}}).state("billing.resolutionCentre",{url:"/resolution-centre",views:{"content@billing":{controller:"ResolutionCentreController",templateUrl:"billing/views/resolution-centre.html"}}}).state("billing.resolutionCentre.detail",{url:"/:refundId",views:{"content@billing":{controller:"RefundDetailController",templateUrl:"billing/views/refund-detail.html"}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("contacts",{"abstract":!0,"default":".mine",url:"/contacts",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{title:"Contacts",theme:"contacts",requireLogin:!0,subNav:"contacts"}}).state("contacts.requestResponse",{url:"/request/:userId/:response",views:{"layout@":{templateUrl:"core/layouts/default.html"},"content@contacts.requestResponse":{controller:"ContactRequestResponseController"}},data:{loadingOnlyState:!0},onEnter:function($rootScope){$rootScope.$broadcast("showLoading")}}).state("contacts.mine",{url:"/all",params:{newContacts:null},views:{"content@contacts":{controller:"MyContactsController",templateUrl:"contacts/views/my-contacts.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch"])}}}).state("contacts.groups",{url:"/groups",views:{"content@contacts":{controller:"ContactGroupsController",templateUrl:"contacts/views/groups.html"}}}).state("contacts.groups.manage",{url:"/manage",views:{"content@contacts":{controller:"ManageGroupsController",templateUrl:"contacts/views/manage-groups.html"}},resolve:{groups:function(){return null},isModal:function(){return!1}}}).state("contacts.find",{url:"/find",views:{"content@contacts":{controller:"ContactSearchController",templateUrl:"contacts/views/contact-search.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch"])}},data:{subNav:"contacts"}}).state("contacts.public",{url:"/profile/:userId",views:{"content@contacts":{controller:"PublicProfileController",templateUrl:"contacts/views/profile.html"}},data:{subNav:"contacts"},resolve:{user:["$q","$rootScope","$state","$stateParams","AuthService","UserService",function($q,$rootScope,$state,$stateParams,AuthService,UserService){$rootScope.$broadcast("showLoading");var deferred=$q.defer();return UserService.getUser($stateParams.userId).then(function(response){response.data.id===AuthService.currentUser.hashId?$state.go("profile"):deferred.resolve(response.data)},function(error){404===error.status?deferred.resolve(error):$state.go("pageNotFound")}),deferred.promise}]}}).state("contacts.invites",{"abstract":!0,"default":".send",url:"/invites",data:{subNav:"invite-contacts"}}).state("contacts.invites.send",{url:"/send",views:{"content@contacts":{controller:"InviteContactsController",templateUrl:"contacts/views/invite-contacts.html"}}}).state("contacts.invites.sent",{url:"/sent",views:{"content@contacts":{controller:"MyInvitesController",templateUrl:"contacts/views/my-invites.html"}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("dashboard",{url:"/dashboard",views:{layout:{templateUrl:"core/layouts/default.html"},"content@dashboard":{controller:"DashboardController",templateUrl:"dashboard/views/dashboard.html"}},data:{title:"Dashboard",theme:"activities",requireLogin:!0},resolve:{redirect:["$q","$state","AuthService",function($q,$state,AuthService){var deferred=$q.defer();return"host"!==AuthService.currentUser.registrationType?($state.go("activities.find"),deferred.reject()):deferred.resolve(),deferred.promise}],dashboardData:["$q","$rootScope","DashboardService",function($q,$rootScope,DashboardService){$rootScope.$broadcast("showLoading");var deferred=$q.defer();return DashboardService.getDashboardData().then(function(response){deferred.resolve(response.data)}),deferred.promise}]}}).state("marketingTools",{url:"/marketing-tools",views:{layout:{templateUrl:"core/layouts/default.html"},"content@marketingTools":{controller:"MarketingToolsController",templateUrl:"dashboard/views/marketing-tools.html"}},data:{title:"Marketing tools",theme:"activities",requireLogin:!0}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("pageNotFound",{url:"/page-not-found",views:{layout:{templateUrl:"core/layouts/default.html"},"content@pageNotFound":{controller:"ErrorController",templateUrl:"errors/views/not-found.html"}},data:{theme:"wallet"}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("interests",{"abstract":!0,"default":".new",url:"/interests",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{title:"Interests",theme:"profile",requireLogin:!0}}).state("interests.new",{url:"/new",views:{"content@interests":{controller:"NewInterestController",templateUrl:"interests/views/form.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches"])}}}).state("interests.edit",{url:"/edit/:interestId",views:{"content@interests":{controller:"EditInterestController",templateUrl:"interests/views/form.html"}},resolve:{interest:["$stateParams","InterestService",function($stateParams,InterestService){return InterestService.getInterest($stateParams.interestId)}],loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("messages",{"abstract":!0,"default":".inbox",url:"/messages",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{title:"Messages",theme:"messages",requireLogin:!0,subNav:"messages"}}).state("messages.inbox",{url:"/inbox",views:{"content@messages":{controller:"MessageListController",templateUrl:"messages/views/list.html"}},params:{filter:"all"},data:{folder:"inbox"}}).state("messages.sent",{url:"/sent",views:{"content@messages":{controller:"MessageListController",templateUrl:"messages/views/list.html"}},params:{filter:"all"},data:{folder:"sent"}}).state("messages.trash",{url:"/trash",views:{"content@messages":{controller:"MessageListController",templateUrl:"messages/views/list.html"}},params:{filter:"all"},data:{folder:"trash"}}).state("messages.view",{url:"/view/:messageId?reply",views:{"content@messages":{controller:"MessageViewController",templateUrl:"messages/views/message.html"}},params:{folder:null,message:null,filter:null,readOnly:!1},resolve:{message:["$q","$state","$stateParams","MessageService","AlertService",function($q,$state,$stateParams,MessageService,AlertService){var deferred=$q.defer();return MessageService.getMessage($stateParams.messageId).then(function(response){deferred.resolve(response.data)},function(responseError){AlertService.showToast("error","The message you are trying to open cannot be found.",""),$state.go("messages.inbox")}),deferred.promise}]}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("offers",{url:"/offers",views:{layout:{templateUrl:"core/layouts/default.html"},"content@offers":{controller:"OfferListController",templateUrl:"activities/views/offers/list.html"}},data:{title:"My activities",theme:"activities",requireLogin:!0,subNav:"hosted-activities"}}).state("offers.add",{url:"/add",views:{"content@offers":{controller:"NewOfferController",templateUrl:"activities/views/offers/form.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["nouislider"])}}}).state("offers.edit",{url:"/edit/:offerId",views:{"content@offers":{controller:"EditOfferController",templateUrl:"activities/views/offers/form.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["nouislider"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("profile",{url:"/profile",views:{layout:{templateUrl:"core/layouts/default.html"},"content@profile":{controller:"MyProfileController",templateUrl:"contacts/views/profile.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["imageCrop"])},user:["$q","$rootScope","AuthService","UserService",function($q,$rootScope,AuthService,UserService){$rootScope.$broadcast("showLoading");var deferred=$q.defer();return UserService.getUser(AuthService.currentUser.hashId).then(function(response){deferred.resolve(response.data)}),deferred.promise}]},data:{title:"My profile",theme:"profile",requireLogin:!0}}).state("profile.reviewRequest",{url:"/request-review",views:{"content@profile":{controller:"RequestReviewController",templateUrl:"reviews/views/request.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput","js/lib/autosize/dist/autosize.min.js"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("review",{"abstract":!0,url:"/review",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{theme:"contacts"}}).state("review.host",{url:"/:userId?token&redirect",views:{"content@review":{controller:"SubmitReviewController",templateUrl:"reviews/views/form.html"}},params:{redirect:"register"},data:{title:"Leave a review"},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["js/lib/autosize/dist/autosize.min.js"])},user:["$q","$state","$stateParams","AuthService","UserService",function($q,$state,$stateParams,AuthService,UserService){var deferred=$q.defer();return UserService.getUser($stateParams.userId).then(function(response){deferred.resolve(response.data)},function(error){$state.go("pageNotFound")}),deferred.promise}]}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("settings",{"abstract":!0,"default":".account",url:"/settings",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{title:"My settings",theme:"profile",requireLogin:!0,subNav:"settings"}}).state("settings.account",{url:"/account-settings",views:{"content@settings":{controller:"AccountSettingsController",templateUrl:"settings/views/account.html"}}}).state("settings.messages",{url:"/message-settings",views:{"content@settings":{controller:"MessageSettingsController",templateUrl:"settings/views/messages.html"}},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["switches"])}}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("stripe",{"abstract":!0,"default":".connect",url:"/stripe",views:{layout:{templateUrl:"core/layouts/default.html"}},data:{theme:"profile",requireLogin:!0}}).state("stripe.connect",{url:"/connect?code&state&error",views:{"content@stripe":{controller:"StripeController",template:""}},data:{loadingOnlyState:!0}})}),angular.module("hulahub").config(function($stateProvider){$stateProvider.state("register",{url:"/signup?plan&promocode",views:{layout:{templateUrl:"core/layouts/no-navigation.html"},"content@register":{controller:"SignupController",templateUrl:"users/views/signup.html"}},params:{resendEmail:null,pageLoadAlertMessage:null},data:{theme:"wallet",noAccessWhenLoggedIn:!0},resolve:{setRegTypeParameter:function(ParameterService){ParameterService.setData({hostOrJoiner:"joiner"})}}}).state("hostSignup",{url:"/host/signup?plan",views:{layout:{templateUrl:"core/layouts/no-navigation.html"},"content@hostSignup":{controller:"SignupController",templateUrl:"users/views/signup.html"}},params:{resendEmail:null},data:{theme:"wallet",noAccessWhenLoggedIn:!0},resolve:{setRegTypeParameter:function(ParameterService){ParameterService.setData({hostOrJoiner:"host"})}}}).state("register.verify",{url:"/verify/:token",views:{"layout@":{templateUrl:"core/layouts/no-navigation.html"},"content@register.verify":{controller:"VerifyEmailController",template:""}},data:{loadingOnlyState:!0,noAccessWhenLoggedIn:!1},onEnter:function($rootScope){$rootScope.$broadcast("showLoading")}}).state("register.setPassword",{url:"/set-password/:token",views:{"layout@":{templateUrl:"core/layouts/no-navigation.html"},"content@register.setPassword":{controller:"SetPasswordController",templateUrl:"users/views/set-password.html"}}}).state("register.completeProfile",{url:"/create-account",views:{"content@register":{controller:"CompleteProfileController",templateUrl:"users/views/complete-profile.html"}},data:{theme:"profile",requireLogin:!0,noAccessWhenLoggedIn:!1},resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["creditcards"])}}}).state("login",{url:"/login?email",views:{layout:{templateUrl:"core/layouts/no-navigation.html"},"content@login":{controller:"LoginController",templateUrl:"users/views/login.html"}},params:{email:null,redirectUrl:null,pageLoadAlertMessage:null},data:{theme:"wallet",noAccessWhenLoggedIn:!0}}).state("logout",{url:"/logout",views:{layout:{template:""}},data:{requireLogin:!0,loadingOnlyState:!0},onEnter:function($rootScope,AuthService,PollingService,StorageService,ENV){if(AuthService.isMasquerading()){var masqueradeRedirect=decodeURIComponent(StorageService.getCookie("masquerade_redirect"));$rootScope.$broadcast("showLoading"),AuthService.logout(),PollingService.stop(),window.location=masqueradeRedirect}else $rootScope.$broadcast("showLoading"),AuthService.logout(),PollingService.stop(),redirectToPage(ENV)}}).state("resetPassword",{url:"/password-reset",views:{layout:{templateUrl:"core/layouts/no-navigation.html"},"content@resetPassword":{controller:"ResetPasswordController",templateUrl:"users/views/forgotten-password.html"}},data:{theme:"wallet",noAccessWhenLoggedIn:!0}}).state("resetPassword.reset",{url:"/:token",views:{"content@resetPassword":{controller:"ResetPasswordController",templateUrl:"users/views/reset-password.html"}}}).state("masquerade",{url:"/masquerade",views:{layout:{templateUrl:"core/layouts/no-navigation.html"},"content@masquerade":{controller:function($scope,$rootScope,$state,AuthService,UserService,StorageService){AuthService.isMasquerading()?(AuthService.loginInProgress=!0,UserService.getMyDetails(function(){StorageService.removeItem("loginRedirectUrl"),AuthService.loginInProgress=!1,AuthService.save(),"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")},function(){AuthService.logout()})):($scope.errorMessage="Token not found",$rootScope.$broadcast("hideLoading"))},templateUrl:"users/views/masquerade.html"}},params:{redirectUrl:null},data:{theme:"wallet",loadingOnlyState:!0},onEnter:function($rootScope){$rootScope.$broadcast("showLoading")}})}),angular.module("hulahub").factory("ActivityFormService",function($uibModal,$q,$timeout,appSettings,FormService,InterestService){var Activity=function(scope,defaults){var hasEndLocation=!!defaults&&null!==defaults.endLocation;return{currentStep:1,steps:["Description","Photos","Requirements","Location","Dates & times","Pricing"],status:defaults?defaults.status:"draft",publishing:!1,"private":!!defaults&&defaults["private"],bannerImage:defaults?defaults.bannerImage:null,bannerImageChanged:!1,photoGallery:{options:{containment:"parent",cursor:"move",helper:"clone",tolerance:"pointer"},photos:defaults?defaults.series.photoGallery:[],deleted:[]},title:defaults?defaults.series.title:null,summary:defaults?defaults.series.summary:"",description:defaults?defaults.series.description:"",interests:defaults?defaults.series.interests:[],locationType:defaults?defaults.locationType:"fixed",meetingPoint:defaults?defaults.meetingPoint:"public",startLocation:defaults?defaults.startLocation:null,hasEndLocation:hasEndLocation,endLocation:defaults?defaults.endLocation:null,flexibleLocationDistance:defaults?FormService.controls().distanceWithMaxLimit(defaults.flexibleLocationDistance,!0):FormService.controls().distanceWithMaxLimit(3,!0),directions:defaults?defaults.directions:"",dateRange:defaults?FormService.controls().dateRange(defaults.dateRange,!0,!0):FormService.controls().dateRange([null,null],!0,!0),joinCutOffDate:defaults&&defaults.joinCutoffDate?FormService.controls().datePicker(defaults.joinCutoffDate,!0,!0):FormService.controls().datePicker(null,!0,!0),joinCutOffDiff:defaults&&defaults.joinCutoffDate?Math.abs(moment(defaults.joinCutoffDate).diff(moment(defaults.dateRange[0]),"hours")):1,joinCutOffOptions:[{hours:1,label:"1 hour"},{hours:2,label:"2 hours"},{hours:3,label:"3 hours"},{hours:4,label:"4 hours"},{hours:8,label:"8 hours"},{hours:12,label:"12 hours"},{hours:24,label:"1 day"},{hours:48,label:"2 days"},{hours:72,label:"3 days"},{hours:96,label:"4 days"},{hours:120,label:"5 days"},{hours:144,label:"6 days"},{hours:168,label:"1 week"},{hours:0,label:"Custom date"}],isFlexible:!!defaults&&defaults.series.flexible,availability:{duration:{hours:defaults?Math.floor(defaults.series.duration/60):0,minutes:defaults?Math.floor(defaults.series.duration%60):0},days:defaults&&defaults.series.availableDays?_.map(defaults.series.availableDays,function(v){return FormService.controls().timeSlider(v?v:[360,1080],null!==v)}):[FormService.controls().timeSlider([360,1080],!0),FormService.controls().timeSlider([360,1080],!0),FormService.controls().timeSlider([360,1080],!0),FormService.controls().timeSlider([360,1080],!0),FormService.controls().timeSlider([360,1080],!0),FormService.controls().timeSlider([360,1080],!1),FormService.controls().timeSlider([360,1080],!1)],dateRange:defaults&&defaults.series.flexible?FormService.controls().dateRange(defaults.dateRange,!0,!0,!1,1):FormService.controls().dateRange([moment().startOf("day").add(1,"d"),null],!0,!0,!1,1)},hasRepeat:!!defaults&&defaults.hasRepeat,repeat:{frequencyOptions:[{label:"Daily",value:"daily"},{label:"Weekly",value:"weekly"},{label:"Monthly",value:"monthly"}],frequency:defaults&&defaults.hasRepeat?defaults.repeat.frequency:"weekly",until:defaults&&defaults.hasRepeat&&!defaults.repeat.indefinite?FormService.controls().datePicker(defaults.repeat.until,!0,!1):FormService.controls().datePicker(null,!0,!1),indefinite:!defaults||!defaults.hasRepeat||defaults.repeat.indefinite,every:defaults&&defaults.hasRepeat?defaults.repeat.every:1,dow:defaults&&defaults.hasRepeat?defaults.repeat.dow:[!1,!1,!1,!1,!1,!1,!1],dom:defaults&&defaults.hasRepeat?defaults.repeat.dom:{available:_.range(1,32),selected:[]},monthOrdinal:defaults&&defaults.hasRepeat&&defaults.repeat.ordinal?FormService.controls().monthOrdinal(defaults.repeat.ordinal.ordinal,defaults.repeat.ordinal.dow,defaults.repeat.useOrdinal):FormService.controls().monthOrdinal(1,1,!1)},groupSize:defaults?defaults.groupSize:[1,null],age:defaults?defaults.age:[18,null],gender:defaults?defaults.series.gender:"u",difficultyLevel:defaults?defaults.series.difficultyLevel:0,additionalRequirements:defaults?defaults.series.additionalRequirements:"",budget:{availableCurrencies:["GBP"],currency:defaults?defaults.budget.currency:appSettings.currencyTLC,perPerson:{model:defaults&&defaults.budget.perPerson>0?(defaults.budget.perPerson/100).toFixed(2):null,value:function(){return Math.round(100*this.model*100)/100}},total:function(){return parseFloat(this.perPerson.value())}},useCustomBookingURL:!(!defaults||null===defaults.customBookingURL),customBookingURL:defaults?defaults.customBookingURL:null,attachments:defaults&&defaults.series?defaults.series.attachments:[],deletedAttachments:[],copyFrom:null,validationRun:!1,validate:function(newStep){this.validationRun=!1;var valid=!0,invalidStep=null;return newStep>1&&(invalidStep=1,valid=angular.isUndefined(scope.form.$error.interestCount)&&scope.form.title.$valid,this.publishing&&(valid=valid&&scope.form.summary.$valid&&scope.form.description.$valid)),valid&&newStep>2&&this.publishing&&(invalidStep=2,valid=scope.formData.bannerImage&&"delete"!==scope.formData.bannerImage),valid&&newStep>3&&(invalidStep=3,valid=scope.form.ageMin.$valid&&scope.form.ageMax.$valid&&scope.form.groupSizeMin.$valid&&scope.form.groupSizeMax.$valid&&scope.form.additionalRequirements.$valid),valid&&newStep>4&&(invalidStep=4,valid=angular.isUndefined(scope.form.$error.startLocation)&&angular.isUndefined(scope.form.$error.endLocation)),valid&&newStep>5&&(invalidStep=5,this.isFlexible?this.publishing&&(valid=angular.isUndefined(scope.form.$error.flexibleDuration)&&angular.isUndefined(scope.form.$error.flexibleDays)):(valid=angular.isUndefined(scope.form.$error.startDate)&&angular.isUndefined(scope.form.$error.endDate)&&angular.isUndefined(scope.form.$error.joinCutOffDate),this.hasRepeat&&(valid=valid&&scope.form.repeatEvery.$valid&&angular.isUndefined(scope.form.$error.repeatUntilDate)))),valid&&newStep>6&&(invalidStep=6,scope.formData.useCustomBookingURL&&(valid=scope.form.customBookingURL.$valid)),valid||(this.validationRun=!0,this.currentStep=invalidStep,jumpToTop()),valid},changeStep:function(newStep){newStep!==this.currentStep&&("prev"===newStep?newStep=this.currentStep-1:"next"===newStep&&(newStep=this.currentStep+1),this.currentStep=newStep)},serialized:function(){this.calculateJoinCutOff(!1);var obj={status:this.status,"private":this["private"],bannerImage:this.bannerImage,removeExistingBannerImage:this.bannerImageChanged,title:this.title,summary:this.summary,description:this.description,interests:_.map(this.interests,"id"),locationType:this.locationType,meetingPoint:this.meetingPoint,startLocation:this.startLocation?{latitude:this.startLocation.latitude,longitude:this.startLocation.longitude,name:this.startLocation.name,locality:this.startLocation.locality,distance:"flexible"===this.locationType?this.flexibleLocationDistance.getValue():null}:null,endLocation:this.hasEndLocation?this.endLocation:null,directions:this.directions,dateRange:this.dateRange.getValue(),joinCutOffDate:this.joinCutOffDate.getValue(),groupSize:this.groupSize,age:this.age,gender:this.gender,difficultyLevel:this.difficultyLevel,additionalRequirements:this.additionalRequirements,budget:{currency:this.budget.currency,perPerson:this.budget.perPerson.value()},customBookingURL:this.useCustomBookingURL?this.customBookingURL:null,attachmentCount:this.attachments.length,deletedAttachments:_.map(this.deletedAttachments,"id"),photoGallery:this.photoGallery.photos,deletedPhotos:this.photoGallery.deleted,copyFrom:this.copyFrom};if(this.hasRepeat){if(obj.repeat={frequency:this.repeat.frequency,until:this.repeat.until.getValue("YYYY-MM-DD"),every:parseInt(this.repeat.every)},"weekly"===this.repeat.frequency){for(var dows=[],i=0;i<=this.repeat.dow.length;i++)this.repeat.dow[i]&&dows.push(i+1);obj.repeat.dow=dows}if("monthly"===this.repeat.frequency){var o=this.repeat.monthOrdinal.getValue();o?(obj.repeat.ordinal=o.ordinal,obj.repeat.dow=[o.dow]):obj.repeat.dom=this.repeat.dom.selected}}return this.isFlexible&&(obj.dateRange=this.availability.dateRange.getValueFullDays(),obj.joinCutOffDate=null,obj.availability={duration:60*this.availability.duration.hours+this.availability.duration.minutes,days:_.map(this.availability.days,function(v){return v.getValue()})}),obj},loadInterests:function(query){var deferred=$q.defer();return InterestService.searchInterests(query).then(function(r){deferred.resolve({data:r})}),deferred.promise},selectedInterest:function($item){$item&&$item.originalObject&&scope.formData.interests.length<10&&(_.find(scope.formData.interests,function(r){return r.id===$item.originalObject.id||r.name.toLowerCase()===$item.originalObject.name.toLowerCase()})||scope.formData.interests.push($item.originalObject),scope.$broadcast("angucomplete-alt:clearInput"))},removeInterest:function(id){_.remove(scope.formData.interests,["id",id])},checkNotEmpty:function($tag){if(0===$tag.id)return!1},startDateSelected:function(){this.dateRange.startDateChanged(),this.calculateJoinCutOff(!0)},calculateJoinCutOff:function(reset){if((this.joinCutOffDiff>168||0===_.filter(this.joinCutOffOptions,["hours",this.joinCutOffDiff]).length)&&(this.joinCutOffDiff=0),0===this.joinCutOffDiff)if(reset)this.joinCutOffDate.date=moment(this.dateRange.startDate.date).toDate();else{
var jc=moment(this.joinCutOffDate.date),s=moment(this.dateRange.startDate.date);jc.isSame(s,"day")?this.joinCutOffDate.date=s.toDate():this.joinCutOffDate.date=jc.endOf("day").toDate()}else this.joinCutOffDate.date=moment(this.dateRange.getValue()[0]).subtract(this.joinCutOffDiff,"h").toDate()},changeScheduling:function(newType){switch(this.isFlexible&&(this.dateRange.clear(),this.joinCutOffDate.date=null,this.joinCutOffDiff=1),newType){case"repeat":this.isFlexible=!1,this.hasRepeat=!0,this.calculateRepeating();break;case"flexible":this.isFlexible=!0,this.hasRepeat=!1;break;default:this.isFlexible=!1,this.hasRepeat=!1}},calculateRepeating:function(){if(this.hasRepeat){var startDate=moment(this.dateRange.startDate.date);this.repeat.dow=_.map(this.repeat.dow,!1),this.repeat.dow[startDate.format("E")-1]=!0,this.repeat.dom.selected=[parseInt(startDate.format("D"))];var nth=Math.ceil(startDate.date()/7);if(4===nth){var nextWeek=moment(startDate).add(7,"d");startDate.get("month")!==nextWeek.get("month")&&(nth=5)}this.repeat.monthOrdinal.value={ordinal:nth,dow:parseInt(startDate.format("E"))}}},changeDoW:function(i){this.repeat.dow[i]=!this.repeat.dow[i],_.some(this.repeat.dow)||(this.repeat.dow[i]=!0)},changeMonthlyRepeatType:function(ordinal){this.repeat.monthOrdinal.enabled=ordinal},selectDoM:function(i){if(!this.repeat.monthOrdinal.enabled){var index=this.repeat.dom.selected.indexOf(i);index===-1?this.repeat.dom.selected.push(i):this.repeat.dom.selected.length>1&&this.repeat.dom.selected.splice(index,1)}},changeBannerImage:function(){var self=this;$uibModal.open({templateUrl:"core/partials/photo-upload-modal.html",controller:"PhotoUploadModalController",keyboard:!1,backdrop:"static",resolve:{data:function(){return{title:"Edit activity photo",theme:"activities",aspectRatio:1,selectedImage:"delete"===self.bannerImage?null:self.bannerImage,croppedSize:{width:500},onSave:function(croppedDataBlob,closeModal,onError){null!==self.bannerImage&&(self.bannerImageChanged=!0),self.bannerImage=croppedDataBlob,closeModal()}}}}})},clearBannerImage:function(){var self=this;showConfirm("Delete cover photo","Are you sure you want to delete your cover photo?",function(){$timeout(function(){self.bannerImage="delete",self.bannerImageChanged=!0},0)})},addPhotoGalleryImage:function(){var self=this;$uibModal.open({templateUrl:"core/partials/photo-upload-modal.html",controller:"PhotoUploadModalController",keyboard:!1,backdrop:"static",resolve:{data:function(){return{title:"Photo gallery",theme:"activities",aspectRatio:1,selectedImage:null,croppedSize:{width:500},onSave:function(croppedDataBlob,closeModal,onError){self.photoGallery.photos.push({id:null,data:croppedDataBlob}),closeModal()}}}}})},removePhotoGalleryImage:function(index){var self=this;showConfirm("Delete photo","Are you sure you want to delete this photo?",function(){$timeout(function(){var photo=self.photoGallery.photos[index];null!==photo.id&&self.photoGallery.deleted.push(photo.id),self.photoGallery.photos.splice(index,1)},0)})},removeAttachment:function(index){var attachment=this.attachments[index];attachment instanceof window.Blob||this.deletedAttachments.push(attachment),this.attachments.splice(index,1)}}};return{loadNew:function(scope){return new Activity(scope)},loadCopy:function(scope,original){original.startDate=original.series.flexible?moment().startOf("day").add(1,"d"):null,original.endDate=null,original.status="draft",original.joinCutoffDate=null,original.series.until=null;var a=this.loadFromAPI(scope,original);return a.copyFrom=original.id,a},loadFromAPI:function(scope,activity){return activity["private"]=activity.series["private"],activity.startLocation={name:activity.startLocationName,locality:activity.startLocationLocality,latitude:activity.startLatitude,longitude:activity.startLongitude},activity.endLocation=null!==activity.endLocationName?{name:activity.endLocationName,locality:activity.endLocationLocality,latitude:activity.endLatitude,longitude:activity.endLongitude}:null,activity.locationType=null!==activity.series.flexibleLocationDistance?"flexible":"fixed",activity.flexibleLocationDistance=null!==activity.series.flexibleLocationDistance?activity.series.flexibleLocationDistance:3,activity.dateRange=[activity.startDate,activity.endDate],activity.hasRepeat=null!==activity.series&&null!==activity.series.frequency,activity.repeat=activity.hasRepeat?{frequency:activity.series.frequency,until:activity.series.until,indefinite:activity.series.repeatIndefinitely,every:activity.series.every,dow:_.map([!1,!1,!1,!1,!1,!1,!1],function(v,i){return activity.series.dow&&activity.series.dow.indexOf(i+1)!==-1}),dom:{available:_.range(1,32),selected:activity.series.dom?activity.series.dom:[]},ordinal:activity.series.ordinal?{ordinal:activity.series.ordinal,dow:activity.series.dow[0]}:null,useOrdinal:null!==activity.series.ordinal}:null,activity.isFlexible=angular.isDefined(activity.availability)&&null!==activity.availability,activity.availability=activity.isFlexible?{duration:[],days:[]}:null,activity.groupSize=[activity.groupSizeMin,activity.groupSizeMax],activity.age=[activity.series.ageMin,activity.series.ageMax],activity.budget={currency:activity.series.budgetCurrency,perPerson:activity.series.budgetPerPerson},new Activity(scope,activity)},runWatchers:function($scope){$scope.$watchCollection("formData.interests",function(items){$scope.form.$setValidity("interestCount",items.length>=1)}),$scope.$watch("formData.startLocation",function(startLocation){$scope.form.$setValidity("startLocation",null!==startLocation&&startLocation.latitude&&startLocation.longitude)}),$scope.$watchGroup(["formData.hasEndLocation","formData.endLocation"],function(newValues,oldValues){newValues[0]!==oldValues[0]&&(newValues[0]?$scope.form.$setValidity("endLocation",null!==newValues[1]&&newValues[1].latitude&&newValues[1].longitude):$scope.form.$setValidity("endLocation",!0))}),$scope.$watch("formData.dateRange",function(ranges){var values=ranges.getValue(),startDate=moment(values[0]);if($scope.form.$setValidity("startDate",startDate.isValid()&&startDate.isAfter()),ranges.endDate.date){var endDate=moment(values[1]);$scope.form.$setValidity("endDate",endDate.isAfter(startDate))}if($scope.formData.hasRepeat)if(null===$scope.formData.repeat.until.date)$scope.form.$setValidity("repeatUntilDate",!0);else{var repeatUntilDate=moment($scope.formData.repeat.until.date);$scope.form.$setValidity("repeatUntilDate",repeatUntilDate.isAfter(startDate))}},!0),$scope.$watch("formData.repeat.until.date",function(date){var dateRange=$scope.formData.dateRange.getValue(),startDate=moment(dateRange[0]);if($scope.formData.hasRepeat)if(null===date)$scope.form.$setValidity("repeatUntilDate",!0);else{var repeatUntilDate=moment(date);$scope.form.$setValidity("repeatUntilDate",repeatUntilDate.isAfter(startDate))}}),$scope.$watch("formData.joinCutOffDate.date",function(date){null===date?$scope.form.$setValidity("joinCutOffDate",!0):isNaN(date.getTime())||$scope.form.$setValidity("joinCutOffDate",moment(date).isAfter(moment()))});var flexibleDurationWatcher=null,flexibleDayWatcher=null;$scope.$watch("formData.isFlexible",function(flexible){flexible?(flexibleDurationWatcher=$scope.$watch("formData.availability.duration",function(duration){$scope.form.$setValidity("flexibleDuration",duration.hours>0||duration.minutes>0)},!0),flexibleDurationWatcher=$scope.$watchGroup(["formData.availability.days[0].enabled","formData.availability.days[1].enabled","formData.availability.days[2].enabled","formData.availability.days[3].enabled","formData.availability.days[4].enabled","formData.availability.days[5].enabled","formData.availability.days[6].enabled"],function(days){$scope.form.$setValidity("flexibleDays",_.some(days))},!0)):(null!==flexibleDurationWatcher&&flexibleDurationWatcher(),null!==flexibleDayWatcher&&flexibleDayWatcher())})}}}),angular.module("hulahubShared").factory("ActivityService",function($http,ENV,$log,Upload,AuthService){return{getMyActivities:function(month,type,success,error){$http.get(ENV.api+"/activity/"+type+"/"+month).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch activities"),void 0!==error&&error(responseError)})},getFlexibleActivities:function(success,error){$http.get(ENV.api+"/activity/hosted/flexible").then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch flexible activities"),void 0!==error&&error(responseError)})},getDrafts:function(success,error){$http.get(ENV.api+"/activity/hosted/draft").then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch draft activities"),void 0!==error&&error(responseError)})},searchActivities:function(data,lastSearch,success,error){$http.post(ENV.api+"/activity/search",data).then(function(response){success(response.data,lastSearch)},function(responseError){$log.error("Failed to search published activities"),void 0!==error&&error(responseError)})},matchedActivities:function(data,lastSearch,success,error){$http.post(ENV.api+"/activity/matched",data).then(function(response){success(response.data,lastSearch)},function(responseError){$log.error("Failed to search published activities"),void 0!==error&&error(responseError)})},getRandomFeatured:function(success,error){$http.get(ENV.api+"/activity/featured").then(function(response){success(response.data)},function(responseError){$log.error("Failed to get random featured activities"),void 0!==error&&error(responseError)})},getActivityForEditing:function(activityId){return $http.get(ENV.api+"/activity/"+activityId)},getActivityPublic:function(activity,success,error){var url=ENV.api+"/activity"+(activity.isExternal?"/external":"")+"/public/"+activity.id;$http.get(url).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch activity info"),void 0!==error&&error(responseError)})},getSeries:function(seriesId,instanceId){var url=ENV.api+"/activity/series/"+seriesId;return instanceId&&(url+="/"+instanceId),$http.get(url)},getInstances:function(seriesId,success){$http.get(ENV.api+"/activity/instances/"+seriesId).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch activity instances"),void 0!==error&&error(responseError)})},getRelatedActivities:function(activityId,isExternal,success,error){$http.get(ENV.api+"/activity/related/"+activityId+"/"+isExternal).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch activity info"),void 0!==error&&error(responseError)})},deleteActivity:function(activityId,success,error){$http["delete"](ENV.api+"/activity/"+activityId).then(function(response){success(response.data)},function(responseError){$log.error("Failed to delete activity"),void 0!==error&&error(responseError)})},save:function(data,success,saveErrorCallback,uploadErrorCallback){var self=this;$http.post(ENV.api+"/activity/save",data.serialized()).then(function(response){var newUploads=_.filter(data.attachments,function(a){return a instanceof window.Blob});newUploads.length?self.uploadFiles(response.data,data.attachments,function(){success(response.data)},function(uploadError){uploadErrorCallback(uploadError,response)}):success(response.data)},function(saveError){$log.error("Failed to save activity"),saveErrorCallback(saveError)})},update:function(activityId,data,series,success,saveErrorCallback,uploadErrorCallback){var url=ENV.api+"/activity/save/"+activityId;series&&(url+="/"+series);var self=this;$http.put(url,data.serialized()).then(function(response){var newUploads=_.filter(data.attachments,function(a){return a instanceof window.Blob});newUploads.length?self.uploadFiles(response.data,newUploads,function(){success(response.data)},function(uploadError){uploadErrorCallback(uploadError,response)}):success(response.data)},function(saveError){$log.error("Failed to update activity"),saveErrorCallback(saveError)})},uploadFiles:function(saveResponse,attachments,success,error){Upload.upload({url:ENV.api+"/upload/activity/"+saveResponse.series,data:{attachments:attachments}}).then(function(response){success(response)},function(response){$log.error(response),void 0!==error&&error(response)})},cancel:function(activityId,data,success){$http.post(ENV.api+"/activity/"+activityId+"/cancel",data).then(function(response){success(response.data)})},publishSeries:function(seriesId,success){$http.put(ENV.api+"/activity/"+seriesId+"/publish").then(function(response){success(response.data)})},joinAttempt:function(activityId){return $http.get(ENV.api+"/activity/join-attempt/"+activityId)},join:function(data,success,error){$http.post(ENV.api+"/activity/join",data).then(function(response){response.newFriend&&(AuthService.currentUser.contactCount++,AuthService.save()),success(response.data)},function(responseError){$log.error("Failed to join activities"),void 0!==error&&error(responseError)})},cancelBooking:function(activityId,data,success,error){$http.post(ENV.api+"/activity/"+activityId+"/cancel-booking",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to cancel booking"),void 0!==error&&error(responseError)})},getDiscussionBoardPosts:function(activityHashId,success,error){$http.get(ENV.api+"/board/"+activityHashId+"/posts").then(function(response){success(response.data)},function(responseError){$log.error("Failed to get discussion board posts"),void 0!==error&&error(responseError)})},postToDiscussionBoard:function(activityHashId,data,success,error){$http.post(ENV.api+"/board/"+activityHashId+"/posts",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get discussion board posts"),void 0!==error&&error(responseError)})},removeDiscussionBoardPost:function(activityHashId,postId){$http["delete"](ENV.api+"/board/"+activityHashId+"/posts/"+postId)},getRandomFeaturedActivities:function(success,error){$http.get(ENV.api+"/activity/featured").then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch featured activities"),void 0!==error&&error(responseError)})},joinExternal:function(source,data,success,error){$http.post(ENV.api+"/imin/join",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch activities"),void 0!==error&&error(responseError)})},suggestActivity:function(data){return $http.post(ENV.api+"/activity/suggest",data)}}}),angular.module("hulahubShared").factory("AlertService",function(){return{showToast:function(type,title,message){var options={success:{color:"green",icon:"ico ico-tick"},error:{color:"red",icon:"ico ico-cross"},warning:{color:"yellow",icon:"ico ico-exclamation"}};iziToast.show(_.extend(options[type],{title:title,message:message}))}}}),angular.module("hulahubShared").service("AnalyticsService",function($window,$log,ENV,AuthService){return{run:function(){null==ENV.gtmContainerId||AuthService.isMasquerading()?$log.info("Analytics - load"):angular.element(document).ready(function(){!function(w,d,s,l,i){w[l]=w[l]||[],w[l].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl="dataLayer"!=l?"&l="+l:"";j.async=!0,j.src="https://www.googletagmanager.com/gtm.js?id="+i+dl,f.parentNode.insertBefore(j,f)}(window,document,"script","dataLayer",ENV.gtmContainerId)})},trigger:function(label,params){angular.isUndefined(params)&&(params={}),null==ENV.gtmContainerId||AuthService.isMasquerading()?$log.info("Analytics event - "+label+" with params: "+JSON.stringify(params)):dataLayer.push(_.merge({event:label},params))},sendEvent:function(category,action,label,value){this.trigger("UA_Event",{eventCategory:category,eventAction:action,eventLabel:label,eventValue:value})},sendGoalEvent:function(action,userId){angular.isUndefined(userId)&&(userId=AuthService.currentUser.id),this.sendEvent("HH - Goal",action,userId,0)},sendUserBehaviourEvent:function(action,value){angular.isUndefined(value)&&(value=0);var userId=AuthService.isLoggedIn?AuthService.currentUser.id:null;this.sendEvent("HH - User - Behaviour",action,userId,value)}}}),angular.module("hulahubShared").factory("AuthService",function($http,$injector,ENV,StorageService){var savedUser=JSON.parse(StorageService.getItem("session.currentUser"));return{isLoggedIn:null!==savedUser,loginInProgress:!1,currentUser:savedUser,accessToken:JSON.parse(StorageService.getItem("session.accessToken")),refreshToken:JSON.parse(StorageService.getItem("session.refreshToken")),masqueradeToken:StorageService.getItem("masquerade_token"),isMasquerading:function(){return angular.isDefined(this.masqueradeToken)&&null!==this.masqueradeToken},getAccessToken:function(endpoint,data,success,error){var UserService=$injector.get("UserService");this.loginInProgress=!0;var self=this;$http.post(ENV.api+endpoint,data).then(function(response){self.setTokens(response.data.access_token,response.data.refresh_token),UserService.getMyDetails(function(){success()},function(responseError){self.logout(),void 0!==error&&error(responseError)})},function(responseError){"password"!==data.grant_type&&self.logout(),void 0!==error&&error(responseError)})},setTokens:function(accessToken,refreshToken){this.accessToken=accessToken,this.refreshToken=refreshToken,this.save()},save:function(forceCookie){angular.isUndefined(forceCookie)&&(forceCookie=!1),forceCookie?(StorageService.setCookie("session.currentUser",JSON.stringify(this.currentUser)),StorageService.setCookie("session.accessToken",JSON.stringify(this.accessToken)),StorageService.setCookie("session.refreshToken",JSON.stringify(this.refreshToken))):(StorageService.setItem("session.currentUser",JSON.stringify(this.currentUser)),StorageService.setItem("session.accessToken",JSON.stringify(this.accessToken)),StorageService.setItem("session.refreshToken",JSON.stringify(this.refreshToken)),StorageService.removeCookie("session.currentUser"),StorageService.removeCookie("session.accessToken"),StorageService.removeCookie("session.refreshToken"))},logout:function(){this.isLoggedIn=!1,this.currentUser=null,this.accessToken=null,this.refreshToken=null,StorageService.clear();var IntercomService=$injector.get("IntercomService");IntercomService.shutdown()}}}),angular.module("hulahubShared").factory("AvailabilityService",function($http,ENV,$log){return{getAvailability:function(activityHashId,success,error){$http.get(ENV.api+"/availability/"+activityHashId).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get availability"),void 0!==error&&error(responseError)})},requestBooking:function(activityHashId,data,success,error){$http.post(ENV.api+"/availability/"+activityHashId+"/request",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to request a booking"),void 0!==error&&error(responseError)})},getBookingRequests:function(madeOrReceived,success,error){$http.get(ENV.api+"/availability/requests/"+madeOrReceived).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get booking requests"),void 0!==error&&error(responseError)})},manageBookingRequest:function(requestId,data,success,error){$http.put(ENV.api+"/availability/request/"+requestId+"/respond",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get booking requests"),void 0!==error&&error(responseError)})},updateBookingRequest:function(requestId,data,success,error){$http.put(ENV.api+"/availability/request/"+requestId+"/update",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get booking requests"),void 0!==error&&error(responseError)})},deleteBookingRequest:function(requestId){$http["delete"](ENV.api+"/availability/request/"+requestId)}}}),angular.module("hulahubShared").service("BrowseActivityService",function($uibModal,$timeout,$filter,AlertService,StorageService,ActivityService,AnalyticsService){this.load=function($scope,filterTheme,modalParams){$scope.filterTheme=filterTheme;var lastSearch,dateFormat="YYYY-MM-DD HH:mm:ss",today=moment().startOf("day"),defaultDates={startDate:today.startOf("day"),endDate:moment().add(6,"months").endOf("day")};$scope.formData={text:null,location:null,filters:{date:{ranges:{all:defaultDates,thisWeek:{label:"This week",startDate:moment().startOf("isoWeek"),endDate:moment().endOf("isoWeek")},nextWeek:{label:"Next week",startDate:moment().add(1,"week").startOf("isoWeek"),endDate:moment().add(1,"week").endOf("isoWeek")},thisMonth:{label:"This month",startDate:moment().startOf("month"),endDate:moment().endOf("month")},nextMonth:{label:"Next month",startDate:moment().add(1,"month").startOf("month"),endDate:moment().add(1,"month").endOf("month")}},model:_.clone(defaultDates),setModel:function(model){this.model.startDate=model.startDate,this.model.endDate=model.endDate},selectedRange:"all",options:{autoApply:!0,minDate:today,locale:{format:"DD/MM/YYYY",firstDay:1},linkedCalendars:$(window).width()>=768,parentEl:$(window).width()>=768?"#dateFilterPopup":".fullScreenModal"},setValue:function(range){this.selectedRange=range,"custom"!==range&&(this.model=_.clone(this.ranges[range]))},getLabel:function(){return"all"===this.selectedRange?"Date":"custom"===this.selectedRange?moment(this.model.startDate).format("DD/MM/YYYY")+" - "+moment(this.model.endDate).format("DD/MM/YYYY"):this.ranges[this.selectedRange].label}},time:{options:[{key:0,value:"12am"},{key:1,value:"1am"},{key:2,value:"2am"},{key:3,value:"3am"},{key:4,value:"4am"},{key:5,value:"5am"},{key:6,value:"6am"},{key:7,value:"7am"},{key:8,value:"8am"},{key:9,value:"9am"},{key:10,value:"10am"},{key:11,value:"11am"},{key:12,value:"12pm"},{key:13,value:"1pm"},{key:14,value:"2pm"},{key:15,value:"3pm"},{key:16,value:"4pm"},{key:17,value:"5pm"},{key:18,value:"6pm"},{key:19,value:"7pm"},{key:20,value:"8pm"},{key:21,value:"9pm"},{key:22,value:"10pm"},{key:23,value:"11pm"},{key:24,value:"Midnight"}],hideMidnight:function(o){return 24!==o.key},ranges:{all:{min:0,max:24},morning:{label:"Morning",min:0,max:12},afternoon:{label:"Afternoon",min:12,max:18},evening:{label:"Evening",min:18,max:24}},model:{min:0,max:24},selectedRange:"all",setValue:function(range){this.selectedRange=range,"custom"!==range&&(this.model=_.clone(this.ranges[range]))},getLabel:function(){return"all"===this.selectedRange?"Time of day":"custom"===this.selectedRange?this.options[this.model.min].value+" - "+this.options[this.model.max].value:this.ranges[this.selectedRange].label}},price:{ranges:{all:{min:0,max:null},free:{label:"Free",min:0,max:0},custom:{label:"Paid",min:1,max:null}},model:{min:0,max:null},valid:function(){return null===this.model.max||""===this.model.max||parseInt(this.model.min)<=parseInt(this.model.max)},getMinPennies:function(){return Math.round(100*this.model.min*100)/100},getMaxPennies:function(){return Math.round(100*this.model.max*100)/100},selectedRange:"all",setValue:function(range){this.selectedRange=range,"custom"!==range&&(this.model=_.clone(this.ranges[range]))},getLabel:function(){return"all"===this.selectedRange?"Price":"custom"!==this.selectedRange?"Free":null===this.model.max||""===this.model.max?$filter("currencyDisplay")(this.getMinPennies(),"GBP",!0,!1,!1)+"+":$filter("currencyDisplay")(this.getMinPennies(),"GBP",!0,!1,!1)+" - "+$filter("currencyDisplay")(this.getMaxPennies(),"GBP",!0,!1,!1)}},age:{ranges:{all:{min:0,max:null},adults:{label:"Adults only",min:18,max:null},children:{label:"Child friendly",min:0,max:17}},valid:function(){return null===this.model.max||""===this.model.max||parseInt(this.model.min)<=parseInt(this.model.max)},model:{min:0,max:null},selectedRange:"all",setValue:function(range){this.selectedRange=range,"custom"!==range&&(this.model=_.clone(this.ranges[range]))},getLabel:function(){return"all"===this.selectedRange?"Age":"custom"!==this.selectedRange?this.ranges[this.selectedRange].label:null===this.model.max||""===this.model.max?(this.model.min||0)+"+ yrs":this.model.min+" - "+this.model.max+" yrs"}},gender:{value:"u",setValue:function(newValue){this.value=newValue},getLabel:function(){return"u"===this.value?"Gender":$filter("genderDisplay")(this.value)+" only"}},difficultyLevel:{value:0,setValue:function(newValue){this.value=newValue},getLabel:function(){return 0===this.value?"Skill level":$filter("difficultyDisplay")(this.value)}},other:{value:{unique:!1,otherHosts:!1},setValue:function(newValue){this.value=newValue},getLabel:function(){return this.value.unique?"Featured":"Other"}},hasFilters:function(){return"all"!==this.date.selectedRange||"all"!==this.time.selectedRange||"all"!==this.price.selectedRange||"all"!==this.age.selectedRange||"u"!==this.gender.value||0!==this.difficultyLevel.value||this.other.value.unique},clearAll:function(){this.date.setValue("all"),this.time.setValue("all"),this.price.setValue("all"),this.age.setValue("all"),this.gender.value="u",this.difficultyLevel.value=0,this.other.value.unique=!1}},sort:{options:[{key:"top_picks",value:"Top picks"},{key:"score",value:"Most relevant"},{key:"distance",value:"Distance"},{key:"price_low",value:"Price (Low)"},{key:"price_high",value:"Price (High)"}],value:"top_picks",manuallyChangedSortOption:!1,getLabel:function(){return(_.find(this.options,{key:this.value})||this.options[0]).value.toLowerCase()},optionShouldShow:function(o){return"distance"!==o.key||"distance"===o.key&&null!==$scope.formData.location}},pagination:{current:1,perPage:$(window).width()>768?12:6,loadedFromSession:!1},serialized:function(){return{text:this.text,location:this.location?{latitude:this.location.latitude,longitude:this.location.longitude}:null,filters:{date:{from:this.filters.date.model.startDate.format(dateFormat),to:this.filters.date.model.endDate.format(dateFormat)},time:{min:this.filters.time.model.min,max:this.filters.time.model.max},price:{min:null!==this.filters.price.model.min&&""!==this.filters.price.model.min?this.filters.price.getMinPennies():1,max:null!==this.filters.price.model.max&&""!==this.filters.price.model.max?this.filters.price.getMaxPennies():null},age:{min:null!==this.filters.age.model.min&&""!==this.filters.age.model.min?parseInt(this.filters.age.model.min):0,max:null!==this.filters.age.model.max&&""!==this.filters.age.model.max?parseInt(this.filters.age.model.max):null},gender:this.filters.gender.value,difficultyLevel:this.filters.difficultyLevel.value,other:_.keys(_.pickBy(this.filters.other.value))},sort:this.sort.value,pagination:{current:this.pagination.current,perPage:this.pagination.perPage}}},sessionData:function(){return{text:this.text,location:this.location,filters:{date:{from:this.filters.date.model.startDate.format(dateFormat),to:this.filters.date.model.endDate.format(dateFormat),selectedRange:this.filters.date.selectedRange},time:{min:this.filters.time.model.min,max:this.filters.time.model.max,selectedRange:this.filters.time.selectedRange},price:{min:this.filters.price.model.min,max:this.filters.price.model.max,selectedRange:this.filters.price.selectedRange},age:{min:this.filters.age.model.min,max:this.filters.age.model.max,selectedRange:this.filters.age.selectedRange},gender:this.filters.gender.value,difficultyLevel:this.filters.difficultyLevel.value,other:this.filters.other.value},sort:{value:this.sort.value,manuallyChangedSortOption:this.sort.manuallyChangedSortOption},pagination:this.pagination}},loadFromSession:function(data){this.text=data.text,this.location=data.location,this.filters.date.selectedRange=data.filters.date.selectedRange;var startDate=moment(data.filters.date.from,dateFormat);startDate.isBefore(today)?"custom"===this.filters.date.selectedRange?(this.filters.date.model=_.clone(defaultDates),this.filters.date.selectedRange="all"):this.filters.date.model=_.clone(this.filters.date.ranges[this.filters.date.selectedRange]):this.filters.date.model={startDate:moment(data.filters.date.from,dateFormat),endDate:moment(data.filters.date.to,dateFormat)},this.filters.time.model={min:data.filters.time.min,max:data.filters.time.max},this.filters.time.selectedRange=data.filters.time.selectedRange,this.filters.price.model={min:data.filters.price.min,max:data.filters.price.max},this.filters.price.selectedRange=data.filters.price.selectedRange,this.filters.age.model={min:data.filters.age.min,max:data.filters.age.max},this.filters.age.selectedRange=data.filters.age.selectedRange,this.filters.gender.value=data.filters.gender,this.filters.difficultyLevel.value=data.filters.difficultyLevel,data.filters.other&&(this.filters.other.value=data.filters.other),this.sort.value=data.sort.value,this.sort.manuallyChangedSortOption=data.sort.manuallyChangedSortOption,this.pagination.current=data.pagination.current,this.pagination.loadedFromSession=!0},search:function(resetPageNumber){resetPageNumber&&(this.pagination.current=1),$scope.loading=!0,null===this.sort.value&&(this.sort.value="score"),lastSearch=JSON.stringify(this.sessionData()),StorageService.setItem("hh-activity-search",lastSearch,!0),ActivityService.searchActivities(this.serialized(),lastSearch,function(response,originalSearch){if(originalSearch===lastSearch){$scope.results=response,$scope.loading=!1;var search=JSON.parse(originalSearch),searchAction=(null===search.text?"Everything":search.text)+(null!==search.location?"|"+search.location.name:""),filters=[];"all"!==search.filters.date.selectedRange&&filters.push(search.filters.date.selectedRange),"all"!==search.filters.time.selectedRange&&filters.push(search.filters.time.selectedRange),"all"!==search.filters.price.selectedRange&&filters.push("Â£"+search.filters.price.min+"-Â£"+search.filters.price.max),"all"!==search.filters.age.selectedRange&&filters.push(search.filters.age.min+(search.filters.age.max?"-"+search.filters.age.max:"+")+" yrs"),"u"!==search.filters.gender&&filters.push($filter("genderDisplay")(search.filters.gender).toLowerCase()),0!==search.filters.difficultyLevel&&filters.push($filter("difficultyDisplay")(search.filters.difficultyLevel).toLowerCase()),search.filters.other.unique&&filters.push("unique"),AnalyticsService.sendEvent("HH - Search","null"===searchAction?"Everything":searchAction,filters.join("|"),response.totalCount),$scope.formData.pagination.loadedFromSession=!1,$scope.initialSearch=!0}},function(errorResponse){$scope.loading=!1,AlertService.showToast("error","An error has occurred while searching for activities.","Please try again later.")})}},$scope.changePage=function(newPage){jumpToTop(),$scope.formData.pagination.current=newPage,$scope.formData.search(!1)},$scope.$watch("formData.text",_.debounce(function(newVal,oldVal){oldVal!==newVal&&($scope.formData.sort.manuallyChangedSortOption||($scope.formData.sort.value="score"),$scope.formData.search(!$scope.formData.pagination.loadedFromSession))},1e3)),$scope.$watch("formData.location",function(newVal,oldVal){var oldString=JSON.stringify(oldVal),newString=JSON.stringify(newVal);oldString!==newString&&($scope.formData.sort.manuallyChangedSortOption||($scope.formData.sort.value="score"),$scope.formData.search(!$scope.formData.pagination.loadedFromSession))}),$scope.changeSortOption=function(key){$scope.formData.sort.manuallyChangedSortOption=!0,$scope.formData.sort.value=key},$scope.$watch("formData.sort.value",function(newVal,oldVal){oldVal!==newVal&&($scope.formData.pagination.loadedFromSession||($scope.formData.pagination.current=1),$scope.formData.search(!0))}),$scope.showFilterModal=function(){$uibModal.open(_.extend({scope:$scope,windowClass:"fullScreenModal",keyboard:!1,backdrop:"static",controller:function($scope){$scope.inMemoryData=_.cloneDeep($scope.formData),$scope.$watch("inMemoryData.filters.time.model.min",function(newVal,oldVal){oldVal!==newVal&&newVal>$scope.inMemoryData.filters.time.model.max&&($scope.inMemoryData.filters.time.model.max=24)}),$scope.maxTimeOptionShouldShow=function(o){return o.key>$scope.inMemoryData.filters.time.model.min},$scope.applyFilter=function(){
$scope.formData.filters.date.model.startDate=$scope.inMemoryData.filters.date.model.startDate,$scope.formData.filters.date.model.endDate=$scope.inMemoryData.filters.date.model.endDate,$scope.formData.filters.date.setValue($scope.inMemoryData.filters.date.selectedRange),$scope.formData.filters.time.model.min=$scope.inMemoryData.filters.time.model.min,$scope.formData.filters.time.model.max=$scope.inMemoryData.filters.time.model.max,$scope.formData.filters.time.setValue($scope.inMemoryData.filters.time.selectedRange),$scope.formData.filters.price.model.min=$scope.inMemoryData.filters.price.model.min,$scope.formData.filters.price.model.max=$scope.inMemoryData.filters.price.model.max,$scope.formData.filters.price.setValue($scope.inMemoryData.filters.price.selectedRange),$scope.formData.filters.age.model.min=$scope.inMemoryData.filters.age.model.min,$scope.formData.filters.age.model.max=$scope.inMemoryData.filters.age.model.max,$scope.formData.filters.age.setValue($scope.inMemoryData.filters.age.selectedRange),$scope.formData.filters.gender.value=$scope.inMemoryData.filters.gender.value,$scope.formData.filters.difficultyLevel.value=$scope.inMemoryData.filters.difficultyLevel.value,$scope.formData.filters.other.value.unique=$scope.inMemoryData.filters.other.value.unique,$scope.formData.search(!0),$scope.$close()}}},modalParams))}}}),angular.module("hulahubShared").factory("CallBackService",function($http,ENV){return{request:function(data,success,error){$http.post(ENV.api+"/callback",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},contactHulaHub:function(data,success,error){$http.post(ENV.api+"/contact",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},enterpriseContact:function(data,success,error){$http.post(ENV.api+"/contact/enterprise-contact",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})}}}),angular.module("hulahub").factory("ContactService",function($http,ENV,AuthService){return{searchContacts:function(data,success,error){$http.post(ENV.api+"/friends/search",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},sendContactRequest:function(userId,error){$http.get(ENV.api+"/friends/hula/"+userId).then(angular.noop,function(response){void 0!==error&&error(response)})},respondToContactRequest:function(userId,action,success,error){var service=this;$http.get(ENV.api+"/friends/hula/"+userId+"/"+action).then(function(response){"accept"===action&&service.changeContactCount(1),success(response)},function(response){void 0!==error&&error(response)})},removeContact:function(userId,success,error){var service=this;$http["delete"](ENV.api+"/friends/unfriend/"+userId).then(function(response){service.changeContactCount(-1),success(response)},function(response){void 0!==error&&error(response)})},findContacts:function(emailAddresses,success,error){var service=this;$http.post(ENV.api+"/friends/find",{emails:emailAddresses}).then(function(response){service.changeContactCount(response.data.friendsAdded.length),success(response.data)},function(response){void 0!==error&&error(response)})},findFacebookFriends:function(data,success,error){var service=this;$http.post(ENV.api+"/friends/facebook",data).then(function(response){service.changeContactCount(response.data.friendsAdded.length),success(response.data)},function(response){void 0!==error&&error(response)})},changeContactCount:function(amount){AuthService.currentUser.contactCount+=amount,AuthService.save()},getGroups:function(success,error){$http.get(ENV.api+"/groups/all").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getGroup:function(groupId,success,error){$http.get(ENV.api+"/groups/"+groupId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},createGroup:function(name,success,error){$http.post(ENV.api+"/groups/create",{name:name}).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},editGroup:function(groupId,data,success,error){$http.put(ENV.api+"/groups/"+groupId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},removeGroup:function(groupId,success,error){$http["delete"](ENV.api+"/groups/"+groupId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getGroupsForContact:function(contactId,success,error){$http.get(ENV.api+"/groups/friend/"+contactId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},addContactToGroups:function(contactId,data,success,error){$http.put(ENV.api+"/groups/friend/"+contactId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})}}}),angular.module("hulahub").factory("CouponService",function($http,ENV){return{validateCoupon:function(code,activityId,success,error){$http.get(ENV.api+"/coupon/validate/"+encodeURIComponent(code)+"/"+activityId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})}}}),angular.module("hulahub").factory("DashboardService",function($http,$log,ENV){return{getDashboardData:function(){return $http.get(ENV.api+"/dashboard")},getHostStats:function(success,error){return $http.get(ENV.api+"/dashboard/host-stats").then(function(response){success(response.data)},function(responseError){$log.error("Failed to get host stats"),void 0!==error&&error(responseError)})}}}),angular.module("hulahub").service("FilterService",function(FormService){var accordion={interests:{visible:!1,open:!1},location:{visible:!1,open:!1},people:{visible:!1,open:!1},timing:{visible:!1,open:!1},budget:{visible:!1,open:!1},status:{visible:!1,open:!1},setVisible:function(sections){this.interests.visible=!1,this.location.open=!1,this.people.visible=!1,this.timing.visible=!1,this.budget.visible=!1,this.status.visible=!1;for(var i=sections.length;i--;)this[sections[i]].visible=!0},setOpen:function(sections){this.interests.open=!1,this.location.open=!1,this.people.open=!1,this.timing.open=!1,this.budget.open=!1,this.status.open=!1;for(var i=sections.length;i--;)this[sections[i]].open=!0}},filters={searchTerm:"",interests:[],hubs:[],interestSearch:!1,locationSearch:!1,reset:function(){this.searchTerm="",this.interests=[],this.hubs=[],this.interestSearch=!1,this.locationSearch=!1},set:function(newControl){var self=this;self.reset();for(var c in newControl)if(newControl.hasOwnProperty(c)){var value=newControl[c];"function"==typeof FormService.controls()[c]?self[c]=FormService.controls()[c](value[0],value[1]):self[c]=value}}};return{accordion:function(){return accordion},filters:function(){return filters}}}),angular.module("hulahubShared").service("FormService",function(appSettings){function fakeToUTC(jsDate){return jsDate.setMinutes(jsDate.getMinutes()+jsDate.getTimezoneOffset()),jsDate}var sliders={single:function(start,range,enabled,tooltipFormatter,labels,lowestValueAllowed){return{enabled:enabled,animate:!1,connect:"lower",start:start,step:1,range:range,behaviour:"snap",tooltips:tooltipFormatter,labels:labels,lowestValueAllowed:lowestValueAllowed,getValue:function(){return this.enabled?Math.round(this.start):void 0},reset:function(){return this.start=start}}}},formatters={"int":function(max){return{from:{},to:function(value){return value===max?"No Limit":value}}},distance:function(units,max){return{from:{},to:function(value){return value===max?"No Limit":1===value?"1 "+units.slice(0,-1):Math.round(value)+" "+units}}},time:function(){return{to:function(val){val=Math.ceil(val);var hours=Math.floor(val/60),minutes=val-60*hours;if(30!==minutes&&0!==minutes){var i=minutes,n=30;minutes=i%n>n/2?i+n-i%n:i-i%n}return 1===hours.toString().length&&(hours="0"+hours),1===minutes.toString().length&&(minutes="0"+minutes),moment(hours+":"+minutes,"HH:mm").format("H:mm")},from:function(val){return val}}}},controls={difficultyLevel:function(value,enabled,allowAny){angular.isUndefined(allowAny)&&(allowAny=!0);var labels=["Beginner","Intermediate","Advanced"];return allowAny&&labels.unshift("Any"),sliders.single(value,{min:allowAny?0:1,max:3},enabled,!1,labels)},distanceWithMaxLimit:function(value,enabled){return value=null!==value?value:10,sliders.single(value,{min:[1,1],"50%":[10,5],max:[30]},enabled,formatters.distance(appSettings.distanceUnit,0))},datePicker:function(date,enabled,disablePastSelection){date=null!==date?fakeToUTC(moment.utc(date).toDate()):null;var today=disablePastSelection?moment().utc().startOf("day").toDate():void 0;return{disablePastSelection:disablePastSelection,enabled:enabled,isOpen:!1,date:date,options:{maxMode:"day",showWeeks:!1,startingDay:1},open:function(minDate,maxDate){this.options.minDate=minDate?minDate:today,angular.isDefined(maxDate)&&(this.options.maxDate=maxDate),this.isOpen=!0},getValue:function(format){if(angular.isUndefined(format)&&(format="YYYY-MM-DD HH:mm:ss"),this.enabled)return this.date?moment(this.date).format(format):null},setValue:function(date){this.date=date}}},dateRange:function(start,enabled,disablePastSelection,allowToday,additionalDaysForEnd){var minDate=void 0;if(disablePastSelection){var d=moment().utc().startOf("day");!angular.isUndefined(allowToday)&&allowToday||(d=d.add(1,"day")),minDate=d.toDate()}var times={start:{hour:12,minute:0},end:{hour:13,minute:0}};return null!==start[0]&&(start[0]=moment(start[0]).toDate(),times.start.hour=start[0].getHours(),times.start.minute=start[0].getMinutes()),null!==start[1]&&(start[1]=moment(start[1]).toDate(),times.end.hour=start[1].getHours(),times.end.minute=59!==start[1].getMinutes()?start[1].getMinutes():0),{disablePastSelection:disablePastSelection,enabled:enabled,options:{maxMode:"day",showWeeks:!1,startingDay:1},startDate:{isOpen:!1,date:start[0],time:times.start},endDate:{isOpen:!1,date:start[1],time:times.end},clear:function(){this.startDate.date=null,this.startDate.time={hour:12,minute:0},this.endDate.date=null,this.endDate.time={hour:13,minute:0}},open:function(which,startMax){if("start"===which)startMax&&(this.options.maxDate=this.endDate.date?_.clone(this.endDate.date):void 0),this.options.minDate=minDate,this.startDate.isOpen=!0;else{this.options.maxDate=void 0;var dateToUse=this.startDate.date&&this.startDate.date>minDate?_.clone(this.startDate.date):minDate;angular.isDefined(additionalDaysForEnd)?this.options.minDate=moment(dateToUse).add(additionalDaysForEnd,"d").toDate():this.options.minDate=moment(dateToUse).toDate(),this.options.initDate=this.options.minDate,this.endDate.isOpen=!0}},getValue:function(format){if(angular.isUndefined(format)&&(format="YYYY-MM-DD HH:mm:ss"),this.enabled){var start=null,end=null;if(this.startDate.date){var s=moment(this.startDate.date);s.set({hours:this.startDate.time.hour,minutes:this.startDate.time.minute,seconds:0}),start=s.format(format)}if(this.endDate.date){var e=moment(this.endDate.date);e.set({hours:this.endDate.time.hour,minutes:this.endDate.time.minute,seconds:0}),end=e.format(format)}return[start,end]}},getValueFullDays:function(format){if(angular.isUndefined(format)&&(format="YYYY-MM-DD HH:mm:ss"),this.enabled){var s=this.startDate.date?moment(this.startDate.date).startOf("day").format(format):null,e=this.endDate.date?moment(this.endDate.date).endOf("day").format(format):null;return[s,e]}},startDateChanged:function(){this.endDate.date<=this.startDate.date&&(angular.isDefined(additionalDaysForEnd)?this.endDate.date=moment(this.startDate.date).add(additionalDaysForEnd,"d").toDate():this.endDate.date=this.startDate.date)}}},dateOfBirth:function(value,enabled){var date=moment(value,"YYYY-MM-DD");return{enabled:enabled,options:{days:_.range(1,32),months:appSettings.months,years:_.rangeRight(1920,moment().utc().year()-17)},value:{day:date.date()||void 0,month:appSettings.months[date.month()],monthNumber:date.month(),year:date.year()||void 0},getValue:function(format){format||(format="YYYY-MM-DD");var v=moment.utc([this.value.year,appSettings.months.indexOf(this.value.month),this.value.day]);return this.enabled&&v.isValid()?v.format(format):void 0},valid:function(allowBlank){if(allowBlank&&!this.value.day&&!this.value.month&&!this.value.year)return!0;var v=moment.utc([this.value.year,appSettings.months.indexOf(this.value.month),this.value.day]);return v.isValid()},clear:function(){this.value.day=null,this.value.month=null,this.value.monthNumber=null,this.value.year=null}}},monthOrdinal:function(ordinal,dow,enabled){return{enabled:enabled,options:{ordinal:[{id:1,name:"First"},{id:2,name:"Second"},{id:3,name:"Third"},{id:4,name:"Fourth"},{id:5,name:"Last"}],dow:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:7,name:"Sunday"}]},value:{ordinal:ordinal,dow:dow},getValue:function(){return this.enabled?this.value:null}}},timeSlider:function(start,enabled){return{start:start,enabled:enabled,animate:!1,connect:!0,step:30,range:{min:0,max:1440},behaviour:"drag-tap",tooltips:!0,format:formatters.time(),margin:60,getValue:function(){return this.enabled?[Math.round(this.start[0]),Math.round(this.start[1])]:null}}}};return{controls:function(){return controls}}}),angular.module("hulahubShared").service("GeocoderService",function($log){function findAddressType(haystack,arr){return arr.some(function(v){return haystack.indexOf(v)>=0})}var validAddressTypes=["neighborhood","sublocality_level_1","locality","postal_town","postal_code_prefix","administrative_area_level_3","administrative_area_level_2","administrative_area_level_1","colloquial_area","natural_feature","country"];return{getLocationText:function(result){for(var i=0;i<result.address_components.length;i++)if(result.address_components[i].long_name&&findAddressType(result.address_components[i].types,validAddressTypes))return result.address_components[i].long_name;return!1},requestLocation:function(success,error){if(navigator.geolocation){var self=this,geocoder=new google.maps.Geocoder,cacheAge=36e5;navigator.geolocation.getCurrentPosition(function(position){var latlng=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);geocoder.geocode({location:latlng},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results){var locationText=self.getLocationText(results[0]);locationText?success({latitude:position.coords.latitude,longitude:position.coords.longitude,name:locationText}):error("No suitable location name found")}else $log.debug(results),error("No geolocation results found");else error("Geocoder failed: "+status)})},function(err){$log.error(err),error("Failed to get current location")},{maximumAge:cacheAge})}else error("Geolocation not possible")},getLatLng:function(string,success,error){var self=this;(new google.maps.Geocoder).geocode({address:string},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results){var locationText=self.getLocationText(results[0]);locationText?success({latitude:results[0].geometry.location.lat(),longitude:results[0].geometry.location.lng(),name:locationText}):($log.warn("No suitable location name found"),error())}else $log.info("No results found"),$log.debug(results),error();else $log.error("Geocoder failed: "+status),error()})}}}),angular.module("hulahubShared").factory("HttpInterceptor",function($injector){return{request:function(config){var authService=$injector.get("AuthService");return null!=authService.masqueradeToken?config.headers.Authorization="Bearer "+authService.masqueradeToken:null!=authService.accessToken&&(config.headers.Authorization="Bearer "+authService.accessToken),config}}}),angular.module("hulahubShared").config(function($httpProvider){$httpProvider.interceptors.push("HttpInterceptor")}),angular.module("hulahubShared").service("IntercomService",function($q,$log,ENV,AuthService){return{shouldRun:function(){return null!=ENV.intercomAppId&&!AuthService.isMasquerading()},getInstance:function(){if(this.shouldRun()){if(window.Intercom)return $q.when(window.Intercom);var deferred=$q.defer();return function(){var w=window,ic=w.Intercom;if("function"==typeof ic)ic("reattach_activator"),ic("update",intercomSettings);else{var d=document,i=function(){i.c(arguments)};i.q=[],i.c=function(args){i.q.push(args)},w.Intercom=i;var s=d.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://widget.intercom.io/widget/"+ENV.intercomAppId;var x=d.getElementsByTagName("script")[0];x.parentNode.insertBefore(s,x)}deferred.resolve(window.Intercom)}(),deferred.promise}},boot:function(){this.shouldRun()&&this.getInstance().then(function(ic){var intercomSettings={app_id:ENV.intercomAppId};if(AuthService.isLoggedIn){var user=AuthService.currentUser;_.extend(intercomSettings,{email:user.email,user_id:user.id})}ic("boot",intercomSettings)})},sendEvent:function(eventName,metadata){this.shouldRun()?this.getInstance().then(function(ic){ic("trackEvent",eventName,metadata)}):$log.info("Intercom event - "+eventName+" with params: "+JSON.stringify(metadata))},shutdown:function(){this.shouldRun()&&this.getInstance().then(function(ic){ic("shutdown")})}}}),angular.module("hulahubShared").factory("InterestService",function($http,ENV,$q,$log){var client=algoliasearch("9FKZSEVO2B","dc1ced219c231145f02c2bf2f538d1ae"),interestIndex=client.initIndex(ENV.interestIndexName);return{autoCompleteSearch:function(query){return interestIndex.clearCache(),interestIndex.search({query:query,hitsPerPage:8,queryType:"prefixAll",filters:"type:interest"}).then(function(response){return response.hits})},searchInterests:function(query){return interestIndex.clearCache(),interestIndex.search({query:query,hitsPerPage:8,queryType:"prefixAll"}).then(function(response){return _.isEmpty(_.filter(response.hits,function(h){return h.name.toLowerCase()===response.query.toLowerCase()}))&&response.hits.unshift({id:response.query,name:response.query}),response.hits})},getInterests:function(success,error){$http.get(ENV.api+"/interest/all").then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch interests"),void 0!==error&&error(responseError)})},getInterest:function(interestId){return $http.get(ENV.api+"/interest/"+interestId)},save:function(data,success,error){$http.post(ENV.api+"/interest/save",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save interest"),void 0!==error&&error(responseError)})},update:function(interestId,data,success,error){$http.put(ENV.api+"/interest/save/"+interestId,data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save interest"),void 0!==error&&error(responseError)})},"delete":function(interestId,success,error){$http["delete"](ENV.api+"/interest/"+interestId).then(function(response){success(response.data)},function(responseError){void 0!==error&&error(responseError)})},getSuggestedInterest:function(success){$http.get(ENV.api+"/interest/suggested").then(function(response){success(response.data)})},getSuggestedInterestsByGroup:function(success){$http.get(ENV.api+"/interest/suggested-by-group").then(function(response){success(response.data)})}}}),angular.module("hulahub").factory("InviteService",function($http,ENV){return{sendContactInvites:function(emailAddresses,success,error){$http.post(ENV.api+"/share/friends",{invites:emailAddresses}).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getSentContactInvites:function(success,error){$http.get(ENV.api+"/share/friends").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},sendActivityInvites:function(activityId,data,success,error){$http.post(ENV.api+"/share/activity/send/"+activityId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},reSendAllActivityInvites:function(activityId,data,success,error){$http.post(ENV.api+"/share/activity/re-send/"+activityId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},reSendActivityInvite:function(inviteId,data,success,error){$http.post(ENV.api+"/share/invite/re-send/"+inviteId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getSentActivityInvites:function(activityId,success,error){$http.get(ENV.api+"/share/activity/sent/"+activityId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},removeSentActivityInvite:function(inviteId){$http["delete"](ENV.api+"/share/activity/sent/"+inviteId)},getReceivedActivityInvites:function(success,error){$http.get(ENV.api+"/share/activity/received").then(function(response){success(response.data)},function(responseError){void 0!==error&&error(responseError)})},declineActivityInvite:function(inviteId,success){$http["delete"](ENV.api+"/share/activity/received/"+inviteId).then(function(response){success(response.data)})}}}),angular.module("hulahub").factory("MessageService",function($http,ENV,$log){return{send:function(message,success,error){$http.post(ENV.api+"/messages/send",message).then(function(response){success(response)},function(responseError){$log.error("Failed to send message"),void 0!==error&&error(responseError)})},reply:function(messageId,message,success,error){$http.post(ENV.api+"/messages/reply/"+messageId,message).then(function(response){success(response)},function(responseError){$log.error("Failed to send reply"),void 0!==error&&error(responseError)})},markAsRead:function(messageId){$http.get(ENV.api+"/messages/"+messageId+"/read")},"delete":function(messageId,success){$http["delete"](ENV.api+"/messages/"+messageId+"/delete").then(function(response){success(response)})},undelete:function(messageId,success){$http.get(ENV.api+"/messages/"+messageId+"/undelete").then(function(response){success(response)})},getMessages:function(data,success,error){$http.post(ENV.api+"/messages",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch messages"),void 0!==error&&error(responseError)})},getMessage:function(messageId){return $http.get(ENV.api+"/messages/single/"+messageId)},savePreferences:function(data){$http.put(ENV.api+"/messages/preferences",data)},trackEngagementFromMessage:function(messageId){return $http.get(ENV.api+"/messages/engagement/host-intro/"+messageId)}}}),angular.module("hulahubShared").service("MouseflowService",function($window,$log,ENV,AuthService){return{newPageView:function(newURL){"prod"!==ENV.name||AuthService.isMasquerading()?$log.info("Mouseflow page change: "+newURL):($window._mfq=$window._mfq||[],$window._mfq.push(["newPageView",newURL]))}}}),angular.module("hulahub").factory("OfferService",function($http,ENV,$log){return{getOffers:function(success,error){$http.get(ENV.api+"/offer/all").then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch offers"),void 0!==error&&error(responseError)})},getOffer:function(offerId,success,error){$http.get(ENV.api+"/offer/"+offerId).then(function(response){success(response.data)},function(responseError){$log.error("Failed to fetch single offer"),void 0!==error&&error(responseError)})},save:function(data,success,error){$http.post(ENV.api+"/offer/save",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save offer"),void 0!==error&&error(responseError)})},update:function(offerId,data,success,error){$http.put(ENV.api+"/offer/save/"+offerId,data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save offer"),void 0!==error&&error(responseError)})},"delete":function(offerId){$http["delete"](ENV.api+"/offer/"+offerId)},pickBestOffer:function(allOffers,totalSpots,totalCost){var qualifiedOffers=_.filter(allOffers,function(o){return o.threshold<=totalSpots});if(!qualifiedOffers.length)return null;var maxThreshold=_.maxBy(qualifiedOffers,"threshold").threshold;return qualifiedOffers=_.filter(qualifiedOffers,function(o){if(o.threshold===maxThreshold)return 0===o.type?o.discountedAmount=o.amount/1e4*totalCost:1===o.type&&(o.discountedAmount=o.amount),o}),qualifiedOffers=_.orderBy(qualifiedOffers,["discountedAmount","type"],["desc","desc"]),qualifiedOffers[0]}}}),angular.module("hulahubShared").service("ParameterService",function(StorageService){var tracking=JSON.parse(StorageService.getCookie("param.tracking"))||{},user=JSON.parse(StorageService.getCookie("param.user"))||{};return{setData:function(params){_.isEmpty(tracking)&&(tracking={utm_source:params.utm_source,utm_campaign:params.utm_campaign,utm_medium:params.utm_medium,utm_term:params.utm_term},StorageService.setCookie("param.tracking",JSON.stringify(tracking))),angular.isDefined(params.email)&&(user.email=decodeURIComponent(params.email)),angular.isDefined(params.inviteToken)&&(user.inviteToken=params.inviteToken),user.hostOrJoiner=params.hostOrJoiner,StorageService.setCookie("param.user",JSON.stringify(user))},getTracking:function(){return tracking},getUser:function(){return user},clearData:function(){tracking={},user={},StorageService.removeCookie("param.tracking"),StorageService.removeCookie("param.user")}}}),angular.module("hulahub").factory("PaymentService",function($http,$log,ENV,AuthService,stripe){return{saveUserVATSettings:function(data,success,error){$http.put(ENV.api+"/users/me/update/vat",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},createPaymentToken:function(cardData,success,error){stripe.card.createToken(cardData).then(function(response){success(response)})["catch"](function(err){var errMsg=err.message;err.type&&/^Stripe/.test(err.type)&&(errMsg="Stripe error: "+err.message),$log.error(errMsg),error(errMsg)})},getPaymentCards:function(){return $http.get(ENV.api+"/payment/cards")},addPaymentCard:function(data,success,error){$http.post(ENV.api+"/payment/card",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},setDefault:function(cardId){return $http.put(ENV.api+"/payment/card/"+cardId)},removePaymentCard:function(cardId){return $http["delete"](ENV.api+"/payment/card/"+cardId)},getTransactions:function(data,success,error){$http.post(ENV.api+"/payment/transactions",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},getBillingItem:function(billingItemId,success,error){$http.get(ENV.api+"/payment/billing/"+billingItemId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},validatePromoCode:function(code,success){$http.get(ENV.api+"/payment/validate-promo-code/"+code).then(function(response){success(response.data)})}}}),angular.module("hulahub").factory("PollingService",function($log,$rootScope,$timeout,$http,ENV,AuthService){var timeout=null;return{getPollableData:function(complete){$http.get(ENV.api+"/users/polling").then(function(response){$rootScope.unreadMessageCount=response.data.messages,AuthService.currentUser&&(AuthService.currentUser.contactCount=response.data.friends,AuthService.save()),complete()},function(responseError){$log.error("Failed to get polling data"),complete()})},start:function(){if(null===timeout){var service=this;!function tick(){service.getPollableData(function(){timeout=$timeout(tick,3e5)})}()}},stop:function(){return $timeout.cancel(timeout),timeout=null,$rootScope.unreadMessageCount=null,this}}}),angular.module("hulahubShared").factory("PublicPageService",function($http,$log,ENV){return{getQuickMatchCount:function(data,success,error){$http.post(ENV.api+"/public/quick-match",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})}}}),angular.module("hulahub").factory("RefundService",function($http,$log,ENV){return{requestRefund:function(paymentId,data,success,error){$http.post(ENV.api+"/refund/request/"+paymentId,data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},getAll:function(success,error){$http.get(ENV.api+"/refund/all").then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},getSingle:function(refundId,success,error){$http.get(ENV.api+"/refund/"+refundId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},respond:function(refundId,data,success,error){$http.put(ENV.api+"/refund/"+refundId+"/respond",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})},escalate:function(refundId,data,success,error){$http.post(ENV.api+"/refund/"+refundId+"/escalate",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response.data)})}}}),angular.module("hulahub").factory("ReviewService",function($http,ENV){return{sendRequests:function(data,success,error){$http.post(ENV.api+"/review/request",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getReviewRequests:function(success,error){$http.get(ENV.api+"/review/requests").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},resendRequest:function(requestID,success,error){$http.get(ENV.api+"/review/request/resend/"+requestID).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},removeRequest:function(requestID){$http["delete"](ENV.api+"/review/request/"+requestID)},submitReview:function(data,success,error){$http.post(ENV.api+"/review/submit",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getReview:function(reviewId,success,error){$http.get(ENV.api+"/review/"+reviewId).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})}}}),angular.module("hulahub").factory("SharingService",function($http,ENV){return{clearFBCache:function(url,callback){$http.get(ENV.api+"/share/clear-facebook-cache?url="+encodeURIComponent(url)).then(function(response){callback()})}}}),angular.module("hulahubShared").factory("SpecialismService",function($http,$log,ENV){return{getSpecialism:function(specialismId,success,error){return $http.get(ENV.api+"/specialism/"+specialismId).then(function(response){success(response.data)},function(responseError){$log.error("Failed to get specialism"),void 0!==error&&error(responseError)})},save:function(data,success,error){$http.post(ENV.api+"/specialism/save",data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save specialism"),void 0!==error&&error(responseError)})},update:function(specialismId,data,success,error){$http.put(ENV.api+"/specialism/save/"+specialismId,data).then(function(response){success(response.data)},function(responseError){$log.error("Failed to save specialism"),void 0!==error&&error(responseError)})},"delete":function(specialismId,success,error){$http["delete"](ENV.api+"/specialism/"+specialismId).then(function(response){success(response.data)},function(responseError){void 0!==error&&error(responseError)})}}}),angular.module("hulahubShared").factory("StorageService",function($window,ENV){return{setItem:function(key,data,isSession){if(angular.isUndefined(isSession)&&(isSession=!1),isSession)try{$window.sessionStorage.setItem(key,data)}catch(err){}else try{$window.localStorage.setItem(key,data)}catch(err){document.cookie=key+"="+encodeURIComponent(data)+"; path=/"}},getItem:function(key,fromSession){if(angular.isUndefined(fromSession)&&(fromSession=!1),
fromSession)return $window.sessionStorage.getItem(key);if(null!==$window.localStorage.getItem(key))return $window.localStorage.getItem(key);var cookie=this.getCookie(key);return cookie?decodeURIComponent(cookie):null},getAllCookies:function(){return document.cookie.split(";")},setCookie:function(cname,cvalue){document.cookie=cname+"="+cvalue+";path=/;domain="+ENV.domain},getCookie:function(cname){for(var name=cname+"=",allCookies=this.getAllCookies(),i=0;i<allCookies.length;i++){for(var c=allCookies[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return null},removeItem:function(key){$window.sessionStorage.removeItem(key),$window.localStorage.removeItem(key),this.removeCookie(key)},removeCookie:function(key){document.cookie=key+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;domain="+ENV.domain},clear:function(){var loginRedirectUrl=this.getItem("loginRedirectUrl");$window.localStorage.clear(),$window.sessionStorage.clear();for(var allCookies=this.getAllCookies(),i=0;i<allCookies.length;i++){var key=allCookies[i].split("=")[0];"cookieconsent_status"!==key.replace(/\s/g,"")&&this.removeCookie(key)}loginRedirectUrl&&this.setItem("loginRedirectUrl",loginRedirectUrl)}}}),angular.module("hulahub").factory("StripeService",function($rootScope,$http,$log,$window,$location,ENV,AuthService,stripe){return{connect:function(state){$rootScope.$broadcast("showLoading");var loggedInUser=AuthService.currentUser,redirectUri=$location.protocol()+"://"+$location.host()+"/stripe/connect",connectURL="https://connect.stripe.com/oauth/authorize?redirect_uri="+redirectUri+"&state="+state+"&response_type=code&client_id="+ENV.stripeClientId+"&scope=read_write&stripe_user[physical_product]=false&stripe_user[email]="+loggedInUser.email+"&stripe_user[phone_number]="+loggedInUser.profile.phoneNumber+"&stripe_user[first_name]="+loggedInUser.profile.firstName+"&stripe_user[last_name]="+loggedInUser.profile.lastName+"&stripe_user[url]="+encodeURIComponent(ENV["public"]+"/people/profile/"+loggedInUser.hashId);if(connectURL+="&stripe_user[product_description]="+encodeURIComponent("Payments for activities hosted at HulaHub"),loggedInUser.profile.dateOfBirth){var birthday=moment(loggedInUser.profile.dateOfBirth,"YYYY-MM-DD");connectURL+="&stripe_user[dob_day]="+birthday.date()+"&stripe_user[dob_month]="+birthday.month()+"&stripe_user[dob_year]="+birthday.year()}connectURL+=loggedInUser.profile.businessName?"&stripe_user[business_name]="+loggedInUser.profile.businessName:"&stripe_user[business_name]="+encodeURIComponent(loggedInUser.profile.firstName+" "+loggedInUser.profile.lastName+" at HulaHub"),$window.location.href=connectURL},connectStripeAccount:function(code,success,error){$http.post(ENV.api+"/stripe/connect",{token:code}).then(function(response){AuthService.currentUser.stripeAccountConnected=!0,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response.data)})},disconnectStripeAccount:function(success,error){$http.get(ENV.api+"/stripe/disconnect").then(function(response){AuthService.currentUser.stripeAccountConnected=!1,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response.data)})}}}),angular.module("hulahubShared").service("TrackingService",function($http,$window,ENV,StorageService){var profilesTrackedThisSession=JSON.parse(StorageService.getItem("session.profilesTracked",!0))||[],activitiesTrackedThisSession=JSON.parse(StorageService.getItem("session.activitiesTracked",!0))||[];return{trackHostContact:function(hostId,hostIntro){var url=ENV.api+"/tracking/contact/"+hostId;angular.isDefined(hostIntro)&&null!==hostIntro&&(url+="/"+hostIntro),$http.get(url)},trackProfilePageView:function(id){profilesTrackedThisSession.indexOf(id)===-1&&($http.post(ENV.api+"/tracking/page-view",{type:"profile",id:id}),profilesTrackedThisSession.push(id),StorageService.setItem("session.profilesTracked",JSON.stringify(profilesTrackedThisSession),!0))},trackActivityPageView:function(id){activitiesTrackedThisSession.indexOf(id)===-1&&($http.post(ENV.api+"/tracking/page-view",{type:"activity",id:id}),activitiesTrackedThisSession.push(id),StorageService.setItem("session.activitiesTracked",JSON.stringify(activitiesTrackedThisSession),!0))}}}),angular.module("hulahubShared").factory("UserService",function($http,ENV,AuthService,$log,$timeout){return{checkEmail:function(email,success,error){$http.get(ENV.api+"/register/check-email/"+encodeURI(email)).then(function(){success()},function(response){void 0!==error&&error(response)})},register:function(data,success,error){$http.post(ENV.api+"/register",data).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success(response.data)},function(response){void 0!==error&&error(response)})},resendConfirmationEmail:function(email){$http.post(ENV.api+"/register/resend",{email:email})},registerExternal:function(externalData,success,error){$http.post(ENV.api+"/register/external",externalData).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success(response.data)},function(response){void 0!==error&&error(response)})},quickRegister:function(data,success,error){$http.post(ENV.api+"/register/quick",data).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success(response.data)},function(response){void 0!==error&&error(response)})},completeProfile:function(data,success,error){$http.put(ENV.api+"/register/complete-profile",data).then(function(response){AuthService.currentUser=response.data.user,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},verifyEmailToken:function(token,success,error){$http.get(ENV.api+"/register/verify/"+token).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success(response.data)},function(response){void 0!==error&&error(response)})},requestPasswordReset:function(data,success,error){$http.post(ENV.api+"/users/reset-password/request",data).then(function(response){success(response)},function(response){void 0!==error&&error(response)})},resetPassword:function(token,data,success,error){$http.post(ENV.api+"/users/reset-password/"+token,data).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success()},function(response){void 0!==error&&error(response)})},setPassword:function(token,data,success,error){$http.post(ENV.api+"/users/set-password/"+token,data).then(function(response){AuthService.setTokens(response.data.access_token,response.data.refresh_token),success()},function(response){void 0!==error&&error(response)})},getMyDetails:function(success,error){$http.get(ENV.api+"/users/me").then(function(response){AuthService.isLoggedIn=!0,AuthService.currentUser=response.data,AuthService.save(),success(response.data)},function(response){AuthService.isLoggedIn=!1,AuthService.currentUser={},void 0!==error&&error(response)})},getExtraDetails:function(success,error){$http.get(ENV.api+"/users/extra").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},switchSubscriptionPlan:function(data,success,error){$http.post(ENV.api+"/subscription/switch",data).then(function(response){AuthService.currentUser=response.data,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},getPromoCodes:function(success,error){$http.get(ENV.api+"/subscription/promo-codes").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},updateSubscriptionSettings:function(data,success,error){$http.put(ENV.api+"/subscription",data).then(function(response){AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},getSubscriptionSettings:function(success,error){$http.get(ENV.api+"/subscription").then(function(response){AuthService.currentUser.subscriptionPlan=response.data.id,AuthService.currentUser.usedTrial=response.data.usedTrial,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},getBenefitsID:function(success,error){$http.get(ENV.api+"/users/me/benefits-id").then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},registerForBenefits:function(){this.getBenefitsID(function(response){$http.get(ENV.premiumBenefitsURL+"?userid="+response.id)})},updateMyDetails:function(data,success,error){$http.put(ENV.api+"/users/me/update",data).then(function(response){AuthService.currentUser=response.data.user,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},updateHomeHub:function(data,success,error){$http.put(ENV.api+"/users/me/update/home",data).then(function(response){AuthService.currentUser=response.data.user,AuthService.save(),success(response.data)},function(response){void 0!==error&&error(response)})},changePassword:function(data,success,error){$http.put(ENV.api+"/users/me/change-password",data).then(function(){success()},function(response){void 0!==error&&error(response)})},updateAvatar:function(data,success,error){$http.put(ENV.api+"/users/me/update/avatar",data).then(function(response){AuthService.currentUser=response.data,AuthService.save(),success()},function(response){void 0!==error&&error(response)})},saveCoverPicture:function(data,success,error){$http.put(ENV.api+"/gallery/save",data).then(function(response){AuthService.currentUser=response.data,AuthService.save(),success()},function(response){void 0!==error&&error(response)})},updateGoal:function(){$http.get(ENV.api+"/users/goal").then(function(response){AuthService.currentUser.currentGoal=response.data.currentGoal,AuthService.currentUser.completedGoals=response.data.completedGoals,AuthService.save()},function(response){$log.error("failed to get next user goal")})},searchUsers:function(data,success,error){$http.post(ENV.api+"/users/search",data).then(function(response){success(response.data)},function(response){void 0!==error&&error(response)})},getUser:function(userId){return $http.get(ENV.api+"/users/profile/"+userId)},getPhoneNumber:function(userId,success){$http.get(ENV.api+"/users/phone/"+userId).then(function(response){success(response.data.number)})}}}),angular.module("hulahub").directive("flexibleDayControl",function(){return{restrict:"E",replace:!0,scope:{label:"@",day:"="},templateUrl:"activities/views/partials/flexible-day-control.html"}}).directive("activityCalendar",function(){return{restrict:"E",replace:!0,scope:{view:"@",deleteActivityHandler:"=?"},templateUrl:"activities/views/partials/activity-calendar.html",controller:function($scope,ActivityService,StorageService,AlertService){function updateActivityList(days){angular.isUndefined(days)&&(days=calendarResponse.days),StorageService.setItem($scope.view+".calendar.view",JSON.stringify(savedCalendarView),!0);var daysWithActivities=_.reject(days,["activities.length",0]),activities=_.uniqBy(_.flatMap(daysWithActivities,"activities"),"id");$scope.$emit("updateScheduledActivities",{activities:activities,calendarView:calendarView})}function getCalendar(month,selectedDay){$scope.loading=!0,$scope.$emit("loadingCalendar",!0),ActivityService.getMyActivities(month,$scope.view,function(data){calendarResponse=data,savedCalendarView.month=month,savedCalendarView.day=selectedDay,$scope.calendarTitle=calendarResponse.calendarTitle,$scope.weeks=_.chunk(calendarResponse.days,7),angular.isDefined(selectedDay)?_.forEach(calendarResponse.days,function(d){d.currentMonth&&d.day===selectedDay&&$scope.selectDate(d)}):updateActivityList(),$scope.loading=!1,$scope.$emit("loadingCalendar",!1)})}var calendarResponse,todayMonth=moment().format("MMYYYY"),storedData=JSON.parse(StorageService.getItem($scope.view+".calendar.view",!0)),savedCalendarView={month:storedData?storedData.month:todayMonth,day:storedData?storedData.day:void 0},calendarView=angular.isDefined(savedCalendarView.day)?"day":"month";$scope.hasActivities=function(day){return day.activities.length>0},$scope.changeMonth=function(direction){calendarView="month",StorageService.removeItem($scope.view+".calendar.selectedActivity",!0),"current"===direction?calendarResponse.currentMonth===todayMonth?$scope.showCurrentMonth():getCalendar(todayMonth):getCalendar("next"===direction?calendarResponse.nextMonth:calendarResponse.previousMonth)},$scope.showCurrentMonth=function(){calendarView="month",delete savedCalendarView.day,StorageService.removeItem($scope.view+".calendar.selectedActivity",!0),_.map(calendarResponse.days,function(d){d.selected=!1}),updateActivityList()},$scope.selectDate=function(day){calendarView="day",savedCalendarView.day=day.day,StorageService.removeItem($scope.view+".calendar.selectedActivity",!0),day.currentMonth?(_.map(calendarResponse.days,function(d){d.selected=!1}),day.selected=!0,updateActivityList([day])):day.day<=11?getCalendar(calendarResponse.nextMonth,day.day):getCalendar(calendarResponse.previousMonth,day.day)},getCalendar(savedCalendarView.month,savedCalendarView.day),null===$scope.deleteActivityHandler&&($scope.deleteActivityHandler=function(activityId,seriesId){_.map($scope.weeks,function(week){_.map(week,function(day){_.remove(day.activities,function(a){return a.id===activityId||a.series===seriesId&&"cancelled"===a.status})})})}),$scope.$on("reloadCalendar",function(event,args){getCalendar(savedCalendarView.month,savedCalendarView.day)})}}}).directive("activityList",function(){return{restrict:"E",replace:!0,scope:{title:"@",theme:"@",activities:"=",selectedActivity:"=",emptyText:"@",loading:"=",hiddenStatus:"@",hiddenText:"@"},templateUrl:"activities/views/partials/activity-list.html",link:function(scope,element){scope.isSingleDayEvent=function(activity){if(angular.isDefined(activity)){var startDate=moment(activity.startDate),endDate=moment(activity.endDate);return startDate.isSame(endDate,"day")}},scope.selectActivity=function(activity){(angular.isUndefined(scope.selectedActivity)||scope.selectedActivity.id!==activity.id)&&scope.$emit("loadActivity",{activity:activity})},scope.hiddenActivities=[],scope.hiddenStatus&&(scope.$watch("activities",function(newVal){newVal&&(scope.hiddenActivities=_.filter(newVal,function(v){return v.status===scope.hiddenStatus}),1===scope.hiddenActivities.length&&scope.selectedActivity&&scope.hiddenActivities[0].id===scope.selectedActivity.id&&(scope.showHidden=!0))},!0),scope.toggleHidden=function(){scope.showHidden&&$("#activityDetails",element).length&&(scope.selectedActivity=void 0,$("#activityDetails",element).remove()),scope.showHidden=!scope.showHidden,$("body,html").scrollTop(element.offset().top-$(".navbar-fixed-top").outerHeight())})}}}).directive("activityPanel",function(){return{restrict:"E",replace:!0,scope:{activity:"=",dropupMenu:"="},templateUrl:"activities/views/partials/activity-panel.html",compile:function(element,attrs){attrs.dropupMenu||(attrs.dropupMenu=!1)},controller:function($rootScope,$scope,$state,$uibModal,ENV,ActivityService,AuthService,InviteService){$scope.isHost=$scope.activity.host.id===AuthService.currentUser.hashId,null===$scope.activity.bannerImage&&$scope.activity.interests&&"draft"!==$scope.activity.status&&($scope.activity.bannerImage="/img/landing/sml/A"+$scope.activity.interests[0].id+"-1.jpg"),$scope.isSingleDayEvent=function(){var startDate=moment($scope.activity.startDate),endDate=moment($scope.activity.endDate);return startDate.isSame(endDate,"day")},$scope.viewActivity=function(){"draft"===$scope.activity.status?$scope.editActivity():$scope.activity.external?$state.go("activities.joined.viewExternal",{activityId:$scope.activity.id}):$state.go($scope.isHost?"activities.hosted.view":"activities.joined.view",{activityId:$scope.activity.id})},$scope.sendInvites=function(){$rootScope.$broadcast("showLoading"),$state.go("activities.hosted.share",{activityId:$scope.activity.id})},$scope.shareActivity=function(){var shareUrl=ENV["public"]+"/activity/"+$scope.activity.publicUrl;$uibModal.open({templateUrl:"core/partials/share-modal.html",controller:"ShareModalController",resolve:{data:function(){return{id:$scope.activity.series,idName:"$scope.activity_id",title:"Share "+$scope.activity.title,url:shareUrl,text:{twitter:"Check out "+$scope.activity.title+" @HulaHubHQ!",email:{subject:"Check out "+$scope.activity.title+" @HulaHubHQ",body:"I saw this activity on HulaHub and thought of you!\n\n"+shareUrl+"\n\nMaybe I'll see you at this one, or another activity on Hulahub soon!"}},intercomEventName:"shared-activity"}}}})},$scope.editActivity=function(){$scope.isHost&&($rootScope.$broadcast("showLoading"),$state.go("activities.edit",{activityId:$scope.activity.id}))},$scope.copyActivity=function(){$scope.isHost&&($rootScope.$broadcast("showLoading"),$state.go("activities.new",{copyFrom:$scope.activity.id}))},$scope.discussionBoard=function(){$rootScope.$broadcast("showLoading"),$state.go($scope.isHost?"activities.hosted.view.discussion":"activities.joined.view.discussion",{activityId:$scope.activity.id})},$scope.cancelActivity=function(){$scope.isHost&&$uibModal.open({templateUrl:"activities/views/partials/cancel-form.html",controller:"CancelActivityModalController",resolve:{data:function(){return{activity:$scope.activity}}}}).result.then(function(response){$rootScope.$broadcast("showLoading"),ActivityService.cancel($scope.activity.id,response,function(){$rootScope.$broadcast("hideLoading"),$scope.activity.status="cancelled",$scope.activity.confirmedFlexibleBooking||($scope.activity.deletable=!0),$scope.activity.editable=!1,$scope.$emit("cancelActivity",{activity:$scope.activity,series:response.series})})})},$scope.deleteActivity=function(){$scope.isHost&&$scope.activity.deletable&&showConfirm("Delete this activity?","Are you sure you want to delete "+$scope.activity.title+"?",function(){$rootScope.$broadcast("showLoading"),ActivityService.deleteActivity($scope.activity.id,function(){$scope.$emit("deleteActivity",{activity:$scope.activity}),$rootScope.$broadcast("hideLoading")},function(response){$rootScope.$broadcast("hideLoading")})})},$scope.newMessage=function(recipients,subject){$uibModal.open({templateUrl:"messages/views/new-message-modal.html",controller:"NewMessageModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput"])},data:function(){return{to:recipients,subject:subject}}}})},$scope.joinActivity=function(){$rootScope.$broadcast("showLoading"),$state.go("activities.join",{seriesId:$scope.activity.series,activityId:$scope.activity.id})},$scope.declineInvite=function(inviteId){showConfirm("Decline invite","Are you sure you want to decline this activity invite?",function(){$rootScope.$broadcast("showLoading"),InviteService.declineActivityInvite(inviteId,function(){$rootScope.$broadcast("hideLoading"),$scope.$emit("removeInvite",{invite:inviteId})})})},$scope.manageBookingRequest=function(response){$scope.isHost&&$uibModal.open({templateUrl:"booking-requests/views/manage-booking-request.html",controller:"ManageBookingRequestModalController",resolve:{data:function(){return{response:response,bookingRequest:$scope.activity.bookingRequest}}},keyboard:!1,backdrop:"static"}).result.then(function(r){"decline"===r.response?($scope.activity.status="declined",$scope.$emit("declineBookingRequest",{bookingRequest:$scope.activity.bookingRequest,message:r.message,reason:r.reason,joinerMessage:r.joinerMessage})):$scope.$emit("acceptBookingRequest",{bookingRequest:$scope.activity.bookingRequest})})},$scope.changeBookingRequest=function(){$scope.isHost||$uibModal.open({templateUrl:"booking-requests/views/edit-booking-request.html",controller:"EditBookingRequestModalController",resolve:{data:function(){return{activity:$scope.activity}}},keyboard:!1,backdrop:"static"}).result.then(function(r){$scope.$emit("changedBookingRequest")})},$scope.deleteBookingRequest=function(){showConfirm("Remove booking request","Are you sure you want to remove this booking request? This can not be undone.",function(){$scope.$emit("deleteBookingRequest",{bookingRequest:$scope.activity.bookingRequest})})},$scope.cancelBookingRequest=function(){showConfirm("Cancel booking request","Are you sure you want to cancel this booking request? It will remove it and can not be undone.",function(){$scope.$emit("deleteBookingRequest",{bookingRequest:$scope.activity.bookingRequest})})}}}}).directive("activityCard",function(){return{restrict:"E",replace:!0,templateUrl:"activities/views/partials/activity-card.html",controller:function($rootScope,$scope,$state,AuthService){$scope.viewActivity=function(activity){$rootScope.$broadcast("showLoading"),activity.isExternal?$state.go("activities.viewExternal",{activityId:activity.instanceId}):$state.go("activities.view",{activityId:activity.instanceId})},$scope.viewProfile=function(host){host.id===AuthService.currentUser.hashId?$state.go("profile"):$state.go("contacts.public",{userId:host.id})}}}}).directive("pricingCalculator",function(){return{restrict:"E",replace:!0,templateUrl:"activities/views/partials/pricing-calculator.html",scope:{perSpot:"=",currency:"=",showHelp:"&"},controller:function($scope,AuthService,OfferService){$scope.pricingCalculator={joiners:1,serviceCharge:AuthService.currentUser.standardFee,appliedOffer:null,allOffers:[],checkOfferQualification:function(){this.subTotal()>0?this.appliedOffer=OfferService.pickBestOffer(this.allOffers,this.joiners,this.subTotal()):this.appliedOffer=null},subTotal:function(){return $scope.perSpot.value()*this.joiners},total:function(){var sub=this.subTotal();null!==this.appliedOffer&&(sub-=this.appliedOffer.discountedAmount,sub<0&&(sub=0));var service=this.serviceCharge/100*sub;service<150&&(service=150);var recieve=sub-service;return sub-service<0?0:recieve}},OfferService.getOffers(function(response){$scope.pricingCalculator.allOffers=response,$scope.$watchGroup(["pricingCalculator.joiners","perSpot.model"],function(){$scope.pricingCalculator.checkOfferQualification()})})}}}),angular.module("hulahubShared").directive("filterPopup",function(){return{restrict:"E",replace:!0,templateUrl:function(e,attr){return attr.template},scope:{data:"=",onApply:"&",theme:"@",type:"@?"},controller:function($scope){var changesApplied=!1;$scope.inMemoryData=_.cloneDeep($scope.data),$scope.toggled=function(open){open?(changesApplied=!1,$scope.inMemoryData=_.cloneDeep($scope.data)):changesApplied||($scope.inMemoryData=_.cloneDeep($scope.data))},"time"===$scope.type&&($scope.$watch("inMemoryData.model.min",function(newVal,oldVal){oldVal!==newVal&&newVal>$scope.inMemoryData.model.max&&($scope.inMemoryData.model.max=24)}),$scope.maxTimeOptionShouldShow=function(o){return o.key>$scope.inMemoryData.model.min}),$scope.applyFilter=function(){$scope.inMemoryData.model&&($scope.data.model.startDate?($scope.data.model.startDate=$scope.inMemoryData.model.startDate,$scope.data.model.endDate=$scope.inMemoryData.model.endDate):($scope.data.model.min=$scope.inMemoryData.model.min,$scope.data.model.max=$scope.inMemoryData.model.max)),$scope.data.setValue($scope.data.hasOwnProperty("selectedRange")?$scope.inMemoryData.selectedRange:$scope.inMemoryData.value),$scope.onApply(),$scope.isOpen=!1,changesApplied=!0}}}}),angular.module("hulahub").directive("profileCard",function($uibModal,ContactService,AuthService){return{restrict:"E",scope:{user:"="},replace:!0,templateUrl:"contacts/views/partials/profile-card.html",controller:function($scope,$rootScope,$log){$scope.currentUser=AuthService.currentUser,$scope.sendContactRequest=function(){$scope.$emit("contactRequestSent",$scope.user),ContactService.sendContactRequest($scope.user.id,function(response){$log.error("Error sending contact request:"+response)})},$scope.acceptContactRequest=function(){$rootScope.$broadcast("showLoading"),ContactService.respondToContactRequest($scope.user.id,"accept",function(response){$scope.$emit("contactRequestAccepted",response.data),$rootScope.$broadcast("hideLoading")},function(response){$log.error("Error accepting contact request:"+response),$rootScope.$broadcast("hideLoading")})},$scope.declineContactRequest=function(){$scope.$emit("contactRequestDeclined",$scope.user),ContactService.respondToContactRequest($scope.user.id,"decline",angular.noop,function(response){$log.error("Error declining contact request:"+response)})},$scope.removeContact=function(){showConfirm("Remove contact","Are you sure you want to remove "+$scope.user.firstName+"?",function(){$rootScope.$broadcast("showLoading"),ContactService.removeContact($scope.user.id,function(response){$scope.$emit("contactRemoved",response.data),$rootScope.$broadcast("hideLoading")},function(response){$log.error("Error removing contact:"+response),$rootScope.$broadcast("hideLoading")})})},$scope.addToGroup=function(){$uibModal.open({templateUrl:"contacts/views/add-to-group.html",controller:"AddToGroupController",keyboard:!1,resolve:{contact:$scope.user}}).result.then(function(result){$scope.user.contactGroups=result})},$scope.newMessage=function(contact){$uibModal.open({templateUrl:"messages/views/new-message-modal.html",controller:"NewMessageModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput"])},data:function(){return{to:[contact],subject:null}}}})}}}}).directive("searchContactFilters",function(){return{restrict:"E",replace:!0,templateUrl:"contacts/views/partials/search-filters.html"}}).directive("myContactFilters",function(){return{restrict:"E",replace:!0,templateUrl:"contacts/views/partials/my-filters.html"}}).directive("nameList",function(){return{restrict:"E",templateUrl:"contacts/views/partials/name-list.html",scope:{items:"=",prefix:"@"}}}),angular.module("hulahub").directive("miniStatPanel",function(){return{restrict:"E",scope:{title:"@",tooltip:"@",tooltipPlacement:"@",latestDate:"@",total:"@",last30:"@",older30:"@",theme:"@"},replace:!0,templateUrl:"dashboard/views/mini-stat-panel.html"}}),angular.module("hulahub").directive("messagePanel",function($state,MessageService){return{restrict:"E",scope:{helpText:"@"},replace:!0,templateUrl:"messages/views/widget.html",link:function(scope){scope.loading=!0,MessageService.getMessages("inbox",3,1,function(response){scope.messages=response,scope.loading=!1}),scope.loadMessage=function(message){$state.go("messages.view",{folder:"inbox",message:message,filter:"all",messageId:message.id})}}}}).directive("messageFilters",function(){return{restrict:"E",replace:!0,templateUrl:"messages/views/partials/filters.html"}}),angular.module("hulahub").directive("paymentCardForm",function(){return{restrict:"E",replace:!0,scope:{buttonText:"@",buttonClass:"@",onSubmit:"&",paymentDue:"=?",backButtonText:"@",backButtonIcon:"@",backButtonClass:"@",onBack:"&?",showSaveButton:"=?",submissionHandler:"=?",clearHandler:"=?"},compile:function(element,attrs){attrs.backButtonText||(attrs.backButtonText="Back"),attrs.backButtonIcon||(attrs.backButtonIcon="ico-chevron-left"),attrs.showSaveButton||(attrs.showSaveButton="true")},templateUrl:"payment/views/partials/payment-form.html",controller:function($scope){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.submissionHandler=$scope.submissionHandler||{},$scope.submissionHandler.submit=function(){$scope.submitForm()},$scope.clearHandler=$scope.clearHandler||{},$scope.clearHandler.submit=function(){$scope.formData.clear()},$scope.showBackButton=angular.isDefined($scope.onBack),$scope.formData={card:{number:"",exp_month:"",exp_year:"",cvc:"",name:""},clear:function(){this.card.number="",this.card.exp_month="",this.card.exp_year="",this.card.cvc="",this.card.name="",$scope.validationRun=!1}},$scope.$watchGroup(["formData.card.exp_year","formData.card.exp_month"],function(newDate,oldDate){if($scope.paymentDue&&newDate[0]&&newDate[1]){var cardExpiry=moment([newDate[0],newDate[1]-1]).endOf("month").unix();$scope.form.$setValidity("ccExpiryBeforeActivity",cardExpiry>$scope.paymentDue)}}),$scope.submitForm=function(){validateForm()&&$scope.onSubmit()($scope.formData)}}}}).directive("paymentMethods",function(PaymentService){return{restrict:"E",replace:!0,scope:{},templateUrl:"payment/views/payment-methods.html",controller:function($scope,$rootScope,$log,$uibModal,AlertService){$scope.loading=!0,$scope.existingCards=[],PaymentService.getPaymentCards().then(function(response){$scope.existingCards=response.data,$scope.loading=!1},function(response){$log.error(response.data)}),$scope.showPaymentForm=function(){$uibModal.open({templateUrl:"payment/views/payment-form-modal.html",controller:"AddPaymentCardModalController"}).result.then(function(response){_.forEach($scope.existingCards,function(c){c["default"]=!1}),$scope.existingCards=_.orderBy($scope.existingCards,["expiryYear","expiryMonth"],["desc","desc"]),$scope.existingCards.unshift(response),$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","Your card has been saved.","")})},$scope.setDefault=function(cardId){showConfirm("Set default","Are you sure you want to set this card as your default payment method? Please be aware that if you are on a Premium plan, this card will be used for upcoming subscription payments.",function(){_.forEach($scope.existingCards,function(c){c["default"]=c.stripeCardId===cardId}),$scope.$apply(),PaymentService.setDefault(cardId)})},$scope.remove=function(cardId,paymentsDue){paymentsDue>0?AlertService.showToast("error","Cannot remove card.","There are pending payments associated with it. Change the card associated with the pending payments before trying again."):showConfirm("Delete card","Are you sure you want to remove this card?",function(){var index=_.indexOf($scope.existingCards,_.find($scope.existingCards,["stripeCardId",cardId]));$scope.existingCards.splice(index,1),$scope.$apply(),PaymentService.removePaymentCard(cardId)})}}}}),angular.module("hulahubShared").directive("ratingControl",function(){return{restrict:"E",scope:{score:"=",label:"@",tooltip:"@",hasError:"="},replace:!0,templateUrl:"reviews/views/partials/rating-control.html",controller:function($scope){var textualRatings=["Not Set","Very poor","Poor","Average","Good","Excellent"],originalScore=$scope.score;$scope.$watch("score",function(newValue){$scope.textualRating=textualRatings[newValue]}),$scope.hover=function(hoverScore){$scope.score=hoverScore},$scope.saveScore=function(){originalScore=$scope.score},$scope.resetScore=function(){$scope.score=originalScore}}}}).directive("review",function(){return{restrict:"E",scope:{data:"=",beforeNavigate:"&",theme:"@"},replace:!0,templateUrl:"reviews/views/partials/review.html",controller:function($scope,$state){$scope.profileClick=function(){angular.isDefined($scope.beforeNavigate)&&$scope.beforeNavigate(),$state.go("contacts.public",{userId:$scope.data.reviewedBy.id})}}}}).directive("reviewStars",function(){return{restrict:"E",scope:{value:"=",theme:"@"},replace:!0,template:'<span class="reviewStars" ng-class="theme">'+"<i ng-class=\"value == 0 ? 'far fa-star' : (value >= 1 ? 'fas fa-star' : 'fas fa-star-half-alt')\"></i><i ng-class=\"value <= 1 ? 'far fa-star' : (value >= 2 ? 'fas fa-star' : 'fas fa-star-half-alt')\"></i><i ng-class=\"value <= 2 ? 'far fa-star' : (value >= 3 ? 'fas fa-star' : 'fas fa-star-half-alt')\"></i><i ng-class=\"value <= 3 ? 'far fa-star' : (value >= 4 ? 'fas fa-star' : 'fas fa-star-half-alt')\"></i><i ng-class=\"value <= 4 ? 'far fa-star' : (value >= 5 ? 'fas fa-star' : 'fas fa-star-half-alt')\"></i></span>"}}),angular.module("hulahub").controller("ActivityFormHeaderController",function($scope,$rootScope,$state){$scope.title=$state.current.data.title,$scope.close=function(){$rootScope.$broadcast("closeActivityForm")},$scope.save=function(){$rootScope.$broadcast("saveActivityForm")}}),angular.module("hulahub").controller("ActivityInfoController",function($scope,$rootScope,$state,$timeout,$location,$log,$uibModal,$facebook,ENV,appSettings,AnalyticsService,TrackingService,ActivityService,AvailabilityService,AlertService,ParameterService,IntercomService,ContactService){
_.isEmpty($location.search())||ParameterService.setData($location.search()),$scope.goBack=function(){window.history.back()},$scope.activity.publicUrl=ENV["public"]+"/activity/"+$scope.activity.publicUrl;var startDate=moment($scope.activity.startDate),endDate=moment($scope.activity.endDate);$scope.singleDayEvent=startDate.isSame(endDate,"day"),$scope.scrollTo=function(elementId){scrollToElement(elementId)},$scope.activity.host.self||(TrackingService.trackActivityPageView($scope.activity.series),ActivityService.getRelatedActivities($scope.activity.id,!1,function(response){$scope.relatedActivities=response,$rootScope.$broadcast("recalcStickies")})),$timeout(function(){var mapCenter={lat:parseFloat($scope.activity.startLocation.latitude),lng:parseFloat($scope.activity.startLocation.longitude)},map=document.getElementById("map");if(map)if($scope.map=new google.maps.Map(map,{zoom:15,center:mapCenter,options:{maxZoom:16,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles}}),null!==$scope.activity.flexibleLocationDistance||"private"===$scope.activity.meetingPoint&&!$scope.activity.alreadyJoined){var circle=new google.maps.Circle({strokeWeight:0,fillColor:"#06A2DD",fillOpacity:.35,map:$scope.map,center:mapCenter,radius:$scope.activity.flexibleLocationDistance?$scope.activity.flexibleLocationDistance*appSettings.distanceMultiplier:appSettings.distanceMultiplier});$scope.map.fitBounds(circle.getBounds())}else new google.maps.Marker({map:$scope.map,position:mapCenter,icon:new google.maps.MarkerImage("img/maps/light-blue.png",null,null,null,new google.maps.Size(40,40))})},0),$scope.editActivity=function(){$rootScope.$broadcast("showLoading"),$state.go("activities.edit",{activityId:$scope.activity.id})},$scope.joinActivity=function(){$scope.activity.hostBankConnected?($rootScope.$broadcast("showLoading"),$state.go("activities.join",{seriesId:$scope.activity.series,activityId:$scope.activity.id})):(ActivityService.joinAttempt($scope.activity.id),AlertService.showToast("error","Sorry!","Your host needs to update a few details before you can join this activity. We'll let you know as soon as booking has reopened."),jumpToTop(),IntercomService.sendEvent("unsuccessful-booking",{activity_id:$scope.activity.id,url:$scope.activity.publicUrl,total_cost:0,instances_joined:0,spots_booked:0,reason:"Host not connected to Stripe"}))},$scope.removeJoiner=function(joiner){$scope.activity.host.self&&$uibModal.open({templateUrl:"activities/views/partials/remove-joiner-form.html",controller:"RemoveJoinerModalController",keyboard:!1,backdrop:"static",resolve:{data:function(){return{activity:$scope.activity,joiner:joiner}}}}).result.then(function(response){$rootScope.$broadcast("showLoading"),ActivityService.cancelBooking($scope.activity.id,{joiner:joiner.id,reason:response.reason,series:response.series},function(response){AlertService.showToast("success",joiner.name+" has been removed",""),_.remove($scope.activity.joiners,["id",joiner.id]),$rootScope.$broadcast("hideLoading")},function(errorResponse){$rootScope.$broadcast("hideLoading")})})},$scope.shareText={twitter:"Check out "+$scope.activity.title+" @HulaHubHQ!",email:{subject:"Check out "+$scope.activity.title+" @HulaHubHQ",body:"I saw this activity on HulaHub and thought of you!\n\n"+$scope.activity.publicUrl+"\n\nMaybe I'll see you at this one, or another activity on Hulahub soon!"}},$scope.shareActivity=function(){$uibModal.open({templateUrl:"core/partials/share-modal.html",controller:"ShareModalController",resolve:{data:function(){return{id:$scope.activity.series,idName:"activity_id",title:"Share "+$scope.activity.title,url:$scope.activity.publicUrl,text:$scope.shareText,intercomEventName:"shared-activity"}}}})},$scope.sendInvites=function(activity){$rootScope.$broadcast("showLoading"),$state.go("activities.hosted.share",{activityId:activity.id})},$scope.discussionBoard=function(activity){$state.go($scope.activity.host.self?"activities.hosted.view.discussion":"activities.joined.view.discussion",{activityId:activity.id})},$scope.sendIntercomShareEvent=function(channel){IntercomService.sendEvent("shared-activity",{channel:channel,activity_id:$scope.activity.series,url:$scope.activity.publicUrl})},$scope.shareFacebook=function(){$scope.sendIntercomShareEvent("facebook"),$rootScope.$broadcast("showLoading"),$facebook.ui({method:"share",href:$scope.activity.publicUrl}).then(function(){$rootScope.$broadcast("hideLoading")},function(err){$rootScope.$broadcast("hideLoading")})},$scope.onClipboardSuccess=function(){$scope.linkCopiedToClipboard=!0},$scope.newMessage=function(recipients){$uibModal.open({templateUrl:"messages/views/new-message-modal.html",controller:"NewMessageModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput"])},data:function(){return{to:recipients,subject:$scope.activity.title+" on "+moment($scope.activity.startDate).format("DD/MM/YYYY")}}}})},$scope.copyActivity=function(activity){$scope.activity.host.self&&($rootScope.$broadcast("showLoading"),$state.go("activities.new",{copyFrom:activity.id}))},$scope.cancelActivity=function(activity){$scope.activity.host.self&&$uibModal.open({templateUrl:"activities/views/partials/cancel-form.html",controller:"CancelActivityModalController",resolve:{data:function(){return{activity:_.clone(activity)}}}}).result.then(function(response){$rootScope.$broadcast("showLoading"),ActivityService.cancel(activity.id,response,function(){$rootScope.$broadcast("hideLoading"),activity.status="cancelled",activity.deletable=!0})})},$scope.deleteActivity=function(){$scope.activity.host.self&&$scope.activity.deletable&&showConfirm("Delete this activity?","Are you sure you want to delete "+$scope.activity.title+"?",function(){$rootScope.$broadcast("showLoading"),ActivityService.deleteActivity($scope.activity.id,function(){AlertService.showToast("success",$scope.activity.title+" has been deleted",""),$state.go("activities.hosted")},function(response){AlertService.showToast("error","An error occurred","Could not delete the activity. Please try again."),$rootScope.$broadcast("hideLoading")})})},$scope.sendContactRequest=function(user){user.contactRequestSent=!0,user.justSentRequest=!0,ContactService.sendContactRequest(user.id,function(response){$log.error("Error sending contact request:"+response)})},$scope.bookFlexibleActivity=function(){$scope.activity.flexible&&(AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Availability"),$uibModal.open({templateUrl:"booking-requests/views/flexible-booking-form.html",controller:"FlexibleBookingFormModalController",resolve:{data:function(){return{activity:$scope.activity}}}}))},$scope.bookRepeatingActivity=function(){!$scope.activity.flexible&&$scope.activity.seriesDates.length>1&&(AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Availability"),$uibModal.open({templateUrl:"activities/views/partials/repeat-activity-booking-form.html",controller:"RepeatActivityBookingFormModalController",resolve:{data:function(){return{activity:$scope.activity}}}}))},$scope.bookOffsiteActivity=function(){AnalyticsService.sendUserBehaviourEvent("Booking Flow - Offsite - Start")},$scope.slickConfig={dots:!0,autoplay:!0,autoplaySpeed:5e3,pauseOnFocus:!1,pauseOnHover:!1,prevArrow:'<div class="button prevButton"><i class="fas fa-angle-left"></i></div>',nextArrow:'<div class="button nextButton"><i class="fas fa-angle-right"></i></div>'},$scope.openPhotoGallery=function(){$("#photoGalleryLightbox a").simpleLightbox({docClose:!1,disableRightClick:!0}).open()};var $stickyBar=$("#floatingFooterBar");if($stickyBar){var $window=$(window);$window.scroll(function(){$stickyBar.toggleClass("displayed",$window.scrollTop()>50)})}}),angular.module("hulahub").controller("ActivityInvitesController",function($log,$rootScope,$scope,$state,$stateParams,InviteService){$scope.loading=!0,InviteService.getReceivedActivityInvites(function(response){$scope.invites=response,$scope.loading=!1},function(error){$log.error("failed to get activity invites"),$scope.loading=!1})}),angular.module("hulahub").controller("BrowseActivitiesController",function($scope,$stateParams,$uibModal,StorageService,AuthService,AlertService,BrowseActivityService){var modalParams={templateUrl:"activities/views/partials/browse-filters.html"};BrowseActivityService.load($scope,"activities",modalParams);var sessionData=JSON.parse(StorageService.getItem("hh-activity-search",!0));null!==sessionData&&$scope.formData.loadFromSession(sessionData),null!==$stateParams.text&&($scope.formData.text=$stateParams.text,$scope.formData.sort.value="score"),null==$scope.formData.location&&AuthService.currentUser.homeHub&&(AuthService.currentUser.homeHub.locality||(AuthService.currentUser.homeHub.locality=AuthService.currentUser.homeHub.name),$scope.formData.location=AuthService.currentUser.homeHub,$scope.formData.sort.value="score"),$stateParams.forceFeatured===!0&&($scope.formData.filters.special.featured=!0),$scope.formData.search(),$scope.saveSearch=function(){$uibModal.open({templateUrl:"interests/views/add-interest-modal.html",controller:"AddInterestModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches"])},data:function(){return{interest:$scope.formData.interest,location:!$scope.formData.location||$scope.formData.location.isHome&&AuthService.currentUser.homeHub?null:$scope.formData.location}}}}).result.then(function(result){AlertService.showToast("success","Search saved!",'See the latest results anytime in your <a class="underlinedLink" href="/activities/find/matches">matched activities</a>')})},$scope.suggestActivity=function(){$uibModal.open({templateUrl:"activities/views/partials/suggest-activity-modal.html",controller:"SuggestActivityModalController",resolve:{data:function(){return{activity:$scope.formData.text,location:$scope.formData.location}}}}).result.then(function(result){AlertService.showToast("success","Thank you for helping us!","We will let you know as soon as we add that activity."),jumpToTop()})}}),angular.module("hulahub").controller("CancelActivityModalController",function($scope,data){function validateForm(){return $scope.validationRun=!0,0===$scope.activity.joiners||$scope.form.$valid}data.activity.seriesDates.constructor===Array&&(data.activity.seriesDates=data.activity.seriesDates.length,data.activity.joiners=data.activity.joiners.length),(0===data.activity.seriesDates||data.activity.availableDays)&&(data.activity.seriesDates=1),$scope.activity=data.activity,$scope.formData={reason:""},$scope.cancelActivity=function(series){validateForm()&&$scope.$close({series:series,reason:$scope.activity.joiners>0?$scope.formData.reason:"No reason needed"})}}),angular.module("hulahub").controller("DiscussionBoardController",function($scope,$rootScope,$state,$stateParams,$timeout,$log,AuthService,ActivityService,AlertService){$scope.activity.host.self||$scope.activity.alreadyJoined||$state.go("activities.view.info",{activityId:$scope.activity.id}),$scope.loading=!0,ActivityService.getDiscussionBoardPosts($scope.activity.id,function(response){$scope.posts=response,$scope.loading=!1},function(error){$log.error(error),$scope.posts=[],$scope.loading=!1}),$scope.deletePost=function(post){AuthService.currentUser.hashId!==$scope.activity.host.id&&AuthService.currentUser.hashId!==post.author.id||showConfirm("Delete post","Are you sure you want to delete this post?",function(){ActivityService.removeDiscussionBoardPost($scope.activity.id,post.id),_.remove($scope.posts,function(n){n.id===post.id&&(n.deleted=!0,n.author=null,n.text=null)}),$scope.$apply()})};var commentBox=$("textarea");$scope.scrollToForm=function(){scrollToElement("discussionForm"),commentBox.focus()},$scope.savePost=function(){$rootScope.$broadcast("showLoading"),ActivityService.postToDiscussionBoard($scope.activity.id,{text:$scope.newPost},function(response){AlertService.showToast("success","Message posted successfully.",""),response.author={id:AuthService.currentUser.hashId,name:AuthService.currentUser.profile.firstName+" "+AuthService.currentUser.profile.lastName,avatarURL:AuthService.currentUser.profile.avatarURL},$scope.posts.push(response),$scope.newPost=null,$timeout(function(){autosize.update(commentBox)},0),$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","Failed to post your message.","Please try again."),$log.error(response),$rootScope.$broadcast("hideLoading")})},$timeout(function(){autosize(commentBox)},0)}),angular.module("hulahub").controller("EditActivityController",function($scope,$rootScope,$state,$log,$timeout,$uibModal,StorageService,ActivityFormService,ActivityService,UserService,AuthService,AlertService,activity){function save(publish,series){$rootScope.$broadcast("showLoading"),ActivityService.update(activity.id,$scope.formData,series,function(response){completeSave(publish,response,series,!1)},function(saveError){$log.error(saveError.data),AlertService.showToast("error","Failed to save your activity.","Please try again."),$rootScope.$broadcast("hideLoading")},function(uploadError,saveResponse){completeSave(publish,saveResponse.data,series,!0)})}function completeSave(publish,response,series,failedDuringUpload){UserService.updateGoal(),StorageService.setItem("myActivities.activeFilter",publish?"published":"draft",!0),failedDuringUpload?(AlertService.showToast("error","An error occurred while uploading attachments.","Please try again."),$state.go("activities.edit",{activityId:response.id},{reload:!0})):publish&&"draft"===$scope.formData.status?ActivityService.publishSeries(response.series,function(){$scope.formData.budget.total()>0&&!AuthService.currentUser.hasPaidActivities&&(AuthService.currentUser.hasPaidActivities=!0),$state.go("activities.hosted.share",{activityId:response.id,skipButton:!0})}):(AlertService.showToast("success","Success!","<strong>"+$scope.formData.title+"</strong> has been updated"),$state.go("activities.hosted"))}if(activity=activity.data,activity.series.until){var m=moment.utc(activity.series.until);$scope.savedRepeatUntil=new Date(m.year(),m.month(),m.date(),0,0,0,0)}$scope.disableActivityRepeatChanges="published"===activity.status,$scope.formData=ActivityFormService.loadFromAPI($scope,activity),$scope.originalData=JSON.stringify($scope.formData.serialized()),ActivityFormService.runWatchers($scope),$timeout(function(){autosize($("textarea"))},0),$scope.$on("closeActivityForm",function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$state.go("activities.hosted"):showConfirm("Close activity form","Are you sure you want to close the form? Any unsaved changes you have made will be lost.",function(){$state.go("activities.hosted")})}),$scope.$on("saveActivityForm",function(){"draft"===$scope.formData.status?$scope.save(!1):"published"===$scope.formData.status&&$scope.save(!0)}),$scope.showHelp=function(content){$uibModal.open({templateUrl:"activities/views/partials/definition-help-modal.html",controller:function($scope){$scope.title=content.replace(/_/g," ").capitalizeFirstLetter(),$scope.content=content}})},$scope.save=function(publish){$scope.formData.publishing=publish,$timeout(function(){if($scope.formData.validate(100))if("published"===$scope.formData.status&&$scope.formData.hasRepeat){var msg="Are you sure you want to make changes to this activity? Please be aware that some of the changes may affect people that have already joined e.g. age or gender requirements.<br /><br />";msg+="Do you want to change this activity and all future activities, or just this activity?",showActivitySeriesConfirm("Confirm changes to this activity",msg,function(){save(publish,!1)},function(){save(publish,!0)})}else publish&&"published"===$scope.formData.status?showActivityEditConfirm("Confirm changes to this activity","Are you sure you want to make changes to this activity? Please be aware that some of the changes may affect people that have already joined e.g. age or gender requirements.",function(){save(publish,!1)}):save(publish,!1)},0)}}),angular.module("hulahub").controller("ExternalActivityController",function($scope,$rootScope,$stateParams,$timeout,$uibModal,$facebook,appSettings,ENV,AnalyticsService,AlertService,ActivityService,IntercomService){$scope.loading=!0,ActivityService.getActivityPublic({id:$stateParams.activityId,isExternal:!0},function(activity){$scope.activity=activity,$scope.activity.publicUrl=ENV["public"]+"/activity/external/"+$scope.activity.publicUrl;var startDate=moment($scope.activity.startDate),endDate=moment($scope.activity.endDate);$scope.singleDayEvent=startDate.isSame(endDate,"day"),$scope.activity.closed=startDate.isBefore(moment()),$scope.scrollTo=function(elementId){scrollToElement(elementId)},ActivityService.getRelatedActivities($scope.activity.id,!0,function(response){$scope.relatedActivities=response,$rootScope.$broadcast("recalcStickies")}),$timeout(function(){var mapCenter={lat:parseFloat(activity.startLocation.latitude),lng:parseFloat(activity.startLocation.longitude)},map=document.getElementById("map");map&&($scope.map=new google.maps.Map(map,{zoom:14,center:mapCenter,options:{maxZoom:16,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles}}),new google.maps.Marker({map:$scope.map,position:mapCenter,icon:new google.maps.MarkerImage("img/maps/light-blue.png",null,null,null,new google.maps.Size(40,40))}))},0),$scope.shareText={twitter:"Check out "+$scope.activity.title+" @HulaHubHQ!",email:{subject:"Check out "+$scope.activity.title+" @HulaHubHQ",body:"I saw this activity on HulaHub and thought of you!\n\n"+$scope.activity.publicUrl+"\n\nMaybe I'll see you at this one, or another activity on Hulahub soon!"}},$scope.shareActivity=function(){$uibModal.open({templateUrl:"core/partials/share-modal.html",controller:"ShareModalController",resolve:{data:function(){return{id:$scope.activity.series,idName:"activity_id",title:"Share "+$scope.activity.title,url:$scope.activity.publicUrl,text:$scope.shareText,intercomEventName:"shared-activity"}}}})},$scope.sendIntercomShareEvent=function(channel){IntercomService.sendEvent("shared-activity",{channel:channel,activity_id:$scope.activity.id,url:$scope.activity.publicUrl})},$scope.shareFacebook=function(){$scope.sendIntercomShareEvent("facebook"),$rootScope.$broadcast("showLoading"),$facebook.ui({method:"share",href:$scope.activity.publicUrl}).then(function(){$rootScope.$broadcast("hideLoading")},function(err){$rootScope.$broadcast("hideLoading")})},$scope.onClipboardSuccess=function(){$scope.linkCopiedToClipboard=!0},$scope.loading=!1},function(error){$scope.loading=!1,$scope.notFound=!0,$scope.activity={title:"Not found"}}),$scope.bookActivity=function(){$rootScope.$broadcast("showLoading"),ActivityService.joinExternal("imin",{activity:$scope.activity.id},function(response){AnalyticsService.sendUserBehaviourEvent("Booking Flow - imin - Start"),window.location.href=response.checkoutUrl},function(error){$rootScope.$broadcast("hideLoading"),AlertService.showToast("error","Failed to join activity.","An error occurred. Please try again.")})}}),angular.module("hulahub").controller("InspireMeController",function($scope,$state,$uibModal,StorageService,AlertService,ActivityService){$scope.addInterest=function(){$uibModal.open({templateUrl:"interests/views/add-interest-modal.html",controller:"AddInterestModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches"])},data:function(){return{interest:null,location:null}}}}).result.then(function(result){AlertService.showToast("success","Interest added!",'See your <a class="underlinedLink" href="/activities/find/matches">matched activities</a> now or add more interests')})},$scope.browseSegment=function(text){StorageService.removeItem("hh-activity-search"),$state.go("activities.find.browse",{text:text})},$scope.loadingFeaturedActivities=!0,ActivityService.getRandomFeatured(function(response){$scope.featuredActivities=response,$scope.loadingFeaturedActivities=!1},function(){$scope.loadingFeaturedActivities=!1})}),angular.module("hulahub").controller("JoinActivityController",function($scope,$rootScope,$state,$stateParams,$log,$window,$uibModal,$facebook,$location,ENV,AuthService,PaymentService,ActivityService,AvailabilityService,AlertService,UserService,AnalyticsService,ParameterService,IntercomService,MouseflowService,StorageService,OfferService,CouponService,activity){function userLoggedIn(callback){AuthService.currentUser.hashId===activity.host.id?($state.go("activities.hosted.view",{activityId:currentInstance.id}),AlertService.showToast("error","Cannot join activity.","You cannot join this activity as you are already hosting it.")):PaymentService.getPaymentCards().then(function(response){$scope.joinerDetails={firstName:AuthService.currentUser.profile.firstName,lastName:AuthService.currentUser.profile.lastName},$scope.existingCards=response.data,$scope.existingCard=$scope.existingCards.length?$scope.existingCards[0].stripeCardId:null,callback&&callback()})}function calculateSteps(callback){$scope.allSteps=[],AuthService.isLoggedIn?$scope.allSteps.push("confirm"):($scope.allSteps.push("register_login"),$scope.allSteps.push("confirm")),callback()}function updateMouseflowStep(){var newUrl=$scope.currentStep;"success_fail"===$scope.currentStep&&(newUrl=$scope.successFailView),MouseflowService.newPageView($location.path()+"/"+newUrl)}function calculateTotals(){_.isEmpty($scope.selectedActivities)?($scope.subTotalCost=0,$scope.totalCost=0):($scope.totalCost=_.sum(_.map($scope.selectedActivities,function(a){return a.spots*activity.budget.totalPerPerson})),checkOfferQualification(),$scope.subTotalCost=$scope.totalCost,$scope.offerApplied&&($scope.totalCost-=$scope.offerApplied.amount),$scope.coupon.data&&("p"===$scope.coupon.data.type?$scope.totalCost-=$scope.coupon.data.amount/1e4*$scope.totalCost:$scope.totalCost-=$scope.coupon.data.amount),$scope.totalCost<0&&($scope.totalCost=0))}function checkOfferQualification(){var totalSpots=_.sumBy($scope.selectedActivities,"spots"),selectedOffer=OfferService.pickBestOffer(activity.availableOffers,totalSpots,$scope.totalCost);$scope.offerApplied=null===selectedOffer?null:{amount:selectedOffer.discountedAmount,offer:selectedOffer};var nextOffers=_.filter(activity.availableOffers,function(o){return o.threshold>totalSpots});$scope.nextOffer=nextOffers.length?nextOffers[0]:null}function completeLogin(){IntercomService.boot(),ParameterService.clearData(),$rootScope.$broadcast("recalcStickies"),$scope.validateCoupon(!0),userLoggedIn(function(){calculateSteps(function(){$scope.currentStep=$scope.allSteps[$scope.allSteps.length-1],updateMouseflowStep()}),$rootScope.$broadcast("hideLoading")})}function loginError(response){423===response.status?$scope.formErrors={email:"locked"}:$scope.formErrors={email:"Log in failed. Please try again."},$("input.email").select(),$rootScope.$broadcast("hideLoading")}function join(data){if($scope.activity.flexible){var requestBody={date:$scope.bookingRequest.date,time:$scope.bookingRequest.time.hour,spots:$scope.selectedActivities[0].spots,message:$scope.bookingRequest.message,payment:data};$scope.offerApplied&&(requestBody.offer=$scope.offerApplied.offer.id),$scope.coupon.data&&(requestBody.coupon=$scope.coupon.code),AvailabilityService.requestBooking($scope.activity.id,requestBody,function(response){StorageService.removeCookie("flexibleBookingRequest"),AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Request",$scope.totalCost),$scope.currentStep="success_fail",$scope.successFailView="success",updateMouseflowStep(),$rootScope.$broadcast("hideLoading")},function(error){402===error.status?AlertService.showToast("error","Payment error",error.data.message):(StorageService.removeCookie("flexibleBookingRequest"),$scope.currentStep="success_fail",$scope.successFailView="fail",updateMouseflowStep()),$rootScope.$broadcast("hideLoading")})}else angular.isUndefined(data)&&(data={}),data.instances=_.map($scope.selectedActivities,function(a){return{id:a.id,spots:a.spots}}),$scope.offerApplied&&(data.offer=$scope.offerApplied.offer.id),$scope.coupon.data&&(data.coupon=$scope.coupon.code),ActivityService.join(data,function(response){AnalyticsService.sendGoalEvent("7 - Join Activity"),AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Book",$scope.totalCost),$scope.currentStep="success_fail",$scope.successFailView="success",updateMouseflowStep(),$rootScope.$broadcast("hideLoading")},function(response){joinFailed(response)})}function joinFailed(error){$rootScope.$broadcast("hideLoading"),409===error.status?("NO_SPOTS"===error.data.code?AlertService.showToast("error","No spots left","Unfortunately there are no more spots available for this activity"):$scope.selectedActivities.length>1?AlertService.showToast("error","Activity cancelled","Sorry, one or more of the activities selected have been cancelled"):AlertService.showToast("error","Activity cancelled","Sorry, this activity has been cancelled"),_.forEach(error.data.errors,function(err){var id=_.keys(err)[0],act=_.find(allDates,["id",id]);"CANCELLED_ACTIVITIES"===error.data.code&&(act.cancelled=!0),$scope.deSelectDay({id:id})}),$scope.currentStep=$scope.allSteps[0]):angular.isDefined(error.data.code)?"ACTIVITY_CANCELLED"===error.data.code?($scope.currentStep=$scope.allSteps[0],AlertService.showToast("error","Activity cancelled",error.data.errors)):"HOST_STRIPE_MISSING"===error.data.code?($scope.currentStep="success_fail",$scope.successFailView="fail",updateMouseflowStep(),IntercomService.sendEvent("unsuccessful-booking",{activity_id:activity.id,url:publicURL,total_cost:$scope.totalCost/100,instances_joined:$scope.selectedActivities.length,spots_booked:_.sum(_.map($scope.selectedActivities,"spots")),reason:"Host not connected to Stripe"}),ActivityService.joinAttempt($scope.selectedActivities[0].id)):"COUPON_INVALID"===error.data.code?($scope.removeCoupon(),AlertService.showToast("error","Coupon not valid","The coupon is not valid and has been removed from your booking. Please add another coupon if you like.")):"COUPON_USER_LIMIT_REACHED"===error.data.code?($scope.removeCoupon(),AlertService.showToast("warning","Coupon not valid","Sorry this coupon has been used and is no longer valid. Please add a new coupon or continue with your current booking.")):AlertService.showToast("error","Unexpected Error",error.data.errors):AlertService.showToast("error","Unexpected Error",error.data.errors)}$scope.activity=activity;var currentInstance=activity.currentInstance;AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Start"),activity.flexible&&($scope.bookingRequest=JSON.parse(StorageService.getCookie("flexibleBookingRequest")),$scope.bookingRequest?$scope.bookingRequest.message=null:AuthService.isLoggedIn?$state.go("activities.view",{activityId:currentInstance.id}):$window.location.href=document.referrer),activity.groupSizeMax&&activity.joiners.length>=activity.groupSizeMax&&$state.go("activities.view",{activityId:currentInstance.id});var startDate=moment(currentInstance.startDate),endDate=moment(currentInstance.endDate);$scope.singleDayEvent=startDate.isSame(endDate,"day"),$scope.existingCards=[],$scope.existingCard=null;var paramUser=ParameterService.getUser();if($scope.joinerDetails={firstName:null,lastName:null,email:paramUser.email,password:null,invitation:paramUser.inviteToken},AuthService.isLoggedIn&&userLoggedIn(),$scope.paymentDueDate=moment(activity.endDate).endOf("day").add(4,"days").unix(),$scope.cancelJoin=function(){AuthService.isLoggedIn?$state.go("activities.view",{activityId:currentInstance.id}):$window.location.href=document.referrer},$scope.registerLoginView="register",$scope.successFailView="success",calculateSteps(function(){$scope.currentStep=$scope.allSteps[0],updateMouseflowStep()}),$scope.$watch("currentStep",function(newStep){$scope.currentStepIndex=$scope.allSteps.indexOf(newStep)+1}),$scope.nextStep=function(){$scope.currentStep=$scope.allSteps[$scope.currentStepIndex],updateMouseflowStep(),jumpToTop()},$scope.previousStep=function(){1===$scope.currentStepIndex?$scope.cancelJoin():($scope.currentStep=$scope.allSteps[$scope.currentStepIndex-2],updateMouseflowStep(),jumpToTop())},$scope.coupon={code:null,valid:null,data:null},$scope.validateCoupon=function(alreadyLoading){$scope.coupon.code&&(alreadyLoading||$rootScope.$broadcast("showLoading"),CouponService.validateCoupon($scope.coupon.code,$stateParams.seriesId,function(response){$scope.coupon.valid=!0,$scope.coupon.data=response,calculateTotals(),alreadyLoading||$rootScope.$broadcast("hideLoading")},function(error){$scope.coupon.data?$scope.removeCoupon():$scope.coupon.valid=!1,"COUPON_USER_LIMIT_REACHED"===error.code&&AlertService.showToast("warning","Sorry this coupon has been used and is no longer valid.","Please add a new coupon or continue with your current booking."),alreadyLoading||$rootScope.$broadcast("hideLoading")}))},$scope.removeCoupon=function(){$scope.coupon.code=null,$scope.coupon.valid=null,$scope.coupon.data=null,calculateTotals()},$scope.$watch("selectedActivities",function(newVal){calculateTotals()},!0),$scope.selectedActivities=[],null!==$stateParams.activityId&&$stateParams.activityId===currentInstance.id&&("Unlimited"===currentInstance.spotsLeft||currentInstance.spotsLeft>0)){var m=moment(activity.currentInstance.startDate),e=moment(activity.currentInstance.endDate);$scope.selectedActivities=[{id:$stateParams.activityId,date:{timestamp:m.unix(),display:m.isSame(e,"day")?m.format("ddd D MMM YYYY, HH:mm")+" - "+e.format("HH:mm"):m.format("ddd D MMM YYYY, HH:mm")},spots:activity.flexible&&$scope.bookingRequest?$scope.bookingRequest.spots:1}],$scope.totalCost=activity.budget.totalPerPerson}$scope.register=function(){$scope.formErrors=null,$scope.registerValidationRun=!0,$scope.registerForm.$valid&&($rootScope.$broadcast("showLoading"),$scope.joinerDetails.channel="activity_booking",UserService.register($scope.joinerDetails,function(){UserService.getMyDetails(function(user){$rootScope.$broadcast("recalcStickies"),IntercomService.boot(),AnalyticsService.sendGoalEvent("0 - Register",user.id),AnalyticsService.trigger("Registration",{form:"activity_booking",type:"joiner",method:"HH signup",status:"complete"}),$rootScope.$broadcast("hideLoading"),$scope.nextStep()})},function(registerError){$scope.formErrors=registerError.data.errors,$rootScope.$broadcast("hideLoading")}))},$scope.login=function(){$scope.formErrors=null,$scope.loginValidationRun=!0,$scope.loginForm.$valid&&($rootScope.$broadcast("showLoading"),AuthService.getAccessToken("/users/login",{grant_type:"password",username:$scope.joinerDetails.email,password:$scope.joinerDetails.password},function(){completeLogin()},loginError))},$scope.facebookLogin=function(){$rootScope.$broadcast("showLoading"),$facebook.login(void 0,!0).then(function(){$facebook.api("/me").then(function(response){var fbAuth=$facebook.getAuthResponse();AuthService.getAccessToken("/users/login/external",{provider:"facebook",id:response.id,accessToken:fbAuth.accessToken},function(){completeLogin()},loginError)},function(err){$rootScope.$broadcast("hideLoading")})})},$scope.paymentFormClearHandler={},$scope.logout=function(){$scope.registerValidationRun=!1,$scope.loginValidationRun=!1,AuthService.isLoggedIn&&AuthService.logout(),$scope.paymentFormClearHandler.submit(),$scope.existingCards=[],$scope.existingCard=null,$scope.joinerDetails={firstName:null,lastName:null,email:null,password:null},$scope.bookingRequest&&($scope.bookingRequest.message=null),$scope.registerLoginView="register",calculateSteps(function(){$scope.currentStep="register_login",updateMouseflowStep()})},$scope.confirmAndJoin=function(newCardData){$rootScope.$broadcast("showLoading"),jumpToTop(),0===$scope.totalCost?join():null!==$scope.existingCard?join({existingCard:$scope.existingCard}):PaymentService.createPaymentToken(newCardData.card,function(response){
join({token:response.id,newCard:{id:response.card.id,last4:response.card.last4,brand:response.card.brand,expiryMonth:response.card.exp_month,expiryYear:response.card.exp_year}})},function(response){joinFailed(response)})};var publicURL=ENV["public"]+"/activity/"+activity.publicUrl;$scope.share={url:publicURL,twitter:"Check out "+activity.title+" @HulaHubHQ!",email:{subject:"Check out "+activity.title+" @HulaHubHQ",body:"I saw this activity on HulaHub and thought of you!\n\n"+publicURL+"\n\nMaybe I'll see you at this one, or another activity on Hulahub soon!"}},$scope.sendIntercomShareEvent=function(channel){IntercomService.sendEvent("shared-activity",{channel:channel,activity_id:activity.id,url:publicURL})},$scope.shareFacebook=function(){$scope.sendIntercomShareEvent("facebook"),$rootScope.$broadcast("showLoading"),$facebook.ui({method:"share",href:publicURL}).then(function(){$rootScope.$broadcast("hideLoading")},function(err){$rootScope.$broadcast("hideLoading")})},$scope.onClipboardSuccess=function(){$scope.linkCopiedToClipboard=!0},$scope.newMessage=function(host,subject){$uibModal.open({templateUrl:"messages/views/new-message-modal.html",controller:"NewMessageModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput"])},data:function(){return{to:[host],subject:subject}}}})}}),angular.module("hulahub").controller("MatchesActivitiesController",function($scope,$uibModal,AuthService,InterestService,AlertService,ActivityService){function loadInterests(){$scope.loadingInterests=!0,InterestService.getInterests(function(response){$scope.allInterests=response,null===$scope.formData.interests&&($scope.formData.interests=_.clone(_.map(response,"id"))),$scope.loadingInterests=!1})}function loadSuggestions(){$scope.loadingSuggestedInterests=!0,InterestService.getSuggestedInterestsByGroup(function(response){$scope.suggestedInterests=response,$scope.loadingSuggestedInterests=!1})}$scope.loadingMatches=!1,$scope.formData={interests:null,sort:{options:[{key:"score",value:"Most relevant"},{key:"price_low",value:"Price (Low)"},{key:"price_high",value:"Price (High)"}],value:"score",getLabel:function(){return _.find(this.options,{key:this.value}).value.toLowerCase()}},pagination:{current:1,perPage:18},serialized:function(){return{interests:this.interests,sort:this.sort.value,pagination:this.pagination}}},0!==AuthService.currentUser.interestCount&&loadInterests(),loadSuggestions(),$scope.addInterest=function(interest){$uibModal.open({templateUrl:"interests/views/add-interest-modal.html",controller:"AddInterestModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","nouislider","switches"])},data:function(){return{interest:interest,location:null}}}}).result.then(function(result){null===$scope.formData.interests?$scope.formData.interests=[result.id]:$scope.formData.interests.push(result.id),loadInterests(),loadSuggestions()})};var resetPageNumber=!1;$scope.changePage=function(newPage){jumpToTop(),$scope.formData.pagination.current=newPage,resetPageNumber=!1};var lastSearch;$scope.$watch("formData",function(newVal,oldVal){if(null!==$scope.formData.interests){var newSerialized=newVal.serialized(),oldSerialized=oldVal.serialized();if($scope.loadingMatches&&JSON.stringify(newSerialized)===JSON.stringify(oldSerialized))return;$scope.loadingMatches=!0,resetPageNumber&&(newVal.pagination.current=1),resetPageNumber=!0,lastSearch=JSON.stringify(newSerialized),ActivityService.matchedActivities(newSerialized,lastSearch,function(response,originalSearch){originalSearch===lastSearch&&($scope.results=response,$scope.loadingMatches=!1)},function(errorResponse){$scope.loading=!1,AlertService.showToast("error","Matching error","An error has occurred while matching activities. Please try again later.")})}},!0)}),angular.module("hulahub").controller("MyActivitiesController",function($log,$scope,$state,$stateParams,$compile,$timeout,$rootScope,AnalyticsService,ActivityService,AvailabilityService,AlertService,InviteService){$stateParams.partner&&$stateParams.partnerBooking&&AnalyticsService.sendUserBehaviourEvent("Booking Flow - "+$stateParams.partner+" - Confirm"),$scope.$on("loadingCalendar",function(event,args){$scope.loadingCalendar=args}),$scope.$on("updateScheduledActivities",function(event,args){$scope.scheduledActivities=args.activities}),$scope.$on("loadActivity",function(event,args){var activity=args.activity;$rootScope.$broadcast("showLoading"),$("#activityDetails").remove(),$scope.selectedActivity=activity;var activityToLoad="BookingRequest"===activity.type?activity.activity:activity;ActivityService.getActivityPublic(activityToLoad,function(response){$scope.activityDetails=response,"ActivityInvite"===activity.type&&(response.invite=activity.invite,response.status="pending"),"BookingRequest"===activity.type&&(response.bookingRequest=activity,response.flexible=!1,response.startDate=activity.startDate,response.endDate=activity.endDate,response.spotsBooked=activity.spots,response.spotsTaken=activity.spots,response.status=activity.status),(angular.isUndefined(activity.type)||"ConfirmedActivity"===activity.type)&&response.flexible&&activity.bookingRequest&&(response.flexible=!1,response.startDate=activity.startDate,response.endDate=activity.endDate,response.spotsBooked=activity.bookingRequest.spots,response.spotsTaken=activity.bookingRequest.spots),$timeout(function(){var selectedDOMElement=$(".myActivityList .activity.selected"),activityDetails=$compile('<activity-panel id="activityDetails" activity="activityDetails" dropup-menu="true"></activity-panel>')($scope);selectedDOMElement.after(activityDetails),$rootScope.$broadcast("hideLoading"),$("body,html").stop(!0,!0).animate({scrollTop:selectedDOMElement.offset().top-$(".navbar-fixed-top").outerHeight()},"normal")},0)},function(){$rootScope.$broadcast("hideLoading"),AlertService.showToast("error","Error","An error occurred while getting the activity details. Please try again.")})}),$scope.deleteCalendarActivityHandler=null,$scope.$on("deleteActivity",function(event,args){$timeout(function(){$scope.draftActivities&&_.remove($scope.draftActivities,function(a){return a.id===args.activity.id}),$scope.scheduledActivities&&_.remove($scope.scheduledActivities,function(a){return a.id===args.activity.id||a.series===args.activity.series&&"cancelled"===a.status}),$scope.flexibleActivities&&_.remove($scope.flexibleActivities,function(a){return a.id===args.activity.id}),null!==$scope.deleteCalendarActivityHandler&&$scope.deleteCalendarActivityHandler(args.activity.id,args.activity.series)},0)}),$scope.$on("cancelActivity",function(event,args){_.map($scope.scheduledActivities,function(a){(a.id===args.activity.id||args.series&&a.series===args.activity.series&&a.startDate>=args.activity.startDate)&&(a.status=args.activity.status,a.deletable=!0)}),$scope.flexibleActivities&&_.map($scope.flexibleActivities,function(a){a.id===args.activity.id&&(a.status=args.activity.status,a.deletable=!0)})}),"joined"===$state.current.data.view&&($scope.loadingInvites=!0,InviteService.getReceivedActivityInvites(function(data){$scope.activityInvites=data,$scope.loadingInvites=!1}),$scope.$on("removeInvite",function(event,args){_.remove($scope.activityInvites,function(row){return row.invite.id===args.invite})}),$scope.$on("changedBookingRequest",function(event,args){$scope.loadBookingRequests(),$scope.selectedActivity=void 0})),"hosted"===$state.current.data.view&&($scope.loadingDraftActivities=!0,ActivityService.getDrafts(function(data){$scope.draftActivities=data,$scope.loadingDraftActivities=!1}),$scope.loadingFlexibleActivities=!0,ActivityService.getFlexibleActivities(function(data){$scope.flexibleActivities=data,$scope.loadingFlexibleActivities=!1}),$scope.$on("acceptBookingRequest",function(event,args){_.remove($scope.bookingRequests,function(a){return a.id===args.bookingRequest.id}),$("#activityDetails").remove(),AlertService.showToast("success","The booking request has been accepted",""),$scope.$broadcast("reloadCalendar"),jumpToTop()}),$scope.$on("declineBookingRequest",function(event,args){$scope.bookingRequests&&(_.map($scope.bookingRequests,function(a){a.id===args.bookingRequest.id&&(a.status="declined",a.hostMessage=args.message,"payment"===args.reason&&(a.paymentError=!0,a.joinerMessage=args.joinerMessage))}),"payment"===args.reason?AlertService.showToast("error","Payment error","This booking couldn't be accepted due us being unable to take the payment."):AlertService.showToast("success","The booking request has been declined"),jumpToTop())})),$scope.loadBookingRequests=function(){$scope.loadingBookingRequests=!0,AvailabilityService.getBookingRequests("joined"===$state.current.data.view?"made":"received",function(data){$scope.bookingRequests=data,$scope.loadingBookingRequests=!1})},$scope.loadBookingRequests(),$scope.$on("deleteBookingRequest",function(event,args){AvailabilityService.deleteBookingRequest(args.bookingRequest.id),_.remove($scope.bookingRequests,function(a){return a.id===args.bookingRequest.id})})}),angular.module("hulahub").controller("NewActivityController",function($scope,$rootScope,$state,$log,$timeout,$uibModal,ActivityFormService,ActivityService,UserService,AuthService,AnalyticsService,AlertService,copyFrom){function completeSave(publish,response,failedDuringUpload){UserService.updateGoal(),"joiner"===AuthService.currentUser.registrationType?AnalyticsService.sendGoalEvent("11 - Host Activity"):(AuthService.currentUser.profile.score=response.user.score,AuthService.save(),AuthService.currentUser.completedGoals.indexOf(104)===-1?AnalyticsService.sendGoalEvent("104 - Create First Activity"):AuthService.currentUser.completedGoals.indexOf(106)===-1&&AnalyticsService.sendGoalEvent("106 - Create Second Activity")),failedDuringUpload?(AlertService.showToast("error","Upload error","An error occurred while uploading attachments."),$state.go("activities.edit",{activityId:response.id})):publish?ActivityService.publishSeries(response.series,function(){$scope.formData.budget.total()>0&&!AuthService.currentUser.hasPaidActivities&&(AuthService.currentUser.hasPaidActivities=!0),$state.go("activities.hosted.share",{activityId:response.id,skipButton:!0})}):(AlertService.showToast("success","Saved as draft","<strong>"+$scope.formData.title+"</strong> has been saved as a draft."),$state.go("activities.hosted"))}null!==copyFrom?$scope.formData=ActivityFormService.loadCopy($scope,copyFrom.data):$scope.formData=ActivityFormService.loadNew($scope),$scope.originalData=JSON.stringify($scope.formData.serialized()),ActivityFormService.runWatchers($scope),$timeout(function(){autosize($("textarea"))},0),$scope.$on("closeActivityForm",function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$state.go("activities.hosted"):showConfirm("Close activity form","Are you sure you want to close the form? Any unsaved changes you have made will be lost.",function(){$state.go("activities.hosted")})}),$scope.$on("saveActivityForm",function(){$scope.save(!1)}),$scope.showHelp=function(content){$uibModal.open({templateUrl:"activities/views/partials/definition-help-modal.html",controller:function($scope){$scope.title=content.replace(/_/g," ").capitalizeFirstLetter(),$scope.content=content}})},$scope.save=function(publish){$scope.formData.publishing=publish,$timeout(function(){$scope.formData.validate(100)&&($rootScope.$broadcast("showLoading"),ActivityService.save($scope.formData,function(response){completeSave(publish,response)},function(saveError){$log.error(saveError.data),AlertService.showToast("error","Save failed","Failed to save your new activity. Please fix any errors and try again."),$rootScope.$broadcast("hideLoading")},function(uploadError,saveResponse){completeSave(publish,saveResponse.data,!0)}))},0)}}),angular.module("hulahub").controller("RemoveJoinerModalController",function($scope,data){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.activity=data.activity,$scope.joiner=data.joiner,$scope.formData={reason:""},$scope.remove=function(series){validateForm()&&$scope.$close({series:series,reason:$scope.formData.reason})}}),angular.module("hulahubShared").controller("RepeatActivityBookingFormModalController",function($scope,$rootScope,$injector,ENV,ActivityService,data){function loadTimes(date){var mDate=moment(date.toISOString());$scope.booking.availableTimes=[$scope.booking.availableDates[mDate.format("MMYYYY")][mDate.format("D")]]}if(data.activity.series)var $state=$injector.get("$state");$scope.activity=data.activity;var seriesId=data.activity.series?data.activity.series:data.activity.id;$scope.loadingDates=!0,ActivityService.getInstances(seriesId,function(response){var availableDates=_.reduce(response.instances,function(result,i){var date=moment(i.startDate);return result[date.format("MMYYYY")]||(result[date.format("MMYYYY")]={}),result[date.format("MMYYYY")][date.format("D")]=i,result},{}),fullyBookedDates=_.map(_.filter(response.instances,["spotsLeft",0]),function(i){var date=moment(i.startDate);return date.format("DDMMYYYY")});$scope.booking={datePicker:{date:new Date(response.firstAvailableDay),options:{maxMode:"day",showWeeks:!1,startingDay:1,minDate:new Date(response.firstAvailableDay),maxDate:new Date(response.lastAvailableDay),dateDisabled:function(data){var index=("0"+(data.date.getMonth()+1)).slice(-2)+data.date.getFullYear();if($scope.booking.availableDates[index])return void 0===$scope.booking.availableDates[index][data.date.getDate()]},customClass:function(data){if(!this.dateDisabled(data)&&data.date>new Date){var date=("0"+data.date.getDate()).slice(-2)+("0"+(data.date.getMonth()+1)).slice(-2)+data.date.getFullYear();if(fullyBookedDates.indexOf(date)!==-1)return"unavailable"}}}},budget:response.budget,availableDates:availableDates,availableTimes:[]},$scope.loadingDates=!1}),$scope.$watch("booking.datePicker.date",function(newVal){newVal&&loadTimes(newVal)}),$scope.joinActivity=function(instanceId){data.activity.series?($rootScope.$broadcast("showLoading"),$scope.$dismiss(),$state.go("activities.join",{seriesId:data.activity.series,activityId:instanceId})):window.location=ENV.frontend+"/activities/join/"+data.activity.id+"/"+instanceId}}),angular.module("hulahub").controller("ShareActivityController",function($scope,$rootScope,$state,$stateParams,$location,$window,$timeout,$facebook,$log,ContactService,AnalyticsService,ActivityService,InviteService,SharingService,AuthService,AlertService,ENV,IntercomService){function removeLoading(){$scope.activity&&$scope.invites&&groupsLoaded&&contactsLoaded&&(availableTags=_.sortBy(availableTags,["name"]),$scope.loading=!1)}function getValidExternalEmails(emailString){var inputEmails=_.uniq(emailString.split(/[\s,\n]+/)).slice(0,50);return _.filter(inputEmails,function(email){if(email.match(emailRegex))return email})}function validate(){return $scope.validationRun=!0,$scope.form.$valid}function loadInvites(){InviteService.getSentActivityInvites($scope.activity.id,function(response){$scope.invites=response,removeLoading()},function(errorResponse){$log.error("Failed to fetch sent invite list")})}$scope.loading=!0;var availableTags=[],groupsLoaded=!1,contactsLoaded=!1;ActivityService.getActivityPublic({id:$stateParams.activityId,isExternal:!1},function(activity){$scope.activity=activity,$scope.formData.comments=activity.inviteText,"cancelled"!==activity.status&&"closed"!==activity.status||$state.go("activities.view",{activityId:activity.id}),loadInvites(),removeLoading()},function(responseError){$state.go("pageNotFound")}),$scope.skipButton=$stateParams.skipButton,ContactService.searchContacts({page:1,limit:5e3},function(contacts){availableTags=_.concat(availableTags,_.map(contacts.results,_.partialRight(_.pick,["id","name","avatarURL"]))),$scope.formData.recipients=$stateParams.to?$stateParams.to:[],contactsLoaded=!0,removeLoading()}),ContactService.getGroups(function(groups){availableTags=_.concat(availableTags,_.map(groups,function(g){return _.assign(g,{isGroup:!0})})),groupsLoaded=!0,removeLoading()}),$scope.loadTags=function(query){return _.filter(availableTags,function(o){return o.name.toLowerCase().indexOf(query.toLowerCase())>-1})},$scope.formData={recipients:[],external:"",comments:"",serialized:function(){return{members:_.map(_.filter(this.recipients,function(r){return!r.isGroup}),"id"),groups:_.map(_.filter(this.recipients,"isGroup"),"id"),external:getValidExternalEmails(this.external),comments:this.comments}}};var emailRegex=/^[a-zA-Z0-9.!#$%&â*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/;$scope.$watchCollection("formData.recipients",function(recipients){$scope.form.$setValidity("recipientCount",recipients.length>=1)}),$scope.$watch("formData.external",function(external){$scope.invalidEmails=[];var invites=getValidExternalEmails(external);$scope.form.$setValidity("recipientCount",$scope.formData.recipients.length>=1||invites.length>=1)}),$scope.back=function(){$window.history.back()},$scope.sendInvites=function(){validate()&&($rootScope.$broadcast("showLoading"),AnalyticsService.sendGoalEvent("110 - Share Activity"),InviteService.sendActivityInvites($scope.activity.id,$scope.formData.serialized(),function(response){$scope.validationRun=!1,$scope.formData.recipients=[],$scope.formData.external="",$scope.sentInvites=response.invitesSent,AlertService.showToast("success","Your invitations have been sent.",""),response.invalidEmails.length&&($scope.invalidEmails=response.invalidEmails,$scope.formData.external=response.invalidEmails.join("\n")),loadInvites(),$rootScope.$broadcast("hideLoading")},function(errorResponse){AlertService.showToast("error","Failed to send invites.","An error occurred during sending. Please try again."),$rootScope.$broadcast("hideLoading")}))},$scope.viewProfile=function(userId){$rootScope.$broadcast("showLoading"),$state.go("contacts.public",{userId:userId})},$scope.resendAll=function(){showConfirm("Re-send all invites","Are you sure you want to re-send all invitations for "+$scope.activity.title+"?",function(){$rootScope.$broadcast("showLoading"),InviteService.reSendAllActivityInvites($scope.activity.id,{comments:$scope.formData.comments},function(){AlertService.showToast("success","All invites have been re-sent.",""),$rootScope.$broadcast("hideLoading")},function(errorResponse){$log.error("Failed to resend invite"),$rootScope.$broadcast("hideLoading")})})},$scope.resendInvite=function(inviteId){$rootScope.$broadcast("showLoading"),InviteService.reSendActivityInvite(inviteId,{comments:$scope.formData.comments},function(){$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","The invite has been re-sent.","")},function(errorResponse){$log.error("Failed to resend invite"),$rootScope.$broadcast("hideLoading")})},$scope.deleteInvite=function(inviteId){showConfirm("Delete invite","Are you sure you want to remove this invitation?",function(){InviteService.removeSentActivityInvite(inviteId),_.remove($scope.invites,function(n){return n.id===inviteId}),$scope.$apply()})},$scope.shareFacebook=function(){var slug=$scope.activity.title.toLowerCase().replace(/[^\w\s\-]/gi,"").replace(/\s+/g,"."),shareURL=ENV["public"]+"/activity/"+slug+"."+$scope.activity.series;$rootScope.$broadcast("showLoading"),SharingService.clearFBCache(shareURL,function(){$rootScope.$broadcast("hideLoading"),IntercomService.sendEvent("shared-activity",{channel:"facebook",activity_id:$scope.activity.id,url:ENV.frontend+"/activities/view/"+$scope.activity.id+"/info"}),$facebook.ui({method:"share",href:shareURL}).then(angular.noop,function(err){$log.error("Facebook share failed")})})},$scope.skip=function(){$state.go("activities.hosted")},$timeout(function(){autosize($("textarea"))},0)}),angular.module("hulahubShared").controller("SuggestActivityModalController",function($scope,data,AuthService,ActivityService){$scope.formData={activity:data.activity,location:data.location?data.location.name:null,description:null,name:AuthService.isLoggedIn?AuthService.currentUser.profile.firstName+" "+AuthService.currentUser.profile.lastName:null,email:AuthService.isLoggedIn?AuthService.currentUser.email:null},$scope.submitSuggestion=function(){ActivityService.suggestActivity($scope.formData),$scope.$close()}}),angular.module("hulahub").controller("BillingItemDetailController",function($rootScope,$scope,$log,$state,$stateParams,$location,$uibModal,PaymentService,AlertService){$scope.loading=!0,$scope.openPaymentForm="changePayment"===$location.hash(),$scope.existingCards=[],PaymentService.getBillingItem($stateParams.billingItemId,function(response){$scope.billingItem=response,$scope.loading=!1},function(response){$log.error(response),$state.go("pageNotFound")}),$scope.requestRefund=function(){$uibModal.open({templateUrl:"billing/views/partials/request-refund-form.html",controller:"RequestRefundModalController",resolve:{data:function(){return{paymentId:$scope.billingItem.id}}},keyboard:!1,backdrop:"static"}).result.then(function(value){AlertService.showToast("success","Refund request received.","Your refund request has been received, and is being processed. We will contact you with further information."),$scope.billingItem.refundable=!1})}}),angular.module("hulahub").controller("EscalateRefundModalController",function($rootScope,$scope,$log,$uibModalInstance,AuthService,RefundService,data){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.formData={email:AuthService.currentUser.email,phoneNumber:AuthService.currentUser.profile.phoneNumber,comments:""},$scope.sendRequest=function(){$scope.errorMessage=null,$scope.formErrors=null,validateForm()&&($scope.loading=!0,RefundService.escalate(data.refundId,$scope.formData,function(response){$uibModalInstance.close()},function(response){$log.error(response),response.errors?$scope.formErrors=response.errors:$scope.errorMessage="There was an error escalating the refund. Please try again.",$scope.loading=!1}))},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("hulahub").controller("PaymentSettingsController",function($rootScope,$scope,$log,$window,StripeService,PaymentService,AuthService,UserService,AlertService){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}function updateVATButton(){$scope.vatButtonLabel=loggedInUser.vatNumber?"Update":"Save"}var loggedInUser=AuthService.currentUser;$scope.loadingStripeDetails=!0,UserService.getExtraDetails(function(response){$scope.userHasPaidPublished=response.hasPaidPublishedActivities,$scope.loadingStripeDetails=!1},function(response){$log.error(response),$scope.loadingStripeDetails=!1}),$scope.connectStripe=function(){StripeService.connect("billing")},$scope.disconnectStripe=function(){showConfirm("Disconnect stripe","Are you sure you want to disconnect your stripe account? You will no longer be able to receive payments through HulaHub unless you re-connect your account in the future.",function(){$rootScope.$broadcast("showLoading"),StripeService.disconnectStripeAccount(function(response){loggedInUser.vatNumber=null,loggedInUser.vatRate=null,AuthService.save(),$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","Account disconnected.","Your stripe account has been disconnected."),$window.scrollTo(0,0)},function(response){$rootScope.$broadcast("hideLoading"),AlertService.showToast("error","An error occurred when trying to disconnect your account.","Please try again."),$window.scrollTo(0,0)})})},$scope.formData={vatNumber:loggedInUser.vatNumber,vatRate:loggedInUser.vatRate},$scope.$watchGroup(["formData.vatNumber","formData.vatRate"],function(values){var invalidValues=null==values[0]&&null==values[1]||""===values[0]&&""===values[1]||null!==values[0]&&""!==values[0]&&null!==values[1]&&""!==values[1];$scope.form.$setValidity("vatSettings",invalidValues)}),$scope.save=function(){validateForm()&&($rootScope.$broadcast("showLoading"),PaymentService.saveUserVATSettings($scope.formData,function(response){loggedInUser.vatNumber=response.vatNumber,loggedInUser.vatRate=response.vatRate,updateVATButton(),AuthService.save(),AlertService.showToast("success","Your VAT settings have been saved.",""),$scope.formData=response,$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","An error occurred when trying to save your settings.","Please try again."),$rootScope.$broadcast("hideLoading")}))},updateVATButton()}),angular.module("hulahub").controller("RefundDetailController",function($rootScope,$scope,$log,$state,$stateParams,AuthService,RefundService,$uibModal,AlertService){function fetchRefund(){$scope.loading=!0,RefundService.getSingle($stateParams.refundId,function(response){$scope.refund=response,$scope.loading=!1,$scope.isHost=$scope.refund.host.id==AuthService.currentUser.hashId},function(response){$log.error(response),$state.go("pageNotFound")})}fetchRefund(),$scope.accept=function(){$rootScope.$broadcast("showLoading"),RefundService.respond($stateParams.refundId,{action:"accept"},function(response){fetchRefund(),$rootScope.$broadcast("hideLoading")},function(response){$log.error(response),AlertService.showToast("error",response.errors,""),$rootScope.$broadcast("hideLoading")})},$scope.showOfferForm=function(){$uibModal.open({templateUrl:"billing/views/partials/partial-refund-form.html",controller:"PartialRefundModalController",resolve:{data:function(){return{refundId:$scope.refund.id,maxAmount:$scope.refund.total,isHost:$scope.isHost}}},keyboard:!1,backdrop:"static"}).result.then(function(value){fetchRefund()})},$scope.showDeclineForm=function(){$uibModal.open({templateUrl:"billing/views/partials/decline-refund-form.html",controller:"DeclineRefundModalController",resolve:{data:function(){return{refundId:$scope.refund.id}}},keyboard:!1,backdrop:"static"}).result.then(function(value){fetchRefund()})},$scope.showEscalationForm=function(){$uibModal.open({templateUrl:"billing/views/partials/refund-escalation-form.html",controller:"EscalateRefundModalController",resolve:{data:function(){return{refundId:$scope.refund.id}}},keyboard:!1,backdrop:"static"}).result.then(function(value){fetchRefund()})}}),angular.module("hulahub").controller("RequestRefundModalController",function($rootScope,$scope,$log,$uibModalInstance,RefundService,data){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.formData={reason:"",additional:""},$scope.sendRequest=function(){$scope.errorMessage=null,validateForm()&&($scope.loading=!0,RefundService.requestRefund(data.paymentId,$scope.formData,function(response){$uibModalInstance.close()},function(response){$log.error(response),response.message?$scope.errorMessage="There was an error processing your request: "+response.message:response.errors?$scope.errorMessage="There was an error processing your request: "+response.errors:$scope.errorMessage="An unknown error occurred while processing your request. Please try again.",$scope.loading=!1}))},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("hulahub").controller("ResolutionCentreController",function($rootScope,$scope,$log,$state,$stateParams,RefundService){$scope.loading=!0,RefundService.getAll(function(response){$scope.allRefunds=response,$scope.loading=!1},function(response){$log.error(response),$scope.loading=!1})}),angular.module("hulahub").controller("SubscriptionPlansController",function($scope,$rootScope,$uibModal,$log,AuthService,UserService,PaymentService,AlertService){function getPaymentCards(){$scope.loadingCards=!0,PaymentService.getPaymentCards().then(function(response){$scope.existingCards=response.data,$scope.existingCard=$scope.existingCards.length?$scope.existingCards[0].stripeCardId:null,originalCard=$scope.existingCard,$scope.loadingCards=!1},function(response){$log.error(response.data)})}$scope.scrollToOtherPlans=function(){scrollToElement("otherPlans")};var originalCard=null;$scope.existingCard=null,$scope.existingCards=[],getPaymentCards(),$scope.loadingSubscriptionInfo=!0,UserService.getSubscriptionSettings(function(subscription){$scope.subscription=subscription,$scope.loadingSubscriptionInfo=!1},function(response){$log.error(response.data)}),$scope.saveCard=function(newCardDetails){$rootScope.$broadcast("showLoading"),PaymentService.createPaymentToken(newCardDetails.card,function(response){UserService.updateSubscriptionSettings({token:response.id,newCard:{id:response.card.id,last4:response.card.last4,brand:response.card.brand,expiryMonth:response.card.exp_month,expiryYear:response.card.exp_year},autoRenew:$scope.subscription.autoRenew},function(){AlertService.showToast("success","Subscription changes have been saved",""),getPaymentCards(),newCardDetails.clear(),$rootScope.$broadcast("hideLoading")},function(response){$rootScope.$broadcast("hideLoading"),$log.error(response.data)})},function(response){$rootScope.$broadcast("hideLoading"),$log.error(response.data)})},$scope.changeAutoRenew=function(){UserService.updateSubscriptionSettings({autoRenew:$scope.subscription.autoRenew},angular.noop,function(response){$log.error(response.data)})},$scope.changePaymentcard=function(){null!==$scope.existingCard&&$scope.existingCard!==originalCard&&($rootScope.$broadcast("showLoading"),UserService.updateSubscriptionSettings({existingCard:$scope.existingCard},function(response){AlertService.showToast("success","Subscription changes have been saved",""),$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","An error occurred trying to update your card.","Please try again."),$rootScope.$broadcast("hideLoading"),$log.error(response.data)}))},$scope.cancelNewCard=function(){$scope.existingCard=originalCard},$scope.showPlan=function($event){openAccordionSection($($event.currentTarget).parent(),!0)},$scope.showContactForm=function(){$uibModal.open({templateUrl:"core/partials/enterprise-contact-form.html",controller:"EnterpriseContactController"})},$scope.showPromoCodePopup=function(){showHintPopup("How a promotional code works",'<p>Promotional codes give you a discount or credit towards HulaHub subscriptions.</p><p>For example, if you successfully applied a code that gives you &pound;20 discount and your next monthly subscription amount due is &pound;15 no payment will be taken from your card and the &pound;5 code balance will be carried over. The following payment taken will therefore be &pound;10 and all subsequent payments will be &pound;15.</p><p class="no-margins">Note: If you change your subscription any unexpired discount or credit on a coupon associated with the previous subscription will expire.</p>')},$scope.showPlanExpiryPopup=function(){showHintPopup("Subscription plan dates",'<p>The next payment due date is when you will next be charged, any promotional code balances will be used before a card payment is taken.</p><p class="no-margins">If you have cancelled your subscription, the plan expiry date is shown and any promotional code balances will be lost on the date your subscription expires.</p>')},$scope.loadingPromoCodes=!0,UserService.getPromoCodes(function(promoCodes){$scope.promoCodes=promoCodes,$scope.loadingPromoCodes=!1},function(response){$log.error(response.data)})}),angular.module("hulahub").controller("SwitchPlanController",function($scope,$rootScope,$state,$stateParams,$log,$window,$uibModal,PaymentService,UserService,AlertService){function getPaymentCards(){$scope.loadingCards=!0,PaymentService.getPaymentCards().then(function(response){$scope.existingCards=response.data,$scope.existingCard=$scope.existingCards.length?$scope.existingCards[0].stripeCardId:null,$scope.loadingCards=!1},function(response){$log.error(response.data)})}function switchPlan(data){UserService.switchSubscriptionPlan(data,function(){UserService.registerForBenefits(),AlertService.showToast("success","Switch successful.","You are now subscribed to a "+$scope.selectedPlan.title+" plan."),$state.go("billing.subscriptionPlans")},function(response){$rootScope.$broadcast("hideLoading"),
$log.error(response.data)})}var plans={personal:{title:"Personal",monthly:{cost:300,code:"PERSONAL_MONTH"},annual:{cost:2500,code:"PERSONAL_YEAR"}},professional:{title:"Professional",monthly:{cost:1200,code:"Professional_Month_Trial"},annual:{cost:1e4,code:"Professional_Year_Trial"}}};$scope.paymentOption="annual",$scope.selectedPlan=plans[$stateParams.plan],$scope.usingTrial=$stateParams.usingTrial,$scope.selectedPlan||$state.go("billing.subscriptionPlans"),$scope.existingCard=null,$scope.existingCards=[],getPaymentCards(),$scope.cancel=function(){$window.history.back()},$scope.paymentFormSubmissionHandler={},$scope.checkPaymentForm=function(){null!==$scope.existingCard?$scope.save():$scope.paymentFormSubmissionHandler.submit()},$scope.save=function(newCardDetails){$rootScope.$broadcast("showLoading"),newCardDetails?PaymentService.createPaymentToken(newCardDetails.card,function(response){switchPlan({plan:$scope.selectedPlan[$scope.paymentOption].code,promoCode:$scope.promoCode.valid?$scope.promoCode.value:null,token:response.id,newCard:{id:response.card.id,last4:response.card.last4,brand:response.card.brand,expiryMonth:response.card.exp_month,expiryYear:response.card.exp_year}})},function(response){$rootScope.$broadcast("hideLoading"),$log.error(response.data)}):switchPlan({plan:$scope.selectedPlan[$scope.paymentOption].code,promoCode:$scope.promoCode.valid?$scope.promoCode.value:null,existingCard:$scope.existingCard})},$scope.promoCode={value:null,verified:!1,valid:!1,validMessage:null},$scope.showPromoCodePopup=function(){showHintPopup("How a promotional code works",'<p>Promotional codes give you a discount or credit towards HulaHub subscriptions.</p><p>For example, if you successfully applied a code that gives you &pound;20 discount and your next monthly subscription amount due is &pound;15 no payment will be taken from your card and the &pound;5 code balance will be carried over. The following payment taken will therefore be &pound;10 and all subsequent payments will be &pound;15.</p><p class="no-margins">Note: If you change your subscription any unexpired discount or credit on a coupon associated with the previous subscription will expire.</p>')},$scope.validatePromoCode=function(){$rootScope.$broadcast("showLoading"),PaymentService.validatePromoCode($scope.promoCode.value,function(response){$scope.promoCode.verified=!0,$scope.promoCode.valid=response.valid,$scope.promoCode.validMessage=response.message,$rootScope.$broadcast("hideLoading")})},$scope.$watch("formData.promoCode.value",function(newValue){$scope.promoCode.verified=!1,$scope.promoCode.valid=!1,$scope.promoCode.validMessage=null})}),angular.module("hulahub").controller("TransactionsController",function($scope,$log,PaymentService,FormService){function getStatement(){PaymentService.getTransactions(filters,function(response){$scope.allBillingItems=response,$scope.loading=!1},function(response){$log.error(response),$scope.loading=!1})}$scope.loading=!0;var filters={startDate:moment().subtract(3,"months").format("YYYY-MM-DD"),endDate:moment().format("YYYY-MM-DD"),page:1,limit:500};getStatement(),$scope.filterTransactions={dateRange:FormService.controls().dateRange([filters.startDate,filters.endDate],!0,!1),update:function(){var v=this.dateRange.getValue("YYYY-MM-DD");filters.startDate=v[0],filters.endDate=v[1],$scope.loading=!0,getStatement()}}}),angular.module("hulahub").controller("EditBookingRequestModalController",function($scope,data,AvailabilityService){$scope.activity=data.activity,$scope.loading=!0,AvailabilityService.getAvailability($scope.activity.series,function(response){$scope.availability={datePicker:{isOpen:!1,date:null,options:{maxMode:"day",showWeeks:!1,startingDay:1,minDate:moment().add(response.leadTime,"h").toDate(),maxDate:null!==response.closingDate?moment(response.closingDate).toDate():null,dateDisabled:function(data){return null===$scope.availability.slots[$scope.availability.datePicker.getDayNumber(data.date)]}},open:function(){this.isOpen=!0},getDayNumber:function(date){if(null!==date)return 0===date.getDay()?6:date.getDay()-1}},availableTimes:function(){if(null!==this.datePicker.date){this.noAvailableTimes=!1;var allTimes=this.slots[this.datePicker.getDayNumber(this.datePicker.date)];if(this.alreadyBooked.length){var selectedDate=moment(this.datePicker.date).format("DDMMYYYY"),unavailableTimes=_.map(_.filter(this.alreadyBooked,function(row){return row.date===selectedDate}),"time");if(unavailableTimes){var timesWithBlockers=allTimes.filter(function(t){return unavailableTimes.indexOf(t.value)===-1});return 0===timesWithBlockers.length&&(this.noAvailableTimes=!0),timesWithBlockers}}return 0===allTimes.length&&(this.noAvailableTimes=!0),allTimes}},noAvailableTimes:!1,selectedTime:null,slots:response.availability,alreadyBooked:response.alreadyBooked},$scope.loading=!1},function(error){$scope.loading=!1}),$scope.submit=function(){var requestObject={date:moment($scope.availability.datePicker.date).format("YYYY-MM-DD"),time:$scope.availability.selectedTime.value,message:$scope.message};$scope.loading=!0,$scope.errorMessage=null,AvailabilityService.updateBookingRequest($scope.activity.bookingRequest.id,requestObject,function(response){$scope.$close()},function(errorResponse){$scope.errorMessage=errorResponse.data.errors,$scope.loading=!1})}}),angular.module("hulahubShared").controller("FlexibleBookingFormModalController",function($scope,$rootScope,$injector,ENV,data,AvailabilityService,StorageService){if(data.activity.series)var $state=$injector.get("$state");$scope.activity=data.activity,$scope.loadingAvailability=!0;var seriesId=data.activity.series?data.activity.series:data.activity.id;AvailabilityService.getAvailability(seriesId,function(response){var minBookingTime=moment().add(response.leadTime,"h"),minMinutes=minBookingTime.diff(minBookingTime.clone().startOf("day"),"minutes"),minTimestamp=(new Date).getTime()+60*response.leadTime*60*1e3;$scope.availability={datePicker:{date:new Date(response.firstAvailableDay),options:{maxMode:"day",showWeeks:!1,startingDay:1,minDate:minBookingTime.toDate(),maxDate:null!==response.closingDate?moment(response.closingDate).toDate():null,dateDisabled:function(data){return null===$scope.availability.slots[$scope.availability.datePicker.getDayNumber(data.date)]},customClass:function(data){if(!this.dateDisabled(data)&&data.date>new Date){var times=$scope.availability.availableTimes(data.date);if(!times.length)return"unavailable"}}},getDayNumber:function(date){if(null!==date)return 0===date.getDay()?6:date.getDay()-1}},availableTimes:function(date){var curDate=date?date:this.datePicker.date;if(null!==curDate){this.noAvailableTimes=!1;var allTimes=this.slots[this.datePicker.getDayNumber(curDate)];if(curDate<minTimestamp&&(allTimes=_.filter(allTimes,function(a){return a.value>minMinutes})),this.alreadyBooked.length){var selectedDate=moment(curDate).format("DDMMYYYY"),unavailableTimes=_.map(_.filter(this.alreadyBooked,function(row){return row.date===selectedDate}),"time");if(unavailableTimes){var timesWithBlockers=allTimes.filter(function(t){return unavailableTimes.indexOf(t.value)===-1});return 0===timesWithBlockers.length&&(this.noAvailableTimes=!0),timesWithBlockers}}return 0===allTimes.length&&(this.noAvailableTimes=!0),allTimes}},noAvailableTimes:!1,selectedTime:null,selectedSpots:data.activity.groupSizeMin,slots:response.availability,alreadyBooked:response.alreadyBooked,price:response.price,locality:response.locality},$scope.loadingAvailability=!1},function(error){$scope.loadingAvailability=!1}),$scope.joinActivity=function(){var requestObject={seriesId:data.activity.id,date:moment($scope.availability.datePicker.date).format("YYYY-MM-DD"),time:{hour:$scope.availability.selectedTime.value,display:$scope.availability.selectedTime.label},spots:$scope.availability.selectedSpots};StorageService.setCookie("flexibleBookingRequest",JSON.stringify(requestObject)),data.activity.series?($rootScope.$broadcast("showLoading"),$scope.$dismiss(),$state.go("activities.join",{seriesId:data.activity.series,activityId:data.activity.id})):window.location=ENV.frontend+"/activities/join/"+data.activity.id+"/"+data.activity.nextInstance}}),angular.module("hulahub").controller("ManageBookingRequestModalController",function($scope,data,AnalyticsService,AvailabilityService){function validateForm(){return $scope.validationRun=!0,"decline"!==$scope.response||$scope.form.$valid}$scope.response=data.response,$scope.bookingRequest=data.bookingRequest,"accept"===data.response?$scope.messagePlaceholder="You can let the joiner know where to meet, who to look for or any additional information the joiner should know before attending your activity...":$scope.messagePlaceholder="Let the joiner know why you are declining their booking request and if possible suggest other dates and times that might work for you...",$scope.formData={reason:"decline"===$scope.response?"unavailable":null,message:"",serialized:function(){return{response:$scope.response,reason:"decline"===$scope.response?this.reason:null,message:this.message}}},$scope.respond=function(){if(validateForm()){var totalCost=$scope.bookingRequest.costPerSpot*$scope.bookingRequest.spots;"accept"===$scope.response?AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Accept",totalCost):AnalyticsService.sendUserBehaviourEvent("Booking Flow - HH - Reject",totalCost),$scope.loading=!0,AvailabilityService.manageBookingRequest($scope.bookingRequest.id,$scope.formData.serialized(),function(response){$scope.formData.message=response.hostMessage,$scope.$close($scope.formData.serialized())},function(error){402===error.status&&"accept"===$scope.response?$scope.$close({response:"decline",reason:"payment",message:error.data.joinerMessage,joinerMessage:error.data.hostMessage}):$scope.loading=!1})}}}),angular.module("hulahub").controller("AddToGroupController",function($scope,$rootScope,ContactService,contact){$scope.contact=contact,$scope.contactLoading=!0,$scope.groupLoading=!0,ContactService.getGroupsForContact(contact.id,function(response){$scope.selectedGroups=response,$scope.contactLoading=!1}),ContactService.getGroups(function(response){$scope.allGroups=_.map(response,_.partialRight(_.pick,["id","name"])),$scope.groupLoading=!1}),$scope.isSelected=function(groupId){return 0!==_.filter($scope.selectedGroups,["id",groupId]).length},$scope.save=function(){$rootScope.$broadcast("showLoading"),ContactService.addContactToGroups(contact.id,{groups:_.map($scope.selectedGroups,"id")},function(){var groupString=_.map(_.sortBy($scope.selectedGroups,"name"),"name").join(", ");$scope.$close(groupString),$rootScope.$broadcast("hideLoading")})}}),angular.module("hulahub").controller("ContactGroupsController",function($scope,$rootScope,$uibModal,ContactService){function filterAvailableContacts(){$scope.availableContacts=_.reject($scope.allContacts,function(item){return _.find($scope.selectedContacts,{id:item.id})})}function changeGroup(){$scope.selectedGroup||($scope.selectedGroup=$scope.allGroups.length?$scope.allGroups[0]:null),$scope.groupLoading=!0,$scope.selectedContacts=[],filterAvailableContacts(),$scope.searchAvailableContacts="",$scope.searchSelectedContacts="",$scope.selectedGroup?ContactService.getGroup($scope.selectedGroup.id,function(response){$scope.selectedContacts=_($scope.allContacts).keyBy("id").at(response.friends).value(),filterAvailableContacts(),$scope.changesToSave=!1,originalContactsInGroup=_.clone($scope.selectedContacts),$scope.groupLoading=!1}):$scope.groupLoading=!1}$scope.loading=!0,ContactService.getGroups(function(response){$scope.allGroups=response,$scope.allGroups.length&&($scope.selectedGroup=$scope.allGroups[0]),$scope.loading=!1}),$scope.manageGroups=function(){$uibModal.open({templateUrl:"contacts/views/manage-groups.html",controller:"ManageGroupsController",keyboard:!1,resolve:{isModal:!0,groups:function(){return $scope.allGroups}}})},$scope.$on("groupModalClosing",function(event,value){$scope.allGroups=_.sortBy(value,["name"]),$scope.selectedGroup=value[0]}),$scope.availableContacts=[],$scope.selectedContacts=[];var originalContactsInGroup=[];$scope.contactLoading=!0,ContactService.searchContacts({page:1,limit:5e3},function(response){$scope.allContacts=_.map(response.results,_.partialRight(_.pick,["id","name","avatarURL"])),filterAvailableContacts(),$scope.contactLoading=!1});var revertedChange=!1;$scope.$watch("selectedGroup",function(newVal,oldVal){newVal!==oldVal&&(oldVal&&$scope.changesToSave&&!revertedChange?showConfirm("Change group","Are you sure you want to change group? You haven't saved your changes to <strong>"+oldVal.name+"</strong>?",function(){changeGroup(),$scope.$apply()},function(){$scope.selectedGroup=oldVal,revertedChange=!0,$scope.$apply()}):revertedChange?revertedChange=!1:changeGroup())}),$scope.addToGroup=function(contact){$scope.changesToSave=!0,$scope.selectedContacts.push(contact),$scope.selectedContacts=_.sortBy($scope.selectedContacts,["name"]),filterAvailableContacts()},$scope.removeFromGroup=function(contact){_.remove($scope.selectedContacts,["id",contact.id]),$scope.changesToSave=!_.isEqual(originalContactsInGroup,$scope.selectedContacts),filterAvailableContacts()},$scope.saveGroup=function(){$scope.changesToSave&&($rootScope.$broadcast("showLoading"),ContactService.editGroup($scope.selectedGroup.id,{friends:_.map($scope.selectedContacts,"id")},function(){$scope.changesToSave=!1,originalContactsInGroup=_.clone($scope.selectedContacts),$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","Changes saved","Your group has been updated.")},function(){AlertService.showToast("error","Changes not saved!","An error occurred while saving your changes. Please try again."),$rootScope.$broadcast("hideLoading")}))}}),angular.module("hulahub").controller("ContactRequestResponseController",function($scope,$state,ContactService,AlertService){var userId=$state.params.userId;ContactService.respondToContactRequest(userId,$state.params.response,function(response){"accept"===$state.params.response?AlertService.showToast("success","The contact request has been accepted.",""):AlertService.showToast("success","The contact request has been declined.",""),$state.go("contacts.public",{userId:userId})},function(response){$state.go("contacts.public",{userId:userId})})}),angular.module("hulahub").controller("ContactSearchController",function($scope,UserService,StorageService){function searchUsers(){$scope.loading=!0,UserService.searchUsers($scope.filterForm.serialized(),function(response){$scope.contacts=response.results,$scope.loading=!1,$scope.pagination.totalPages=response.totalPages},function(error){$scope.loading=!1})}$scope.pagination={currentPage:1,totalPages:1,perPage:30,nextPage:function(){this.currentPage++,searchUsers()},prevPage:function(){this.currentPage--,searchUsers()}};var storedFilter=JSON.parse(StorageService.getItem("findContacts.filter",!0));$scope.filterForm={name:storedFilter?storedFilter.name:null,location:storedFilter?storedFilter.location:null,distance:storedFilter?storedFilter.distance:10,distanceOptions:[{value:1,label:"1 mile"},{value:2,label:"2 miles"},{value:3,label:"3 miles"},{value:5,label:"5 miles"},{value:10,label:"10 miles"},{value:15,label:"15 miles"},{value:20,label:"20 miles"},{value:30,label:"30 miles"},{value:50,label:"50 miles"}],interests:storedFilter?storedFilter.interests:null,locationSearchBox:storedFilter&&storedFilter.location?storedFilter.location.name:null,serialized:function(){return{name:this.name?this.name.toLowerCase():null,latitude:this.location?this.location.latitude:null,longitude:this.location?this.location.longitude:null,distance:this.distance?this.distance:null,interests:this.interests?[this.interests.id]:[],page:$scope.pagination.currentPage,limit:$scope.pagination.perPage}},saveFilters:function(){return{name:this.name,location:this.location,distance:this.distance,interests:this.interests}},update:function(){StorageService.setItem("findContacts.filter",JSON.stringify(this.saveFilters()),!0),$scope.pagination.currentPage=1,searchUsers()}},searchUsers(),$scope.$on("contactRequestSent",function(e,user){user.hulaSent=!0}),$scope.$on("contactRequestAccepted",function(e,user){var index=_.indexOf($scope.contacts,_.find($scope.contacts,["id",user.id]));$scope.contacts.splice(index,1,user)}),$scope.$on("contactRequestDeclined",function(e,user){user.hulaSent=!1,user.hulaReceived=!1}),$scope.$on("contactRemoved",function(e,user){var index=_.indexOf($scope.contacts,_.find($scope.contacts,["id",user.id]));$scope.contacts.splice(index,1,user)})}),angular.module("hulahub").controller("InviteContactsController",function($log,$scope,$rootScope,$state,UserService,ContactService,$facebook,AnalyticsService,InviteService,IntercomService){var emailRegex=/^[a-zA-Z0-9.!#$%&â*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/;$scope.findOnFacebook=function(){$scope.facebookLoading=!0,$facebook.login().then(function(){$facebook.api("/me").then(function(response){var fbAuth=$facebook.getAuthResponse();ContactService.findFacebookFriends({id:response.id,accessToken:fbAuth.accessToken},function(response){var contactsAdded=response.friendsAdded;0===contactsAdded.length?($scope.facebookFeedback="Unfortunately, none of your Facebook friends are using HulaHub, or you are already connected to them. Post to your timeline, or invite your friends using their email address.",$scope.spreadWordButton=!0):($scope.contactsAdded=contactsAdded,$scope.facebookFeedback=!0,$scope.spreadWordButton=!0,UserService.updateGoal(),AnalyticsService.sendGoalEvent("6 - Find Contacts")),$scope.facebookLoading=!1},function(response){$scope.facebookLoading=!1,$scope.facebookFeedback="Could not find friends on Facebook."})},function(err){$scope.facebookLoading=!1})})},$scope.shareFacebook=function(){IntercomService.sendEvent("shared-hulahub",{channel:"facebook"}),$facebook.ui({method:"share",href:"https://www.hulahub.com"}).then(angular.noop,function(err){$log.error("Facebook share failed")})},$scope.inviteStep=1,$scope.inviteTextBox="";var invites=[];$scope.findContacts=function(){$scope.errorMessage=null,$scope.newContacts=null,$scope.sent=null;var inputEmails=_.uniq($scope.inviteTextBox.split(/[\s,\n]+/)).slice(0,50);invites=_.filter(inputEmails,function(email){if(email.match(emailRegex))return email}),0==invites?$scope.errorMessage="No valid email addresses have been entered":($scope.findContactsLoading=!0,ContactService.findContacts(invites,function(response){$scope.newContacts=response.friendsAdded,$scope.possibleInvites=response.possibleInvites,invites=$scope.possibleInvites,$scope.inviteTextBox=invites.join("\n"),$scope.inviteCount=invites.length,$scope.newContacts.length&&(UserService.updateGoal(),AnalyticsService.sendGoalEvent("6 - Find Contacts")),invites.length?$scope.inviteStep=2:$scope.inviteTextBox="",$scope.findContactsLoading=!1},function(response){$scope.errorMessage="There was an error sending the invites.",$scope.findContactsLoading=!1}))},$scope.inviteBackStep=function(){$scope.inviteStep--,$scope.newContacts=null,$scope.invalidEmails=null},$scope.sendInvites=function(){invites&&($scope.findContactsLoading=!0,InviteService.sendContactInvites(invites,function(response){UserService.updateGoal(),AnalyticsService.sendGoalEvent("6 - Find Contacts"),$scope.sent=response.invitesSent,$scope.inviteStep=1;var invalid=response.invalidEmails;invalid.length?($scope.invalidEmails=invalid,$scope.inviteTextBox=invalid.join("\n")):$scope.inviteTextBox="",$scope.newContacts=null,$scope.findContactsLoading=!1},function(response){$rootScope.$broadcast("hideLoading"),$scope.inviteFeedback="Failed to send the invites. Try again."}))}}),angular.module("hulahub").controller("ManageGroupsController",function($scope,$rootScope,$timeout,ContactService,groups,isModal){function validate(){return $scope.validationRun=!0,$scope.newGroupForm.$valid}$scope.isModal=isModal,groups?$scope.allGroups=groups:($scope.loading=!0,ContactService.getGroups(function(response){$scope.allGroups=response,$scope.loading=!1})),$scope.createGroup=function(){validate()&&($rootScope.$broadcast("showLoading"),ContactService.createGroup($scope.newGroupName,function(response){$rootScope.$broadcast("hideLoading"),$scope.validationRun=!1,$scope.newGroupName=null,$scope.allGroups.unshift(response)}))},$scope.setEditing=function(group,state){state?(group.originalName=group.name,group.editing=!0,$timeout(function(){$("#group_"+group.id).focus()},0)):(group.name=group.originalName,group.editing=!1)},$scope.renameGroup=function(group){group.editing=!1,ContactService.editGroup(group.id,{name:group.name},angular.noop)},$scope.removeGroup=function(group){if(isModal){var currentModal=$(".modal");currentModal.hide()}showConfirm("Delete group","Are you sure you want to remove your group <strong>"+group.name+"</strong>? You will not lose your contacts in the group.",function(){isModal&&currentModal.show(),_.remove($scope.allGroups,["id",group.id]),ContactService.removeGroup(group.id,angular.noop)},function(){isModal&&currentModal.show()})},$scope.$on("modal.closing",function(){$rootScope.$broadcast("groupModalClosing",$scope.allGroups)})}),angular.module("hulahub").controller("MyContactsController",function($scope,$rootScope,$log,$facebook,ContactService,StorageService,IntercomService){function searchUsers(){$scope.loading=!0,ContactService.searchContacts($scope.filterForm.serialized(),function(response){$scope.contacts=response.results,$scope.loading=!1,$scope.pagination.totalPages=response.totalPages},function(error){$scope.loading=!1})}$scope.shareFacebook=function(){IntercomService.sendEvent("shared-hulahub",{channel:"facebook"}),$facebook.ui({method:"share",href:"https://www.hulahub.com"}).then(angular.noop,function(err){$log.error("Facebook share failed")})},$scope.pagination={currentPage:1,totalPages:1,perPage:30,nextPage:function(){this.currentPage++,searchUsers()},prevPage:function(){this.currentPage--,searchUsers()}};var storedFilter=JSON.parse(StorageService.getItem("myContacts.filter",!0));$scope.filterForm={name:storedFilter?storedFilter.name:null,location:storedFilter?storedFilter.location:null,interests:storedFilter?storedFilter.interests:null,locationSearchBox:storedFilter&&storedFilter.location?storedFilter.location.name:null,group:storedFilter&&storedFilter.group?storedFilter.group:null,serialized:function(){return{name:this.name?this.name.toLowerCase():null,latitude:this.location?this.location.latitude:null,longitude:this.location?this.location.longitude:null,interests:this.interests?[this.interests.id]:[],group:this.group,page:$scope.pagination.currentPage,limit:$scope.pagination.perPage}},saveFilters:function(){return{name:this.name,location:this.location,interests:this.interests,group:this.group}},update:function(){StorageService.setItem("myContacts.filter",JSON.stringify(this.saveFilters()),!0),$scope.hasSearched=!0,$scope.pagination.currentPage=1,searchUsers()}},ContactService.getGroups(function(response){$scope.filterForm.allGroups=_.map(response,_.partialRight(_.pick,["id","name"]))}),searchUsers(),$scope.$on("contactRemoved",function(e,user){var index=_.indexOf($scope.contacts,_.find($scope.contacts,["id",user.id]));$scope.contacts.splice(index,1)})}),angular.module("hulahub").controller("MyInvitesController",function($log,$scope,$rootScope,$state,InviteService){$scope.busy=!0,InviteService.getSentContactInvites(function(response){$scope.busy=!1,$scope.invites=response},function(errorResponse){$log.error("Failed to fetch invite list")}),$scope.viewProfile=function(userId){$state.go("contacts.public",{userId:userId})}}),angular.module("hulahub").controller("PublicProfileController",function($scope,$rootScope,$state,$log,$uibModal,$location,$timeout,ContactService,ENV,appSettings,UserService,TrackingService,MessageService,AlertService,user){function addMarker(markerData){var position={lat:markerData.latitude,lng:markerData.longitude};interestMarkers.push({marker:new google.maps.Marker({map:interestMap,position:position,name:markerData.name,icon:new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40))}),circle:new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:interestMap,center:position,radius:markerData.distance*appSettings.distanceMultiplier})})}if(404===user.status)return!1;$scope.theme="contacts",$scope.user=user,$scope.viewingSelf=!1,user.isHostAccount&&TrackingService.trackProfilePageView(user.id),user.personalStatement||user.personalStatement||user.gender&&"u"!==user.gender||user.dateOfBirth?$scope.activeTab="about":user.homeHub?$scope.activeTab="locations":user.specialisms&&user.specialisms.length?$scope.activeTab="specialisms":user.interests&&user.interests.length&&($scope.activeTab="interests"),$location.hash()&&($scope.activeTab=$location.hash(),scrollToElement("profileTabs")),$scope.goToReviews=function(){scrollToElement("reviews")},$scope.shareProfile=function(){$uibModal.open({templateUrl:"core/partials/share-modal.html",controller:"ShareModalController",resolve:{data:function(){var profileLink=ENV["public"]+"/profile/"+$scope.user.profileLink,userFullName=$scope.user.firstName+" "+$scope.user.lastName;return{id:$scope.user.id,idName:"profile_id",title:"Share "+$scope.user.firstName+"'s profile",url:profileLink,text:{twitter:"Check out "+userFullName+" and their activities @HulaHubHQ!",email:{subject:"Check out "+userFullName+" and their activities @HulaHubHQ",body:"Find out more about them, read their reviews and see their activities!\n\n"+profileLink+"\n\nMaybe I'll see you at one of their activities soon!"}},intercomEventName:"shared-profile"}}}})};var mapOptions={maxZoom:15,draggable:$(window).width()>=768,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles},locationMap=null,locationMarkers=[];$scope.drawLocationMap=function(){locationMap||$scope.user.homeHub&&$timeout(function(){var element=document.getElementById("locationMap");if(null!==element){var position={lat:$scope.user.homeHub.latitude,lng:$scope.user.homeHub.longitude};locationMap=new google.maps.Map(element,{zoom:13,center:position,options:mapOptions}),locationMarkers.push({marker:new google.maps.Marker({map:locationMap,position:position,icon:new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40))}),circle:new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:locationMap,center:position,radius:$scope.user.homeHub.distance*appSettings.distanceMultiplier})});var bounds=new google.maps.LatLngBounds;bounds.union(locationMarkers[0].circle.getBounds()),locationMap.fitBounds(bounds)}},0)};var interestMap=null,interestMarkers=[];$scope.drawInterestMap=function(){interestMap||$timeout(function(){var element=document.getElementById("interestMap");if(null!==element){interestMap=new google.maps.Map(element,{zoom:13,center:{lat:0,lng:0},options:mapOptions});for(var allHubs=_.uniqBy(_.flatMap(user.interests,"hubs"),"id"),i=0;i<=allHubs.length-1;i++)addMarker(allHubs[i]);interestMarkers.length&&$timeout(function(){for(var bounds=new google.maps.LatLngBounds,i=0;i<interestMarkers.length;i++)bounds.union(interestMarkers[i].circle.getBounds());interestMap.fitBounds(bounds)},100)}},0)},$scope.trackContact=function(){$scope.user.isHostAccount&&TrackingService.trackHostContact($scope.user.id)},$scope.sendContactRequest=function(){$scope.user.hulaSent=!0,ContactService.sendContactRequest($scope.user.id,function(response){$log.error("Error sending hula:"+response),$rootScope.$broadcast("hideLoading")})},$scope.acceptContactRequest=function(){$rootScope.$broadcast("showLoading"),ContactService.respondToContactRequest($scope.user.id,"accept",function(response){$rootScope.$broadcast("hideLoading"),$scope.user=response.data},function(response){$log.error("Error accepting hula:"+response),$rootScope.$broadcast("hideLoading")})},$scope.declineContactRequest=function(){$scope.user.hulaSent=!1,$scope.user.hulaReceived=!1,ContactService.respondToContactRequest($scope.user.id,"decline",angular.noop,function(response){$log.error("Error declining hula:"+response),$rootScope.$broadcast("hideLoading")})},$scope.removeContact=function(){showConfirm("Remove contact","Are you sure you want to remove "+$scope.user.firstName+"?",function(){$rootScope.$broadcast("showLoading"),ContactService.removeContact($scope.user.id,function(response){$state.reload()},function(response){$log.error("Error removing contact:"+response),$rootScope.$broadcast("hideLoading")})})},$scope.addToGroup=function(){$uibModal.open({templateUrl:"contacts/views/add-to-group.html",controller:"AddToGroupController",keyboard:!1,resolve:{contact:$scope.user}})},$scope.revealPhone=function(){$scope.user.hasPhoneNumber&&($scope.trackContact(),$rootScope.$broadcast("showLoading"),UserService.getPhoneNumber($scope.user.id,function(number){$scope.user.phone=number,$rootScope.$broadcast("hideLoading")}))},$scope.messageFormData={subject:null,message:null,serialized:function(){return{recipients:[$scope.user.id],subject:this.subject,message:this.message}},clear:function(){this.subject="",this.message=""}},$scope.sendMessage=function(messageForm){$rootScope.$broadcast("showLoading"),MessageService.send($scope.messageFormData.serialized(),function(response){AlertService.showToast("success","Message sent","Your message has been sent."),$scope.messageFormData.clear(),messageForm.$setPristine(),$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","Message not sent!","There was an error sending the message. Please try again."),$rootScope.$broadcast("hideLoading")})}}),angular.module("hulahub").controller("ContactUsController",function($scope,$rootScope,CallBackService,AlertService){$scope.formData={serialized:function(){return{subject:this.subject,message:this.message}}},$scope.send=function(){$rootScope.$broadcast("showLoading"),CallBackService.contactHulaHub($scope.formData.serialized(),function(response){console.log($scope.formData.serialized()),AlertService.showToast("success","Message sent","We will respond to your message as soon as possible."),$rootScope.$broadcast("hideLoading"),$scope.$close()},function(errorResponse){AlertService.showToast("error","Unable to send message","An error occurred while sending your message. Please try again."),$rootScope.$broadcast("hideLoading")})}}),angular.module("hulahubShared").controller("EnterpriseContactController",function($scope,CallBackService,AuthService){function validate(){return $scope.validationRun=!0,$scope.contactForm.$valid}if($scope.formData={serialized:function(){return{firstName:this.firstName,lastName:this.lastName,phoneNumber:this.phoneNumber,email:this.email,businessName:this.businessName,businessRegNumber:this.businessRegNumber,website:this.website,employees:this.employeeCount,message:this.message,userId:this.userId}},clear:function(){this.userId=null,this.firstName=null,this.lastName=null,this.phoneNumber=null,this.email=null,this.businessName=null,this.businessRegNumber=null,this.website=null,this.employeeCount=null,this.message=null}},AuthService.isLoggedIn){var currentUser=AuthService.currentUser;$scope.formData.userId=currentUser.id,$scope.formData.firstName=currentUser.profile.firstName,$scope.formData.lastName=currentUser.profile.lastName,$scope.formData.phoneNumber=currentUser.profile.phoneNumber,$scope.formData.email=currentUser.email,$scope.formData.businessName=currentUser.profile.businessName}$scope.send=function(){$scope.formErrors=null,$scope.successMessage=null,validate()&&($scope.sending=!0,CallBackService.enterpriseContact($scope.formData.serialized(),function(response){$scope.successMessage="Thank you for your interest. We have received your details and one of our team will be in contact to discuss an Enterprise membership.",$scope.formData.clear(),$scope.validationRun=!1,$scope.sending=!1},function(errorResponse){$scope.sending=!1,$scope.callBackFormErrors=errorResponse.errors;
}))}}),angular.module("hulahub").controller("PhotoUploadModalController",function($scope,$uibModalInstance,$timeout,data){function initCropper(){$scope.loading=!0,null!==cropper&&cropper.destroy(),$timeout(function(){var image=document.getElementsByClassName("imageCropping")[0];image.addEventListener("crop",function(e){$timeout(function(){$scope.deleteConfirm=!1},0)}),cropper=new Cropper(image,cropperOptions),$scope.loading=!1},500)}$scope.title=data.title,$scope.theme=data.theme,$scope.cropPreviewClass=data.cropPreviewClass;var cropperOptions={aspectRatio:data.aspectRatio,autoCropArea:1,viewMode:1,dragMode:"move",guides:!1,center:!1,cropBoxMovable:!1,cropBoxResizable:!1,toggleDragModeOnDblclick:!1},cropper=null,selectedImageType=null;$scope.change=function($files,$file){null!==$file&&(selectedImageType=$file.type,initCropper())},$scope.zoom=function(amount){cropper.zoom(amount)},$scope.rotate=function(amount){cropper.rotate(amount)},$scope.flipX=function(){var cropperData=cropper.getData();cropper.scaleX(cropperData.scaleX*-1)},$scope.flipY=function(){var cropperData=cropper.getData();cropper.scaleY(cropperData.scaleY*-1)},$scope.reset=function(){cropper.reset()},$scope.clearPicture=function(){$scope.deleteConfirm?($scope.selectedImage=null,selectedImageType=null,$scope.deleteConfirm=!1):$scope.deleteConfirm=!0},data.selectedImage&&($scope.selectedImage=data.selectedImage,initCropper()),$scope.save=function(){if($scope.deleteConfirm=!1,$scope.uploadError=null,$scope.loading=!0,$scope.selectedImage)var blob=cropper.getCroppedCanvas(data.croppedSize).toDataURL(selectedImageType);else blob="delete";data.onSave(blob,function(){$scope.$dismiss()},function(error){$scope.loading=!1,$scope.uploadError="An error occurred during saving. Please try again."})}}),angular.module("hulahubShared").controller("ShareModalController",function($scope,$rootScope,$log,$facebook,IntercomService,data){$scope.id=data.id,$scope.title=data.title,$scope.url=data.url,$scope.twitterText=data.text.twitter,$scope.emailSubject=data.text.email.subject,$scope.emailBody=data.text.email.body;var intercomEventName=data.intercomEventName,idName=data.idName;$scope.onClipboardSuccess=function(){$scope.linkCopiedToClipboard=!0},$scope.shareFacebook=function(){$scope.sendIntercomShareEvent("facebook"),$rootScope.$broadcast("showLoading"),$facebook.ui({method:"share",href:$scope.url}).then(function(){$rootScope.$broadcast("hideLoading")},function(err){$rootScope.$broadcast("hideLoading")})},$scope.sendIntercomShareEvent=function(channel){var obj={channel:channel,url:$scope.url};obj[idName]=$scope.id,IntercomService.sendEvent(intercomEventName,obj)}}),angular.module("hulahub").controller("HeaderController",function($scope,$rootScope,$state,$stateParams,$log,$window,AuthService,ENV,ParameterService,UserService){function updateTitleAndSubNavigation(){$scope.subNav=$state.current.data.subNav,$scope.subNavExtraClass=$state.current.data.subNavExtraClass,$scope.title=$state.current.data.title}if(AuthService.currentUser)$scope.registrationType=AuthService.currentUser.registrationType;else{var paramUser=ParameterService.getUser();$scope.registrationType=paramUser.hostOrJoiner}updateTitleAndSubNavigation(),$scope.$on("updateHeader",function(){$scope.subNavHighlight=null,updateTitleAndSubNavigation()}),$scope.logoClicked=function(){AuthService.isLoggedIn?"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find"):"host"===$scope.registrationType?$scope.hostLanding():redirectToPage(ENV)},$scope.hostLanding=function(){redirectToPage(ENV,"/host")},$("#showOffCanvasNav").on("touchstart click",function(e){e.stopPropagation(),e.preventDefault();var nav=$(".offCanvasNav");if(nav.is(".open"))closeOffCanvasNav(nav);else{var blackout=$('<div id="navBlackout"></div>');blackout.hide().bind("touchstart click",function(){closeOffCanvasNav(nav)}),$("body").append(blackout),blackout.fadeIn(),nav.stop().animate({right:0},"fast").addClass("open")}}),$scope.goToBenefits=function(){if($rootScope.$broadcast("showLoading"),"FREE"!==AuthService.currentUser.subscriptionPlan){var popup=$window.open("","_blank");popup.document.write("Please wait a moment whilst we load your HulaHub benefits..."),UserService.getBenefitsID(function(response){popup.location.href=ENV.premiumBenefitsURL+"?userid="+response.id,$rootScope.$broadcast("hideLoading")},function(error){$log.error("Failed to get benefits ID for user"),$rootScope.$broadcast("hideLoading")})}}}),angular.module("hulahub").controller("NavigationController",function($scope,$rootScope,$state,$window,$log,ENV,AuthService,UserService){function updateHighlightedNavItem(currentState){var parentState=currentState.name.substring(0,currentState.name.indexOf("."));$scope.nav={account:"account"===parentState,activities:"activities"===parentState,contacts:"contacts"===parentState,messages:"messages"===parentState,help:"help"===parentState}}updateHighlightedNavItem($state.current),$scope.$watch("$state.current",function(newValue,oldValue){newValue!==oldValue&&updateHighlightedNavItem(newValue)}),$(".heading",$(".navmenu-fixed-left .navGroup")).on("touchstart click",function(e){e.stopPropagation(),e.preventDefault();var content=$(this).next(".content");$(".tempActive").removeClass("tempActive"),content.is(".open")?content.slideUp(function(){$(this).removeClass("open").addClass("closed")}):($(this).addClass("tempActive"),$(".content.open").slideUp(function(){$(this).removeClass("open").addClass("closed")}),content.slideDown(function(){$(this).addClass("open").removeClass("closed")}))}),$scope.goToBenefits=function(){if($rootScope.$broadcast("showLoading"),"FREE"!==AuthService.currentUser.subscriptionPlan){var popup=$window.open("","_blank");popup.document.write("Please wait a moment whilst we load your HulaHub benefits..."),UserService.getBenefitsID(function(response){popup.location.href=ENV.premiumBenefitsURL+"?userid="+response.id,$rootScope.$broadcast("hideLoading")},function(error){$log.error("Failed to get benefits ID for user"),$rootScope.$broadcast("hideLoading")})}}}),angular.module("hulahub").controller("DashboardController",function($scope,$rootScope,$window,$uibModal,AlertService,AuthService,UserService,ENV,dashboardData){$scope.data=dashboardData,AuthService.currentUser.emailVerified?AuthService.currentUser.stripeAccountConnected?0===dashboardData.specialismCount?$scope.hintToShow="specialisms":0===dashboardData.ratings.totalCount&&($scope.hintToShow="reviews"):$scope.hintToShow="connect_stripe":$scope.hintToShow="email_verification",$scope.goToBenefits=function(){if($rootScope.$broadcast("showLoading"),"FREE"!==AuthService.currentUser.subscriptionPlan){var popup=$window.open("","_blank");popup.document.write("Please wait a moment whilst we load your HulaHub benefits..."),UserService.getBenefitsID(function(response){popup.location.href=ENV.premiumBenefitsURL+"?userid="+response.id,$rootScope.$broadcast("hideLoading")},function(error){AlertService.showToast("error","Error","There was an error retrieving your benefits. Please try again."),$rootScope.$broadcast("hideLoading")})}},$scope.resendVerificationEmail=function(){UserService.resendConfirmationEmail(AuthService.currentUser.email),AlertService.showToast("success","Verification email re-sent","You should receive the verification email shortly.")},$scope.contactHulaHub=function(){$uibModal.open({templateUrl:"core/partials/contact-hulahub-form.html",controller:"ContactUsController",keyboard:!1,backdrop:"static"})}}),angular.module("hulahub").controller("MarketingToolsController",function($scope,AlertService,DashboardService){$scope.tooltips={reach:"Reach represents how many unique Personal intros have been sent to HulaHub members.",queue:"Queue shows the number of HulaHub members that are still awaiting your Personal Intro email.",opens:"Opens show the percentage of HulaHub members that opened your Personal Intro email.",engagement:"This is the percentage of HulaHub members that have engaged with your Personal Intro email after opening it by either replying to it, clicking the 'View profile button or going to one of your activities.",contacts:"Contacts show the number of HulaHub members that got in touch with you after receiving your Personal Intro email by either sending you a message, revealing your phone number, clicking one of the social links on your profile page or booking one of your activities.",bookings:"This is the total number of spots that were booked after seeing your Personal Intro email."},$scope.loading=!0,DashboardService.getHostStats(function(response){$scope.stats=response,$scope.loading=!1},function(errorResponse){AlertService.showToast("error","Error","There was an error retrieving your stats. Please try again."),$scope.loading=!1})}),angular.module("hulahub").controller("ErrorController",function($scope){$scope.pageTitle="404: Page not found"}),angular.module("hulahub").controller("AddInterestModalController",function($scope,$log,AuthService,UserService,AnalyticsService,FormService,InterestService,data){function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.savedHomeHub=AuthService.currentUser.homeHub;var defaultHubs=[];null!==data.location&&defaultHubs.push(data.location),$scope.formData={interest:data.interest?data.interest:null,useHomeHub:!!$scope.savedHomeHub,hubs:defaultHubs,difficultyLevel:FormService.controls().difficultyLevel(1,!0,!1),serialized:function(){return{interest:this.interest.id,useHomeHub:this.useHomeHub,hubs:_.map(this.hubs,function(m){return{latitude:m.latitude,longitude:m.longitude,name:m.locality}}),difficultyLevel:this.difficultyLevel.getValue()}}},$scope.$watch("newLocation",function(loc){loc&&loc.name&&($scope.formData.hubs.push({name:loc.name,locality:angular.isDefined(loc.locality)?loc.locality:loc.name,latitude:loc.latitude,longitude:loc.longitude}),$scope.newLocation=null)}),$scope.$watch("formData.interest",function(interest){$scope.form.$setValidity("interest",null!==interest&&void 0!==interest)}),$scope.$watch("[formData.useHomeHub, formData.hubs]",function(data){$scope.form.$setValidity("hubs",data[0]||data[1].length>0)},!0),$scope.removeLocation=function(location){var index=_.findIndex($scope.formData.hubs,function(h){return h===location});index!==-1&&$scope.formData.hubs.splice(index,1)},$scope.save=function(){validate()&&($scope.loading=!0,InterestService.save($scope.formData.serialized(),function(response){UserService.updateGoal(),AnalyticsService.sendGoalEvent("4 - Choose Interests"),AuthService.currentUser.interestCount++,AuthService.save(),$scope.$close(response)},function(response){$log.error(response.data),$scope.loading=!1}))}}),angular.module("hulahub").controller("EditInterestController",function($scope,$rootScope,$state,$log,appSettings,FormService,AuthService,InterestService,AlertService,interest){function addMarker(markerData){var position={lat:markerData.latitude,lng:markerData.longitude},circle=new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:$scope.map,center:position,radius:markerData.distance*appSettings.distanceMultiplier});$scope.markers.push({isHome:markerData.isHome,marker:new google.maps.Marker({map:$scope.map,position:position,name:markerData.name,locality:angular.isDefined(markerData.locality)?markerData.locality:markerData.name,icon:markerImage}),distance:{value:FormService.controls().distanceWithMaxLimit(markerData.distance,!0),events:{update:function(values){circle.setRadius(parseInt(values)*appSettings.distanceMultiplier)},change:function(values){fitBounds()}},circle:circle}}),fitBounds()}function removeMarker(index){$scope.markers[index].marker.setMap(null),$scope.markers[index].distance.circle.setMap(null),$scope.markers.splice(index,1),fitBounds()}function fitBounds(){if($scope.markers.length){for(var bounds=new google.maps.LatLngBounds,i=0;i<$scope.markers.length;i++)bounds.union($scope.markers[i].distance.circle.getBounds());$scope.map.fitBounds(bounds)}}function validate(){return $scope.validationRun=!0,$scope.form.$valid}interest=interest.data,$scope.savedHomeHub=AuthService.currentUser.homeHub,$scope.interestName=interest.interest.name,$scope.map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:$scope.savedHomeHub?{lat:$scope.savedHomeHub.latitude,lng:$scope.savedHomeHub.longitude}:{lat:appSettings.defaultLocation.latitude,lng:appSettings.defaultLocation.longitude},options:{maxZoom:15,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles}}),$scope.markers=[];var markerImage=new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40));interest.useHomeHub&&addMarker($scope.savedHomeHub);for(var i=0;i<=interest.hubs.length-1;i++)addMarker(interest.hubs[i]);$scope.formData={interest:interest.interest,useHomeHub:interest.useHomeHub,difficultyLevel:FormService.controls().difficultyLevel(interest.difficultyLevel,!0,!1),serialized:function(){return{interest:null!==this.interest&&void 0!==this.interest?this.interest.id:null,useHomeHub:this.useHomeHub,hubs:_.map(_.filter($scope.markers,["isHome",!1]),function(m){var pos=m.marker.getPosition();return{latitude:pos.lat(),longitude:pos.lng(),distance:m.distance.value.getValue(),name:m.marker.locality}}),difficultyLevel:this.difficultyLevel.getValue()}}},$scope.originalData=JSON.stringify($scope.formData.serialized()),$scope.$watch("newLocation",function(loc){loc&&loc.name&&(loc.isHome=!1,addMarker(loc),$scope.locationSearchBox="",$scope.newLocation=null)}),$scope.removeLocation=function(marker){var index=_.findIndex($scope.markers,function(m){return m===marker});index!==-1&&removeMarker(index)},$scope.$watch("formData.useHomeHub",function(newValue,oldValue){if(newValue!==oldValue)if(newValue)addMarker($scope.savedHomeHub);else{var index=_.findIndex($scope.markers,function(m){return m.isHome===!0});index!==-1&&removeMarker(index)}}),$scope.cancel=function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$state.go("profile",{"#":"interests"}):showConfirm("Cancel","Are you sure you want to cancel? You will lose any changes you have made.",function(){$state.go("profile",{"#":"interests"})})},$scope.save=function(){validate()&&($rootScope.$broadcast("showLoading"),InterestService.update(interest.id,$scope.formData.serialized(),function(response){$state.go("profile",{"#":"interests"})},function(response){AlertService.showToast("error","Failed to update interest.",""),$log.error(response.data),$rootScope.$broadcast("hideLoading")}))},$scope.$watch("formData.interest",function(interest){$scope.form.$setValidity("interest",null!==interest&&void 0!==interest)}),$scope.$watchCollection("markers",function(markers){$scope.form.$setValidity("hubs",markers.length>=1)})}),angular.module("hulahub").controller("NewInterestController",function($scope,$rootScope,$state,$log,appSettings,FormService,UserService,AuthService,InterestService,AnalyticsService,AlertService){function addMarker(markerData){var position={lat:markerData.latitude,lng:markerData.longitude},circle=new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:$scope.map,center:position,radius:markerData.distance*appSettings.distanceMultiplier});$scope.markers.push({isHome:markerData.isHome,marker:new google.maps.Marker({map:$scope.map,position:position,name:markerData.name,locality:angular.isDefined(markerData.locality)?markerData.locality:markerData.name,icon:markerImage}),distance:{value:FormService.controls().distanceWithMaxLimit(markerData.distance,!0),events:{update:function(values){circle.setRadius(parseInt(values)*appSettings.distanceMultiplier)},change:function(values){fitBounds()}},circle:circle}}),fitBounds()}function removeMarker(index){$scope.markers[index].marker.setMap(null),$scope.markers[index].distance.circle.setMap(null),$scope.markers.splice(index,1),fitBounds()}function fitBounds(){if($scope.markers.length){for(var bounds=new google.maps.LatLngBounds,i=0;i<$scope.markers.length;i++)bounds.union($scope.markers[i].distance.circle.getBounds());$scope.map.fitBounds(bounds)}}function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.savedHomeHub=AuthService.currentUser.homeHub,$scope.map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:$scope.savedHomeHub?{lat:$scope.savedHomeHub.latitude,lng:$scope.savedHomeHub.longitude}:{lat:appSettings.defaultLocation.latitude,lng:appSettings.defaultLocation.longitude},options:{maxZoom:15,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles}}),$scope.markers=[];var markerImage=new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40));$scope.savedHomeHub&&addMarker($scope.savedHomeHub),$scope.$watch("newLocation",function(loc){loc&&loc.name&&(loc.isHome=!1,addMarker(loc),$scope.locationSearchBox="",$scope.newLocation=null)}),$scope.removeLocation=function(marker){var index=_.findIndex($scope.markers,function(m){return m===marker});index!==-1&&removeMarker(index)},$scope.$watch("formData.useHomeHub",function(newValue,oldValue){if(newValue!==oldValue)if(newValue)addMarker($scope.savedHomeHub);else{var index=_.findIndex($scope.markers,function(m){return m.isHome===!0});index!==-1&&removeMarker(index)}}),$scope.formData={interest:null,useHomeHub:!!$scope.savedHomeHub,difficultyLevel:FormService.controls().difficultyLevel(1,!0,!1),serialized:function(){return{interest:null!==this.interest&&void 0!==this.interest?this.interest.id:null,useHomeHub:this.useHomeHub,hubs:_.map(_.filter($scope.markers,["isHome",!1]),function(m){var pos=m.marker.getPosition();return{latitude:pos.lat(),longitude:pos.lng(),distance:m.distance.value.getValue(),name:m.marker.locality}}),difficultyLevel:this.difficultyLevel.getValue()}}},$scope.originalData=JSON.stringify($scope.formData.serialized()),$scope.cancel=function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$state.go("profile",{"#":"interests"}):showConfirm("Cancel","Are you sure you want to cancel? You will lose any changes you have made.",function(){$state.go("profile",{"#":"interests"})})},$scope.save=function(){validate()&&($rootScope.$broadcast("showLoading"),InterestService.save($scope.formData.serialized(),function(response){UserService.updateGoal(),AnalyticsService.sendGoalEvent("4 - Choose Interests"),AuthService.currentUser.interestCount++,AuthService.save(),$state.go("profile",{"#":"interests"})},function(response){AlertService.showToast("error","Failed to save interest.",""),$log.error(response.data),$rootScope.$broadcast("hideLoading")}))},$scope.$watch("formData.interest",function(interest){$scope.form.$setValidity("interest",null!==interest&&void 0!==interest)}),$scope.$watchCollection("markers",function(markers,oldValue){$scope.form.$setValidity("hubs",markers.length>=1)})}),angular.module("hulahub").controller("MessageListController",function($scope,$rootScope,$state,$log,$uibModal,MessageService,FormService){function searchMessages(){$scope.loading=!0,MessageService.getMessages($scope.filterForm.serialized(),function(response){$scope.messages=response.results,$scope.pagination.totalPages=response.totalPages,$scope.loading=!1},function(error){$log.error("failed to load "+$scope.folder),$scope.loading=!1})}$scope.newMessage=function(){$uibModal.open({templateUrl:"messages/views/new-message-modal.html",controller:"NewMessageModalController",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["tagInput"])},data:function(){return{to:null,subject:null}}}})},$scope.folder=$state.current.data.folder,$scope.pagination={currentPage:1,totalPages:1,perPage:25,nextPage:function(){this.currentPage++,searchMessages()},prevPage:function(){this.currentPage--,searchMessages()}},$scope.filterForm={dateRange:FormService.controls().dateRange([null,null],!0,!1),folder:$scope.folder,category:"all",categories:[{id:"all",label:"All"},{id:"friends",label:"My contacts"},{id:"activities",label:"My activities"},{id:"hulahub",label:"HulaHub"}],serialized:function(){var v=this.dateRange.getValue("YYYY-MM-DD");return{from:v[0],to:v[1],folder:this.folder,category:this.category,page:$scope.pagination.currentPage,limit:$scope.pagination.perPage}},update:function(){$scope.pagination.currentPage=1,searchMessages()}},searchMessages(),$scope.loadMessage=function(message,readOnly){readOnly=readOnly||!1,$rootScope.$broadcast("showLoading"),$state.go("messages.view",{folder:$scope.folder,message:message,filter:$scope.filterForm.category,readOnly:readOnly,messageId:message.id})}}),angular.module("hulahub").controller("MessageViewController",function($scope,$rootScope,$state,$stateParams,$timeout,$log,MessageService,ContactService,AlertService,message){function validate(){return $timeout(function(){$scope.validationRun=!0},0),$scope.form.$valid}$scope.message=message,$scope.folder=$scope.message.folder?$scope.message.folder:$scope.message.deleted?"trash":"inbox",$scope.readOnly="sent"===$scope.folder,$scope.readOnly||$scope.message.read||("inbox"===$scope.folder&&$rootScope.unreadMessageCount>0&&$rootScope.unreadMessageCount--,MessageService.markAsRead($scope.message.id)),$scope.message.message=$scope.message.message.replace(/<br\s*[\/]?>--/g,"<br /><br />--"),$scope.loadReplyForm=function(){if($scope.readOnly||"friend_message"!==$scope.message.type&&"activity_match"!==$scope.message.type)return!1;"activity_match"!==$scope.message.type||$scope.message.engaged||(MessageService.trackEngagementFromMessage($scope.message.id),$scope.message.engaged=!0);var messageHTML=$($scope.message.message);$(".hideInApp",messageHTML).remove();var strippedHTML=messageHTML.html().replace(/<[^>]+>/g,"").replace(/<br\s*[\/]?>/g,"\n"),replyMessage="\n\n--\nOn "+$scope.message.date+", "+$scope.message.from+" wrote:\n\n"+strippedHTML;$scope.formData={message:replyMessage,serialized:function(){return{message:this.message}}},$scope.showReplyForm=!0,$timeout(function(){setCaretToPos($("#replyMessage")[0],0),$("#replyMessage").scrollTop(0),scrollToElement("replyForm")},0)},"true"===$stateParams.reply&&$scope.loadReplyForm(),$scope.hideReplyForm=function(){$scope.formData=null,$scope.showReplyForm=!1,scrollToTop()},$scope.sendReply=function(){validate()&&($rootScope.$broadcast("showLoading"),MessageService.reply($scope.message.id,$scope.formData.serialized(),function(response){AlertService.showToast("success","Your message has been sent.",""),$state.go("messages.inbox"),$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","Failed to send the message.",""),$log.error(response.data.errors),$rootScope.$broadcast("hideLoading")}))},$scope["delete"]=function(){$scope.readOnly||($scope.message.deleted=!0,MessageService["delete"]($scope.message.id,angular.noop))},$scope.undelete=function(){$scope.readOnly||($scope.message.deleted=!1,MessageService.undelete($scope.message.id,angular.noop))},$scope.back=function(){$state.go("messages."+$scope.folder)}}),angular.module("hulahub").controller("NewMessageModalController",function($scope,$stateParams,$log,ContactService,MessageService,AlertService,data){function removeLoading(){groupsLoaded&&contactsLoaded&&(availableTags=_.sortBy(availableTags,["name"]),$scope.loading=!1)}function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.loading=!0;var availableTags=[],groupsLoaded=!1,contactsLoaded=!1;ContactService.searchContacts({page:1,limit:5e3},function(contacts){availableTags=_.concat(availableTags,_.map(contacts.results,_.partialRight(_.pick,["id","name","avatarURL"]))),contactsLoaded=!0,removeLoading()}),ContactService.getGroups(function(groups){availableTags=_.concat(availableTags,_.map(groups,function(g){return _.assign(g,{isGroup:!0})})),groupsLoaded=!0,removeLoading()}),$scope.loadTags=function(query){return _.filter(availableTags,function(o){return o.name.toLowerCase().indexOf(query.toLowerCase())>-1})},$scope.formData={recipients:data.to||[],subject:data.subject||"",message:"",serialized:function(){return{recipients:_.map(_.filter(this.recipients,function(r){return!r.isGroup}),"id"),groups:_.map(_.filter(this.recipients,"isGroup"),"id"),subject:this.subject,message:this.message}},clear:function(){this.recipients=[],this.subject="",this.message=""}},$scope.$watchCollection("formData.recipients",function(items){$scope.form.$setValidity("recipientCount",items&&items.length>=1)}),$scope.send=function(){validate()&&($scope.sendError=null,$scope.loading=!0,MessageService.send($scope.formData.serialized(),function(response){AlertService.showToast("success","Your message has been sent.",""),$scope.$close(),jumpToTop()},function(response){$scope.sendError="Failed to send the message. Please try again.",$log.error(response.data.errors),$scope.loading=!1}))}}),angular.module("hulahub").controller("AddPaymentCardModalController",function($scope,$rootScope,$log,PaymentService){$scope.saveCard=function(formData){$rootScope.$broadcast("showLoading"),$scope.errorMessage=null,PaymentService.createPaymentToken(formData.card,function(response){var paymentDetails={token:response.id,id:response.card.id,last4:response.card.last4,brand:response.card.brand,expiryMonth:response.card.exp_month,expiryYear:response.card.exp_year};PaymentService.addPaymentCard(paymentDetails,function(response){$scope.$close(response)},function(response){$log.error(response.errors),$rootScope.$broadcast("hideLoading"),$scope.errorMessage="Failed to add the card: "+response.errors})},function(response){$rootScope.$broadcast("hideLoading"),$scope.errorMessage="Failed to add the card: "+response})}}),angular.module("hulahub").controller("DeclineRefundModalController",function($rootScope,$scope,$log,$uibModalInstance,RefundService,data){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.formData={comments:null,serialized:function(){return{action:"decline",comments:this.comments}}},$scope.send=function(){validateForm()&&($scope.loading=!0,RefundService.respond(data.refundId,$scope.formData.serialized(),function(response){$uibModalInstance.close()},function(response){$log.error(response),$scope.errorMessage=response.errors,$scope.loading=!1}))},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("hulahub").controller("PartialRefundModalController",function($rootScope,$scope,$log,$uibModalInstance,RefundService,data){function validateForm(){return $scope.validationRun=!0,$scope.form.$valid}$scope.maxAmount=data.maxAmount,$scope.isHost=data.isHost,$scope.formData={amount:null,comments:null,serialized:function(){return{action:"offer",amount:100*this.amount,comments:this.comments}}},$scope.$watch("formData.amount",function(amount){$scope.form.$setValidity("amount",100*amount<=$scope.maxAmount)}),$scope.sendOffer=function(){validateForm()&&($scope.loading=!0,RefundService.respond(data.refundId,$scope.formData.serialized(),function(response){$uibModalInstance.close()},function(response){$log.error(response),$scope.errorMessage=response.errors,$scope.loading=!1}))},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("hulahub").controller("EditHomeHubModalController",function($scope,$log,GeocoderService,AuthService,UserService){function validate(){return $scope.validationRun=!0,$scope.homeHubForm.$valid}var savedHomeHub=AuthService.currentUser.homeHub;$scope.formData={locationSearchBox:savedHomeHub?savedHomeHub.name:"",homeHub:savedHomeHub,homeHubDistance:savedHomeHub?savedHomeHub.distance:10,serialized:function(){return{homeHub:this.homeHub?{latitude:this.homeHub.latitude,longitude:this.homeHub.longitude,name:this.homeHub.name,distance:this.homeHubDistance}:void 0}}};var defaultPlaceholder="Home location: click pin or type...";$scope.locationPlaceholder=defaultPlaceholder,$scope.useCurrentLocation=function(){$scope.locationPlaceholder="Fetching location...",GeocoderService.requestLocation(function(location){$scope.$apply(function(){$scope.formData.homeHub=location,$scope.formData.locationSearchBox=location.name,$scope.locationPlaceholder=defaultPlaceholder})},function(errorMessage){$log.error(errorMessage),$scope.$apply(function(){$scope.locationPlaceholder=defaultPlaceholder})})},$scope.validationRun=!1,$scope.save=function(){validate()&&($scope.loading=!0,UserService.updateHomeHub($scope.formData.serialized(),function(response){$scope.$close(response)},function(responseError){$scope.loading=!1,$log.error("Failed to save the home location",responseError)}))}}),angular.module("hulahub").controller("MyProfileController",function($scope,$rootScope,$state,$log,$uibModal,$location,$timeout,AuthService,ENV,appSettings,FormService,UserService,SpecialismService,InterestService,AlertService,user){function addMarker(markerData){var position={lat:markerData.latitude,lng:markerData.longitude};interestMarkers.push({marker:new google.maps.Marker({map:interestMap,position:position,name:markerData.name,icon:new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40))}),circle:new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:interestMap,center:position,radius:markerData.distance*appSettings.distanceMultiplier})})}$scope.theme="profile",$scope.user=user,$scope.viewingSelf=!0,$scope.activeTab="about",$location.hash()&&($scope.activeTab=$location.hash(),scrollToElement("profileTabs")),$scope.goToReviews=function(){scrollToElement("reviews")},$scope.showProfileScoreModal=function(){"host"===AuthService.currentUser.registrationType&&$uibModal.open({templateUrl:"profile/views/profile-score-modal.html",controller:"ProfileScoreModalController",resolve:{data:function(){return{specialismCount:$scope.user.specialisms.length}}}}).result.then(function(addMissingData){switch(addMissingData){case"personalStatement":case"dateOfBirth":case"gender":$scope.activeTab="about";break;case"phoneNumber":case"socialLinks":$scope.activeTab="contact";break;case"homeHub":$timeout(function(){$scope.editHomeHub()},500);break;case"avatar":$timeout(function(){$scope.changeProfilePicture()},500);break;case"coverPhoto":$timeout(function(){$scope.changeCoverPicture()},500);break;case"specialism":$timeout(function(){$scope.addSpecialism()},500)}})},$scope.changeProfilePicture=function(){$uibModal.open({templateUrl:"core/partials/photo-upload-modal.html",controller:"PhotoUploadModalController",keyboard:!1,backdrop:"static",resolve:{data:function(){return{title:"Edit profile picture",theme:"profile",aspectRatio:1,cropPreviewClass:"circleCropper",selectedImage:$scope.user.avatarURL,croppedSize:{width:300,height:300},onSave:function(croppedDataBlob,closeModal,onError){UserService.updateAvatar({avatar:croppedDataBlob},function(){$scope.user.avatarURL=AuthService.currentUser.profile.avatarURL,$scope.user.dateVerified=AuthService.currentUser.profile.verified,closeModal()},function(error){$log.error(error),onError(error)})}}}}})},$scope.changeCoverPicture=function(){$uibModal.open({templateUrl:"core/partials/photo-upload-modal.html",controller:"PhotoUploadModalController",keyboard:!1,backdrop:"static",resolve:{data:function(){return{title:"Edit cover picture",theme:"profile",aspectRatio:2.8,selectedImage:$scope.user.coverPhotoURL,croppedSize:{width:1920},onSave:function(croppedDataBlob,closeModal,onError){UserService.saveCoverPicture({photo:croppedDataBlob,cover:!0},function(){$scope.user.coverPhotoURL=AuthService.currentUser.profile.coverPhotoURL,closeModal()},function(error){$log.error(error),onError(error)})}}}}})},$scope.shareProfile=function(){$uibModal.open({templateUrl:"core/partials/share-modal.html",controller:"ShareModalController",resolve:{data:function(){var profileLink=ENV["public"]+"/profile/"+$scope.user.profileLink,userFullName=$scope.user.firstName+" "+$scope.user.lastName;return{id:$scope.user.id,idName:"profile_id",title:"Share your profile",url:profileLink,text:{twitter:"Check out my HulaHub profile and activities @HulaHubHQ",email:{
subject:"Check out my HulaHub profile and activities @HulaHubHQ",body:"Find out more about me, read my reviews and join my activities!\n\n"+profileLink+"\n\nHope to see you at one of my activities soon!\n\n"+userFullName}},intercomEventName:"shared-profile"}}}})},$scope.saveBusinessName=function(){$rootScope.$broadcast("showLoading"),UserService.updateMyDetails({businessName:$scope.user.businessName},function(response){AlertService.showToast("success","Changes saved","Your business name has been updated."),$rootScope.$broadcast("hideLoading"),$scope.editingBusinessName=!1},function(responseError){$rootScope.$broadcast("hideLoading"),$log.error("Failed to save the profile settings",responseError)})},$scope.formData={personalStatement:$scope.user.personalStatement,dateOfBirth:FormService.controls().dateOfBirth($scope.user.dateOfBirth,!0),gender:{options:[{id:"u",name:"Unspecified"},{id:"f",name:"Female"},{id:"m",name:"Male"}],value:$scope.user.gender},serialized:function(){return{updateProfile:!0,personalStatement:this.personalStatement,dateOfBirth:this.dateOfBirth.getValue()?this.dateOfBirth.getValue():"delete",gender:this.gender.value}}},$scope.saveAbout=function(aboutForm){$rootScope.$broadcast("showLoading"),UserService.updateMyDetails($scope.formData.serialized(),function(response){AlertService.showToast("success","Changes saved","Your profile has been updated."),$scope.user.personalStatement=$scope.formData.personalStatement,$rootScope.$broadcast("hideLoading"),aboutForm.$setPristine()},function(responseError){$rootScope.$broadcast("hideLoading"),$log.error("Failed to save the profile settings",responseError)})};var mapOptions={maxZoom:15,draggable:$(window).width()>=768,scrollwheel:!1,mapTypeControl:!1,streetViewControl:!1,styles:appSettings.mapStyles},locationMap=null,locationMarkers=[];$scope.drawLocationMap=function(){if(!locationMap&&$scope.user.homeHub){var element=document.getElementById("locationMap");if(null!==element){var position={lat:$scope.user.homeHub.latitude,lng:$scope.user.homeHub.longitude};locationMap=new google.maps.Map(element,{zoom:13,center:position,options:mapOptions}),locationMarkers.push({marker:new google.maps.Marker({map:locationMap,position:position,icon:new google.maps.MarkerImage("img/maps/light-pink.png",null,null,null,new google.maps.Size(40,40))}),circle:new google.maps.Circle({strokeWeight:0,fillColor:"#F15F6C",fillOpacity:.35,map:locationMap,center:position,radius:$scope.user.homeHub.distance*appSettings.distanceMultiplier})}),setTimeout(function(){var bounds=new google.maps.LatLngBounds;bounds.union(locationMarkers[0].circle.getBounds()),locationMap.fitBounds(bounds)},100)}}},$scope.editHomeHub=function(){$uibModal.open({templateUrl:"profile/views/edit-homehub-modal.html",controller:"EditHomeHubModalController",keyboard:!1,backdrop:"static"}).result.then(function(result){result.user.homeHub?($scope.user.homeHub=result.user.homeHub,locationMap=null,$scope.drawLocationMap()):$scope.user.homeHub=null})};var interestMap=null,interestMarkers=[];$scope.drawInterestMap=function(){interestMap||$timeout(function(){var element=document.getElementById("interestMap");if(null!==element){interestMap=new google.maps.Map(element,{zoom:13,center:{lat:0,lng:0},options:mapOptions});for(var allHubs=_.uniqBy(_.flatMap(user.interests,"hubs"),"id"),i=0;i<=allHubs.length-1;i++)addMarker(allHubs[i]);interestMarkers.length&&$timeout(function(){for(var bounds=new google.maps.LatLngBounds,i=0;i<interestMarkers.length;i++)bounds.union(interestMarkers[i].circle.getBounds());interestMap.fitBounds(bounds)},100)}},0)},$scope.editInterest=function(interestId){$rootScope.$broadcast("showLoading"),$state.go("interests.edit",{interestId:interestId})},$scope.deleteInterest=function(userInterest){showConfirm("Delete "+userInterest.interest.name,"Are you sure you want to remove this interest?",function(){$rootScope.$broadcast("showLoading"),InterestService["delete"](userInterest.id,function(){AuthService.currentUser.interestCount--,AuthService.save();var index=_.indexOf($scope.user.interests,_.find($scope.user.interests,["id",userInterest.id]));$scope.user.interests.splice(index,1),interestMap=null,$scope.drawInterestMap(),$rootScope.$broadcast("hideLoading")},function(response){AlertService.showToast("error","Failed to delete this interest.",""),$log.error(response.data),$rootScope.$broadcast("hideLoading")})})},$scope.addSpecialism=function(){$uibModal.open({templateUrl:"specialisms/views/specialism-modal.html",controller:"SpecialismModalController",keyboard:!1,backdrop:"static",openedClass:"modal-open pacContainerDropUpMobile",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","switches"])},data:function(){return{}}}}).result.then(function(response){$scope.user.specialisms=response.specialisms,AuthService.currentUser.profile.score<5&&response.profileScore>=5&&($scope.user.dateVerified=moment().format("DD/MM/YYYY")),AuthService.currentUser.profile.score=response.profileScore,AuthService.save()})},$scope.editSpecialism=function(specialismId){$uibModal.open({templateUrl:"specialisms/views/specialism-modal.html",controller:"SpecialismModalController",keyboard:!1,backdrop:"static",openedClass:"modal-open pacContainerDropUpMobile",resolve:{loadPlugin:function($ocLazyLoad){return $ocLazyLoad.load(["interestSearch","switches"])},data:function(){return{specialismId:specialismId}}}}).result.then(function(result){$scope.user.specialisms=result})},$scope.deleteSpecialism=function(specialismId){showConfirm("Delete specialism?","Are you sure you want to delete this specialism? This cannot be undone.",function(){$rootScope.$broadcast("showLoading"),SpecialismService["delete"](specialismId,function(response){AuthService.currentUser.profile.score>=5&&response.profileScore<5&&($scope.user.dateVerified=null),AuthService.currentUser.profile.score=response.profileScore,AuthService.save();var index=_.findIndex($scope.user.specialisms,function(s){return s.id===specialismId});$scope.user.specialisms.splice(index,1),$rootScope.$broadcast("hideLoading")},function(){AlertService.showToast("error","Error","There was an error removing the specialism. Please try again."),$rootScope.$broadcast("hideLoading")})})},$scope.contactFormData={phoneNumber:user.phone,website:user.websiteURL,facebook:user.socialLinks.facebook,twitter:user.socialLinks.twitter,linkedin:user.socialLinks.linkedin,instagram:user.socialLinks.instagram,serialized:function(){return{phoneNumber:""!==this.phoneNumber?this.phoneNumber:"",websiteURL:this.website?addHttp(this.website):"",socialLinks:{facebook:this.facebook?addHttp(this.facebook):"",twitter:this.twitter?addHttp(this.twitter):"",linkedin:this.linkedin?addHttp(this.linkedin):"",instagram:this.instagram?addHttp(this.instagram):""}}}},$scope.saveContact=function(contactForm){$rootScope.$broadcast("showLoading"),UserService.updateMyDetails($scope.contactFormData.serialized(),function(response){AlertService.showToast("success","Changes saved","Your profile has been updated."),$rootScope.$broadcast("hideLoading"),contactForm.$setPristine()},function(responseError){$rootScope.$broadcast("hideLoading"),$log.error("Failed to save the contact settings",responseError)})}}),angular.module("hulahub").controller("ProfileScoreModalController",function($scope,AuthService,data){var currentUser=AuthService.currentUser;$scope.score={hasNameAndNumber:null!==currentUser.profile.firstName&&null!==currentUser.profile.lastName&&angular.isDefined(currentUser.profile.phoneNumber),hasAvatar:angular.isDefined(currentUser.profile.avatarURL),hasShortBio:angular.isDefined(currentUser.profile.personalStatement)&&currentUser.profile.personalStatement.length>=200,hasHomeHub:angular.isDefined(currentUser.homeHub),hasSpecialism:data.specialismCount>0,hasCoverPhoto:angular.isDefined(currentUser.profile.coverPhotoURL),hasDOB:angular.isDefined(currentUser.profile.dateOfBirth),hasGender:"u"!==currentUser.profile.gender,hasBusinessName:angular.isDefined(currentUser.profile.businessName),hasSocialLink:currentUser.profile.socialLinks.length>0||angular.isDefined(currentUser.profile.websiteURL)},$scope.addMissingData=function(type){$scope.$close(type)}}),angular.module("hulahub").controller("RequestReviewController",function($scope,$rootScope,$state,$stateParams,$location,$window,$timeout,$log,$uibModal,ContactService,ReviewService,AlertService,AuthService){function removeLoading(){groupsLoaded&&contactsLoaded&&(availableTags=_.sortBy(availableTags,["name"]),$rootScope.$broadcast("hideLoading"))}function getValidExternalEmails(emailString){var inputEmails=_.uniq(emailString.split(/[\s,\n]+/)).slice(0,50);return _.filter(inputEmails,function(email){if(email.match(emailRegex))return email})}function validate(){return $scope.validationRun=!0,$scope.form.$valid}function loadRequests(){$scope.loading=!0,ReviewService.getReviewRequests(function(response){$scope.loading=!1,$scope.requests=response},function(errorResponse){$log.error("Failed to fetch sent invite list")})}var availableTags=[],groupsLoaded=!1,contactsLoaded=!1;$rootScope.$broadcast("showLoading"),ContactService.searchContacts({page:1,limit:5e3},function(contacts){availableTags=_.concat(availableTags,_.map(contacts.results,_.partialRight(_.pick,["id","name","avatarURL"]))),$scope.formData.recipients=$stateParams.to?$stateParams.to:[],contactsLoaded=!0,removeLoading()}),ContactService.getGroups(function(groups){availableTags=_.concat(availableTags,_.map(groups,function(g){return _.assign(g,{isGroup:!0})})),groupsLoaded=!0,removeLoading()}),$scope.loadTags=function(query){var existingRequestIds=_.map($scope.requests,"recipient.id");return _.filter(availableTags,function(o){return existingRequestIds.indexOf(o.id)===-1&&o.name.toLowerCase().indexOf(query.toLowerCase())>-1})},$scope.formData={recipients:[],external:"",comments:AuthService.currentUser.profile.lastReviewRequestText,serialized:function(){return{members:_.map(_.filter(this.recipients,function(r){return!r.isGroup}),"id"),groups:_.map(_.filter(this.recipients,"isGroup"),"id"),external:getValidExternalEmails(this.external),comments:""!==this.comments?this.comments:null}}};var emailRegex=/^[a-zA-Z0-9.!#$%&â*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/;$scope.$watchCollection("formData.recipients",function(recipients){$scope.form.$setValidity("recipientCount",recipients.length>=1)}),$scope.$watch("formData.external",function(external){$scope.invalidEmails=[];var invites=getValidExternalEmails(external);$scope.form.$setValidity("recipientCount",$scope.formData.recipients.length>=1||invites.length>=1)}),$scope.sendRequests=function(){validate()&&($rootScope.$broadcast("showLoading"),ReviewService.sendRequests($scope.formData.serialized(),function(response){$scope.validationRun=!1,$scope.formData.recipients=[],$scope.formData.external="",response.invalidEmails.length&&($scope.invalidEmails=response.invalidEmails,$scope.formData.external=response.invalidEmails.join("\n")),AuthService.currentUser.profile.lastReviewRequestText=$scope.formData.comments,AuthService.save(),AlertService.showToast("success","Your review requests have been sent.","Please note: this review request won't be sent to people who you have already asked to review you. Use the Options button in the section below to re-send a request."),jumpToTop(),loadRequests(),$rootScope.$broadcast("hideLoading")},function(errorResponse){AlertService.showToast("error","An error occurred during sending.","Please try again."),$rootScope.$broadcast("hideLoading")}))},loadRequests(),$scope.viewProfile=function(userId){$rootScope.$broadcast("showLoading"),$state.go("contacts.public",{userId:userId})},$scope.resendRequest=function(requestId){$rootScope.$broadcast("showLoading"),ReviewService.resendRequest(requestId,function(){$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","The review request has been re-sent.",""),jumpToTop()},function(errorResponse){$log.error("Failed to re-send request"),$rootScope.$broadcast("hideLoading")})},$scope.deleteRequest=function(request){var title=request.recipient?request.recipient.name:request.emailAddress;showConfirm("Remove review request","Are you sure you want to remove "+title+" from this list?",function(){ReviewService.removeRequest(request.id),_.remove($scope.requests,function(n){return n.id==request.id}),$scope.$apply()})},$timeout(function(){autosize($("textarea"))},0),$scope.viewReview=function(reviewRequest){$rootScope.$broadcast("showLoading"),ReviewService.getReview(reviewRequest.reviewId,function(reviewData){$rootScope.$broadcast("hideLoading"),$uibModal.open({template:'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">View review</h1></div><div class="modal-body"><review data="review" theme="profile" before-navigate="$dismiss()"></review></div>',controller:function($scope){$scope.review=reviewData}})},function(errorResponse){AlertService.showToast("error","An error occurred.","Please try again."),$rootScope.$broadcast("hideLoading")})}}),angular.module("hulahub").controller("SubmitReviewController",function($scope,$rootScope,$state,$stateParams,$timeout,AuthService,AlertService,ReviewService,StorageService,user){function validate(){return $scope.validationRun=!0,$scope.form.$valid}AuthService.isLoggedIn||($state.current.data.theme="wallet",$state.current.data.title=null),$scope.user=user,$scope.formData={requestToken:$stateParams.token,user:$stateParams.userId,reliability:0,expertise:0,enthusiasm:0,headline:"",text:""},$scope.$watch("formData.reliability",function(data){$scope.form.$setValidity("reliability",0!==data)}),$scope.$watch("formData.expertise",function(data){$scope.form.$setValidity("expertise",0!==data)}),$scope.$watch("formData.enthusiasm",function(data){$scope.form.$setValidity("enthusiasm",0!==data)}),$scope.submitReview=function(){if(validate())if(AuthService.isLoggedIn)$rootScope.$broadcast("showLoading"),ReviewService.submitReview($scope.formData,function(response){$state.go("contacts.public",{userId:$stateParams.userId,"#":"reviews"})},function(error){$rootScope.$broadcast("hideLoading"),AlertService.showToast("error","An error occurred.",error.data.message)});else{StorageService.setItem("storedReview",JSON.stringify($scope.formData),!0);var redirectMessage=null;redirectMessage="register"==$stateParams.redirect?'Please note, to leave a review you must be a member of HulaHub. Use the form below to sign up or if you are already a member please <a ui-sref="login" class="underlinedLink">log in</a>.':'Please note, to leave a review you must be a member of HulaHub. Use the form below to log in or if you are not yet a member please <a ui-sref="register" class="underlinedLink">sign up</a>.',$state.go($stateParams.redirect,{pageLoadAlertMessage:redirectMessage})}},$scope.cancel=function(){$state.go("contacts.public",{userId:$stateParams.userId})},$timeout(function(){autosize($("textarea"))},0)}),angular.module("hulahub").controller("AccountSettingsController",function($rootScope,$scope,AuthService,UserService,AlertService,PollingService,ENV){function validate(formName){return $scope.validationRun[formName]=!0,$scope[formName].$valid}$scope.formData={firstName:AuthService.currentUser.profile.firstName,lastName:AuthService.currentUser.profile.lastName,email:AuthService.currentUser.email,closeAccount:!1,currentPassword:null,newPassword:null,confirmPassword:null,reset:function(){this.firstName=AuthService.currentUser.profile.firstName,this.lastName=AuthService.currentUser.profile.lastName,this.email=AuthService.currentUser.email,this.closeAccount=!1,this.currentPassword=null,this.newPassword=null,this.confirmPassword=null},serialized:function(){switch($scope.editing){case"name":return{firstName:this.firstName,lastName:this.lastName};case"email":return{email:this.email};case"password":return{currentPassword:this.currentPassword,newPassword:this.newPassword,confirmPassword:this.confirmPassword};case"status":return{closeAccount:this.closeAccount}}}},$scope.validationRun=[],$scope.edit=function(section){$scope.editing=section},$scope.save=function(){validate($scope.editing+"Form")&&($rootScope.$broadcast("showLoading"),"password"===$scope.editing?UserService.changePassword($scope.formData.serialized(),function(){$scope.cancel(),$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","Your password has been updated.","")},function(responseError){$scope.formErrors=responseError.data.errors,$rootScope.$broadcast("hideLoading")}):UserService.updateMyDetails($scope.formData.serialized(),function(){if($scope.formData.closeAccount)AuthService.logout(),PollingService.stop(),redirectToPage(ENV);else{var updatedField="name"===$scope.editing?"name":"email address";$scope.cancel(),$rootScope.$broadcast("hideLoading"),AlertService.showToast("success","Your "+updatedField+" has been updated.","")}},function(responseError){$scope.formErrors=responseError.data.errors,$rootScope.$broadcast("hideLoading")}))},$scope.cancel=function(){$scope.formErrors=null,$scope.editing=null,$scope.validationRun=[],$scope.formData.reset()}}),angular.module("hulahub").controller("MessageSettingsController",function($scope,MessageService,AuthService,$timeout){$scope.alwaysOn=!0,$scope.settings=AuthService.currentUser.messagePrefs;var timeout;$scope.$watch("settings",function(newValue,oldValue){newValue!==oldValue&&($timeout.cancel(timeout),timeout=$timeout(function(){MessageService.savePreferences($scope.settings),AuthService.currentUser.messagePrefs=$scope.settings,AuthService.save()},2e3))},!0)}),angular.module("hulahub").controller("SpecialismModalController",function($scope,data,AuthService,SpecialismService){function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.savedHomeHub=AuthService.currentUser.homeHub,$scope.formData={interest:null,useHomeHub:!!$scope.savedHomeHub,hubs:[],serialized:function(){return{interest:this.interest.id,useHomeHub:this.useHomeHub,hubs:_.map(this.hubs,function(m){return{latitude:m.latitude,longitude:m.longitude,name:angular.isDefined(m.locality)?m.locality:m.name}})}}},data.specialismId?($scope.loading=!0,$scope.editMode=!0,SpecialismService.getSpecialism(data.specialismId,function(data){$scope.formData.interest=data.interest,$scope.formData.useHomeHub=data.useHomeHub,$scope.formData.hubs=data.hubs,$scope.loading=!1})):$scope.editMode=!1,$scope.$watch("newLocation",function(loc){loc&&loc.name&&($scope.formData.hubs.push({name:loc.name,locality:angular.isDefined(loc.locality)?loc.locality:loc.name,latitude:loc.latitude,longitude:loc.longitude}),$scope.newLocation=null)}),$scope.$watch("formData.interest",function(interest){$scope.form.$setValidity("interest",null!==interest&&void 0!==interest)}),$scope.$watch("[formData.useHomeHub, formData.hubs]",function(data){$scope.form.$setValidity("hubs",data[0]||data[1].length>0)},!0),$scope.removeLocation=function(location){var index=_.findIndex($scope.formData.hubs,function(h){return h===location});index!==-1&&$scope.formData.hubs.splice(index,1)},$scope.save=function(){validate()&&($scope.loading=!0,$scope.editMode?SpecialismService.update(data.specialismId,$scope.formData.serialized(),function(response){$scope.$close(response)},function(response){$scope.loading=!1}):SpecialismService.save($scope.formData.serialized(),function(response){$scope.$close(response)},function(response){$scope.loading=!1}))}}),angular.module("hulahub").controller("StripeController",function($rootScope,$scope,$state,$stateParams,StripeService,AuthService,StorageService,AnalyticsService,UserService,ActivityService,AlertService){$rootScope.$broadcast("showLoading"),$stateParams.code||$stateParams.state||$state.go("pageNotFound");var state=$stateParams.state.indexOf(":")>0?$stateParams.state.split(":"):$stateParams.state,route="",params={};"billing"===state?(route="billing.settings",params.alertMsg="Your stripe account has been connected. You can now accept payments through HulaHub."):route=state,$stateParams.error?(AlertService.showToast("error","access_denied"===$stateParams.error?"Access to your Stripe account was denied.":$stateParams.error,""),$state.go(route,{activityId:params.activityId})):StripeService.connectStripeAccount($stateParams.code,function(response){AuthService.currentUser.stripeAccountConnected=!0,AuthService.save(),"joiner"===AuthService.currentUser.registrationType?AnalyticsService.sendGoalEvent("13 - Connect Bank Account"):AnalyticsService.sendGoalEvent("105 - Connect Bank Account"),UserService.updateGoal(),AlertService.showToast("success",params.alertMsg,""),$state.go(route,params)},function(response){$rootScope.$broadcast("hideLoading"),AlertService.showToast("error","An error occurred when trying to connect your Stripe account.","Please try again."),"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")})}),angular.module("hulahub").controller("CompleteProfileController",function($scope,$rootScope,$state,$location,$log,ENV,AuthService,FormService,GeocoderService,PaymentService,StorageService,UserService,ReviewService,AlertService){function validate(){return $scope.validationRun=!0,$scope.form.$valid}function completeProfile(){StorageService.removeItem("registerPromoCode",!0),UserService.completeProfile($scope.formData.serialized(),function(response){var storedReview=JSON.parse(StorageService.getItem("storedReview",!0));storedReview?ReviewService.submitReview(storedReview,function(response){StorageService.removeItem("storedReview"),$state.go("contacts.public",{userId:storedReview.user,"#":"reviews"})},function(error){StorageService.removeItem("storedReview"),handleRedirect()}):handleRedirect()},function(response){response.data.errors.payment?AlertService.showToast("error","Failed to create account",response.data.errors.payment):$scope.formErrors=response.data.errors,$rootScope.$broadcast("hideLoading")})}function handleRedirect(){var redirectURL=StorageService.getItem("loginRedirectUrl");null!==redirectURL?(StorageService.removeItem("loginRedirectUrl"),$location.url(redirectURL)):"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")}var currentUser=AuthService.currentUser,savedHomeHub=currentUser.homeHub,plans={PERSONAL:{title:"Personal",monthly:{cost:300,code:"PERSONAL_MONTH"},annual:{cost:2500,code:"PERSONAL_YEAR"}},PROFESSIONAL:{title:"Professional",monthly:{cost:1200,code:"Professional_Month_Trial"},annual:{cost:1e4,code:"Professional_Year_Trial"}}};if("FREE"!==currentUser.subscriptionPlan){var planType=currentUser.subscriptionPlan.split(/_(.+)/)[0];$scope.selectedPlan=plans[planType.toUpperCase()]}$scope.formData={firstName:currentUser.profile.firstName,lastName:currentUser.profile.lastName,businessName:currentUser.profile.businessName,websiteURL:currentUser.profile.websiteURL,email:currentUser.email,phoneNumber:currentUser.profile.phoneNumber,gender:{options:[{id:"f",name:"Female"},{id:"m",name:"Male"}],value:currentUser.profile.gender},dateOfBirth:FormService.controls().dateOfBirth(currentUser.profile.dateOfBirth,!0),locationSearchBox:savedHomeHub?savedHomeHub.name:"",homeHub:savedHomeHub,payment:null,promoCode:{value:StorageService.getItem("registerPromoCode",!0),verified:!1,valid:!1,validMessage:null},selectedSubscription:currentUser.subscriptionPlan,serialized:function(){return{firstName:this.firstName,lastName:this.lastName,businessName:this.businessName,websiteURL:this.websiteURL?addHttp(this.websiteURL):null,email:this.email,phoneNumber:this.phoneNumber,gender:this.gender.value,dateOfBirth:this.dateOfBirth.getValue(),homeHub:this.homeHub?{latitude:this.homeHub.latitude,longitude:this.homeHub.longitude,name:this.homeHub.name,distance:10}:void 0,selectedSubscription:"FREE"!==this.selectedSubscription?this.selectedSubscription:null,payment:this.payment,promoCode:this.promoCode.valid?this.promoCode.value:null}}};var defaultPlaceholder="Home location: click pin or type...";$scope.locationPlaceholder=defaultPlaceholder,$scope.useCurrentLocation=function(){$scope.locationPlaceholder="Fetching location...",GeocoderService.requestLocation(function(location){$scope.$apply(function(){$scope.formData.homeHub=location,$scope.formData.locationSearchBox=location.name,$scope.locationPlaceholder=defaultPlaceholder})},function(errorMessage){$log.error(errorMessage),$scope.$apply(function(){$scope.locationPlaceholder=defaultPlaceholder})})},$scope.paymentFormSubmissionHandler={},$scope.savePaymentDetails=function(newCardDetails){$rootScope.$broadcast("showLoading"),PaymentService.createPaymentToken(newCardDetails.card,function(response){$scope.formData.payment={token:response.id,id:response.card.id,last4:response.card.last4,brand:response.card.brand,expiryMonth:response.card.exp_month,expiryYear:response.card.exp_year},UserService.registerForBenefits(),completeProfile()},function(response){$rootScope.$broadcast("hideLoading"),$log.error(response.data)})},$scope.save=function(){validate()&&("FREE"!==currentUser.subscriptionPlan?$scope.paymentFormSubmissionHandler.submit():($rootScope.$broadcast("showLoading"),completeProfile()))},$scope.showPromoCodePopup=function(){showHintPopup("How a promotional code works",'<p>Promotional codes give you a discount or credit towards HulaHub subscriptions.</p><p>For example, if you successfully applied a code that gives you &pound;20 discount and your next monthly subscription amount due is &pound;15 no payment will be taken from your card and the &pound;5 code balance will be carried over. The following payment taken will therefore be &pound;10 and all subsequent payments will be &pound;15.</p><p class="no-margins">Note: If you change your subscription any unexpired discount or credit on a coupon associated with the previous subscription will expire.</p>')},$scope.validatePromoCode=function(){$rootScope.$broadcast("showLoading"),PaymentService.validatePromoCode($scope.formData.promoCode.value,function(response){$scope.formData.promoCode.verified=!0,$scope.formData.promoCode.valid=response.valid,$scope.formData.promoCode.validMessage=response.message,$rootScope.$broadcast("hideLoading")})},null!==StorageService.getItem("registerPromoCode",!0)&&$scope.validatePromoCode(),$scope.$watch("formData.promoCode.value",function(newValue){$scope.formData.promoCode.verified=!1,$scope.formData.promoCode.valid=!1,$scope.formData.promoCode.validMessage=null,angular.isDefined($scope.formErrors)&&($scope.formErrors.promoCode=null)})}),angular.module("hulahub").controller("LoginController",function($scope,$rootScope,$state,$stateParams,$timeout,$facebook,$window,IntercomService,AuthService,UserService,ParameterService,StorageService,ReviewService){function formError(response){423===response.status?$scope.formErrors={email:"locked"}:$scope.formErrors={email:"Log in failed. Please try again."},$("input.email").select(),$rootScope.$broadcast("hideLoading")}function completeLogin(){IntercomService.boot(),ParameterService.clearData();var storedReview=JSON.parse(StorageService.getItem("storedReview",!0));storedReview?ReviewService.submitReview(storedReview,function(response){StorageService.removeItem("storedReview"),$state.go("contacts.public",{userId:storedReview.user,"#":"reviews"})},function(error){StorageService.removeItem("storedReview"),loginRedirect()}):loginRedirect()}function loginRedirect(){var loginRedirectUrl=StorageService.getItem("loginRedirectUrl");null!==loginRedirectUrl&&!loginFromJoinButtonTest&&loginRedirectUrl.indexOf("/join/")>=0&&(loginRedirectUrl=null,StorageService.removeItem("loginRedirectUrl")),angular.isDefined($stateParams.redirectUrl)&&null!==$stateParams.redirectUrl&&(loginRedirectUrl=$stateParams.redirectUrl),null!==loginRedirectUrl?($window.location.href=loginRedirectUrl,StorageService.removeItem("loginRedirectUrl")):"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")}var loginFromJoinButtonTest=StorageService.getCookie("loginFromSEOJoinButton");StorageService.removeCookie("loginFromSEOJoinButton"),$scope.pageLoadAlertMessage=$stateParams.pageLoadAlertMessage;var paramUser=ParameterService.getUser();$scope.formData={email:$stateParams.email,password:"",registrationType:paramUser.hostOrJoiner},$scope.validate=function(){return $timeout(function(){$scope.validationRun=!0},0),$scope.form.$valid},$scope.login=function(){$scope.resent=!1,$scope.formErrors=null,$scope.loginError=null,$scope.validate()&&($rootScope.$broadcast("showLoading"),AuthService.getAccessToken("/users/login",{grant_type:"password",username:$scope.formData.email,password:$scope.formData.password},function(){completeLogin()},formError))},$scope.facebookLogin=function(){$rootScope.$broadcast("showLoading"),$facebook.login(void 0,!0).then(function(){$facebook.api("/me").then(function(response){var fbAuth=$facebook.getAuthResponse();AuthService.getAccessToken("/users/login/external",{provider:"facebook",id:response.id,accessToken:fbAuth.accessToken},function(){completeLogin()},formError)},function(err){$rootScope.$broadcast("hideLoading")})})};var lastSend=null;$scope.resend=function(){$scope.resent=!1,$scope.loginError=null,moment().diff(lastSend,"seconds")<60?$scope.loginError="Wait at least one minute before requesting another send":($scope.resent=!0,UserService.resendConfirmationEmail($scope.formData.email),lastSend=moment())}}),angular.module("hulahub").controller("ResetPasswordController",function($rootScope,$scope,$state,$window,UserService,AuthService,AlertService,ParameterService,StorageService){function requestAction(){var lastSend=null;$scope.send=function(resend){resend=resend||!1,moment().diff(lastSend,"seconds")<60?AlertService.showToast("warning","Wait at least 1 minute before requesting another send.",""):$scope.validate()&&($rootScope.$broadcast("showLoading"),UserService.requestPasswordReset($scope.formData,function(response){$rootScope.$broadcast("hideLoading"),$scope.checkEmail=!0,resend&&AlertService.showToast("success","Reset email has been re-sent.",""),lastSend=moment()},function(response){$scope.formErrors=response.data.errors,$rootScope.$broadcast("hideLoading")}))}}function resetAction(token){token||$state.go("pageNotFound"),$scope.save=function(){$scope.validate()&&($scope.formErrors=null,$rootScope.$broadcast("showLoading"),UserService.resetPassword(token,$scope.formData,function(response){UserService.getMyDetails(function(){$rootScope.$broadcast("hideLoading");var loginRedirectUrl=StorageService.getItem("loginRedirectUrl");null!==loginRedirectUrl?($window.location.href=loginRedirectUrl,StorageService.removeItem("loginRedirectUrl")):"host"===AuthService.currentUser.registrationType?$state.go("dashboard"):$state.go("activities.find")})},function(response){switch(response.status){case 404:$state.go("pageNotFound");break;case 498:$scope.tokenExpired=!0,$rootScope.$broadcast("hideLoading");break;default:$scope.formErrors=response.data.errors,$rootScope.$broadcast("hideLoading")}}))}}$scope.validate=function(){return $scope.validationRun=!0,$scope.form.$valid};var paramUser=ParameterService.getUser();switch($scope.registrationType=paramUser.hostOrJoiner,$state.current.name){case"resetPassword":requestAction();break;default:resetAction($state.params.token)}}),angular.module("hulahub").controller("SetPasswordController",function($scope,$rootScope,$state,$window,AlertService,UserService,AnalyticsService,StorageService){var token=$state.params.token;token||$state.go("pageNotFound"),$scope.validate=function(){return $scope.validationRun=!0,$scope.form.$valid},$scope.save=function(){$scope.validate()&&($scope.formErrors=null,$rootScope.$broadcast("showLoading"),UserService.setPassword(token,$scope.formData,function(response){UserService.getMyDetails(function(user){$rootScope.$broadcast("hideLoading");var loginRedirectUrl=StorageService.getItem("loginRedirectUrl");null!==loginRedirectUrl?($window.location.href=loginRedirectUrl,StorageService.removeItem("loginRedirectUrl")):"joiner"===user.registrationType?(AnalyticsService.sendGoalEvent("1 - Verify Email"),
$state.go("activities.find")):(AnalyticsService.sendGoalEvent("101 - Verify Email"),$state.go("dashboard"))})},function(response){AlertService.showToast("error","We have been unable to activate your account.","Please try again."),$scope.formErrors=response.data.errors,$rootScope.$broadcast("hideLoading")}))}}),angular.module("hulahubShared").controller("SignupController",function($scope,$rootScope,$state,$stateParams,$facebook,AlertService,AnalyticsService,StorageService,ParameterService,IntercomService,UserService){function validate(){return $scope.validationRun=!0,$scope.form.$valid}function signupComplete(user,method){IntercomService.boot(),AnalyticsService.trigger("Conversion_Activity_Register"),AnalyticsService.sendGoalEvent(("host"===$scope.formData.registrationType?"100":"0")+" - Register",user.id),AnalyticsService.trigger("Registration",{form:"generic",type:$scope.formData.registrationType,method:method,status:"complete"}),ParameterService.clearData(),$state.go("register.completeProfile")}angular.isDefined($stateParams.promocode)&&StorageService.setItem("registerPromoCode",$stateParams.promocode,!0),$scope.pageLoadAlertMessage=$stateParams.pageLoadAlertMessage;var paramUser=ParameterService.getUser();$scope.formData={email:paramUser.email,invitation:paramUser.inviteToken,registrationType:paramUser.hostOrJoiner,tracking:ParameterService.getTracking(),plan:"joiner"===paramUser.hostOrJoiner&&$stateParams.plan?"PERSONAL_YEAR":null},$scope.register=function(){validate()&&($rootScope.$broadcast("showLoading"),UserService.register($scope.formData,function(response){UserService.getMyDetails(function(user){signupComplete(user,"HH signup")})},function(response){409===response.status&&response.data.errors.locked&&($scope.closedAccount=!0),$scope.formErrors=response.data.errors,$rootScope.$broadcast("hideLoading")}))},$scope.resend=function(){$scope.resent=!0,$scope.validationRun=!1,UserService.resendConfirmationEmail($scope.formData.email)},$scope.facebookRegister=function(){$rootScope.$broadcast("showLoading"),$scope.validationRun=!1,$facebook.login(void 0,!0).then(function(){$facebook.api("/me?fields=id,name,email").then(function(fbResponse){if(angular.isDefined(fbResponse.email)){var fbAuth=$facebook.getAuthResponse();UserService.registerExternal({provider:"facebook",id:fbResponse.id,email:fbResponse.email,registrationType:paramUser.hostOrJoiner,accessToken:fbAuth.accessToken,invitation:$scope.formData.invitation,tracking:$scope.formData.tracking,plan:$scope.formData.plan},function(response){UserService.getMyDetails(function(user){signupComplete(user,"FB signup")})},function(response){$rootScope.$broadcast("hideLoading"),409===response.status||response.data.errors.email?AlertService.showToast("error","An account with that email address already exists","<a class='underlinedLink' href='/login'>Go to Log in</a>."):AlertService.showToast("error","Registration error","There was a problem registering your account. Please try again.")})}else AlertService.showToast("error","Registration error","Please share your email address to sign up."),$rootScope.$broadcast("hideLoading")},function(err){$rootScope.$broadcast("hideLoading")})})}}),angular.module("hulahub").controller("VerifyEmailController",function($scope,$rootScope,$state,UserService,AuthService,AlertService,AnalyticsService){var token=$state.params.token;token||$state.go("pageNotFound"),AuthService.logout(),UserService.verifyEmailToken(token,function(response){UserService.getMyDetails(function(user){AlertService.showToast("success","Email verified","Your email address has been verified."),"joiner"===user.registrationType?(AnalyticsService.sendGoalEvent("1 - Verify Email"),$state.go("activities.find")):(AnalyticsService.sendGoalEvent("101 - Verify Email"),$state.go("dashboard"))})},function(response){$rootScope.$broadcast("hideLoading"),404===response.status?(AlertService.showToast("error","The verification token has either expired or is not valid.",""),$state.go("login")):400===response.status?$state.go("register.setPassword",{token:token}):(AlertService.showToast("error","There was an error verifying your email.",""),$state.go("login"))})}),angular.module("hulahub").controller("EditOfferController",function($scope,$rootScope,$state,$stateParams,$log,$window,AlertService,OfferService){function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.newOffer=!1,$scope.loading=!0,OfferService.getOffer($stateParams.offerId,function(response){$scope.offer={id:response.id,type:response.type,threshold:response.threshold,amount:{model:response.amount/100,value:function(){return 100*this.model}}},$scope.formData={threshold:$scope.offer.threshold,type:$scope.offer.type,amount:$scope.offer.amount,serialized:function(){return{type:parseInt(this.type),threshold:parseInt(this.threshold),amount:this.amount.value()}}},$scope.originalData=JSON.stringify($scope.formData.serialized()),$scope.loading=!1},function(response){AlertService.showToast("error","Failed to retrieve the offer.","Please try again."),$log.error(response.data),$scope.loading=!1}),$scope.cancel=function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$window.history.back():showConfirm("Cancel","Are you sure you want to cancel? You will lose any changes you have made.",function(){$window.history.back()})},$scope.save=function(){validate()&&($rootScope.$broadcast("showLoading"),OfferService.update($scope.offer.id,$scope.formData.serialized(),function(response){AlertService.showToast("success","The offer has been updated.",""),$state.go("offers")},function(response){AlertService.showToast("error","Failed to update the offer.","Please try again."),$log.error(response.data),$rootScope.$broadcast("hideLoading")}))}}),angular.module("hulahub").controller("NewOfferController",function($scope,$rootScope,$state,$log,$window,AlertService,FormService,OfferService){function validate(){return $scope.validationRun=!0,$scope.form.$valid}$scope.newOffer=!0,$scope.formData={type:0,threshold:null,amount:{model:null,value:function(){return this.model?100*this.model:null}},serialized:function(){return{type:parseInt(this.type),threshold:parseInt(this.threshold),amount:this.amount.value()}}},$scope.originalData=JSON.stringify($scope.formData.serialized()),$scope.cancel=function(){angular.equals(JSON.stringify($scope.formData.serialized()),$scope.originalData)?$window.history.back():showConfirm("Cancel","Are you sure you want to cancel? You will lose any changes you have made.",function(){$window.history.back()})},$scope.save=function(){validate()&&($rootScope.$broadcast("showLoading"),OfferService.save($scope.formData.serialized(),function(response){AlertService.showToast("success","The offer has been saved.",""),$state.go("offers")},function(response){AlertService.showToast("error","Failed to save the offer.","Please try again."),$log.error(response.data),$rootScope.$broadcast("hideLoading")}))}}),angular.module("hulahub").controller("OfferListController",function($scope,$rootScope,$state,AlertService,OfferService){$scope.loading=!0,OfferService.getOffers(function(response){$scope.loading=!1,$scope.offers=response},function(response){AlertService.showToast("error","An error occurred when trying to fetch all offers.","Please try again."),$scope.loading=!1}),$scope["delete"]=function(offer,$event){showConfirm("Delete this offer?","Are you sure you want to remove this offer? It will no longer be available on your future activities",function(){OfferService["delete"](offer.id),$($event.currentTarget.closest("li")).animate({opacity:0},"slow",function(){var index=_.indexOf($scope.offers,_.find($scope.offers,["id",offer.id]));$scope.offers.splice(index,1),$scope.$apply()})})}}),angular.module("hulahubShared").run(["$templateCache",function($templateCache){$templateCache.put("activities/views/activity-info.html",'<div class="row"><div id="photoGalleryLightbox" class="hidden"><a href="{{ activity.bannerImage || (\'/img/landing/lrg/A\' + activity.interests[0].id + \'-1.jpg\') }}"></a> <a ng-repeat="photoURL in activity.photoGallery" href="{{ photoURL }}"></a></div><div class="photoGallery relative visible-xs gutterMarginBottom"><slick settings="slickConfig"><div class="activityImage lrg" style="background-image: url({{ activity.bannerImage || (\'/img/landing/lrg/A\' + activity.interests[0].id + \'-1.jpg\') }})"></div><div ng-repeat="photoURL in activity.photoGallery" class="activityImage lrg" style="background-image: url({{ photoURL }})"></div></slick><a class="btn btn-white abs topRight" ng-click="shareActivity()"><i class="fas fa-share-alt no-margins"></i></a> <a class="btn btn-white abs bottomLeft" ng-click="openPhotoGallery()"><i class="ico ico-picture no-margins"></i></a></div><div class="row"><div class="col-xs-12 col-sm-7"><h4 ng-show="activity.featured" class="gutterMarginBottom half contactsColour text-uppercase">Featured</h4><h1 class="marginBottom">{{ activity.title }}</h1><p class="no-margins">Hosted by <a ui-sref="contacts.public({ userId: activity.host.id })" class="activities">{{ activity.host.name }}</a></p><div class="vAlignParent" ng-if="activity.host.reviewCount > 0"><review-stars theme="contacts sml vAlign spacingRight half" value="activity.host.overallRating"></review-stars><span class="mutedText small vAlign">({{ activity.host.reviewCount }} reviews)</span></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><ul class="list-unstyled iconBulletList noMarginBottom"><li><i class="ico ico-coins"></i><span>Price: <strong>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</strong><span ng-if="activity.budget.totalPerPerson > 0"> per person</span></span></li><li><i class="ico ico-pin"></i><span>Location: <strong>{{ activity.startLocation.locality }}</strong> (<a class="activities" ng-click="scrollTo(\'mapSection\')">view map</a>)</span></li><li><i class="ico ico-clock"></i><span>Duration: <strong>{{ ::activity.duration }}</strong> (<a class="activities" ng-click="scrollTo(\'instanceSection\')">view dates</a>)</span></li></ul><div ng-show="activity.host.self" class="marginTop btn-group visible-xs clearfix"><button type="button" class="btn btn-activities btn-block dropdown-toggle" data-toggle="dropdown">Manage activity<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-right full-width"><li ng-show="(activity.status == \'open\' || activity.status == \'draft\') && !activity.confirmedFlexibleBooking"><a ng-click="editActivity(activity)">Edit activity</a></li><li ng-show="activity.status == \'open\' && !activity.confirmedFlexibleBooking"><a ng-click="sendInvites(activity)">Send invites</a></li><li ng-show="activity.joiners.length"><a ng-click="newMessage(activity.joiners, activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Message joiners</a></li><li ng-show="activity.status != \'draft\'"><a ng-click="discussionBoard(activity)">Discussion board</a></li><li><a ng-click="copyActivity(activity)">Copy activity</a></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'" role="separator" class="divider"></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'"><a ng-click="cancelActivity(activity)">Cancel activity</a></li><li ng-show="activity.deletable" class="divider"></li><li ng-show="activity.deletable"><a ng-click="deleteActivity()">Delete activity</a></li></ul></div><div ng-show="activity.alreadyJoined" class="marginTop btn-group visible-xs clearfix"><button type="button" class="btn btn-activities btn-block dropdown-toggle" data-toggle="dropdown">Manage booking<span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-right full-width"><li ng-show="activity.status == \'open\'"><a ng-click="sendInvites(activity)">Share activity</a></li><li><a ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Contact host</a></li><li><a ng-click="discussionBoard(activity)">Discussion board</a></li></ul></div></div><div class="shareBar activities row noGutter text-center visible-xs"><a class="col-xs-3" ng-click="shareFacebook()"><i class="ico ico-facebook"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{ shareText.twitter | encodeURI }}&url={{ activity.publicUrl | encodeURI }}&related=HulaHubHQ"><i class="ico ico-twitter"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{ shareText.email.subject }}&body={{ shareText.email.body | encodeURI }}"><i class="ico ico-message"></i></a> <a class="col-xs-3" ngclipboard data-clipboard-text="{{ activity.publicUrl }}" ngclipboard-success="onClipboardSuccess(e)"><i class="ico" ng-class="{\'ico-documents\': !linkCopiedToClipboard, \'ico-tick\': linkCopiedToClipboard}"></i></a></div><div class="sectionContent mobileFullPadding noPadding borderBottom" ng-if="activity.interests.length"><div class="labelContainer"><span class="label grey notBold" ng-repeat="interest in activity.interests">{{ interest.name }}</span></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><h2 class="gutterMarginBottom">Who is this activity aimed at?</h2><div class="row noGutter"><div class="col-xs-4"><i class="ico ico-cake marginRight"></i><span class="hidden-xs hidden-sm marginRight">Age:</span><strong ng-hide="activity.ageMax">{{ activity.ageMin }}+</strong><strong ng-show="activity.ageMax">{{ activity.ageMin }}-{{ activity.ageMax }}</strong></div><div class="col-xs-4"><i class="ico ico-gender marginRight"></i><span class="hidden-xs hidden-sm marginRight">Gender:</span><strong>{{ activity.gender | genderDisplay }}</strong></div><div class="col-xs-4"><i class="ico ico-level marginRight"></i><span class="hidden-xs hidden-sm marginRight">Level:</span><strong>{{ activity.difficultyLevel | difficultyDisplay }}</strong></div></div><div class="gutterMarginTop" ng-show="activity.additionalRequirements" ng-bind-html="activity.additionalRequirements | nl2br | sanitize"></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><h2 class="gutterMarginBottom">About this activity</h2><div class="hidden-xs" ng-bind-html="activity.summary | nl2br | sanitize"></div><div class="visible-xs" read-more limit="100" link-class="activities" content="{{ activity.summary|nl2br }}"></div><div class="gutterMarginTop" ng-show="activity.description"><h3 class="gutterMarginBottom">What we\'ll do</h3><div class="hidden-xs" ng-bind-html="activity.description | nl2br | sanitize"></div><div class="visible-xs" read-more limit="100" link-class="activities" content="{{ activity.description|nl2br }}"></div></div><div class="gutterMarginTop" ng-if="activity.attachments.length"><h3 class="gutterMarginBottom">Attachments</h3><ul class="list-unstyled attachmentList no-margins"><li ng-repeat="attachment in activity.attachments" ng-switch on="attachment.ext"><a ng-switch-when="pdf" href="{{ attachment.url }}" target="_blank" class="activities"><i class="ico ico-pdf"></i> {{ attachment.name }}</a> <a ng-switch-default href="{{ attachment.url }}" target="_blank" class="activities"><i class="ico ico-picture"></i> {{ attachment.name }}</a></li></ul></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom" id="mapSection"><h2 class="gutterMarginBottom">Where to find us</h2><div ng-show="!activity.endLocation"><strong>{{ activity.startLocation.name }}</strong></div><ul class="list-unstyled noMarginBottom" ng-show="activity.endLocation"><li>Starts: <strong>{{ activity.startLocation.name }}</strong></li><li>Ends: <strong>{{ activity.endLocation.name }}</strong></li></ul><div ng-if="(activity.meetingPoint == \'private\' && !activity.alreadyJoined)" class="small">The exact address will be shared once the booking is confirmed.</div><div ng-if="!activity.alreadyJoined && activity.flexibleLocationDistance" class="small">Once your booking is confirmed you can arrange an exact address with the host within {{ activity.flexibleLocationDistance }} miles from {{ activity.startLocation.name }}.</div><div ng-if="activity.alreadyJoined && activity.flexibleLocationDistance">Please <a class="activities" ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">contact the host</a> to arrange a location for this activity within {{ activity.flexibleLocationDistance }} miles from {{ activity.startLocation.name }}.</div><div ng-if="activity.directions" class="gutterMarginTop" ng-bind-html="activity.directions | nl2br | sanitize"></div><div class="mapHolder gutterMarginTop"><div id="map"></div><a ng-if="activity.flexibleLocationDistance == null && (activity.meetingPoint !== \'private\' || activity.alreadyJoined) && !auth.currentUser.homeHub" class="btn btn-white" href="https://www.google.com/maps/dir//{{ activity.startLocation.latitude }},{{ activity.startLocation.longitude }}" target="_blank"><i class="ico ico-directions no-margins"></i></a> <a ng-if="activity.flexibleLocationDistance == null && (activity.meetingPoint !== \'private\' || activity.alreadyJoined) && auth.currentUser.homeHub" class="btn btn-white" href="https://www.google.com/maps/dir/{{ auth.currentUser.homeHub.latitude }},{{ auth.currentUser.homeHub.longitude }}/{{ activity.startLocation.latitude }},{{ activity.startLocation.longitude }}" target="_blank"><i class="ico ico-directions no-margins"></i></a></div></div><div class="sectionContent mobileFullPadding noPadding" ng-class="{\'borderBottom\': !activity.bestOffer, \'noPaddingBottom\': activity.bestOffer}" id="instanceSection"><h2 class="gutterMarginBottom">What\'s available</h2><div class="vAlignParent full-width"><div class="vAlign" ng-show="activity.flexible"><p class="h3 notBold">Flexi session</p><div>{{ activity.duration }}</div><div>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}<span ng-if="activity.budget.totalPerPerson > 0"> per person</span></div></div><div class="vAlign" ng-show="!activity.flexible && activity.seriesDates.length > 1"><p class="h3 notBold">Single session</p><div>{{ activity.duration }}</div><div>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}<span ng-if="activity.budget.totalPerPerson > 0"> per person</span></div></div><div class="vAlign" ng-show="!activity.flexible && activity.seriesDates.length === 1"><span class="label grey notBold gutterMarginBottom half" ng-show="!activity.host.self && !activity.alreadyJoined && activity.spacesLeft !== \'Unlimited\' && activity.spacesLeft <= 3">{{ activity.spacesLeft }} spot<span ng-if="activity.spacesLeft > 1">s</span> left</span><p class="h3 notBold">{{ activity.startDate | dateFormat:\'ddd, D MMM YYYY\' }}</p><div ng-show="singleDayEvent">{{ activity.startDate | dateFormat:\'HH:mm\' }} - {{ activity.endDate | dateFormat:\'HH:mm\' }}</div><div ng-show="!singleDayEvent">Starts at {{ activity.startDate | dateFormat:\'HH:mm\' }}</div><div>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}<span ng-if="activity.budget.totalPerPerson > 0"> per person</span></div></div><div class="vAlign col-xs-4 noPadding text-right" ng-show="!activity.host.self"><a class="btn btn-profile" ng-show="activity.customBookingURL" ng-click="bookOffsiteActivity()" href="{{ activity.customBookingURL }}" target="_blank"><i class="ico ico-activities-plus"></i>Book now</a> <a class="btn btn-profile" ng-show="!activity.customBookingURL && activity.flexible" ng-click="bookFlexibleActivity()"><i class="ico ico-calendar"></i>See dates</a> <a class="btn btn-profile" ng-show="!activity.customBookingURL && !activity.flexible && activity.seriesDates.length > 1" ng-click="bookRepeatingActivity()"><i class="ico ico-calendar"></i>See dates</a> <a class="btn btn-profile" ng-show="!activity.alreadyJoined && !activity.customBookingURL && !activity.flexible && activity.seriesDates.length === 1 && (activity.spacesLeft == \'Unlimited\' || activity.spacesLeft > 0)" ng-click="joinActivity()"><i class="ico ico-activities-plus"></i>Book now</a></div></div><div class="specialOfferBanner profileColour marginTop text-center" ng-if="activity.bestOffer"><div class="title"><i class="ico ico-offer-tag marginRight"></i> Special offers</div><div class="marginTop marginBottom"><strong>Bring your friends and get up to {{ activity.bestOffer.type === 1 ? (activity.bestOffer.amount|currencyDisplay:activity.budget.currency) : (activity.bestOffer.amount + \'%\') }} off!</strong></div></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><h2 class="gutterMarginBottom">HulaHub guarantee</h2><div>You can request a cancellation and full refund of an activity booking from the host up to 24 hours before the activity\'s start date.</div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><div class="clearfix gutterMarginBottom"><h2 class="pull-left">Hosted By</h2><button ng-show="!activity.host.self" type="button" class="pull-right hidden-xs btn btn-messages btn-outline" ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))"><i class="ico ico-message"></i>Contact host</button></div><div class="vAlignParent"><div class="vAlign noFontSize spacingRight"><a ui-sref="contacts.public({ userId: activity.host.id })"><span class="circlePhoto activities med" ng-class="{\'noPhoto\' : !activity.host.avatar}" style="background-image:url(\'{{ activity.host.avatar }}\')"></span></a></div><div class="vAlign"><p class="no-margins h3"><a ui-sref="contacts.public({ userId: activity.host.id })" class="textColour">{{ activity.host.name }}</a></p><p class="no-margins" ng-if="activity.host.businessName">{{ activity.host.businessName }}</p><div class="vAlignParent" ng-if="activity.host.reviewCount > 0"><review-stars theme="contacts med vAlign spacingRight half" value="activity.host.overallRating"></review-stars><span class="mutedText small vAlign">({{ activity.host.reviewCount }} reviews)</span></div></div></div><div class="gutterMarginTop half" ng-if="activity.host.personalStatement">{{ activity.host.personalStatement|limitTo:200 }}<span ng-if="activity.host.personalStatement.length > 200">... <a class="activities" ui-sref="contacts.public({ userId: activity.host.id })">read more</a></span></div><button ng-show="!activity.host.self" type="button" class="visible-xs btn btn-messages btn-outline btn-block marginTop" ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))"><i class="ico ico-message"></i>Contact host</button></div><div class="activityJoinerList sectionContent mobileFullPadding noPadding noPaddingBottom borderBottom" ng-if="activity.joiners.length"><div class="clearfix gutterMarginBottom"><h2 class="pull-left">Joiners</h2><button ng-show="activity.host.self" type="button" class="pull-right hidden-xs btn btn-messages btn-outline" ng-click="newMessage(activity.joiners, activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))"><i class="ico ico-message"></i>Message all joiners</button></div><div class="gutterMarginBottom vAlignParent full-width" ng-repeat="person in activity.joiners"><div class="vAlign"><div class="vAlignParent"><div class="vAlign spacingRight avatar"><a ui-sref="contacts.public({ userId: person.id })"><span class="circlePhoto activities med" ng-class="{\'noPhoto\' : !person.avatar}" style="background-image:url(\'{{ person.avatar }}\')"></span></a></div><div class="vAlign"><div class="h3 truncate"><span>{{ person.name }}</span></div><div ng-if="person.rating"><review-stars theme="contacts med" value="person.rating"></review-stars></div><div>Spots booked: {{ person.spotsBooked }}</div></div></div></div><div class="vAlign text-right noFontSize" ng-if="person.id !== auth.currentUser.hashId"><button type="button" class="btn btn-messages btn-outline no-margins" ng-click="newMessage([person])"><i class="ico ico-message noSpacingXS noSpacingSM"></i><span class="hidden-xs hidden-sm">Message</span></button> <button ng-if="activity.host.self" type="button" class="btn btn-red btn-outline" ng-click="removeJoiner(person)"><i class="ico ico-cross noSpacingXS noSpacingSM"></i><span class="hidden-xs hidden-sm">Remove</span></button> <button ng-if="!activity.host.self && !person.friend && !person.contactRequestSent" type="button" class="btn btn-contacts btn-outline" ng-click="sendContactRequest(person)"><i class="ico ico-person-plus noSpacingXS noSpacingSM"></i><span class="hidden-xs hidden-sm">Add contact</span></button> <button ng-if="person.justSentRequest" type="button" class="btn btn-green"><i class="ico ico-tick no-margins"></i></button></div></div><button ng-show="activity.host.self" type="button" class="visible-xs btn btn-messages btn-outline btn-block marginTop marginBottom" ng-click="newMessage(activity.joiners, activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))"><i class="ico ico-message"></i>Message all joiners</button></div></div><div class="col-sm-5 hidden-xs" sticky keep-in-parent="true"><div class="photoGallery relative"><slick settings="slickConfig"><div class="activityImage lrg" style="background-image: url({{ activity.bannerImage || (\'/img/landing/lrg/A\' + activity.interests[0].id + \'-1.jpg\') }})"></div><div ng-repeat="photoURL in activity.photoGallery" class="activityImage lrg" style="background-image: url({{ photoURL }})"></div></slick><a class="btn btn-white abs topRight" ng-click="shareActivity()"><i class="fas fa-share-alt"></i>Share</a> <a class="btn btn-white abs bottomLeft" ng-click="openPhotoGallery()"><i class="ico ico-picture noSpacingSM"></i><span class="hidden-sm">Photos</span></a></div><div class="activityJoinBar"><div class="vAlignParent full-width gutterMarginTop"><div class="vAlign"><p><strong>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</strong><span ng-if="activity.budget.totalPerPerson > 0"> per person</span></p><div ng-if="activity.bestOffer" class="profileColour small smallMarginTop"><i class="ico ico-offer-tag marginRight"></i>Up to {{ activity.bestOffer.type === 1 ? (activity.bestOffer.amount|currencyDisplay:activity.budget.currency) : (activity.bestOffer.amount + \'%\') }} off for groups!</div></div><div class="vAlign text-right"><div ng-show="!activity.host.self && !activity.alreadyJoined"><div ng-show="activity.customBookingURL"><a class="btn btn-profile" ng-click="bookOffsiteActivity()" href="{{ activity.customBookingURL }}" target="_blank"><i class="ico ico-activities-plus"></i>Book now</a></div><div ng-show="!activity.customBookingURL && activity.flexible && activity.status == \'open\'"><a class="btn btn-profile" ng-click="bookFlexibleActivity()"><i class="ico ico-calendar"></i>See dates</a></div><div ng-show="!activity.customBookingURL && !activity.flexible && activity.seriesDates.length > 1"><a class="btn btn-profile" ng-click="bookRepeatingActivity()"><i class="ico ico-calendar"></i>See dates</a></div><div ng-show="!activity.customBookingURL && !activity.flexible && activity.seriesDates.length === 1"><a class="btn btn-profile" ng-show="activity.status == \'open\' && (activity.spacesLeft == \'Unlimited\' || activity.spacesLeft > 0)" ng-click="joinActivity()"><i class="ico ico-activities-plus"></i>Book now</a><div class="h3 activityColour" ng-if="activity.status == \'open\' && activity.spacesLeft == 0">Fully booked</div><div class="h3 redColour" ng-if="activity.status == \'cancelled\'">Cancelled</div><div class="h3 activityColour" ng-if="activity.status == \'closed\'">Closed</div><div class="h3 activityColour" ng-if="activity.status == \'completed\'">Ended</div></div></div><div ng-show="activity.host.self" class="btn-group dropup"><button type="button" class="btn btn-activities dropdown-toggle" data-toggle="dropdown">Manage activity<span class="caret"></span></button><ul class="dropdown-menu full-width"><li ng-show="(activity.status == \'open\' || activity.status == \'draft\') && !activity.confirmedFlexibleBooking"><a ng-click="editActivity(activity)">Edit activity</a></li><li ng-show="activity.status == \'open\' && !activity.confirmedFlexibleBooking"><a ng-click="sendInvites(activity)">Send invites</a></li><li ng-show="activity.joiners.length"><a ng-click="newMessage(activity.joiners, activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Message joiners</a></li><li ng-show="activity.status != \'draft\'"><a ng-click="discussionBoard(activity)">Discussion board</a></li><li><a ng-click="copyActivity(activity)">Copy activity</a></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'" role="separator" class="divider"></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'"><a ng-click="cancelActivity(activity)">Cancel activity</a></li><li ng-show="activity.deletable" class="divider"></li><li ng-show="activity.deletable"><a ng-click="deleteActivity()">Delete activity</a></li></ul></div><div ng-show="activity.alreadyJoined" class="btn-group dropup"><button type="button" class="btn btn-activities dropdown-toggle" data-toggle="dropdown">Manage booking<span class="caret"></span></button><ul class="dropdown-menu full-width"><li ng-show="activity.status == \'open\'"><a ng-click="sendInvites(activity)">Share activity</a></li><li><a ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Contact host</a></li><li><a ng-click="discussionBoard(activity)">Discussion board</a></li></ul></div></div></div></div><div class="shareBar activities row noGutter text-center"><a class="col-xs-3" ng-click="shareFacebook()"><i class="ico ico-facebook"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{ shareText.twitter | encodeURI }}&url={{ activity.publicUrl | encodeURI }}&related=HulaHubHQ"><i class="ico ico-twitter"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{ shareText.email.subject }}&body={{ shareText.email.body | encodeURI }}"><i class="ico ico-message"></i></a> <a class="col-xs-3" ngclipboard data-clipboard-text="{{ activity.publicUrl }}" ngclipboard-success="onClipboardSuccess(e)"><i class="ico" ng-class="{\'ico-documents\': !linkCopiedToClipboard, \'ico-tick\': linkCopiedToClipboard}"></i></a></div><div ng-if="activity.seriesDates.length > 1" class="gutterMarginTop text-center small">Prices and locations may vary depending on the date you select</div></div></div><div class="row" ng-if="!activity.host.self && relatedActivities.length"><div class="col-xs-12"><div class="sectionContent mobileFullPadding noPadding noPaddingBottom activityListMaximum2Tablet"><h2 class="marginBottom">Other activities you may like</h2><div class="activitiesContainer maximum2Tablet"><div class="row halfGutter gridLayout"><activity-card ng-repeat="activity in relatedActivities"></activity-card></div></div></div></div></div></div><div class="visible-xs"><div id="floatingFooterBar" class="vAlignParent full-width" ng-show="!activity.host.self && !activity.alreadyJoined && activity.status == \'open\'"><div class="vAlign"><div class="h3">{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}<span class="notBold" ng-if="activity.budget.totalPerPerson > 0"> per person</span></div><div ng-if="activity.bestOffer" class="profileColour small smallMarginTop"><i class="ico ico-offer-tag marginRight"></i>Up to {{ activity.bestOffer.type === 1 ? (activity.bestOffer.amount|currencyDisplay:activity.budget.currency) : (activity.bestOffer.amount + \'%\') }} off for groups!</div></div><div class="vAlign text-right col-xs-5 noPadding"><a class="btn btn-profile" ng-show="activity.customBookingURL" href="{{ activity.customBookingURL }}" target="_blank"><i class="ico ico-activities-plus"></i>Book now</a> <a class="btn btn-profile" ng-show="!activity.customBookingURL && activity.flexible" ng-click="bookFlexibleActivity()"><i class="ico ico-calendar"></i>See dates</a> <a class="btn btn-profile" ng-show="!activity.customBookingURL && !activity.flexible && activity.seriesDates.length > 1" ng-click="bookRepeatingActivity()"><i class="ico ico-calendar"></i>See dates</a> <a class="btn btn-profile" ng-show="!activity.customBookingURL && !activity.flexible && activity.seriesDates.length === 1 && (activity.spacesLeft == \'Unlimited\' || activity.spacesLeft > 0)" ng-click="joinActivity()"><i class="ico ico-activities-plus"></i>Book now</a></div></div></div>'),
$templateCache.put("activities/views/browse.html",'<section class="row white-bg marginBottom sectionContent"><div class="row halfGutter"><div class="col-xs-12 col-sm-6" ng-class="{\'col-md-5\': formData.text || formData.location, \'col-md-6\': !formData.text && !formData.location}"><div class="form-group gutterMarginBottomXSOnly"><div class="clearableInput iconInput notClickable"><i class="ico ico-search"></i> <input ng-model="formData.text" type="text" placeholder="Search an activity you want to do" class="form-control" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="loading=true"> <i class="fas fa-times-circle" ng-show="formData.text" ng-click="loading=true; formData.text=null"></i></div></div></div><div class="col-xs-12 col-sm-6" ng-class="{\'col-md-5\': formData.text || formData.location, \'col-md-6\': !formData.text && !formData.location}"><div class="form-group no-margins"><location-search data="formData.location" placeholder="Search a postcode, town or area"></location-search></div></div><div class="col-xs-12 col-md-2 text-xs-right text-md-left" ng-show="formData.text || formData.location"><a class="activities saveSearchButton" ng-click="saveSearch()">Save this search</a></div></div><div class="row halfGutter gutterMarginTop visible-xs"><div class="col-xs-6"><button class="btn btn-activities btn-block" ng-click="showFilterModal()">Advanced filter</button></div><div class="col-xs-6"><div class="dropdown"><button class="btn btn-activities btn-outline btn-block dropdown-toggle" type="button" data-toggle="dropdown">Sort by<span class="caret caretAbsolute"></span></button><ul class="dropdown-menu dropdown-menu-right minWidth100"><li ng-repeat="option in formData.sort.options | filter:formData.sort.optionShouldShow"><a ng-click="changeSortOption(option.key)">{{ option.value }}</a></li></ul></div></div></div></section><div class="desktopFilters hidden-xs text-center gutterMarginBottom half"><filter-popup data="formData.filters.date" template="activities/views/partials/filters/date.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.time" type="time" template="activities/views/partials/filters/time.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.price" template="activities/views/partials/filters/price.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.age" template="activities/views/partials/filters/age.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.gender" template="activities/views/partials/filters/gender.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.difficultyLevel" template="activities/views/partials/filters/difficultyLevel.html" theme="activities" on-apply="formData.search(true)"></filter-popup><filter-popup data="formData.filters.other" template="activities/views/partials/filters/other.html" theme="activities" on-apply="formData.search(true)"></filter-popup></div><div class="appliedFiltersContainer visible-xs text-center gutterMarginBottom" ng-show="formData.filters.hasFilters()"><span class="tag" ng-click="formData.filters.date.useRange(\'all\'); formData.search(true);" ng-if="formData.filters.date.selectedRange!=\'all\'">{{ formData.filters.date.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.time.useRange(\'all\'); formData.search(true);" ng-if="formData.filters.time.selectedRange!=\'all\'">{{ formData.filters.time.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.price.useRange(\'all\'); formData.search(true);" ng-if="formData.filters.price.selectedRange!=\'all\'">{{ formData.filters.price.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.age.useRange(\'all\'); formData.search(true);" ng-if="formData.filters.age.selectedRange!=\'all\'">{{ formData.filters.age.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.gender.value=\'u\'; formData.search(true);" ng-if="formData.filters.gender.value != \'u\'">{{ formData.filters.gender.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.difficultyLevel.value=0; formData.search(true);" ng-if="formData.filters.difficultyLevel.value != 0">{{ formData.filters.difficultyLevel.getLabel() }}<i class="fas fa-times fixedSize"></i></span> <span class="tag" ng-click="formData.filters.other.value.unique=false; formData.search(true);" ng-if="formData.filters.other.value.unique">Featured<i class="fas fa-times fixedSize"></i></span></div><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div class="row" ng-show="!loading"><div class="vAlignParent full-width marginBottom"><div class="vAlign text-center text-sm-left h2"><strong>{{ results.totalCount|number }} {{ formData.text }} <span ng-pluralize count="results.totalCount" when="{\'1\': \'activity\', \'other\': \'activities\'}"></span><span ng-show="formData.location"> near {{ formData.location.locality }}</span></strong> <span class="visible-xs" style="margin-top:5px" ng-show="results.totalCount > 0">Sorted by <span>{{ formData.sort.getLabel() }}</span></span></div><div class="vAlign hidden-xs text-right form-inline"><label>Sort by:</label><select class="form-control" ng-options="option.key as option.value for option in formData.sort.options | filter:formData.sort.optionShouldShow" ng-model="formData.sort.value" ng-change="formData.sort.manuallyChangedSortOption=true"></select></div></div><div class="activitiesContainer search" ng-show="!loading"><div ng-show="results.totalCount == 0" class="text-xs-center text-sm-left"><p class="gutterMarginBottom half">OK so we need to work on this! We\'re adding new activities every day and we\'ll prioritise your search.</p><p class="marginBottom">We can notify you as soon as we have matching activities.</p><a class="btn btn-profile btn-outline" ng-click="suggestActivity()">Yes, notify me</a></div><div ng-show="results.totalCount > 0" class="row halfGutter gridLayout"><activity-card ng-repeat="activity in results.activities"></activity-card></div></div><div class="pagination vAlignParent full-width" ng-if="results.pagination.totalPages > 1"><div class="vAlign"><a class="btn btn-activities" ng-class="{\'invisible\': formData.pagination.current==1}" ng-click="changePage(formData.pagination.current-1)"><i class="ico ico-chevron-left noSpacingXS"></i><span class="hidden-xs">Back</span></a></div><div class="vAlign text-center"><ul class="list-unstyled list-inline no-margins"><li><a class="activities underlineOnHover" ng-class="{\'current\': formData.pagination.current == 1}" ng-click="changePage(1)">1</a></li><li class="hidden-xs" ng-show="formData.pagination.current >= 5">...</li><li class="visible-xs-inline" ng-show="formData.pagination.current >= 3">...</li><li ng-repeat="page in results.pagination.pages" ng-class="{\'hidden-xs\': page !== formData.pagination.current}"><a class="activities underlineOnHover" ng-class="{\'current\': page == formData.pagination.current}" ng-click="changePage(page)">{{ page|number }}</a></li><li class="hidden-xs" ng-show="formData.pagination.current <= results.pagination.totalPages-4">...</li><li class="visible-xs-inline" ng-show="formData.pagination.current <= results.pagination.totalPages-2">...</li><li><a class="activities underlineOnHover" ng-class="{\'current\': formData.pagination.current == results.pagination.totalPages}" ng-click="changePage(results.pagination.totalPages)">{{ results.pagination.totalPages|number }}</a></li></ul></div><div class="vAlign text-right"><a class="btn btn-activities iconRight" ng-class="{\'invisible\': formData.pagination.current==results.pagination.totalPages}" ng-click="changePage(formData.pagination.current+1)"><span class="hidden-xs">Next</span><i class="ico ico-chevron-right noSpacingXS"></i></a></div></div><div ng-show="results.totalCount > 0" class="col-xs-12 text-center marginTop gutterMarginBottomXSOnly"><p class="smallMargin"><strong>Can\'t find your perfect match?</strong></p><p class="marginBottom">We\'re building coverage fast and always on the lookout for new activities.<br>Let us know what we\'re missing and we\'ll get straight on the case!</p><a class="btn btn-profile btn-outline" ng-click="suggestActivity()">Suggest an activity</a></div></div>'),$templateCache.put("activities/views/discussion-board.html",'<section id="discussionBoard" class="row"><section-header text="Discussion board" type="activities"><a class="btn btn-outline btn-activities" ng-click="scrollToForm()"><i class="ico ico-chat-boxes noSpacingXS"></i><span class="hidden-xs">Write post</span></a></section-header><div class="img bgFade activities" style="background-image: url({{ activity.bannerImage || (\'/img/landing/lrg/A\' + activity.interests[0].id + \'-1.jpg\') }})"><div class="topLayer"><div class="abs topLeft activityInterestList"><span class="label activities" ng-repeat="interest in activity.interests">{{ interest.name }}</span></div><span class="abs bottom h1">{{ activity.title }}</span> <a ng-if="$state.includes(\'activities.hosted\')" class="abs topRight btn btn-outline btn-white" ui-sref="activities.hosted.view.info({activityId: activity.id})"><i class="ico ico-super-man noSpacingXS"></i><span class="hidden-xs">View activity</span></a> <a ng-if="$state.includes(\'activities.joined\')" class="abs topRight btn btn-outline btn-white" ui-sref="activities.joined.view.info({activityId: activity.id})"><i class="ico ico-super-man noSpacingXS"></i><span class="hidden-xs">View activity</span></a></div></div><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading"><section class="gutterMarginTop text-center white-bg sectionContent" ng-if="!posts.length"><p class="h3">No comments or questions have been posted yet</p></section><section class="comment gutterMarginTop" ng-repeat="post in posts"><div ng-if="post.deleted" class="text-center"><em class="greyColour">This post has been deleted</em></div><div class="sectionContent white-bg" ng-show="!post.deleted"><div class="clearfix"><div class="fixedColumn"><span ui-sref="contacts.public({ userId: post.author.id })" class="circlePhoto med activities" ng-class="{\'noPhoto\' : !post.author.avatarURL}" style="background-image:url(\'{{ post.author.avatarURL }}\')"></span></div><div class="postContent"><div class="row noGutter"><p class="col-xs-12 col-sm-8 h3"><a ui-sref="contacts.public({ userId: post.author.id })" class="activities underlineOnHover">{{ post.author.name }} <i ng-if="post.author.id == activity.host.id" class="ico ico-person"></i></a></p><p class="col-xs-12 col-sm-4 text-xs-left text-sm-right greyColour no-margins">{{ post.created | dateFormat:\'DD/MM/YYYY [at] HH:mm\' }}</p></div><div class="gutterMarginTop gutterMarginBottom half" ng-bind-html="post.text | nl2br | sanitize"></div><div class="text-right" ng-show="auth.currentUser.hashId == activity.host.id || auth.currentUser.hashId == post.author.id"><a ng-click="deletePost(post)" class="circleButton red" uib-tooltip="Delete post"><i class="ico ico-trash"></i></a></div></div></div></div></section><form id="discussionForm" name="form" class="gutterMarginTop sectionContent" novalidate autocomplete="off"><div class="form-group"><profile-photo class="med activities"></profile-photo><label>Leave a comment or question</label><textarea class="form-control" rows="6" ng-model="newPost" required></textarea></div><div class="text-right"><button class="btn btn-activities btn-outline" type="button" ng-click="savePost()" ng-disabled="form.$invalid"><i class="ico ico-message-fly"></i>Post</button></div></form></div></section>'),$templateCache.put("activities/views/external-activity.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-if="notFound" class="h2 show text-center">This activity does not exist, or has been removed.</div><div class="row" ng-if="!loading && !notFound"><div class="profileBackground visible-xs gutterMarginBottom" style="height: 300px; background-image: url({{ activity.bannerImage || (\'/img/landing/sml/A\' + activity.interests[0].id + \'-1.jpg\') }})"><div class="topLayer text-center"><a class="btn btn-white abs topRight" ng-click="shareActivity()"><i class="fas fa-share-alt noSpacingXS"></i><span class="hidden-xs">Share</span></a></div></div><div class="row"><div class="col-xs-12 col-sm-7"><h1 class="marginBottom">{{ activity.title }}</h1><div>Hosted by {{ activity.host.name }}</div><div class="sectionContent mobileFullPadding noPadding borderBottom"><ul class="list-unstyled iconBulletList noMarginBottom"><li ng-if="!activity.budget.totalPerPerson"><i class="ico ico-coins"></i><span>Price: <strong>Contact host</strong></span></li><li ng-if="activity.budget.totalPerPerson"><i class="ico ico-coins"></i><span>Price: <strong>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</strong><span ng-if="activity.budget.totalPerPerson > 0"> per person</span></span></li><li><i class="ico ico-pin"></i><span>Location: <strong>{{ activity.startLocation.locality }}</strong> (<a class="activities" ng-click="scrollTo(\'mapSection\')">view map</a>)</span></li><li><i class="ico ico-clock"></i><span>Duration: <strong>{{ activity.duration }}</strong> (<a class="activities" ng-click="scrollTo(\'instanceSection\')">view dates</a>)</span></li></ul><div class="marginTop" ng-show="showBookButtons && activity.checkoutUrl"><div ng-show="activity.closed" class="h3 activityColour">Ended</div><div ng-show="!activity.closed && activity.spotsBooked > 0" class="h3 activityColour">Already booked</div><a ng-show="!activity.closed && activity.spotsBooked == 0" ng-click="bookActivity()" class="btn btn-profile btn-block-xs"><i class="ico ico-activities-plus"></i>Book now</a></div></div><div class="shareBar activities row noGutter text-center visible-xs"><a class="col-xs-3" ng-click="shareFacebook()"><i class="ico ico-facebook"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{ shareText.twitter | encodeURI }}&url={{ activity.publicUrl | encodeURI }}&related=HulaHubHQ"><i class="ico ico-twitter"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{ shareText.email.subject }}&body={{ shareText.email.body | encodeURI }}"><i class="ico ico-message"></i></a> <a class="col-xs-3" ngclipboard data-clipboard-text="{{ activity.publicUrl }}" ngclipboard-success="onClipboardSuccess(e)"><i class="ico" ng-class="{\'ico-documents\': !linkCopiedToClipboard, \'ico-tick\': linkCopiedToClipboard}"></i></a></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><div class="labelContainer"><span class="label grey notBold" ng-repeat="interest in activity.interests">{{ interest.name }}</span></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><h2 class="gutterMarginBottom">Who is this activity aimed at?</h2><div class="row noGutter"><div class="col-xs-4"><i class="ico ico-cake marginRight"></i><span class="hidden-xs hidden-sm marginRight">Age:</span><strong ng-hide="activity.ageMax">{{ activity.ageMin }}+</strong><strong ng-show="activity.ageMax">{{ activity.ageMin }}-{{ activity.ageMax }}</strong></div><div class="col-xs-4"><i class="ico ico-gender marginRight"></i><span class="hidden-xs hidden-sm marginRight">Gender:</span><strong>{{ activity.gender | genderDisplay }}</strong></div><div class="col-xs-4"><i class="ico ico-level marginRight"></i><span class="hidden-xs hidden-sm marginRight">Level:</span><strong>Mixed</strong></div></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom"><h2 class="gutterMarginBottom">About this activity</h2><div class="hidden-xs" ng-bind-html="activity.description | nl2br | sanitize"></div><div class="visible-xs" read-more limit="100" link-class="activities" content="{{ activity.description|nl2br }}"></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom" id="mapSection"><h2 class="gutterMarginBottom">Where to find us</h2><div ng-show="!activity.endLocation"><strong>{{ activity.startLocation.name }}</strong></div><ul class="list-unstyled noMarginBottom" ng-show="activity.endLocation"><li>Starts: <strong>{{ activity.startLocation.name }}</strong></li><li>Ends: <strong>{{ activity.endLocation.name }}</strong></li></ul><div class="mapHolder gutterMarginTop"><div id="map"></div><a class="btn btn-white" ng-if="auth.currentUser.homeHub" href="https://www.google.com/maps/dir//{{ activity.startLocation.latitude }},{{ activity.startLocation.longitude }}" target="_blank"><i class="ico ico-directions no-margins"></i></a> <a class="btn btn-white" ng-if="!auth.currentUser.homeHub" href="https://www.google.com/maps/dir/{{ auth.currentUser.homeHub.latitude }},{{ auth.currentUser.homeHub.longitude }}/{{ activity.startLocation.latitude }},{{ activity.startLocation.longitude }}" target="_blank"><i class="ico ico-directions no-margins"></i></a></div></div><div class="sectionContent mobileFullPadding noPadding borderBottom" id="instanceSection"><h2 class="gutterMarginBottom">What\'s available</h2><div class="vAlignParent full-width"><div class="vAlign"><p class="h3 notBold">{{ activity.startDate | dateFormat:\'ddd, D MMM YYYY\' }}</p><div>{{ activity.startDate | dateFormat:\'HH:mm\' }} - {{ activity.endDate | dateFormat:\'HH:mm\' }}</div><div ng-if="!activity.budget.totalPerPerson">Contact host for price</div><div ng-if="activity.budget.totalPerPerson">{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}<span ng-if="activity.budget.totalPerPerson > 0"> per person</span></div></div><div class="vAlign col-xs-4 noPadding text-right"><a class="btn btn-profile" ng-click="bookActivity()"><i class="ico ico-activities-plus"></i>Book now</a></div></div></div></div><div class="col-xs-12 col-sm-5" sticky keep-in-parent="true"><div class="activityImage lrg relative hidden-xs" style="background-image: url({{ activity.bannerImage || (\'/img/landing/lrg/A\' + activity.interests[0].id + \'-1.jpg\') }})"><a class="btn btn-white abs topRight" ng-click="shareActivity()"><i class="fas fa-share-alt noSpacingXS"></i><span class="hidden-xs">Share</span></a></div><div class="activityJoinBar vAlignParent full-width gutterMarginTop hidden-xs"><div class="vAlign"><p ng-if="!activity.budget.totalPerPerson">Contact host for price</p><p ng-if="activity.budget.totalPerPerson"><strong>{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</strong><span ng-if="activity.budget.totalPerPerson > 0"> per person</span></p></div><div class="vAlign text-right" ng-show="activity.checkoutUrl"><div ng-show="activity.closed" class="h3 activityColour">Ended</div><div ng-show="!activity.closed && activity.spotsBooked > 0" class="h3 activityColour">Already booked</div><a ng-show="!activity.closed && activity.spotsBooked == 0" ng-click="bookActivity()" class="btn btn-profile"><i class="ico ico-activities-plus"></i>Book now</a></div></div><div class="shareBar activities row noGutter text-center hidden-xs"><a class="col-xs-3" ng-click="shareFacebook()"><i class="ico ico-facebook"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{ shareText.twitter | encodeURI }}&url={{ activity.publicUrl | encodeURI }}&related=HulaHubHQ"><i class="ico ico-twitter"></i></a> <a class="col-xs-3" ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{ shareText.email.subject }}&body={{ shareText.email.body | encodeURI }}"><i class="ico ico-message"></i></a> <a class="col-xs-3" ngclipboard data-clipboard-text="{{ activity.publicUrl }}" ngclipboard-success="onClipboardSuccess(e)"><i class="ico" ng-class="{\'ico-documents\': !linkCopiedToClipboard, \'ico-tick\': linkCopiedToClipboard}"></i></a></div></div></div><div class="row" ng-if="relatedActivities.length"><div class="col-xs-12"><div class="sectionContent mobileFullPadding noPadding noPaddingBottom activityListMaximum2Tablet"><h2 class="marginBottom">Other activities you may like</h2><div class="activitiesContainer maximum2Tablet"><div class="row halfGutter gridLayout"><activity-card ng-repeat="activity in relatedActivities"></activity-card></div></div></div></div></div></div>'),$templateCache.put("activities/views/form-layout.html",'<div ng-controller="ActivityFormHeaderController"><nav class="navbar navbar-fixed-top headerRow"><div class="container-fluid"><div class="clearfix"><a class="logo pull-left" style="cursor:default"><img src="/img/hh_logo.svg"></a><div class="vAlignParent pull-right"><div class="vAlign spacingRight"><a ng-show="formData.status != \'published\' && formData.status != \'completed\'" class="btn btn-activities btn-outline" ng-click="save()"><i class="ico ico-tick"></i>Save</a></div><div class="vAlign"><a class="textColour underlineOnHover" ng-click="close()"><i class="ico ico-cross" style="margin-right:5px"></i>Close</a></div></div></div></div></nav><div class="breadcrumbRow"><div class="container clearfix"><div class="h3 text-xs-center pull-left-sm pull-left-md pull-left-lg">{{ title }}</div></div></div></div><div id="page-wrapper" class="pageWrapper loggedIn"><div id="main" class="container animated fadeIn"><div ui-view name="content"></div></div></div><div ng-include="\'core/partials/footer.html\'"></div>'),$templateCache.put("activities/views/form.html",'<div class="row alert alert-warning" ng-if="!auth.currentUser.emailVerified">Please verify your email address to publish activities.</div><div class="row"><form name="form" novalidate id="activityDefinitionForm"><div class="stepTracker visible-xs"><div class="text-center stepTitle h3"><strong>{{ formData.steps[formData.currentStep-1] }}</strong></div><div class="bar"><span class="fill" style="width: {{ ((formData.currentStep-1) / 5) * 100 }}%"></span><div class="pips"><div><span ng-click="formData.changeStep(1)" ng-class="{\'active\': formData.currentStep >= 1}">1</span></div><div><span ng-click="formData.changeStep(2)" ng-class="{\'active\': formData.currentStep >= 2}">2</span></div><div><span ng-click="formData.changeStep(3)" ng-class="{\'active\': formData.currentStep >= 3}">3</span></div><div><span ng-click="formData.changeStep(4)" ng-class="{\'active\': formData.currentStep >= 4}">4</span></div><div><span ng-click="formData.changeStep(5)" ng-class="{\'active\': formData.currentStep >= 5}">5</span></div><div><span ng-click="formData.changeStep(6)" ng-class="{\'active\': formData.currentStep >= 6}">6</span></div></div></div></div><div class="formTabs vAlignParent full-width hidden-xs"><div class="vAlign text-center" ng-click="formData.changeStep(1)" ng-class="{\'active\': formData.currentStep == 1}">{{ formData.steps[0] }}</div><div class="vAlign text-center" ng-click="formData.changeStep(2)" ng-class="{\'active\': formData.currentStep == 2}">{{ formData.steps[1] }}</div><div class="vAlign text-center" ng-click="formData.changeStep(3)" ng-class="{\'active\': formData.currentStep == 3}">{{ formData.steps[2] }}</div><div class="vAlign text-center" ng-click="formData.changeStep(4)" ng-class="{\'active\': formData.currentStep == 4}">{{ formData.steps[3] }}</div><div class="vAlign text-center" ng-click="formData.changeStep(5)" ng-class="{\'active\': formData.currentStep == 5}">{{ formData.steps[4] }}</div><div class="vAlign text-center" ng-click="formData.changeStep(6)" ng-class="{\'active\': formData.currentStep == 6}">{{ formData.steps[5] }}</div></div><div ng-show="formData.currentStep == 1" class="sectionContent white-bg"><div class="form-group"><h2 class="gutterMarginBottom half">Activity visibility<a class="small activities marginLeft" ng-click="showHelp(\'activity_visibility\')">Tips &amp; examples</a></h2><p>Select whether your activity should be visible to anyone using HulaHub or only specific people you invite.</p><div class="radioControl"><div class="radioButton clearfix activities" ng-class="{\'active\' : !formData.private}" ng-click="formData.private = false"><div class="pull-left radio"></div><label class="pull-left"><strong>My activity is public</strong></label></div><div class="radioButton clearfix activities" ng-class="{\'active\' : formData.private}" ng-click="formData.private = true"><div class="pull-left radio"></div><label class="pull-left"><strong>My activity is private</strong></label></div></div></div><div class="form-group" ng-class="{\'has-error\': formData.validationRun && form.$error.interestCount}"><h2 class="marginTop gutterMarginBottom half">Activity tags*<a class="small activities marginLeft" ng-click="showHelp(\'activity_tags\')">Tips &amp; examples</a></h2><p>Add tags to your activities so they are easy for people to find by searching and filtering.</p><div class="row noGutter"><div class="col-xs-12 col-sm-6"><angucomplete-alt id="interestSearchBox" class="angucomplete-theme-activities" input-class="form-control" pause="400" remote-api-handler="formData.loadInterests" selected-object="formData.selectedInterest" title-field="name" focus-first="true" minlength="1" template-url="autocomplete-add-new-tags.html"></angucomplete-alt><script type="text/ng-template" id="autocomplete-add-new-tags.html"><div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}">\n                                <input ng-model="searchStr"\n                                       ng-disabled="disableInput"\n                                       type="text"\n                                       ng-focus="onFocusHandler()"\n                                       class="{{inputClass}}"\n                                       ng-focus="resetHideResults()"\n                                       ng-blur="hideResults($event)"\n                                       autocapitalize="off"\n                                       autocorrect="off"\n                                       autocomplete="off"\n                                       ng-change="inputChangeHandler(searchStr)"/>\n                                <div class="angucomplete-dropdown" ng-show="showDropdown">\n                                    <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>\n                                    <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>\n\n                                    <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': currentIndex == $index}">\n                                        <div class="angucomplete-title" ng-if="$index == 0 && result.originalObject.id === result.originalObject.name"><em>"{{ result.title }}"</em></div>\n                                        <div class="angucomplete-title" ng-if="$index > 0 || result.originalObject.id !== result.originalObject.name">{{ result.title }}</div>\n                                    </div>\n                                </div>\n                            </div></script><span class="help-block text-right" ng-show="formData.interests.length == 0">1 tag needed</span> <span class="help-block text-right" ng-show="formData.interests.length > 0">{{ 10 - formData.interests.length }} tag<span ng-show="formData.interests.length !== 9">s</span> remaining</span></div></div></div><div class="row noGutter" ng-if="formData.interests.length"><div class="form-group col-xs-12"><div class="tagListContainer labelContainer"><span class="label activities" ng-repeat="interest in formData.interests" ng-click="formData.removeInterest(interest.id)">{{ interest.name }}<i class="fas fa-times fixedSize"></i></span></div></div></div><div class="form-group" ng-class="{\'has-error\': formData.validationRun && form.title.$invalid}"><h2 class="marginTop gutterMarginBottom half">Activity title*<a class="small activities marginLeft" ng-click="showHelp(\'activity_title\')">Tips &amp; examples</a></h2><p>Make the title descriptive and try to include words that provide context.</p><div class="row noGutter"><div class="col-xs-12 col-sm-6"><input class="form-control" ng-model="formData.title" type="text" name="title" required minlength="10" maxlength="65"><character-count min="10" max="65" text="form.title.$viewValue"></character-count></div></div></div><h2 class="marginTop gutterMarginBottom half">Activity description<a class="small activities marginLeft" ng-click="showHelp(\'activity_description\')">Tips &amp; examples</a></h2><div class="marginBottom">The more information you provide the better so add as many sections as you need to. Make sure to highlight what makes your activity special so that it stands out to people who may be interested in joining.</div><div class="form-group" ng-class="{\'has-error\': formData.validationRun && form.summary.$invalid}"><h3 class="gutterMarginBottom half">Short overview*<a class="small activities marginLeft" ng-click="showHelp(\'activity_overview\')">Tips &amp; examples</a></h3><p>The short overview is the first thing people will see, so write a short and eye catching paragraph!</p><textarea class="form-control" rows="4" ng-model="formData.summary" name="summary" ng-required="formData.publishing" minlength="150" maxlength="300"></textarea><character-count min="150" max="300" text="form.summary.$viewValue"></character-count></div><div class="form-group" ng-class="{\'has-error\': formData.validationRun && form.description.$invalid}"><h3 class="gutterMarginBottom half">What we\'ll do*<a class="small activities marginLeft" ng-click="showHelp(\'what_we\\\'ll_do\')">Tips &amp; examples</a></h3><textarea class="form-control" rows="8" ng-model="formData.description" name="description" ng-required="formData.publishing" minlength="200" maxlength="1000"></textarea><character-count min="200" max="1000" text="form.description.$viewValue"></character-count></div><div class="form-group no-margins" ng-class="{\'has-error\' : form.attachmentButton.$error.maxSize }"><h2 class="marginTop smallMargin">Add attachments<a class="small activities marginLeft" ng-click="showHelp(\'attachments\')">Tips &amp; examples</a></h2><p class="marginBottom">Use this section to add any documents like insurance waivers. You can add a maximum of 3 attachments, up to 1MB each.</p><ul class="list-unstyled marginBottom"><li class="gutterMarginBottom half" ng-repeat="file in formData.attachments"><i class="ico ico-document"></i><span class="marginLeft">{{ file.name }}</span><a class="redColour marginLeft" ng-click="formData.removeAttachment($index)"><i class="ico ico-trash"></i></a></li></ul><a class="btn btn-activities btn-outline" ng-show="formData.attachments.length < 3" ngf-select ng-model="formData.attachments" name="attachmentButton" ngf-multiple="true" ngf-keep="true" ngf-pattern="\'image/*,application/pdf\'" ngf-accept="\'image/*,application/pdf\'" ngf-max-files="3" ngf-max-size="1MB" ngf-capture="\'camera\'"><i class="ico ico-attach"></i>Add attachment</a><div class="help-block" ng-show="form.attachmentButton.$error.maxSize">An attachment you have selected is too large.</div></div></div><div ng-show="formData.currentStep == 2" class="sectionContent white-bg"><h2 class="gutterMarginBottom half">Add activity photos</h2><p>Add great looking photos that will attract people to your activity.</p><h3 class="gutterMarginBottom half">Cover photo*<a class="small activities marginLeft" ng-click="showHelp(\'activity_cover_photo\')">Tips &amp; examples</a></h3><p>Choose a photo that represents your activity. This is the main image displayed on the results page and the first image on the main activity page.</p><div class="form-group" ng-class="{\'has-error\' : formData.publishing && (!formData.bannerImage || formData.bannerImage == \'delete\') }"><div ng-show="!formData.bannerImage || formData.bannerImage == \'delete\'" class="uploadBannerImageContainer text-center"><a class="btn btn-activities btn-outline" ng-click="formData.changeBannerImage()"><i class="ico ico-picture-plus"></i>Add a photo</a></div><div class="help-block" ng-show="formData.publishing && (!formData.bannerImage || formData.bannerImage == \'delete\')">A main photo is required</div><div class="row halfGutter" ng-show="formData.bannerImage && formData.bannerImage != \'delete\'"><div class="col-xs-12 col-sm-5"><div class="mainPreviewImage gutterMarginBottom half" ngf-background="formData.bannerImage"><button type="button" class="btn btn-red abs topRight" ng-click="formData.clearBannerImage()"><i class="ico ico-trash no-margins"></i></button></div><div class="small">This is how your photo will appear on the main activity page</div></div><div class="hidden-xs col-sm-4"><div class="searchResultsPreviewImage gutterMarginBottom half" ngf-background="formData.bannerImage"></div><div class="small">This is how your photo will appear in search results</div></div></div></div><h3 class="gutterMarginBottom half">Photo gallery<a class="small activities marginLeft" ng-click="showHelp(\'photo_gallery\')">Tips &amp; examples</a></h3><div>Add up to 9 additional photos that paint a picture of your activity. You can drag your photos so that theyâre in your preferred order.</div><div class="row halfGutter" ui-sortable="formData.photoGallery.options" ng-model="formData.photoGallery.photos"><div class="col-xs-4 photoGalleryImage" ng-repeat="photo in formData.photoGallery.photos"><div class="image" ngf-background="photo.data"><button type="button" class="btn btn-red abs topRight" ng-click="formData.removePhotoGalleryImage($index)"><i class="ico ico-trash no-margins"></i></button></div></div><div class="col-xs-4 photoGalleryImage" ng-show="formData.photoGallery.photos.length < 9"><div class="uploadPhotoGalleryImageContainer text-center"><a class="btn btn-activities btn-outline" ng-click="formData.addPhotoGalleryImage()"><i class="ico ico-picture-plus"></i>Add a photo</a></div></div></div></div><div ng-show="formData.currentStep == 3" class="sectionContent white-bg"><div class="form-group" ng-class="{\'has-error\': form.groupSizeMin.$invalid || form.groupSizeMax.$invalid}"><h2 class="gutterMarginBottom half">How many spots are available for your activity?*<a class="small activities marginLeft" ng-click="showHelp(\'spots_available\')">Tips &amp; examples</a></h2><p>Specify the minimum and/or maximum number of people that can attend your activity.</p><div class="vAlignParent"><input class="vAlign form-control fixedWidth" integer-only-input ng-model="formData.groupSize[0]" placeholder="Minimum" type="number" name="groupSizeMin" required min="1" max="{{ formData.groupSize[1] }}"> <span class="vAlign inputRangeHyphen">-</span> <input class="vAlign form-control fixedWidth" integer-only-input ng-model="formData.groupSize[1]" placeholder="No limit" type="number" name="groupSizeMax" min="{{ formData.groupSize[0] }}"></div><div class="help-block" ng-show="form.groupSizeMin.$invalid || form.groupSizeMax.$invalid">This is not a valid range</div></div><div class="form-group"><h2 class="marginTop gutterMarginBottom half">Difficulty level</h2><p>Let people know what level of skill is required to attend your activity. If all levels are welcome, please select mixed.</p><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.difficultyLevel == 0}" ng-click="formData.difficultyLevel = 0"><div class="pull-left radio"></div><label class="pull-left">Mixed</label></div><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.difficultyLevel == 1}" ng-click="formData.difficultyLevel = 1"><div class="pull-left radio"></div><label class="pull-left">Beginner</label></div><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.difficultyLevel == 2}" ng-click="formData.difficultyLevel = 2"><div class="pull-left radio"></div><label class="pull-left">Intermediate</label></div><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.difficultyLevel == 3}" ng-click="formData.difficultyLevel = 3"><div class="pull-left radio"></div><label class="pull-left">Advanced</label></div></div><div class="form-group" ng-class="{\'has-error\': form.ageMin.$invalid || form.ageMax.$invalid}"><h2 class="marginTop gutterMarginBottom half">Age limits*<a class="small activities marginLeft" ng-click="showHelp(\'age_limits\')">Tips &amp; examples</a></h2><p>Specify the minimum and/or the maximum age required to attend your activity.</p><div class="vAlignParent"><input class="vAlign form-control fixedWidth" integer-only-input ng-model="formData.age[0]" placeholder="Minimum" type="number" name="ageMin" required min="0" max="{{ formData.age[1] }}"> <span class="vAlign inputRangeHyphen">-</span> <input class="vAlign form-control fixedWidth" integer-only-input ng-model="formData.age[1]" placeholder="No limit" type="number" name="ageMax" min="{{ formData.age[0]+1 }}"></div><div class="help-block" ng-show="form.ageMin.$invalid || form.ageMax.$invalid">This is not a valid range</div></div><div class="form-group"><h2 class="marginTop gutterMarginBottom half">Gender</h2><p>If your activity is gender specific please select the appropriate option, otherwise leave the mixed option selected.</p><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.gender == \'u\'}" ng-click="formData.gender = \'u\'"><div class="pull-left radio"></div><label class="pull-left">Mixed</label></div><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.gender == \'f\'}" ng-click="formData.gender = \'f\'"><div class="pull-left radio"></div><label class="pull-left">Female only</label></div><div class="radioButton clearfix activities" ng-class="{\'active\' : formData.gender == \'m\'}" ng-click="formData.gender = \'m\'"><div class="pull-left radio"></div><label class="pull-left">Male only</label></div></div><div class="form-group no-margins" ng-class="{\'has-error\': formData.validationRun && form.additionalRequirements.$invalid}"><h2 class="marginTop gutterMarginBottom half">Who is this activity aimed at?*<a class="small activities marginLeft" ng-click="showHelp(\'who_is_this_activity_aimed_at?\')">Tips &amp; examples</a></h2><p>Keep in mind that someone booking your activity might book spots for other people. Use this section to describe the type of person and skills that they would need to normally participate in this activity.</p><textarea class="form-control" rows="4" ng-model="formData.additionalRequirements" name="additionalRequirements" ng-required="formData.publishing" minlength="50" maxlength="500"></textarea><character-count min="50" max="500" text="form.additionalRequirements.$viewValue"></character-count></div></div><div ng-show="formData.currentStep == 4" class="sectionContent white-bg"><div class="form-group"><h2 class="gutterMarginBottom half">Activity location<a class="small activities marginLeft" ng-click="showHelp(\'activity_location\')">Tips &amp; examples</a></h2><p>Choose whether your activity has a fixed location, or whether you are willing to travel within a certain area to provide the activity</p><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.locationType == \'fixed\'}" ng-click="formData.locationType = \'fixed\'"><div class="pull-left radio"></div><label class="pull-left">Fixed location</label></div><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.locationType == \'flexible\'}" ng-click="formData.locationType = \'flexible\';formData.meetingPoint = \'public\';formData.hasEndLocation = false"><div class="pull-left radio"></div><label class="pull-left">Flexible location</label></div></div><div class="form-group" ng-class="{\'has-error\' : formData.validationRun && form.$error.startLocation }"><h3 class="gutterMarginBottom half" ng-show="!formData.hasEndLocation && formData.locationType == \'fixed\'">Enter the address where your activity takes place<a class="small activities marginLeft" ng-click="showHelp(\'activity_address\')">Tips &amp; examples</a></h3><h3 class="gutterMarginBottom half" ng-show="formData.hasEndLocation">Enter the start address<a class="small activities marginLeft" ng-click="showHelp(\'activity_address\')">Tips &amp; examples</a></h3><h3 class="gutterMarginBottom half" ng-show="formData.locationType == \'flexible\'">Enter the city, town or area do you offer your activity<a class="small activities marginLeft" ng-click="showHelp(\'flexible_activity_location\')">Tips &amp; examples</a></h3><div class="row"><div class="col-xs-12 col-sm-6"><div class="vAlignParent full-width"><location-search class="vAlign spacingRight" data="formData.startLocation" placeholder="Search by postcode, street name or area..."></location-search><div class="vAlign" ng-show="formData.meetingPoint == \'private\'"><i class="ico ico-lock"></i></div></div><span class="help-block" ng-show="formData.validationRun && form.$error.startLocation">An activity must have a valid <span ng-show="formData.hasEndLocation">starting </span>location</span></div></div></div><div class="form-group" ng-class="{\'has-error\' : formData.validationRun && form.$error.endLocation }" ng-show="formData.hasEndLocation"><h3 class="gutterMarginBottom half">Enter the end address</h3><div class="row"><div class="col-xs-12 col-sm-6"><div class="vAlignParent full-width"><location-search class="vAlign spacingRight" data="formData.endLocation" placeholder="Search by postcode, street name or area..."></location-search><div class="vAlign" ng-show="formData.meetingPoint == \'private\'"><i class="ico ico-lock"></i></div></div><span class="help-block" ng-show="formData.validationRun && form.$error.endLocation">An activity must have a valid end location</span></div></div></div><div class="row" ng-show="formData.locationType == \'flexible\'"><div class="form-group sliderGroup col-xs-12 col-sm-6"><h3 class="gutterMarginBottom half">How far are you willing to travel?</h3><div class="marginBottom">Let people know how far you are willing to travel from the location above.</div><div class="noUi-extended" ya-no-ui-slider="formData.flexibleLocationDistance"></div></div></div><div class="form-group" ng-show="formData.locationType == \'fixed\'"><div class="vAlignParent"><div class="vAlign spacingRight noFontSize"><switch ng-model="formData.hasEndLocation"></switch></div><label class="vAlign">My activity ends in a different location</label></div></div><div class="form-group" ng-show="formData.locationType == \'fixed\'"><h2 class="marginTop gutterMarginBottom half">How do you want the address to be displayed?<a class="small activities marginLeft" ng-click="showHelp(\'address_privacy\')">Tips &amp; examples</a></h2><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\' : formData.meetingPoint == \'public\'}" ng-click="formData.meetingPoint = \'public\'"><div class="pull-left radio"></div><label class="pull-left">Make the address public</label></div><div class="radioButton clearfix activities" ng-class="{\'active\' : formData.meetingPoint == \'private\'}" ng-click="formData.meetingPoint = \'private\'"><div class="pull-left radio"></div><label class="pull-left">Keep the address private</label></div></div><div class="form-group no-margins"><h2 class="marginTop gutterMarginBottom half">Additional instructions</h2><textarea class="form-control" rows="4" ng-model="formData.directions" name="directions" maxlength="200"></textarea><character-count max="200" text="form.directions.$viewValue"></character-count></div></div><div ng-show="formData.currentStep == 5" class="sectionContent white-bg"><div class="form-group"><h2 class="marginBottom">How is your activity scheduled?<a class="small activities marginLeft" ng-click="showHelp(\'how_is_your_activity_scheduled?\')">Tips &amp; examples</a></h2><div class="radioControl"><div class="radioButton clearfix activities" ng-class="{\'active\': !formData.hasRepeat && !formData.isFlexible, \'disabled\': (formData.status == \'published\' || formData.status == \'completed\')}" ng-click="(formData.status != \'published\' && formData.status != \'completed\') && formData.changeScheduling(\'oneoff\')"><div class="pull-left radio"></div><label class="pull-left">One-off activity</label></div><div class="radioButton clearfix activities" ng-class="{\'active\': formData.hasRepeat, \'disabled\': (formData.status == \'published\' || formData.status == \'completed\')}" ng-click="(formData.status != \'published\' && formData.status != \'completed\') && formData.changeScheduling(\'repeat\')"><div class="pull-left radio"></div><label class="pull-left">Repeating activity</label></div><div class="radioButton clearfix activities" ng-class="{\'active\': formData.isFlexible, \'disabled\': (formData.status == \'published\' || formData.status == \'completed\')}" ng-click="(formData.status != \'published\' && formData.status != \'completed\') && formData.changeScheduling(\'flexible\')"><div class="pull-left radio"></div><label class="pull-left">Flexible availability</label></div></div></div><div ng-show="formData.isFlexible"><h2 class="marginTop marginBottom">What\'s the activity duration?*<a class="small activities marginLeft" ng-click="showHelp(\'activity_duration\')">Tips &amp; examples</a></h2><div class="marginBottom" ng-class="{\'has-error\' : formData.publishing && form.$error.flexibleDuration }"><div class="vAlignParent durationSelects"><div class="vAlign form-group"><label>Hours</label><select class="form-control" ng-model="formData.availability.duration.hours" convert-to-number><option ng-repeat="n in _.range(0, 9)" value="{{ n }}">{{ n }}</option></select></div><div class="vAlign form-group"><label>&nbsp;</label><div style="padding: 0 10px">:</div></div><div class="vAlign form-group"><label>Minutes</label><select class="form-control" ng-model="formData.availability.duration.minutes" convert-to-number><option value="0">00</option><option value="15">15</option><option value="30">30</option><option value="45">45</option></select></div></div><div class="help-block" ng-show="formData.publishing && form.$error.flexibleDuration">This is required to save the activity</div></div><div style="display: inline-block" class="marginTop marginBottom" ng-class="{\'has-error\': formData.validationRun && form.$error.flexibleDays}"><h2>What\'s your weekly availability?*<a class="small activities marginLeft" ng-click="showHelp(\'specify_your_availability\')">Tips &amp; examples</a></h2><div class="help-block" ng-show="formData.validationRun && form.$error.flexibleDays">At least 1 day must be enabled</div></div><div class="flexibleSliders marginBottom"><flexible-day-control label="Monday" day="formData.availability.days[0]"></flexible-day-control><flexible-day-control label="Tuesday" day="formData.availability.days[1]" class="marginTop"></flexible-day-control><flexible-day-control label="Wednesday" day="formData.availability.days[2]" class="marginTop"></flexible-day-control><flexible-day-control label="Thursday" day="formData.availability.days[3]" class="marginTop"></flexible-day-control><flexible-day-control label="Friday" day="formData.availability.days[4]" class="marginTop"></flexible-day-control><flexible-day-control label="Saturday" day="formData.availability.days[5]" class="marginTop"></flexible-day-control><flexible-day-control label="Sunday" day="formData.availability.days[6]" class="marginTop"></flexible-day-control></div><h2 class="marginTop marginBottom">What\'s your availability time period?*<a class="small activities marginLeft" ng-click="showHelp(\'availability_time_period\')">Tips &amp; examples</a></h2><div class="vAlignParent inlineDatePickers"><div class="vAlign form-group"><label>Starts</label><div class="iconInput fixedWidth"><i class="ico ico-calendar" ng-click="formData.availability.dateRange.open(\'start\')"></i> <input type="text" placeholder="Select date..." onkeydown="return false" ng-change="(formData.availability.dateRange.endDate.date !== null) && formData.availability.dateRange.startDateChanged()" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.availability.dateRange.startDate.date" datepicker-options="formData.availability.dateRange.options" is-open="formData.availability.dateRange.startDate.isOpen" show-button-bar="false" ng-focus="formData.availability.dateRange.open(\'start\')" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div></div><div class="vAlign form-group hidden-xs"><label>&nbsp;</label><div style="padding: 0 10px">-</div></div><div class="vAlign form-group no-margins"><label>Ends</label><div class="clearfix"><div class="iconInput fixedWidth pull-left"><i class="ico ico-calendar" ng-click="formData.availability.dateRange.open(\'end\')"></i> <input type="text" placeholder="Never" onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.availability.dateRange.endDate.date" datepicker-options="formData.availability.dateRange.options" is-open="formData.availability.dateRange.endDate.isOpen" show-button-bar="false" ng-focus="formData.availability.dateRange.open(\'end\')" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div><a class="btn btn-textcolour pull-left marginLeft" ng-show="formData.availability.dateRange.endDate.date !== null" ng-click="formData.availability.dateRange.endDate.date = null"><i class="fas fa-sync-alt no-margins"></i></a></div></div></div></div><div ng-show="!formData.isFlexible"><h2 class="marginTop marginBottom" ng-show="!formData.hasRepeat && !formData.isFlexible">Set a date and time*<a class="small activities marginLeft" ng-click="showHelp(\'activity_date_and_time\')">Tips &amp; examples</a></h2><h2 class="marginTop marginBottom" ng-show="formData.hasRepeat">Set initial date and time*<a class="small activities marginLeft" ng-click="showHelp(\'activity_initial_date_and_time\')">Tips &amp; examples</a></h2><div class="form-group" ng-class="{\'has-error\': (formData.validationRun && form.$error.startDate) || (form.$error.startDate && formData.dateRange.endDate.date) }"><label>Starts</label><div class="vAlignParent dateAndTime"><div class="vAlign"><div class="iconInput fixedWidth"><i class="ico ico-calendar" ng-click="formData.dateRange.open(\'start\')"></i> <input type="text" placeholder="Select date..." onkeydown="return false" ng-change="formData.startDateSelected();formData.calculateRepeating();" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.dateRange.startDate.date" datepicker-options="formData.dateRange.options" is-open="formData.dateRange.startDate.isOpen" show-button-bar="false" ng-focus="formData.dateRange.open(\'start\')" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div></div><div class="vAlign separator hidden-xs" ng-show="formData.dateRange.startDate.date">at</div><div class="vAlign separator visible-xs" ng-show="formData.dateRange.startDate.date"></div><div class="vAlign" ng-show="formData.dateRange.startDate.date"><time-picker value="formData.dateRange.startDate.time" on-change="formData.calculateJoinCutOff(false)"></time-picker></div></div><span class="help-block" ng-show="formData.validationRun && !formData.dateRange.startDate.date">An activity needs a start date</span> <span class="help-block" ng-show="formData.dateRange.startDate.date && form.$error.startDate">Start date can\'t be set in the past</span></div><div class="form-group" ng-show="formData.dateRange.endDate.date" ng-class="{\'has-error\': form.$error.endDate}"><label>Ends</label><div class="vAlignParent dateAndTime"><div class="vAlign"><div class="iconInput fixedWidth"><i class="ico ico-calendar" ng-click="formData.dateRange.open(\'end\')"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.dateRange.endDate.date" datepicker-options="formData.dateRange.options" is-open="formData.dateRange.endDate.isOpen" show-button-bar="false" ng-focus="formData.dateRange.open(\'end\')" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div></div><div class="vAlign separator hidden-xs">at</div><div class="vAlign separator visible-xs"></div><div class="vAlign"><time-picker value="formData.dateRange.endDate.time"></time-picker></div></div><span class="help-block" ng-show="form.$error.endDate">End time can\'t be set before start time</span></div><div class="activityRepeat" ng-show="formData.dateRange.endDate.date && formData.hasRepeat"><h2 class="marginTop marginBottom">Set a repeat pattern<a class="small activities marginLeft" ng-click="showHelp(\'activity_repeat_pattern\')">Tips &amp; examples</a></h2><div class="clearfix"><div class="form-group pull-left" style="margin-right: 20px"><label>Repeat</label><select class="form-control fixedWidth" ng-model="formData.repeat.frequency" ng-options="option.value as option.label for option in formData.repeat.frequencyOptions" ng-disabled="disableActivityRepeatChanges"></select></div><div class="form-group pull-left" ng-class="{\'has-error\': form.repeatEvery.$invalid}"><div class="repeatEvery" ng-switch on="formData.repeat.frequency"><label>Every*</label><div class="vAlignParent"><div class="vAlign spacingRight"><input type="number" class="form-control fixedWidth" name="repeatEvery" ng-model="formData.repeat.every" integer-only-input min="1" ng-required="formData.hasRepeat" ng-disabled="disableActivityRepeatChanges"></div><div class="vAlign"><span ng-switch-when="daily">day(s)</span> <span ng-switch-when="weekly">week(s) on</span> <span ng-switch-when="monthly">month(s) on</span></div></div></div><span class="help-block" ng-show="form.repeatEvery.$invalid">Must be at least 1</span></div></div><div class="row" ng-show="formData.repeat.frequency == \'weekly\'"><div class="form-group col-xs-12 col-sm-10 col-md-11"><div class="weekPicker noFontSize" ng-class="{\'disabled\': disableActivityRepeatChanges}"><a ng-class="{\'selected\': formData.repeat.dow[0]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(0)"><i class="ico ico-tick"></i><span class="dayName">M<span class="hidden-xs">on<span class="hidden-xs hidden-sm">day</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[1]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(1)"><i class="ico ico-tick"></i><span class="dayName">T<span class="hidden-xs">ue<span class="hidden-xs hidden-sm">sday</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[2]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(2)"><i class="ico ico-tick"></i><span class="dayName">W<span class="hidden-xs">ed<span class="hidden-xs hidden-sm">nesday</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[3]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(3)"><i class="ico ico-tick"></i><span class="dayName">T<span class="hidden-xs">hu<span class="hidden-xs hidden-sm">rsday</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[4]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(4)"><i class="ico ico-tick"></i><span class="dayName">F<span class="hidden-xs">ri<span class="hidden-xs hidden-sm">day</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[5]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(5)"><i class="ico ico-tick"></i><span class="dayName">S<span class="hidden-xs">at<span class="hidden-xs hidden-sm">urday</span></span></span></a> <a ng-class="{\'selected\': formData.repeat.dow[6]}" ng-click="!disableActivityRepeatChanges && formData.changeDoW(6)"><i class="ico ico-tick"></i><span class="dayName">S<span class="hidden-xs">un<span class="hidden-xs hidden-sm">day</span></span></span></a></div></div></div><div class="row halfGutter" ng-show="formData.repeat.frequency == \'monthly\'"><div class="col-xs-12 col-sm-6"><div class="switchWithLabel clearfix radioButton activities" ng-class="{\'active\' : !formData.repeat.monthOrdinal.enabled, \'disabled\' : disableActivityRepeatChanges}" ng-click="!disableActivityRepeatChanges && formData.changeMonthlyRepeatType(false)"><div class="pull-left radio" ng-click="!disableActivityRepeatChanges && formData.changeMonthlyRepeatType(false)"></div><label class="pull-left">Day of the month</label></div><ul class="marginTop marginBottom list-unstyled list-inline numberGrid" ng-class="{\'disabled\' : formData.repeat.monthOrdinal.enabled || disableActivityRepeatChanges}"><li ng-repeat="i in formData.repeat.dom.available"><div><label ng-click="!disableActivityRepeatChanges && formData.selectDoM(i)" ng-class="{\'checked\' : formData.repeat.dom.selected.indexOf(i) > -1}"><span>{{ i }}</span></label></div></li></ul></div><div class="col-xs-12 col-sm-6 marginBottom"><div class="row halfGutter"><div class="col-xs-12"><div class="switchWithLabel clearfix radioButton activities marginBottom" ng-class="{\'active\' : formData.repeat.monthOrdinal.enabled, \'disabled\' : disableActivityRepeatChanges}" ng-click="!disableActivityRepeatChanges && formData.changeMonthlyRepeatType(true)"><div class="pull-left radio" ng-click="!disableActivityRepeatChanges && formData.changeMonthlyRepeatType(true)"></div><label class="pull-left">Day of the week</label></div></div><div class="col-xs-6"><select class="form-control" ng-disabled="!formData.repeat.monthOrdinal.enabled || disableActivityRepeatChanges" ng-model="formData.repeat.monthOrdinal.value.ordinal" ng-options="option.id as option.name for option in formData.repeat.monthOrdinal.options.ordinal"></select></div><div class="col-xs-6"><select class="form-control" ng-disabled="!formData.repeat.monthOrdinal.enabled || disableActivityRepeatChanges" ng-model="formData.repeat.monthOrdinal.value.dow" ng-options="option.id as option.name for option in formData.repeat.monthOrdinal.options.dow"></select></div></div></div></div><div class="form-group" ng-class="{\'has-error\': form.$error.repeatUntilDate}"><label>Ends</label><div class="clearfix"><div class="iconInput fixedWidth pull-left"><i class="ico ico-calendar" ng-click="formData.repeat.until.open(savedRepeatUntil || moment(formData.dateRange.startDate.date).add(1, \'d\').toDate())"></i> <input type="text" placeholder="Never" ng-disabled="disableActivityRepeatChanges && formData.repeat.indefinite" onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.repeat.until.date" datepicker-options="formData.repeat.until.options" is-open="formData.repeat.until.isOpen" show-button-bar="false" ng-focus="formData.repeat.until.open(savedRepeatUntil || moment(formData.dateRange.startDate.date).add(1, \'d\').toDate())" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div><a class="btn btn-textcolour pull-left marginLeft" ng-show="formData.status == \'draft\' && formData.repeat.until.date !== null" ng-click="formData.repeat.until.setValue(null); savedRepeatUntil=null;"><i class="fas fa-sync-alt no-margins"></i></a></div><span class="help-block" ng-show="form.$error.repeatUntilDate">End date must be after the start date</span></div></div><h2 class="marginTop marginBottom">When\'s the closing time for joining?<a class="small activities marginLeft" ng-click="showHelp(\'closing_time_for_joining\')">Tips &amp; examples</a></h2><div class="form-group no-margins" ng-class="{\'has-error\': form.$error.joinCutOffDate }"><select class="form-control fixedWidth" ng-model="formData.joinCutOffDiff" ng-change="formData.calculateJoinCutOff()" ng-options="option.hours as option.label for option in formData.joinCutOffOptions"></select><div class="iconInput fixedWidth marginTop" ng-show="formData.joinCutOffDiff == 0"><i class="ico ico-calendar" ng-click="formData.joinCutOffDate.open(null, formData.dateRange.startDate.date)"></i> <input type="text" placeholder="Select date..." onkeydown="return false" ng-change="formData.calculateJoinCutOff(false)" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="formData.joinCutOffDate.date" datepicker-options="formData.joinCutOffDate.options" is-open="formData.joinCutOffDate.isOpen" show-button-bar="false" ng-focus="formData.joinCutOffDate.open(null, formData.dateRange.startDate.date)" datepicker-append-to-body="true" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div><span class="help-block" ng-show="form.$error.joinCutOffDate">Closing time can\'t be set in the past</span> <span class="help-block" ng-show="!form.$error.joinCutOffDate && formData.dateRange.endDate.date && formData.joinCutOffDiff == 0">Joiners must book by {{ formData.joinCutOffDate.getValue(\'DD/MM/YYYY\') }}</span> <span class="help-block" ng-show="!form.$error.joinCutOffDate && formData.dateRange.endDate.date && formData.joinCutOffDiff != 0">Joiners must book at least {{ _.find(formData.joinCutOffOptions, [\'hours\', formData.joinCutOffDiff]).label }} before the activity starts</span></div></div></div><div ng-show="formData.currentStep == 6" class="sectionContent white-bg"><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group"><h2 class="marginBottom">Set your price per spot<a class="small activities marginLeft" ng-click="showHelp(\'set_a_price_per_spot\')">Tips &amp; examples</a></h2><div class="input-group fixedWidth"><span class="input-group-addon">{{ formData.budget.currency }}</span> <input type="text" class="form-control" ng-model="formData.budget.perPerson.model" placeholder="Free" number-only-input></div></div><div class="form-group" ng-class="{\'no-margins\': formData.useCustomBookingURL === false}"><h2 class="marginTop marginBottom">Choose your booking platform<a class="small activities marginLeft" ng-click="showHelp(\'booking_platforms\')">Tips &amp; examples</a></h2><div class="radioControl"><div class="radioButton clearfix activities" ng-class="{\'active\' : formData.useCustomBookingURL === false}" ng-click="formData.useCustomBookingURL = false"><div class="pull-left radio"></div><label class="pull-left">HulaHub</label></div><div class="radioButton clearfix activities" ng-class="{\'active\' : formData.useCustomBookingURL === true}" ng-click="formData.useCustomBookingURL = true"><div class="pull-left radio"></div><label class="pull-left">Your own</label></div></div></div><div class="form-group no-margins" ng-show="formData.useCustomBookingURL === true" ng-class="{\'has-error\': formData.validationRun && form.customBookingURL.$invalid}"><input class="form-control" ng-model="formData.customBookingURL" placeholder="Enter URL e.g. www.yoursite.com/booking" type="text" name="customBookingURL" ng-required="formData.useCustomBookingURL === true"> <span class="help-block" ng-show="formData.validationRun && form.customBookingURL.$invalid">Please enter your booking URL</span></div></div><div class="col-xs-12 col-sm-5 col-sm-offset-1"><pricing-calculator class="gutterMarginTopXSOnly" per-spot="formData.budget.perPerson" currency="formData.budget.currency" show-help="showHelp(label)"></pricing-calculator></div></div></div><div class="small gutterMarginTop half" ng-show="formData.currentStep !== 5">* This information is required to publish the activity</div><div class="buttons clearfix gutterMarginTop" ng-class="{\'half\': formData.currentStep < 5}"><a ng-show="formData.currentStep > 1" class="btn btn-textcolour btn-outline pull-left" ng-click="formData.changeStep(\'prev\')"><i class="ico ico-chevron-left"></i>Back</a> <button type="button" ng-show="formData.currentStep == 6" class="btn btn-green pull-right iconRight" ng-click="save(true)" ng-class="{\'btn-disabled\': !auth.currentUser.emailVerified}" ng-disabled="!auth.currentUser.emailVerified">Publish<i class="ico ico-chevron-right"></i></button> <a ng-show="formData.currentStep < 6" class="btn btn-activities pull-right iconRight" ng-click="formData.changeStep(\'next\')">Next<i class="ico ico-chevron-right"></i></a></div></form></div>'),
$templateCache.put("activities/views/hosted.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Hosted activities" type="activities"><a class="btn btn-outline btn-activities" ui-sref="activities.new"><i class="ico ico-plus noSpacingXS"></i><span class="hidden-xs">Host an activity</span></a></section-header></section><activity-calendar id="calendar" view="hosted" delete-activity-handler="deleteCalendarActivityHandler"></activity-calendar><div id="activityList" class="row gutterMarginTop"><div class="row halfGutter"><section class="myActivityList col-xs-12 col-md-6 gutterMarginBottom half"><activity-list class="gutterMarginBottom half" title="Activity drafts" theme="contacts" activities="draftActivities" selected-activity="selectedActivity" empty-text="No activity drafts" loading="loadingDraftActivities"></activity-list><activity-list title="Flexible activities" theme="activities" activities="flexibleActivities" selected-activity="selectedActivity" empty-text="No flexible activities" loading="loadingFlexibleActivities" hidden-status="completed" hidden-text="completed activities"></activity-list></section><section class="myActivityList col-xs-12 col-md-6"><activity-list class="gutterMarginBottom half" title="Booking requests" theme="info" activities="bookingRequests" selected-activity="selectedActivity" empty-text="No booking requests" loading="loadingBookingRequests" hidden-status="declined" hidden-text="declined requests"></activity-list><activity-list title="Scheduled activities" theme="activities" activities="scheduledActivities" empty-text="No scheduled activities" selected-activity="selectedActivity" loading="loadingCalendar" hidden-status="completed" hidden-text="completed activities"></activity-list></section></div></div>'),$templateCache.put("activities/views/inspire.html",'<div class="row suggestedTiles"><div class="row gutterMarginBottom"><div class="col-xs-12"><div ng-if="auth.currentUser.interestCount == 0" class="suggestedLandingPagePanel matchedPanel vAlignParent full-width text-xs-center text-sm-left" style="background-image:url(\'/img/landing/sml/A90-1.jpg\')"><div class="bgOverlay"></div><div class="blueChevron vAlign hidden-xs"><div class="h3">Set your interests and preferred locations, so we can match you with activities you\'ll enjoy.</div></div><div class="h3 visible-xs extraText">Set your interests and preferred locations, so we can match you with activities you\'ll enjoy.</div><div class="vAlign text-sm-right"><a class="btn btn-white" ng-click="addInterest()"><i class="ico ico-plus fixedSize"></i>Add your interests</a></div></div><div ng-if="auth.currentUser.interestCount > 0" class="suggestedLandingPagePanel matchedPanel vAlignParent full-width text-xs-center text-sm-left" style="background-image:url(\'/img/landing/sml/A90-1.jpg\')"><div class="bgOverlay"></div><div class="blueChevron vAlign text-center hidden-xs hideChevronMobile"><h2 class="no-margins">You have {{ auth.currentUser.interestCount|number }}<ng-pluralize count="auth.currentUser.interestCount" when="{\'one\': \' interest\', \'other\': \' interests\'}"></ng-pluralize></h2><a class="btn btn-white" ng-click="addInterest()"><i class="ico ico-plus fixedSize"></i>Add more interests</a></div><div class="vAlign extraText"><h2 class="visible-xs">You have {{ auth.currentUser.interestCount|number }}<ng-pluralize count="auth.currentUser.interestCount" when="{\'one\': \' interest\', \'other\': \' interests\'}"></ng-pluralize></h2><h2 class="hidden-xs">Your matched activities</h2><p>We have selected best activities matching your location-based interests</p></div><div class="row visible-xs"><div class="col-xs-6"><a class="btn btn-white btn-block inverse" ng-click="addInterest()"><i class="ico ico-plus fixedSize"></i>Add interest</a></div><div class="col-xs-6"><a class="btn btn-white btn-block iconRight" ui-sref="activities.find.matches">Explore now<i class="ico ico-chevron-right"></i></a></div></div><div class="vAlign text-sm-right hidden-xs"><a class="btn btn-white iconRight" ui-sref="activities.find.matches">Explore now<i class="ico ico-chevron-right"></i></a></div></div></div></div><div class="row gutterMarginBottom halfGutter flexContainer-md"><div class="col-xs-12 col-md-4"><div class="suggestedLandingPagePanel text-center" style="background-image:url(\'/img/landing/sml/A4-1.jpg\')"><div class="bgOverlay"></div><h2>Adventure Sports</h2><p>Adrenaline seekers, awaken your wild side</p><a class="btn btn-white iconRight" ng-click="browseSegment(\'Adventure Sports\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div><div class="col-xs-12 col-md-8"><div class="row halfGutter"><div class="col-xs-12 col-sm-6"><div class="suggestedLandingPagePanel text-center spacingMobile" style="background-image:url(\'/img/landing/sml/A136-1.jpg\')"><div class="bgOverlay"></div><h2>Dance</h2><p>Smile and swing in a frenzy of self-expression</p><a class="btn btn-white iconRight" ng-click="browseSegment(\'Dance\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div><div class="col-xs-12 col-sm-6"><div class="suggestedLandingPagePanel text-center spacingMobile" style="background-image:url(\'/img/landing/sml/A159-1.jpg\')"><div class="bgOverlay"></div><h2>Performance Arts</h2><p>Acting, singing, and dancing... become a triple threat!</p><a class="btn btn-white iconRight" ng-click="browseSegment(\'Performance Arts\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div></div><div class="row"><div class="col-xs-12"><div class="suggestedLandingPagePanel text-xs-center gutterMarginTop" style="background-image:url(\'/img/landing/sml/A72-2.jpg\')"><div class="bgOverlay"></div><div class="text-md-left"><h2>Fitness &amp; Wellbeing</h2><p>Challenge muscles and your mind to go the extra mile</p></div><a class="btn btn-white iconRight positioned-md" ng-click="browseSegment(\'Fitness & Wellbeing\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div></div></div></div><div class="row halfGutter"><div class="col-xs-12 col-sm-6"><div class="suggestedLandingPagePanel text-xs-center text-sm-center" style="background-image:url(\'/img/landing/sml/A114-1.jpg\')"><div class="bgOverlay"></div><div class="text-lg-left"><h2>Arts &amp; Crafts</h2><p>Try working with your hands for a change</p></div><a class="btn btn-white iconRight positioned-lg" ng-click="browseSegment(\'Arts & Crafts\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div><div class="col-xs-12 col-sm-6"><div class="suggestedLandingPagePanel text-xs-center gutterMarginTopXSOnly" style="background-image:url(\'/img/landing/sml/A166-1.jpg\')"><div class="bgOverlay"></div><div class="text-lg-left"><h2>Knowledge &amp; Education</h2><p>Self-improvement\'s all the rage these days</p></div><a class="btn btn-white iconRight positioned-lg" ng-click="browseSegment(\'Knowledge & Education\')">Explore now<i class="ico ico-chevron-right"></i></a></div></div></div></div><div class="row marginTop"><div class="vAlignParent full-width marginBottom"><h2 class="vAlign">Featured activities</h2><div class="vAlign text-right"><a ui-sref="activities.find.browse({forceFeatured:true})" class="btn btn-activities btn-outline">View all</a></div></div><div ng-show="loadingFeaturedActivities" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingFeaturedActivities" class="activitiesContainer maximum2Tablet"><div class="row halfGutter gridLayout"><activity-card ng-repeat="activity in featuredActivities"></activity-card></div></div></div>'),$templateCache.put("activities/views/join.html",'<div class="row"><p ng-show="allSteps.length > 1 && currentStep != \'success_fail\'" class="h4 gutterMarginBottom"><strong>Step {{ currentStepIndex }} of {{ allSteps.length }}</strong></p><div class="row halfGutter"><div class="col-xs-12 col-md-7 col-md-push-5" ng-show="currentStep == \'success_fail\'"><section class="white-bg bordered gutterMarginBottom"><div class="sectionContent" ng-show="successFailView == \'success\'"><div ng-if="!activity.flexible"><h1 class="marginBottom">You have booked {{ ::activity.title }}!</h1><p class="marginBottom">Thank you for your booking, the confirmation will be sent to <strong>{{ auth.currentUser.email }}</strong> shortly.</p></div><div ng-if="activity.flexible"><h1 class="marginBottom">You have submitted your booking request for {{ ::activity.title }}!</h1><p class="marginBottom">Thank you for your booking request, the confirmation will be sent to <strong>{{ auth.currentUser.email }}</strong> shortly.</p><p class="marginBottom">Once the host accepts your request your booking will be confirmed and payment taken.</p><p class="marginBottom">You can view and manage your booking request by clicking \'My activities\' button below.</p></div><a class="btn btn-activities" ui-sref="activities.joined"><i class="ico ico-activities"></i>My activities</a><div class="divider marginTop marginBottom"></div><h3 class="marginBottom">Share this activity with your friends!</h3><p class="marginBottom">Experiences are better when shared with others. Share this activity to let your friends know what you\'re doing.</p><div class="row halfGutter"><div class="col-xs-3"><a class="btn btn-block btn-facebook" ng-click="shareFacebook()"><i class="ico ico-facebook noSpacingXS"></i><span class="hidden-xs">Facebook</span></a></div><div class="col-xs-3"><a class="btn btn-block btn-twitter" ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{share.twitter|encodeURI}}&url={{share.url|encodeURI}}&related=HulaHubHQ"><i class="ico ico-twitter noSpacingXS"></i><span class="hidden-xs">Twitter</span></a></div><div class="col-xs-3"><a class="btn btn-block btn-messages" ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{ share.email.subject }}&body={{ share.email.body|encodeURI }}"><i class="ico ico-message noSpacingXS"></i><span class="hidden-xs">Email</span></a></div><div class="col-xs-3"><a class="btn btn-block btn-textcolour" ngclipboard data-clipboard-text="{{share.url}}" ngclipboard-success="onClipboardSuccess(e)"><i class="ico noSpacingXS" ng-class="{\'ico-documents\': !linkCopiedToClipboard, \'ico-tick\': linkCopiedToClipboard}"></i><span ng-if="!linkCopiedToClipboard" class="hidden-xs">Copy link</span><span ng-if="linkCopiedToClipboard" class="hidden-xs">Copied</span></a></div></div></div><div class="sectionContent" ng-show="successFailView != \'success\'"><div ng-if="activity.flexible"><h1 class="marginBottom">Sorry, we couldn\'t process your booking request!</h1><p class="marginBottom">We weren\'t able to process your booking request for <strong>{{ ::activity.title }}</strong></p><p class="marginBottom">Please message the host or try booking another date and/or time for this activity. We are really sorry for the inconvenience.</p></div><div ng-if="!activity.flexible"><h1 class="marginBottom">Sorry, we couldn\'t book you in!</h1><p class="marginBottom">We weren\'t able to book you onto <strong>{{ ::activity.title }}</strong> as the host can\'t accept payments at the moment.</p><p class="marginBottom">We have notified them about the problem, as soon as they fix the issue we will let you know. You can also get in contact with them directly.</p><p class="marginBottom">In the meantime, check out similar activities we have available.</p></div><a class="btn btn-activities" ui-sref="activities.find.browse"><i class="ico ico-search"></i>Browse activities</a></div></section></div><div class="col-xs-12 col-md-5" ng-class="{\'col-md-pull-7\': currentStep == \'success_fail\'}"><section class="white-bg bordered gutterMarginBottom"><div class="sectionContent"><div class="row halfGutter"><div class="col-xs-8"><h2 class="gutterMarginBottom half">{{ ::activity.title }}</h2><div ng-show="!activity.flexible">Single session</div><div ng-show="activity.flexible">Flexi session</div><div>{{ activity.flexible ? activity.flexibleDuration : activity.currentInstance.duration }}</div><div ng-show="currentStep != \'success_fail\'">Hosted by {{ ::activity.host.firstName }} {{ ::activity.host.lastName }}</div><div ng-show="currentStep == \'success_fail\'"><p class="no-margins">Hosted by <a ui-sref="contacts.public({userId: activity.host.id})" class="activities">{{ ::activity.host.firstName }} {{ ::activity.host.lastName }}</a></p><p ng-if="activity.host.phoneNumber" class="no-margins"><a class="textColour" href="tel:{{ ::activity.host.phoneNumber }}">{{ ::activity.host.phoneNumber }}</a></p><a class="btn btn-messages gutterMarginTop" ng-click="newMessage({id: activity.host.id, name: activity.host.firstName + \' \' + activity.host.lastName}, activity.title)"><i class="ico ico-message"></i>Message host</a></div></div><div class="col-xs-4"><div class="activityImage sml" style="background-image: url({{ activity.bannerImage || (\'/img/landing/sml/A\' + activity.interests[0].id + \'-1.jpg\') }})"></div></div></div></div></section><section class="white-bg bordered gutterMarginBottom"><div class="sectionContent"><h3 class="gutterMarginBottom half">Location</h3><div ng-show="!activity.currentInstance.endLocation">{{ ::activity.currentInstance.startLocation.name }}</div><div ng-show="activity.currentInstance.endLocation"><strong>Starts:</strong> {{ ::activity.currentInstance.startLocation.name }}<br><strong>Ends:</strong> {{ ::activity.currentInstance.endLocation.name }}</div><div class="small gutterMarginTop half" ng-show="activity.flexibleLocationDistance">Once your booking is confirmed you can arrange an exact address with the host within {{ ::activity.flexibleLocationDistance }} miles from {{ ::activity.currentInstance.startLocation.name }}.</div><div class="small gutterMarginTop half" ng-show="activity.currentInstance.startLocation.meetingPoint == \'private\'">The exact address will be shared once the booking is confirmed.</div></div></section><section class="white-bg bordered gutterMarginBottom"><div class="sectionContent"><div class="clearfix gutterMarginBottom half"><h3 class="pull-left">Date &amp; time</h3></div><div ng-show="!activity.flexible && !activity.repeating"><div ng-if="singleDayEvent"><div>{{ activity.currentInstance.startDate | dateFormat:\'ddd D MMM YYYY\' }}, {{ activity.currentInstance.startDate | dateFormat:\'HH:mm\' }} - {{ activity.currentInstance.endDate | dateFormat:\'HH:mm\' }}</div></div><div ng-if="!singleDayEvent"><div><strong>Starts:</strong> {{ activity.currentInstance.startDate | dateFormat:\'ddd, D MMM YYYY [at] HH:mm\' }}</div><div><strong>Ends:</strong> {{ activity.currentInstance.endDate | dateFormat:\'ddd, D MMM YYYY [at] HH:mm\' }}</div></div></div><div ng-show="!activity.flexible && activity.repeating"><div ng-show="!selectedActivities.length">Select dates you want to join</div><div ng-show="selectedActivities.length" class="clearfix" ng-repeat="selected in selectedActivities">{{ selected.date.display }}</div></div><div ng-show="activity.flexible">{{ bookingRequest.date | dateFormat:\'ddd D MMM YYYY\' }}, {{ ::bookingRequest.time.display }}</div></div></section><section class="white-bg bordered gutterMarginBottom" ng-show="successFailView == \'success\'"><div class="sectionContent"><h3 class="gutterMarginBottom half">Pricing</h3><div class="gutterMarginBottom half" ng-show="activity.availableOffers.length && nextOffer && currentStep != \'success_fail\'"><div ng-repeat="offer in activity.availableOffers" ng-show="offer == nextOffer" class="label show grey text-uppercase"><span class="profileColour"><i class="ico ico-offer-tag" style="margin-right:5px"></i>Book for {{ ::offer.threshold }} people and get <span ng-if="offer.type == 0">{{ ::offer.amount/100 }}%</span><span ng-if="offer.type == 1">{{ ::offer.amount | currencyDisplay:\'GBP\':true:false }}</span> off!</span></div></div><div ng-if="currentStep !== \'success_fail\'" class="vAlignParent full-width"><span class="vAlign">{{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency:true:false }} per spot</span> <span class="vAlign text-right"><span ng-if="activity.currentInstance.alreadyJoined">Already joined</span> <span ng-if="!activity.currentInstance.alreadyJoined && !activity.currentInstance.spotsLeft">Fully booked</span><plus-minus-control ng-if="selectedActivities.length" class="pull-right" value="selectedActivities[0].spots" min="{{ activity.flexible ? activity.currentInstance.groupSizeMin : 1}}" max="activity.currentInstance.spotsLeft"></plus-minus-control></span></div><div ng-if="!activity.repeating && currentStep == \'success_fail\'" class="vAlignParent full-width"><span class="vAlign">Spots booked</span> <span class="vAlign text-right">{{ selectedActivities[0].spots }} x {{ activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency:true:false }}</span></div><div ng-show="!activity.repeating" class="divider gutterMarginTop gutterMarginBottom half"></div><div class="clearfix" ng-show="currentStep != \'success_fail\' || (offerApplied || coupon.data)"><span class="pull-left">Subtotal</span> <span class="pull-right">{{ subTotalCost | currencyDisplay:activity.budget.currency:true:false }}</span></div><div ng-show="activity.availableOffers.length && offerApplied" class="clearfix"><span class="pull-left">Group discount</span> <span class="pull-right" ng-show="offerApplied.offer.type == 0">-{{ offerApplied.offer.amount/100 }}%</span> <span class="pull-right" ng-show="offerApplied.offer.type == 1">-{{ offerApplied.offer.amount | currencyDisplay:activity.budget.currency:true:false }}</span></div><div class="clearfix" ng-show="coupon.data"><span class="pull-left">Coupon discount<i ng-show="currentStep != \'success_fail\'" ng-click="removeCoupon()" class="ico ico-trash redColour marginLeft jsButton"></i></span> <span ng-if="coupon.data.type == \'p\'" class="pull-right">-{{ coupon.data.amount/100 }}%</span> <span ng-if="coupon.data.type == \'c\'" class="pull-right">-{{ coupon.data.amount | currencyDisplay:coupon.data.currency:true:false }}</span></div><div class="form-group gutterMarginTop half noMarginBottom" ng-show="currentStep != \'success_fail\' && !coupon.data && totalCost > 0"><div class="input-group"><input type="text" class="form-control noBorderRight" placeholder="Coupon code" ng-model="coupon.code" ng-change="coupon.valid = null" capitalize-input ng-keyup="$event.keyCode == 13 ? validateCoupon() : null"> <span class="input-group-btn"><button class="btn btn-grey" ng-show="coupon.valid === null" type="button" ng-click="validateCoupon()" ng-disabled="!coupon.code">Apply</button> <button class="btn btn-red" ng-show="coupon.valid === false" type="button">Invalid</button></span></div></div><div class="divider gutterMarginTop gutterMarginBottom half" ng-show="currentStep != \'success_fail\' || (offerApplied || coupon.data)"></div><div class="clearfix no-margins"><strong class="pull-left">Total</strong> <strong class="pull-right">{{ totalCost | currencyDisplay:activity.budget.currency:true:false }}</strong></div><div ng-show="currentStep != \'success_fail\' && totalCost > 0" class="gutterMarginTop half small">No hidden fees: this is the total amount payable</div></div></section></div><div class="col-xs-12 col-md-7" ng-show="currentStep != \'success_fail\'"><section class="white-bg bordered" ng-show="currentStep == \'register_login\'"><div class="sectionContent"><div ng-show="registerLoginView == \'register\'"><div class="clearfix"><h3 class="text-xs-center text-md-left pull-left-md pull-left-lg gutterMarginBottom half">Your details</h3><p class="text-xs-center text-md-right pull-right-md pull-right-lg marginBottom">Have an account already? <a tabindex="5" ng-click="registerLoginView=\'login\'" class="profileColour">Log in</a></p></div><form name="registerForm" autocomplete="off" novalidate><div class="form-group" ng-class="{\'has-error\': registerValidationRun && registerForm.firstName.$invalid}"><label>First name</label><input tabindex="1" class="form-control" ng-model="joinerDetails.firstName" name="firstName" type="text" required> <span class="help-block" ng-show="registerValidationRun && registerForm.firstName.$invalid">This is a required field</span></div><div class="form-group" ng-class="{\'has-error\': registerValidationRun && registerForm.lastName.$invalid}"><label>Last name</label><input tabindex="2" class="form-control" ng-model="joinerDetails.lastName" name="lastName" type="text" required> <span class="help-block" ng-show="registerValidationRun && registerForm.lastName.$invalid">This is a required field</span></div><div class="form-group" ng-class="{\'has-error\': (registerValidationRun && registerForm.email.$invalid) || formErrors.email}"><label>Email address</label><input tabindex="3" class="form-control email" ng-model="joinerDetails.email" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required> <span class="help-block" ng-show="(registerValidationRun && registerForm.email.$invalid) || formErrors.email">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="form-group" ng-class="{\'has-error\': (registerValidationRun && registerForm.password.$invalid) || formErrors.password}"><label>Choose a password</label><input tabindex="4" autocomplete="new-password" class="form-control" ng-model="joinerDetails.password" type="password" name="password" required> <span class="help-block" ng-show="(registerValidationRun && registerForm.password.$invalid) || formErrors.password">{{ formErrors.password || \'This is a required field\' }}</span></div><div class="gutterMarginTop clearfix formActions"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="previousStep()"><i class="ico ico-chevron-left"></i> Back</button> <button class="btn btn-green btn-outline pull-right iconRight" type="submit" ng-click="register()">Next<i class="ico ico-chevron-right"></i></button></div></form></div><div ng-show="registerLoginView == \'login\'"><div class="clearfix"><h3 class="text-xs-center text-md-left pull-left-md gutterMarginBottom">Your details</h3><p class="text-xs-center text-md-right pull-right-md marginBottom">Don\'t have an account? <a tabindex="8" ng-click="registerLoginView=\'register\'" class="profileColour">Sign up</a></p></div><button class="btn btn-facebook btn-block" type="button" ng-click="facebookLogin()"><i class="ico ico-facebook"></i>Log in with Facebook</button><p class="textWithLine marginTop marginBottom"><span>or</span></p><form name="loginForm" autocomplete="off" novalidate><div class="form-group" ng-class="{\'has-error\': (loginValidationRun && loginForm.email.$invalid) || formErrors.email}"><label>Email address</label><input tabindex="6" class="form-control email" ng-model="joinerDetails.email" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required> <span class="help-block" ng-show="loginForm.email.$valid && formErrors.email == \'locked\'">This account is closed.</span> <span class="help-block" ng-show="(loginValidationRun && loginForm.email.$invalid) || (formErrors.email && formErrors.email != \'locked\')">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="form-group" ng-class="{\'has-error\': loginValidationRun && loginForm.password.$invalid}"><label class="pull-right notBold"><a class="profile" ui-sref="resetPassword" tabindex="4">Forgot password?</a></label><label>Password</label><input tabindex="7" class="form-control" ng-model="joinerDetails.password" type="password" name="password" required> <span class="help-block" ng-show="loginValidationRun && loginForm.password.$invalid">This is a required field</span></div><div class="gutterMarginTop clearfix formActions"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="previousStep()"><i class="ico ico-chevron-left"></i> Back</button> <button class="btn btn-green btn-outline pull-right iconRight" type="submit" ng-click="login()">Next<i class="ico ico-chevron-right"></i></button></div></form></div></div></section><section class="white-bg bordered" ng-show="currentStep == \'confirm\'"><div class="sectionContent"><h3 class="gutterMarginBottom text-xs-center text-md-left">Confirm<span ng-show="totalCost"> and pay</span></h3><div class="vAlignParent gutterMarginBottom"><div class="vAlign spacingRight noFontSize"><profile-photo class="med activities"></profile-photo></div><div class="vAlign"><p class="no-margins">{{ joinerDetails.firstName }} {{ joinerDetails.lastName }}</p><p class="no-margins"><a class="activities" ng-click="logout()">Not you?</a></p></div></div><div class="form-group" ng-show="activity.flexible"><label>Message</label><textarea class="form-control" rows="4" ng-model="bookingRequest.message" placeholder="Here you can write any questions you may have for the host..." maxlength="200"></textarea><character-count max="200" text="bookingRequest.message"></character-count></div><div ng-show="totalCost > 0"><div class="divider gutterMarginBottom"></div><div class="form-group" ng-show="existingCards.length"><label>Payment card</label><select class="form-control" ng-model="existingCard" ng-options="option.stripeCardId as option.display for option in existingCards"><option value="">Add a new payment card...</option></select></div><div ng-show="!existingCard && selectedActivities.length"><payment-card-form clear-handler="paymentFormClearHandler" button-theme="green" back-button-class="btn-red" button-text="Confirm and pay" back-button-text="Cancel" back-button-icon="ico-cross" on-submit="confirmAndJoin" on-back="cancelJoin()" payment-due="paymentDueDate"></payment-card-form></div></div><div class="clearfix formActions"><button ng-if="totalCost == 0 || existingCard" class="btn btn-red pull-left btn-outline" ng-click="cancelJoin()"><i class="ico ico-cross"></i> Cancel</button> <button ng-if="totalCost > 0 && existingCard" class="btn btn-green pull-right" type="button" ng-click="confirmAndJoin()" ng-class="{\'btn-disabled\': !selectedActivities.length}" ng-disabled="!selectedActivities.length"><i class="ico ico-tick"></i> Confirm and pay</button> <button ng-if="totalCost == 0" class="btn btn-green pull-right" type="button" ng-click="confirmAndJoin()" ng-class="{\'btn-disabled\': !selectedActivities.length}" ng-disabled="!selectedActivities.length"><i class="ico ico-tick"></i> Confirm</button></div><div class="text-xs-center text-sm-right gutterMarginTop small">By confirming the booking, you agree to our <a href="{{ env.public }}/terms" target="_blank" class="underlineOnHover activities">Terms of use</a></div></div></section><section class="white-bg bordered gutterMarginTop"><div class="sectionContent"><h3 class="gutterMarginBottom half">HulaHub guarantee</h3><div>You can request a cancellation and full refund of an activity booking from the host up to 24 hours before the activity\'s start date.</div></div></section></div></div></div>'),$templateCache.put("activities/views/joined.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Joined activities" type="activities"><a class="btn btn-outline btn-activities" ui-sref="activities.find.browse"><i class="ico ico-search noSpacingXS"></i><span class="hidden-xs">Browse activities</span></a></section-header></section><activity-calendar id="calendar" view="joined"></activity-calendar><div id="activityList" class="row gutterMarginTop"><div class="row halfGutter"><section class="myActivityList col-xs-12 col-md-6 gutterMarginBottom half"><activity-list class="gutterMarginBottom half" title="Activity invites" theme="info" activities="activityInvites" selected-activity="selectedActivity" empty-text="No activity invites" loading="loadingInvites"></activity-list><activity-list title="Booking requests" theme="contacts" activities="bookingRequests" selected-activity="selectedActivity" empty-text="No booking requests" loading="loadingBookingRequests"></activity-list></section><section class="myActivityList col-xs-12 col-md-6"><activity-list title="Confirmed bookings" theme="activities" activities="scheduledActivities" selected-activity="selectedActivity" empty-text="No bookings" loading="loadingCalendar" hidden-status="completed" hidden-text="completed activities"></activity-list></section></div></div>'),$templateCache.put("activities/views/matches.html",'<div class="row"><section-header text="Matched activities" type="activities"><a class="btn btn-activities" ng-click="addInterest()"><i class="ico ico-plus fixedSize noSpacingXS"></i><span class="hidden-xs"> Add <span ng-if="auth.currentUser.interestCount == 0">your</span><span ng-if="auth.currentUser.interestCount > 0">more</span> interests</span></a></section-header><div ng-if="auth.currentUser.interestCount > 0"><div class="sectionContent white-bg withOffsetBorder gutterMarginBottom"><div ng-show="loadingInterests" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingInterests" class="matchedInterestCheckboxes clearfix"><span><label ng-repeat="interest in allInterests" ng-class="{\'checked\': formData.interests.indexOf(interest.id) >= 0}"><i class="ico ico-tick"></i> <input type="checkbox" checklist-model="formData.interests" checklist-value="interest.id"> {{ interest.interest.name }} ({{ interest.difficultyLevel|difficultyDisplay }})</label></span><a ui-sref="profile({\'#\': \'interests\'})" class="activitiesDark"><i class="ico ico-head-search"></i> Manage interests</a></div></div><div ng-if="loadingMatches" class="text-center"><div class="loadingSpinner wink"></div></div><div ng-if="!loadingInterests && !loadingMatches"><div class="hidden-xs vAlignParent full-width marginBottom marginTop"><div class="vAlign h2"><strong>{{ results.totalCount|number }} matched <span ng-pluralize count="results.totalCount" when="{\'1\': \'activity\', \'other\': \'activities\'}"></span></strong></div><div ng-show="results.totalCount > 0" class="vAlign text-right form-inline"><label>Sort by:</label><select class="form-control" ng-options="option.key as option.value for option in formData.sort.options" ng-model="formData.sort.value"></select></div></div><div class="visible-xs marginBottom marginTop"><div class="text-center"><h2>{{ results.totalCount|number }} matched <span ng-pluralize count="results.totalCount" when="{\'1\': \'activity\', \'other\': \'activities\'}"></span></h2><div ng-show="results.totalCount > 0" class="form-inline gutterMarginTop"><label>Sort by:</label><select class="form-control" ng-options="option.key as option.value for option in formData.sort.options" ng-model="formData.sort.value"></select></div></div></div><div class="activitiesContainer search"><div ng-show="results.totalCount > 0" class="row halfGutter gridLayout"><activity-card ng-repeat="activity in results.activities"></activity-card></div></div><div class="pagination vAlignParent full-width" ng-if="results.pagination.totalPages > 1"><div class="vAlign"><a class="btn btn-activities" ng-class="{\'invisible\': formData.pagination.current==1}" ng-click="changePage(formData.pagination.current-1)"><i class="ico ico-chevron-left noSpacingXS"></i><span class="hidden-xs">Back</span></a></div><div class="vAlign text-center"><ul class="list-unstyled list-inline no-margins"><li><a class="activities underlineOnHover" ng-class="{\'current\': formData.pagination.current == 1}" ng-click="changePage(1)">1</a></li><li class="hidden-xs" ng-show="formData.pagination.current >= 5">...</li><li class="visible-xs-inline" ng-show="formData.pagination.current >= 3">...</li><li ng-repeat="page in results.pagination.pages" ng-class="{\'hidden-xs\': page !== formData.pagination.current}"><a class="activities underlineOnHover" ng-class="{\'current\': page == formData.pagination.current}" ng-click="changePage(page)">{{ page|number }}</a></li><li class="hidden-xs" ng-show="formData.pagination.current <= results.pagination.totalPages-4">...</li><li class="visible-xs-inline" ng-show="formData.pagination.current <= results.pagination.totalPages-2">...</li><li><a class="activities underlineOnHover" ng-class="{\'current\': formData.pagination.current == results.pagination.totalPages}" ng-click="changePage(results.pagination.totalPages)">{{ results.pagination.totalPages|number }}</a></li></ul></div><div class="vAlign text-right"><a class="btn btn-activities iconRight" ng-class="{\'invisible\': formData.pagination.current==results.pagination.totalPages}" ng-click="changePage(formData.pagination.current+1)"><span class="hidden-xs">Next</span><i class="ico ico-chevron-right noSpacingXS"></i></a></div></div></div></div><div ng-show="!loadingMatches && (auth.currentUser.interestCount == 0 || results.totalCount == 0)" class="sectionContent white-bg" ng-class="{\'withOffsetBorder\': auth.currentUser.interestCount == 0 }"><div ng-show="loadingSuggestedInterests" class="text-center"><div class="loadingSpinner wink"></div></div><div ng-show="!loadingSuggestedInterests"><p ng-show="auth.currentUser.interestCount == 0" class="h2 text-center sectionContent gutterMarginBottom improvedLineHeight">Set your interests and preferred locations, so we can match you with activities you\'ll enjoy.</p><div ng-show="results.totalCount == 0" class="sectionContent text-center gutterMarginBottom"><div class="h2 improvedLineHeight gutterMarginBottom half">Sorry! No activities match your current interests and locations.</div><div class="h2 improvedLineHeight">Widen your match criteria by adding more interests.</div></div><h3>Our sports suggestions</h3><div class="row halfGutter marginBottom"><div ng-repeat="interest in suggestedInterests.sport" class="interestCardSuggestion col-xs-12 col-sm-6 col-md-4 gutterMarginTop"><div class="img bgFade" style="background-image: url(\'/img/landing/sml/A{{ interest.id }}-1.jpg\')"><div class="topLayer vAlignParent full-width text-center"><div class="full-width vAlign"><div class="h1 gutterMarginBottom half">Try something new...</div><div class="h2 gutterMarginBottom">{{ interest.name }}</div><a class="btn btn-white btn-outline activityHover" ng-click="addInterest(interest)"><i class="ico ico-plus fixedSize"></i> Add interest</a></div></div></div></div></div><h3>Our arts suggestions</h3><div class="row halfGutter marginBottom"><div ng-repeat="interest in suggestedInterests.art" class="interestCardSuggestion col-xs-12 col-sm-6 col-md-4 gutterMarginTop"><div class="img bgFade" style="background-image: url(\'/img/landing/sml/A{{ interest.id }}-1.jpg\')"><div class="topLayer vAlignParent full-width text-center"><div class="full-width vAlign"><div class="h1 gutterMarginBottom half">Try something new...</div><div class="h2 gutterMarginBottom">{{ interest.name }}</div><a class="btn btn-white btn-outline activityHover" ng-click="addInterest(interest)"><i class="ico ico-plus fixedSize"></i> Add interest</a></div></div></div></div></div><h3>Our culture suggestions</h3><div class="row halfGutter"><div ng-repeat="interest in suggestedInterests.culture" class="interestCardSuggestion col-xs-12 col-sm-6 col-md-4 gutterMarginTop"><div class="img bgFade" style="background-image: url(\'/img/landing/sml/A{{ interest.id }}-1.jpg\')"><div class="topLayer vAlignParent full-width text-center"><div class="full-width vAlign"><div class="h1 gutterMarginBottom half">Try something new...</div><div class="h2 gutterMarginBottom">{{ interest.name }}</div><a class="btn btn-white btn-outline activityHover" ng-click="addInterest(interest)"><i class="ico ico-plus fixedSize"></i> Add interest</a></div></div></div></div></div></div></div></div>'),
$templateCache.put("activities/views/share.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><section class="row white-bg gutterMarginBottom" ng-show="!loading"><section-header text="Invite to {{ activity.title }}" type="activities" xs-padding="true"><a class="btn btn-facebook btn-outline" ng-click="shareFacebook()"><i class="ico ico-facebook noSpacingXS"></i><span class="hidden-xs">Share on Facebook</span></a></section-header><div class="sectionContent withOffsetBorder"><form name="form" novalidate><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group" ng-class="{ \'has-error\': validationRun && form.$error.recipientCount}"><label>Invite contacts on HulaHub</label><tags-input class="activities" ng-model="formData.recipients" display-property="name" key-property="id" placeholder="Search contacts and groups..." replace-spaces-with-dashes="false" add-from-autocomplete-only="true" on-tag-added="tagAdded($tag)" on-tag-removed="tagRemoved($tag)"><auto-complete source="loadTags($query)" highlight-matched-text="false" template="core/partials/autocomplete-contact-and-group.html" min-length="1"></auto-complete></tags-input></div></div><div class="col-xs-12 col-sm-6"><div class="form-group" ng-class="{ \'has-error\': (validationRun && form.$error.recipientCount) || invalidEmails.length}"><label>Invite contacts outside of HulaHub</label><textarea class="form-control" rows="4" ng-model="formData.external" placeholder="Enter comma-seperated email addresses of contacts to share this activity..."></textarea><span class="help-block" ng-show="validationRun && form.$error.recipientCount">You must enter at least one recipient</span> <span class="help-block" ng-show="invalidEmails.length">Unfortunately the following email address<span ng-show="invalidEmails.length > 1">es are </span><span ng-show="invalidEmails.length == 1">&nbsp;is </span>invalid</span></div></div><div class="col-xs-12"><div class="form-group"><label>Personalise your invite</label><textarea class="form-control" rows="4" ng-model="formData.comments" placeholder="Write your personalised message here that will be included in your invitation..."></textarea></div></div></div><div class="row formActions"><div class="col-xs-12"><button class="btn btn-activities pull-right btn-outline" ng-click="sendInvites()"><i class="ico ico-message-fly"></i> Send invites</button> <button ng-show="skipButton" class="btn btn-activities dark pull-right btn-outline" style="margin-right: 10px" ng-click="skip()"><i class="ico ico-forward"></i> Skip</button> <button ng-show="!skipButton" class="btn btn-red pull-left btn-outline" ng-click="back()"><i class="ico ico-chevron-left"></i> Back</button></div></div></form></div></section><section class="row white-bg" ng-show="!loading"><section-header text="Invites sent" type="activities"><a class="btn btn-activities btn-outline" ng-show="invites.length" ng-click="resendAll()"><i class="ico ico-message-fly"></i>Re-send all</a></section-header><div class="sectionContent withOffsetBorder"><p class="h2 text-center" ng-show="!invites.length">You have not invited anyone to join this activity.</p><table ng-show="invites.length" class="simpleTable middleAlign activities" cellspacing="0" cellpadding="0" border="0"><tr><th class="text-left" width="150">Date invited</th><th class="text-left">Recipient</th><th class="text-left">Status</th><th>&nbsp;</th></tr><tr ng-repeat="invite in invites"><td class="text-left">{{ invite.created | dateFormat:\'DD/MM/YY\' }}</td><td class="text-left" ng-show="!invite.user">{{ invite.recipient }}</td><td class="text-left" ng-show="invite.user"><a class="activities underlinedLink" ng-click="viewProfile(invite.user)">{{ invite.recipient }}</a></td><td class="text-left" ng-if="invite.declined">Declined</td><td class="text-left" ng-if="!invite.declined">Pending</td><td class="text-right"><a class="btn btn-activities btn-outline" ng-click="resendInvite(invite.id)"><i class="ico ico-message-fly"></i>Re-send</a> <a class="btn btn-activities btn-outline" ng-click="deleteInvite(invite.id)"><i class="ico ico-cross"></i>Remove</a></td></tr></table></div></section>'),$templateCache.put("billing/views/billing-item-detail.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div ng-show="!loading" class="row gutterPaddingBottom"><a class="profile" ui-sref="billing.transactions">&lt; Back to transactions</a></div><section class="row white-bg singleBillingItem" ng-hide="loading"><section-header text="{{ billingItem.type|capitalize }}" type="profile"></section-header><div class="sectionContent withOffsetBorder"><ul class="list-unstyled gutterMarginBottom"><li><span>{{ ::billingItem.type|capitalize }} date:</span>{{ billingItem.date | dateFormat:\'DD/MM/YY\' }}</li><li><span>{{ ::billingItem.type|capitalize }} number:</span>{{ ::billingItem.number }}</li><li ng-if="billingItem.type == \'refund\'"><span>Linked {{ billingItem.linkedItem.type }}:</span><a ui-sref="billing.transactions.detail({billingItemId: billingItem.linkedItem.id})" class="profile">{{ ::billingItem.lineItems[0].description }}</a></li></ul><ul class="list-unstyled gutterMarginBottom"><li><span>From:</span><a class="profile" ui-sref="contacts.public({userId: billingItem.from.id})">{{ ::billingItem.from.name }}</a></li><li><span>To:</span><a class="profile" ui-sref="contacts.public({userId: billingItem.to.id})">{{ ::billingItem.to.name }}</a></li></ul><ul class="list-unstyled gutterMarginBottom"><li><strong><span>Total:</span>{{ billingItem.total.total | currencyDisplay:billingItem.currency:true:false:true }}</strong></li><li ng-if="billingItem.status !== \'Paid\'"><strong><span>Payment Due:</span>{{ billingItem.payment.due | dateFormat:\'DD/MM/YY\' }}</strong></li><li><strong><span>Status:</span>{{ ::billingItem.status }}</strong></li></ul><table ng-if="billingItem.type != \'refund\'" class="paymentsTable gutterMarginBottom" cellspacing="0" cellpadding="0" border="0"><tr><th class="text-left">Reference</th><th>Quantity</th><th class="text-right">Price</th><th class="text-right">Total</th></tr><tr ng-repeat="lineItem in billingItem.lineItems"><td class="text-left">{{ ::lineItem.description }}</td><td class="text-center">{{ ::lineItem.quantity }}</td><td class="text-right">{{ ::(lineItem.costPerUnit/100) | number:2 }}</td><td class="text-right">{{ ::((lineItem.costPerUnit * lineItem.quantity)/100) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="4"></td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3">Total:</td><td class="text-right">{{ (billingItem.total.subtotal)/100 | number: 2 }}</td></tr><tr class="tableSummaryRow" ng-if="billingItem.total.discount > 0"><td class="text-right" colspan="3">Group discount:</td><td class="text-right">{{ ((billingItem.total.discount/100)*-1) | number: 2 }}</td></tr><tr class="tableSummaryRow" ng-if="billingItem.total.couponDiscount > 0"><td class="text-right" colspan="3">Coupon discount:<span class="show">({{billingItem.coupon.code}})</span><i class="show small" ng-hide="billingItem.type == \'invoice\' || billingItem.coupon.hostPays">Paid by HulaHub</i></td><td class="text-right" valign="top">{{ ((billingItem.total.couponDiscount/100)*-1) | number: 2 }}</td></tr><tr class="tableSummaryRow" ng-if="billingItem.total.serviceCharge"><td class="text-right" colspan="3">Service charge:</td><td class="text-right">{{ ((billingItem.total.serviceCharge/100)*-1) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="4"></td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3"><strong>Amount due:</strong></td><td class="text-right"><strong>{{ (billingItem.total.total/100) | number: 2 }}</strong></td></tr><tr class="tableSummaryRow spacer"><td colspan="4"></td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3"><em>Net:</em></td><td class="text-right">{{ (billingItem.total.net/100) | number: 2 }}</td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3"><em>VAT:</em></td><td class="text-right">{{ (billingItem.total.vat/100) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="{{ billingItem.total.discount > 0 ? \'6\' : \'4\' }}"></td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3"><span ng-if="billingItem.type == \'credit\'">Received</span><span ng-if="billingItem.type != \'credit\'">Paid</span>:</td><td class="text-right">{{ (billingItem.total.paid/100) | number: 2 }}</td></tr><tr class="tableSummaryRow"><td class="text-right" colspan="3"><span ng-if="billingItem.type == \'credit\'">Outstanding</span><span ng-if="billingItem.type != \'credit\'">Due</span>:</td><td class="text-right">{{ ((billingItem.total.total - billingItem.total.paid)/100) | number: 2 }}</td></tr></table><table ng-if="billingItem.type == \'refund\'" class="paymentsTable gutterMarginBottom" cellspacing="0" cellpadding="0" border="0"><tr><th class="text-left">Reference</th><th class="text-right" width="90">Total</th></tr><tr ng-repeat="lineItem in billingItem.lineItems"><td class="text-left">{{ ::billingItem.title }}</td><td class="text-right">{{ (lineItem.costPerUnit/100) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="2"></td></tr><tr class="tableSummaryRow"><td class="text-right">Total:</td><td class="text-right">{{ (billingItem.total.total/100) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="2"></td></tr><tr class="tableSummaryRow"><td class="text-right"><em>Net:</em></td><td class="text-right">{{ (billingItem.total.net/100) | number: 2 }}</td></tr><tr class="tableSummaryRow"><td class="text-right"><em>VAT:</em></td><td class="text-right">{{ (billingItem.total.vat/100) | number: 2 }}</td></tr><tr class="tableSummaryRow spacer"><td colspan="3"></td></tr><tr class="tableSummaryRow"><td class="text-right">Paid:</td><td class="text-right">{{ (billingItem.total.paid/100) | number: 2 }}</td></tr><tr class="tableSummaryRow"><td class="text-right">Due:</td><td class="text-right">{{ ((billingItem.total.total - billingItem.total.paid)/100) | number: 2 }}</td></tr></table><h3 ng-if="billingItem.notes.length">Payment History</h3><table class="paymentsTable gutterMarginBottom" cellspacing="0" cellpadding="0" border="0" ng-if="billingItem.notes.length"><tr><th class="text-left">Date</th><th>Type</th><th>Method</th><th class="text-right">Total</th></tr><tr ng-repeat="note in billingItem.notes"><td class="text-left">{{ note.created | dateFormat:\'DD/MM/YY\' }}</td><td>{{ ::note.type }}</td><td>{{ ::note.message }}</td><td class="text-right"><span ng-if="note.value">{{ ::(note.value/100) | number: 2 }}</span></td></tr></table><div ng-if="!billingItem.notes.length" class="gutterMarginBottom borderBottom"></div><p ng-if="billingItem.type == \'invoice\' && billingItem.refundable" class="gutterMarginBottom">If you had a problem with this activity you may be entitled to a partial or full refund of the booking from the host. <a class="profile" ng-click="requestRefund()">Request a refund</a></p><h3>Notes</h3><p>In the event of a query please contact us at <a href="mailto:support@hulahub.com" class="profile">support@hulahub.com</a> or telephone <a href="tel:03333443996" class="profile">0333 344 3996</a>.<br>HulaHub is a limited company, registered in England &amp; Wales.<br>Registered office: 1-7 Sussex Road, Haywards Heath, West Sussex, RH16 4DZ.<br>Company number: 9910455, VAT number 231582621.<br>All amounts in currency: {{ billingItem.currency }}<br>This transaction is governed by our <a ui-sref="info.paymentTerms" class="profile">Payment Terms</a></p></div></section>'),$templateCache.put("billing/views/payment-settings.html",'<section class="row white-bg gutterMarginBottom" ng-if="auth.currentUser.registrationType != \'host\'"><section-header text="Payment cards" type="profile"></section-header><payment-methods></payment-methods></section><section class="row white-bg gutterMarginBottom"><section-header text="Payment systems" type="profile"></section-header><div class="sectionContent withOffsetBorder item"><div class="row"><div class="col-xs-12 col-sm-7 gutterMarginBottomXSOnly"><div ng-if="auth.currentUser.stripeAccountConnected"><div ng-show="loadingStripeDetails" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingStripeDetails"><p class="gutterMarginBottom">Your stripe account has been connected to HulaHub and you are able to take payments through the system.</p><a ng-show="!userHasPaidPublished" ng-click="disconnectStripe()" class="btn btn-profile"><i class="ico ico-stripe"></i> Disconnect your Stripe account</a> <a ng-show="userHasPaidPublished" class="btn btn-profile" ng-disabled="true" uib-tooltip="Cannot disconnect while you have published activities"><i class="ico ico-stripe"></i> Disconnect your Stripe account</a></div></div><div ng-if="!auth.currentUser.stripeAccountConnected"><p class="gutterMarginBottom">To use the platform to take payments for your activities, you need to connect your HulaHub account with a stripe account. If you do not have a stripe account, you will have the opportunity to create one.</p><a ng-click="connectStripe()" class="btn btn-profile btn-outline"><i class="ico ico-stripe"></i> Connect with Stripe</a></div></div><div class="col-xs-12 col-sm-5 bordered-sm-left"><form name="form" class="formSection" novalidate autocomplete="off"><div class="row halfGutter no-padding"><div class="form-group col-xs-7"><label>VAT number</label><input class="form-control" ng-model="formData.vatNumber" name="vatNumber" type="text"></div><div class="form-group col-xs-5"><label>VAT rate (%)</label><input class="form-control" ng-model="formData.vatRate" name="vatRate" type="text" number-only-input></div></div><button class="btn btn-green btn-block btn-outline" type="button" ng-click="save()" ng-disabled="form.$error.vatSettings"><i class="ico ico-tick"></i>{{ vatButtonLabel }} VAT settings</button></form></div></div></div></section><section class="row white-bg gutterMarginBottom" ng-if="auth.currentUser.registrationType == \'host\'"><section-header text="Payment cards" type="profile"></section-header><payment-methods></payment-methods></section>'),$templateCache.put("billing/views/refund-detail.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div class="row" ng-hide="loading"><div class="alert alert-success profile" ng-if="refund.escalated">The refund request has been escalated. We will review the refund request and one of our agents will be in contact.</div><div class="alert alert-success profile" ng-if="refund.dateRefunded">{{ refund.amountRefunded | currencyDisplay:refund.currency }} was refunded on {{ refund.dateRefunded | dateFormat:\'DD/MM/YY HH:mm\' }}</div></div><section class="row white-bg" ng-hide="loading"><section-header text="Refund details" type="profile"></section-header><div class="sectionContent withOffsetBorder refundDetails"><div class="row"><div class="detailsColumn col-xs-12 col-sm-6"><div class="row"><div class="col-xs-12 col-sm-6"><h4>Requested</h4><p>{{ refund.requested | dateFormat:\'DD/MM/YY HH:mm\' }}</p></div><div class="col-xs-12 col-sm-6"><h4>Status</h4><p>{{ refund.status }}</p></div></div><h4>Reason for refund</h4><p>{{ refund.reason }}</p><div ng-if="refund.additional"><h4>Additional information</h4><p>{{ refund.additional }}</p></div><div ng-if="refund.declinedReason"><h4>Reason for decline</h4><p>{{ refund.declinedReason }}</p></div></div><div class="col-xs-12 col-sm-6"><h4>Total payment</h4><p class="gutterMarginBottom">{{ refund.total | currencyDisplay:refund.currency }}</p><h4>Activity</h4><div class="h2 gutterMarginBottom">{{ refund.activityTitle }}</div><div ng-show="isHost"><h4>Requested by</h4><div class="vAlignParent"><div class="vAlign"><span class="circlePhoto med profile" ng-class="{\'noPhoto\' : !refund.joiner.avatar}" style="background-image:url({{ refund.joiner.avatar }})"></span></div><div class="vAlign h2">{{ refund.joiner.name }}</div></div></div><div ng-show="!isHost"><h4>Hosted by</h4><div class="vAlignParent"><div class="vAlign"><span class="circlePhoto med profile" ng-class="{\'noPhoto\' : !refund.host.avatar}" style="background-image:url({{ refund.host.avatar }})"></span></div><div class="vAlign h2">{{ refund.host.name }}</div></div></div></div></div><div ng-show="!refund.offers.length && isHost && !refund.closed && !refund.escalated && !refund.offerSent"><a class="btn btn-outline btn-profile" ng-click="accept()">Accept full refund</a> <a class="btn btn-outline btn-profile" ng-click="showOfferForm()">Offer partial refund</a> <a class="btn btn-outline btn-profile" ng-show="!refund.offers.length" ng-click="showDeclineForm()">Decline refund</a></div></div></section><section class="row white-bg marginTop" ng-hide="loading || !refund.offers.length"><section-header text="Offer history" type="profile"></section-header><div class="sectionContent withOffsetBorder"><table class="paymentsTable" cellspacing="0" cellpadding="0" border="0"><tr><th width="160">Date</th><th>From</th><th width="90" class="text-right">Amount</th><th class="text-left">Comments</th><th>&nbsp;</th></tr><tr ng-repeat="offer in refund.offers"><td>{{ offer.date | dateFormat:\'DD/MM/YY HH:mm\' }}</td><td>{{ offer.sender.name }}</td><td class="text-right">{{ offer.amount | currencyDisplay:refund.currency }}</td><td class="text-left">{{ offer.comments }}</td><td class="text-right"><div ng-show="$index == 0 && !refund.closed && !refund.escalated && offer.sender.id != auth.currentUser.hashId"><a class="btn btn-outline btn-profile" ng-click="accept()">Accept offer</a> <a class="btn btn-outline btn-profile" ng-click="showOfferForm()">Counter offer</a> <a ng-show="(!isHost && refund.offers.length >= 5)" class="btn btn-outline btn-profile" ng-click="showEscalationForm()">Escalate to HulaHub</a></div></td></tr></table></div></section>'),$templateCache.put("billing/views/resolution-centre.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><section class="row white-bg" ng-hide="loading"><section-header text="Refund enquiries" type="profile"></section-header><div class="sectionContent withOffsetBorder"><p class="no-margins" ng-hide="allRefunds.length">You have no refund enquiries.</p><table ng-show="allRefunds.length" class="paymentsTable" cellspacing="0" cellpadding="0" border="0"><tr><th>Date</th><th>Item</th><th>Requested by</th><th>Total</th><th>Status</th></tr><tr ng-repeat="refund in allRefunds"><td>{{ refund.requested | dateFormat:\'DD/MM/YY\' }}</td><td><a ui-sref="billing.resolutionCentre.detail({refundId: refund.id})" class="profile underlinedLink">Refund enquiry #{{ refund.number }}</a></td><td>{{ refund.joiner.name }}</td><td>{{ refund.total | currencyDisplay:refund.currency }}</td><td>{{ refund.status }}</td></tr></table></div></section>'),$templateCache.put("billing/views/subscription-plans.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Current subscription" type="profile"><a class="btn btn-outline btn-profile visible-xs" ng-click="scrollToOtherPlans()">Other plans</a></section-header><div class="sectionContent withOffsetBorder"><div ng-show="loadingSubscriptionInfo" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingSubscriptionInfo"><h2 class="profileColour gutterMarginBottom" ng-show="auth.currentUser.registrationType === \'joiner\' && subscription.id == \'FREE\'">Standard plan</h2><h2 class="profileColour gutterMarginBottom" ng-show="auth.currentUser.registrationType === \'host\' && subscription.id == \'FREE\'">Essential plan</h2><h2 class="profileColour gutterMarginBottom" ng-show="subscription.id != \'FREE\'">{{ subscription.name }}</h2><div class="currentPlanFree" ng-show="auth.currentUser.registrationType === \'joiner\' && subscription.id == \'FREE\'"><p>Our entry level plan is ideal for people that like being spontaneous and inspired in their leisure time.</p><ul class="list-unstyled"><li>Free for life</li><li>Join unlimited activities nationwide</li><li>Save your favourites for later</li><li>Request bespoke activities</li></ul><p class="no-margins">Upgrade your subscription to get access to wide range of leisure savings and retail discounts.</p></div><div class="currentPlanFree" ng-show="auth.currentUser.registrationType === \'host\' && subscription.id == \'FREE\'"><p>Our Essential plan gives you access to all the professional plan features on a pay as you go basis without the need to commit to a paid subscription.</p><ul class="list-unstyled"><li>Free for life</li><li>Join and host unlimited activities</li><li>12% standard service charge*</li><li>2% reduced service charge for pre-existing clients*</li><li>No service charge when hosting free activities</li><li>Access to HulaHub client acquisition tools</li><li>HulaHub coins are paid for on an as used basis</li></ul><p>For better value and significantly reduced service charges upgrade to a paid plan at any time.</p><p class="small no-margins">*Subject to a minimum charge of &pound;1.50</p></div><div ng-show="subscription.id != \'FREE\'"><div class="gutterMarginBottom" ng-show="subscription.id === \'Professional_Month_Trial\' || subscription.id === \'Professional_Year_Trial\'"><div class="row"><div class="col-xs-6 col-sm-9"><strong>Free trial</strong> ({{ subscription.trialDays }} days)</div><div class="col-xs-6 col-sm-3 text-right" ng-show="subscription.status === \'trialing\'">Active</div><div class="col-xs-6 col-sm-3 text-right" ng-show="subscription.status !== \'trialing\'">Ended</div></div></div><div class="row"><div class="col-xs-6 col-sm-9"><strong>Price</strong></div><div class="col-xs-6 col-sm-3 text-right">{{ subscription.cost | currencyDisplay:\'GBP\':false }}/{{ subscription.recurrence }}</div></div><div class="row gutterMarginTop"><div class="gutterMarginBottom col-xs-6 col-sm-9"><strong ng-if="subscription.autoRenew">Next payment</strong> <strong ng-if="!subscription.autoRenew">Plan expires</strong> <a class="helpButton" ng-click="showPlanExpiryPopup()"><i class="ico ico-question fixedSize"></i></a></div><div class="col-xs-6 col-sm-3 text-right">{{ subscription.nextPayment }}</div></div><div ng-show="loadingCards" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingCards"><div class="form-group gutterMarginBottom" ng-show="existingCards.length"><label>Payment card</label><select name="paymentCards" class="form-control" ng-model="existingCard" ng-options="option.stripeCardId as option.display for option in existingCards" ng-change="changePaymentcard()"><option value="">Add a new card...</option></select></div><div ng-show="!existingCard"><payment-card-form on-submit="saveCard" button-text="Save new card" on-back="cancelNewCard()" back-button-icon="ico-cross" back-button-text="Cancel" back-button-class="btn-red"></payment-card-form></div></div><div class="row" ng-show="existingCard"><div class="vAlignParent full-width"><div class="vAlign col-xs-6 col-sm-10"><strong>Status: </strong><span ng-if="subscription.autoRenew">Active</span><span ng-if="!subscription.autoRenew">Cancelled</span></div><div class="vAlign col-xs-6 col-sm-2 text-right" ng-show="auth.currentUser.registrationType !== \'host\' || auth.isMasquerading()"><div class="switchContainer"><switch ng-model="subscription.autoRenew" ng-change="changeAutoRenew()"></switch></div></div></div></div><div class="divider gutterMarginTop gutterMarginBottom" ng-show="existingCard"></div><p class="no-margins small text-xs-left text-sm-right" ng-show="existingCard && auth.currentUser.registrationType === \'joiner\'">To cancel your subscription turn off the switch and you will revert to the free plan at the end of your subscription period.<br>Please see our <a href="{{ env.public }}/terms/payment-terms" target="_blank" class="profile underlinedLink">payment terms</a> for details.</p><p class="no-margins small text-xs-left text-sm-right" ng-show="existingCard && auth.currentUser.registrationType === \'host\'">To cancel your subscription or change plans, email us at <a href="mailto:support@hulahub.com" class="profile underlinedLink">support@hulahub.com</a> or call us on <a href="tel:03333 443996" class="profile underlinedLink">03333 443996</a>.<br>Please see our <a href="{{ env.public }}/terms/payment-terms" target="_blank" class="profile underlinedLink">payment terms</a> for details.</p></div></div></div></section><section ng-show="promoCodes.length" class="row white-bg gutterMarginBottom"><header class="sectionHeader profile"><div class="h3">Promotional codes<a class="helpButton" ng-click="showPromoCodePopup()"><i class="ico ico-question fixedSize"></i></a></div></header><div class="sectionContent withOffsetBorder"><div ng-show="loadingPromoCodes" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loadingPromoCodes"><p class="h3 no-margins text-center" ng-if="!promoCodes.length">You haven\'t applied any promotional codes yet.</p><div ng-repeat="row in promoCodes" class="row noGutter" ng-class="{\'gutterPaddingBottom half gutterMarginBottom\': !$last}"><div class="col-xs-12 col-sm-8"><strong>{{ ::row.title }}</strong> ({{ ::row.code }})</div><div class="col-xs-12 col-sm-4 text-sm-right">Applied on {{ ::row.date | dateFormat:\'DD/MM/YYYY\' }}</div></div></div></div></section><section ng-show="!loadingSubscriptionInfo && subscription.id !== \'ENTERPRISE_MONTH\' && subscription.id !== \'ENTERPRISE_YEAR\'" id="otherPlans" class="row gutterMarginBottom"><section-header text="Upgrade to another plan" type="profile"></section-header></section><div class="row availablePlans" ng-show="!loadingSubscriptionInfo"><div class="item gutterMarginBottom" ng-show="auth.currentUser.registrationType === \'joiner\' && subscription.id === \'FREE\'"><div class="sectionHeader profile" ng-click="showPlan($event)"><h2>Personal plan</h2>&pound;3/month (or Â£25/year)</div><div class="accordionContent"><div class="white-bg sectionContent text-xs-center text-sm-left"><div class="row"><div class="col-xs-12 col-sm-8"><p class="h2 gutterMarginBottom"><strong>Ideal for people who regularly participate in leisure activities</strong></p><p>We make it super easy to join leisure activities, bring along your guests and invite friends to join you on your next sporting adventure or relaxing cultural event.</p><div class="divider gutterMarginTop gutterMarginBottom visible-xs"></div><ul class="list-unstyled"><li>Join unlimited activities nationwide</li><li>Enjoy 6,000+ retail discounts</li><li>Find and join local interest groups</li><li>Discounts on group bookings</li></ul></div><div class="col-xs-12 col-sm-3 col-sm-offset-1"><a ui-sref="billing.subscriptionPlans.switch({plan:\'personal\'})" class="btn btn-profile btn-block"><i class="ico ico-refresh"></i>Upgrade</a></div></div></div></div></div><div class="item gutterMarginBottom" ng-show="auth.currentUser.registrationType === \'host\' && (subscription.id === \'FREE\' || subscription.id === \'PERSONAL_MONTH\' || subscription.id === \'PERSONAL_YEAR\')"><div class="sectionHeader profile" ng-click="showPlan($event)"><h2>Professional plan<span ng-if="!subscription.usedTrial"> (with 30-day Free Trial)</span></h2>&pound;12/month (or Â£100/year)</div><div class="accordionContent"><div class="white-bg sectionContent text-xs-center text-sm-left"><div class="row"><div class="col-xs-12 col-sm-8"><p class="h2 gutterMarginBottom"><strong>Ideal for independent sports and leisure professionals</strong></p><p>Proactively market yourself to people interested in exactly what you offer, show case what you do with a high quality business profile and enjoy heavily discounted services charges.</p><div class="divider gutterMarginTop gutterMarginBottom visible-xs"></div><ul class="list-unstyled"><li ng-if="!subscription.usedTrial">30-day no obligation Free Trial</li><li>Inclusive client acquisition tools</li><li>Inclusive HulaCoins to spend on proactive marketing</li><li>Business profile with reviews & ratings</li><li>Dedicated account manager</li><li>2% service charge for all paid bookings*</li><li>No service charge when hosting free activities</li><li>Access to 6,000+ retail discounts</li></ul><div class="small gutterMarginTop">*Subject to a minimum charge of &pound;1.50</div></div><div class="col-xs-12 col-sm-3 col-sm-offset-1"><a ng-show="!subscription.usedTrial" ui-sref="billing.subscriptionPlans.switch({plan:\'professional\', usingTrial:true})" class="btn btn-profile btn-block"><i class="ico ico-refresh"></i>Start FREE trial</a> <a ng-show="subscription.usedTrial" ui-sref="billing.subscriptionPlans.switch({plan:\'professional\', usingTrial:false})" class="btn btn-profile btn-block"><i class="ico ico-refresh"></i>Upgrade</a></div></div></div></div></div><div class="item" ng-show="auth.currentUser.registrationType === \'host\' && (subscription.id === \'FREE\' || subscription.id === \'PROFESSIONAL_MONTH\' || subscription.id === \'PROFESSIONAL_YEAR\' || subscription.id === \'Professional_Month_Trial\' || subscription.id === \'Professional_Year_Trial\')"><div class="sectionHeader profile" ng-click="showPlan($event)"><h2>Enterprise plan</h2>&pound;120/month (or Â£1,000/year)</div><div class="accordionContent"><div class="white-bg sectionContent text-xs-center text-sm-left"><div class="row"><div class="col-xs-12 col-sm-8"><p class="h2 gutterMarginBottom"><strong>Ideal for larger sports or leisure organisations with a range of bookable activities and / or locations</strong></p><div class="divider gutterMarginBottom visible-xs"></div><ul class="list-unstyled"><li>Business profile, reviews &amp; ratings</li><li>Dedicated account manager</li><li>Multi-administrator access</li><li>1.3% service charge for all paid bookings*</li><li>No service charge when hosting free activities</li><li>Enjoy 6,000+ retail discounts for all plan users</li></ul><div class="small gutterMarginTop">*Subject to a minimum charge of &pound;1.50</div></div><div class="col-xs-12 col-sm-3 col-sm-offset-1"><a ng-click="showContactForm()" class="btn btn-profile btn-block"><i class="ico ico-message"></i>Contact us</a></div></div></div></div></div></div>'),$templateCache.put("billing/views/switch-plan.html",'<section class="row white-bg"><section-header text="Upgrade plan to {{ selectedPlan.title }}" type="profile"></section-header><div class="sectionContent withOffsetBorder"><p class="h3 gutterMarginBottom"><strong>1. Choose {{ selectedPlan.title }} plan subscription</strong></p><div class="gutterMarginBottom" ng-show="usingTrial && auth.currentUser.registrationType === \'host\'">Your no obligation 30-day free trial will start immediately on upgrade and can be cancelled at any point during that period whereupon your will revert to free Essential plan.</div><div class="planSelection marginBottom profile"><div class="row"><div class="col-xs-12 col-sm-6 vAlign"><div class="row halfGutter"><div class="col-xs-6" ng-click="paymentOption=\'monthly\'"><div class="switchWithLabel radioButton profile" ng-class="{\'active\' : paymentOption == \'monthly\'}"><div class="vAlignParent full-width"><div class="vAlign"><div class="radio hidden-xs hidden-sm"></div></div><div class="vAlign text-xs-center text-sm-right"><label class="h2"><strong>{{ selectedPlan.monthly.cost | currencyDisplay:\'GBP\':false }}</strong><span class="small">/month</span></label></div></div></div></div><div class="col-xs-6" ng-click="paymentOption=\'annual\'"><div class="switchWithLabel radioButton profile" ng-class="{\'active\' : paymentOption == \'annual\'}"><div class="vAlignParent full-width"><div class="vAlign"><div class="radio hidden-xs hidden-sm"></div></div><div class="vAlign text-xs-center text-sm-right"><label class="h2"><strong>{{ selectedPlan.annual.cost | currencyDisplay:\'GBP\':false }}</strong><span class="small">/year</span></label></div></div></div></div></div></div><div class="col-xs-12 form-group gutterMarginTop"><label class="notBold">Add a promotional code<a class="helpButton" ng-click="showPromoCodePopup()"><i class="ico ico-question fixedSize"></i></a></label><div class="vAlignParent"><div class="vAlign" style="padding-right: 10px"><input ng-model="promoCode.value" type="text" class="form-control"></div><div class="vAlign"><button type="button" class="btn btn-profile" ng-click="validatePromoCode()" ng-disabled="!promoCode.value">Apply</button></div></div><div class="gutterMarginTop half" ng-show="formErrors.promoCode || (promoCode.value && promoCode.verified && !promoCode.valid)"><strong class="redColour">Sorry!</strong> {{ promoCode.validMessage || \'You need a valid promotional code.\' }}</div><div class="gutterMarginTop half" ng-show="promoCode.value && promoCode.verified && promoCode.valid"><strong class="greenColour">Success!</strong> {{ promoCode.validMessage }}</div></div></div></div><div class="divider marginTop marginBottom"></div><p class="h3 gutterMarginBottom"><strong>2. Enter payment details</strong></p><div ng-show="loadingCards" class="text-center"><div class="loadingSpinner basic"></div></div><div class="row" ng-show="!loadingCards"><div class="col-xs-12"><div class="form-group" ng-show="existingCards.length"><label>Select an existing payment card or add a new one</label><select name="paymentCards" class="form-control" ng-model="existingCard" ng-options="option.stripeCardId as option.display for option in existingCards"><option value="">Add a new card...</option></select></div><div ng-show="!existingCard"><payment-card-form show-save-button="false" submission-handler="paymentFormSubmissionHandler" on-submit="save"></payment-card-form></div></div></div><div class="clearfix" ng-show="!loadingCards"><button class="btn btn-red pull-left btn-outline" type="button" ng-click="cancel()"><i class="ico ico-cross"></i> Cancel</button> <button ng-show="!usingTrial || auth.currentUser.registrationType === \'joiner\'" class="btn btn-green pull-right" type="button" ng-click="checkPaymentForm()"><i class="ico ico-tick"></i> Upgrade</button> <button ng-show="usingTrial && auth.currentUser.registrationType === \'host\'" class="btn btn-green pull-right" type="button" ng-click="checkPaymentForm()"><i class="ico ico-tick"></i> Start FREE trial</button></div></div></section>'),
$templateCache.put("billing/views/transactions.html",'<section class="row white-bg"><section-header text="Transactions" type="profile"></section-header><div class="sectionContent withOffsetBorder"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading"><form name="form" novalidate autocomplete="off" class="row halfGutter"><div class="form-group col-xs-12 col-sm-5"><label>From</label><div class="iconInput inlineControlMobile"><i class="ico ico-calendar" ng-click="filterTransactions.dateRange.open(\'start\', true)"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="filterTransactions.dateRange.startDate.date" datepicker-options="filterTransactions.dateRange.options" is-open="filterTransactions.dateRange.startDate.isOpen" show-button-bar="false" ng-focus="filterTransactions.dateRange.open(\'start\', true)" datepicker-append-to-body="true"></div></div><div class="form-group col-xs-12 col-sm-5"><label>To</label><div class="iconInput inlineControlMobile"><i class="ico ico-calendar" ng-click="filterTransactions.dateRange.open(\'end\')"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="filterTransactions.dateRange.endDate.date" datepicker-options="filterTransactions.dateRange.options" is-open="filterTransactions.dateRange.endDate.isOpen" show-button-bar="false" ng-focus="filterTransactions.dateRange.open(\'end\')" datepicker-append-to-body="true"></div></div><div class="form-group col-xs-12 col-sm-2"><label class="hidden-xs">&nbsp;</label><button class="btn btn-outline btn-profile btn-block" ng-click="filterTransactions.update()"><i class="ico ico-search"></i> Search</button></div></form><p class="marginTop h2 text-center" ng-hide="allBillingItems.length">You have no transactions between {{ filterTransactions.dateRange.startDate.date | dateFormat:\'DD/MM/YY\' }} and {{ filterTransactions.dateRange.endDate.date | dateFormat:\'DD/MM/YY\' }}.</p><table ng-show="allBillingItems.length" class="paymentsTable" cellspacing="0" cellpadding="0" border="0"><tr><th width="110" class="hidden-xs">Date</th><th>Description</th><th width="100" class="text-right">Payment</th></tr><tr ng-repeat="billingItem in allBillingItems" ng-class="{\'last\': $last}"><td class="hidden-xs">{{ billingItem.date | dateFormat:\'DD/MM/YY\' }}</td><td><span class="show visible-xs">{{ billingItem.date | dateFormat:\'DD/MM/YY\' }}</span> <a ui-sref="billing.transactions.detail({billingItemId: billingItem.id})" class="profile">{{ billingItem.title }}</a> <span class="show small textColour">{{ billingItem.otherUser.name }}</span> <span class="show small text-uppercase textColour">{{ billingItem.type }}</span> <a ui-sref="billing.transactions.detail({billingItemId: billingItem.id})" class="profile small">View details</a></td><td class="text-right"><span ng-if="billingItem.total > 0">+</span>{{ billingItem.total | currencyDisplay:billingItem.currency:true:false:true }}</td></tr></table></div></div></section>'),$templateCache.put("booking-requests/views/edit-booking-request.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()" ng-show="!loading"><span>&times;</span></a><h1 class="modal-title">Change date and time</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="alert alert-danger" ng-show="errorMessage">{{ errorMessage }}</div><form name="form" novalidate autocomplete="off" class="row halfGutter" ng-show="!loading"><h3 class="col-xs-12 marginBottom">{{ ::activity.title }}</h3><p class="col-xs-12 marginBottom redColour" ng-if="activity.bookingRequest.status == \'declined\'">Unfortunately the {{ activity.bookingRequest.startDate | dateFormat:\'DD/MM/YYYY [at] HH:mm\' }} has been declined by the host so please pick a new date and time.</p><div class="form-group col-xs-12 col-sm-6"><div class="iconInput inlineControlMobile"><i class="ico ico-calendar" ng-click="availability.datePicker.open()"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="availability.datePicker.date" datepicker-options="availability.datePicker.options" is-open="availability.datePicker.isOpen" show-button-bar="false" ng-focus="availability.datePicker.open()" datepicker-template-url="core/partials/uib-datepicker/datepicker.html"></div></div><div class="form-group col-xs-12 col-sm-6"><select ng-show="!availability.noAvailableTimes" class="form-control" ng-model="availability.selectedTime" ng-options="t as t.label for t in availability.availableTimes()" ng-disabled="!availability.datePicker.date"><option value="" disabled="disabled">Choose a time slot...</option></select><span ng-show="availability.noAvailableTimes" style="display: block; height: 34px; line-height:34px">Sorry, this date is fully booked</span></div><div class="form-group no-margins col-xs-12"><label>Message</label><textarea class="form-control" rows="5" ng-model="message" placeholder="Here you can write any questions you may have for the host..."></textarea></div></form></div><div class="modal-footer" ng-show="!loading"><button class="btn btn-textcolour btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green" type="button" ng-click="submit()" ng-disabled="!availability.datePicker.date || !availability.selectedTime"><i class="ico ico-tick"></i>Submit</button></div>'),$templateCache.put("booking-requests/views/flexible-booking-form.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Select date and time</h1></div><div class="modal-body"><div ng-show="loadingAvailability" class="text-center"><div class="loadingSpinner basic"></div></div><form name="form" novalidate autocomplete="off" ng-show="!loadingAvailability"><div class="form-group"><div ng-if="!loadingAvailability" uib-datepicker class="inPageCalendar" ng-model="availability.datePicker.date" datepicker-options="availability.datePicker.options" template-url="core/partials/uib-datepicker/datepicker.html"></div></div><strong>Availability for {{ availability.datePicker.date | dateFormat:\'ddd, D MMM YYYY\' }}</strong><div class="form-group borderTop marginTop paddingTop"><select ng-show="!availability.noAvailableTimes" class="form-control" ng-model="availability.selectedTime" ng-options="t as t.label for t in availability.availableTimes()" ng-disabled="!availability.datePicker.date"><option value="" disabled="disabled">Choose time slot</option></select><span ng-show="availability.noAvailableTimes" style="display: block; height: 34px; line-height:34px">Sorry, this date is fully booked</span></div><ul class="list-unstyled iconBulletList no-margins"><li><i class="ico ico-coins"></i><span>{{ availability.price.perPerson | currencyDisplay:availability.price.currency }}<span ng-if="availability.price.perPerson > 0"> per person</span></span></li><li><i class="ico ico-pin"></i><span>{{ availability.locality }}</span></li></ul><div class="marginTop"><button type="button" ng-click="joinActivity()" ng-disabled="!availability.datePicker.date || !availability.selectedTime" class="btn btn-profile btn-block"><i class="ico ico-calendar"></i>Request date</button></div></form></div>'),$templateCache.put("booking-requests/views/manage-booking-request.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()" ng-show="!loading"><span>&times;</span></a><h1 class="modal-title">{{ ::response|capitalize }} booking request</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading"><h3 class="smallMargin">{{ ::bookingRequest.title }}</h3><div class="smallMargin">{{ ::bookingRequest.from.name }} would like to make a booking for {{ bookingRequest.startDate|dateFormat:\'ddd D MMMM YYYY [at] HH:mm\' }}.</div><strong class="contactsColour" ng-if="response === \'accept\' && bookingRequest.costPerSpot > 0 && !auth.currentUser.stripeAccountConnected">To accept this booking request you must first connect your bank account</strong><form class="gutterMarginTop half" name="form" novalidate autocomplete="off" ng-show="response === \'decline\' || (bookingRequest.costPerSpot == 0 || (bookingRequest.costPerSpot > 0 && auth.currentUser.stripeAccountConnected))"><div class="form-group" ng-if="response === \'decline\'"><label>What is the reason for cancelling this activity</label><div class="radioButton clearfix activities gutterMarginBottom half" ng-class="{\'active\': formData.reason === \'unavailable\'}" ng-click="formData.reason = \'unavailable\'"><div class="pull-left radio"></div><label class="pull-left">This slot is no longer available</label></div><div class="radioButton clearfix activities" ng-class="{\'active\': formData.reason !== \'unavailable\'}" ng-click="formData.reason = \'other\'"><div class="pull-left radio"></div><label class="pull-left">Other reason</label></div></div><div class="form-group no-margins" ng-class="{ \'has-error\': validationRun && form.message.$invalid }"><label>Message<span ng-if="response === \'decline\'">*</span></label><textarea class="form-control" rows="5" ng-model="formData.message" name="message" placeholder="{{ messagePlaceholder }}" ng-required="response === \'decline\'"></textarea><span class="help-block" ng-show="validationRun && form.message.$invalid">A message is required</span></div></form></div></div><div class="modal-footer" ng-show="!loading"><button class="btn btn-textcolour btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green" ng-if="response === \'accept\'" ng-click="respond()" ng-disabled="bookingRequest.costPerSpot > 0 && !auth.currentUser.stripeAccountConnected" type="button"><i class="ico ico-tick"></i>Accept</button> <button class="btn btn-red" ng-if="response === \'decline\'" ng-click="respond()" type="button"><i class="ico ico-tick"></i>Decline</button></div>'),$templateCache.put("contacts/views/add-to-group.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Add {{ contact.firstName }} to groups</h1></div><div class="modal-body"><div ng-show="contactLoading || groupLoading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div><div class="addContactToGroupList" ng-show="!contactLoading && !groupLoading"><div ng-if="!allGroups.length" class="text-center"><h3 class="marginBottom">You haven\'t created any groups yet</h3><a class="btn btn-outline btn-contacts" ui-sref="contacts.groups" ng-click="$dismiss()"><i class="ico ico-group"></i>Create groups</a></div><div ng-if="allGroups.length" class="vAlignParent marginBottom"><span class="vAlign circlePhoto contacts lrg" ng-class="{\'noPhoto\': !contact.avatarURL}" style="background-image:url(\'{{contact.avatarURL}}\')"></span><div class="vAlign"><span class="h3">{{ contact.name }}</span></div></div><p ng-if="allGroups.length">Select the groups that you would like {{contact.firstName}} to be a part of</p><ul class="no-margins noPadding list-unstyled"><li ng-repeat="group in allGroups"><label class="vAlignParent"><span class="vAlign"><span class="checkbox ico ico-tick" ng-class="{\'checked\': isSelected(group.id)}"></span> </span><span class="vAlign"><input type="checkbox" checklist-model="selectedGroups" checklist-value="group"> {{ group.name }}</span></label></li></ul></div></div><div class="modal-footer" ng-show="!contactLoading && !groupLoading"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button ng-if="allGroups.length" class="btn btn-green btn-outline pull-right" type="button" ng-click="save()"><i class="ico ico-tick"></i> Save</button></div>'),$templateCache.put("contacts/views/contact-search.html",'<div class="row alert alert-warning" ng-if="!auth.currentUser.emailVerified">Please verify your email address to connect with other members.</div><section class="row white-bg gutterMarginBottom"><section-header text="Find contacts" type="contacts"></section-header><div class="sectionContent withOffsetBorder noPaddingBottom"><search-contact-filters></search-contact-filters></div></section><section class="row contactsRow" ng-show="!loading"><div class="column col-xs-12 col-sm-6 col-md-4" ng-repeat="user in contacts"><profile-card user="user"></profile-card></div><section class="white-bg marginTop" ng-show="!contacts.length"><span class="h2 show sectionContent text-center">No users found. Adjust your search criteria and try again.</span></section></section><div class="row gutterMarginTop" ng-show="!loading && contacts"><div class="row"><div class="vAlignParent full-width"><div class="col-xs-4 vAlign"><a ng-show="pagination.currentPage > 1" ng-click="pagination.prevPage()" class="btn btn-textcolour btn-outline"><i class="ico ico-chevron-left"></i> Back</a></div><div ng-show="pagination.totalPages > 0" class="col-xs-4 vAlign text-center"><span>Page {{ pagination.currentPage }} of {{ pagination.totalPages }}</span></div><div class="col-xs-4 vAlign text-right"><a ng-show="pagination.currentPage < pagination.totalPages" ng-click="pagination.nextPage()" class="btn btn-textcolour btn-outline iconRight">Next <i class="ico ico-chevron-right"></i></a></div></div></div></div><div ng-show="loading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div>'),$templateCache.put("contacts/views/groups.html",'<section class="row white-bg editGroupsPage"><section-header text="Groups" type="contacts"><a class="btn btn-contacts btn-outline" ng-click="manageGroups()"><i class="ico ico-group"></i>Manage groups</a></section-header><div class="sectionContent withOffsetBorder"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div><div ng-show="!loading" class="row"><div class="col-xs-12"><strong class="block gutterMarginBottom">Select existing group</strong></div><div class="col-xs-6"><select id="groupSelectBox" class="form-control" ng-model="selectedGroup" ng-options="g as g.name for g in allGroups" ng-disabled="groupLoading"><option value="" disabled="disabled">Select a group...</option></select></div><div class="col-xs-6 text-right"><a class="btn btn-outline" ng-class="{\'btn-disabled\': !changesToSave, \'btn-green\': changesToSave}" ng-disabled="!changesToSave" ng-click="saveGroup()"><i class="ico ico-tick"></i> Save</a></div></div><div ng-show="!loading" class="divider gutterMarginTop gutterMarginBottom"></div><div ng-show="!loading" class="row"><div class="col-xs-6"><strong class="block gutterMarginBottom">All contacts</strong><div class="form-group" ng-show="allGroups.length && selectedGroup && !contactLoading && !groupLoading"><div class="input-group"><input type="text" class="form-control noBorderRight" placeholder="Search by name..." ng-model="searchAvailableContacts"> <span class="input-group-addon justTooltip"><i class="ico ico-search fixedSize"></i></span></div></div><div class="contactList"><div ng-show="contactLoading || groupLoading" class="text-center"><div class="loadingSpinner basic marginTop"></div></div><div ng-hide="contactLoading || groupLoading"><div class="emptyWidget" ng-show="!allGroups.length"><h3>You haven\'t created any groups yet</h3><div><a ng-click="manageGroups()" class="btn btn-contacts btn-outline"><i class="ico ico-group"></i>Create groups</a></div></div><p ng-show="allGroups.length && !availableContacts.length && !searchAvailableContacts">There are no contacts available to be added to this group.</p><p ng-show="allGroups.length && !selectedGroup">You must select a group above to add contacts.</p><ul class="list-unstyled no-margins" ng-show="selectedGroup && filteredAvailableContacts.length"><li class="vAlignParent full-width" ng-repeat="contact in filteredAvailableContacts = (availableContacts|filter: { name: searchAvailableContacts })"><div class="vAlign avatarColumn"><span class="circlePhoto med contacts" ng-class="{\'noPhoto\': !contact.avatarURL}" style="background-image:url(\'{{contact.avatarURL}}\')"></span></div><div class="vAlign">{{ contact.name }}</div><div ng-hide="groupLoading" class="vAlign text-right"><a class="circleButton green" ng-click="addToGroup(contact);" uib-tooltip="Add {{ contact.name }} to group"><i class="ico ico-double-chevron-right"></i></a></div></li></ul><p ng-show="selectedGroup && searchAvailableContacts && !filteredAvailableContacts.length">You have no contacts matching that search.</p></div></div></div><div class="col-xs-6 borderLeft"><strong class="block gutterMarginBottom clearfix"><span ng-show="groupLoading">Contacts in {{ selectedGroup.name || "group" }}</span> <span ng-hide="groupLoading"><ng-pluralize count="selectedContacts.length" when="{\'one\': \'1 contact in \', \'other\': \'{} contacts in \'}"></ng-pluralize>{{ selectedGroup.name || "group" }}</span></strong><div class="form-group" ng-show="allGroups.length && selectedContacts.length && !groupLoading"><div class="input-group"><input type="text" class="form-control noBorderRight" placeholder="Search by name..." ng-model="searchSelectedContacts"> <span class="input-group-addon justTooltip"><i class="ico ico-search fixedSize"></i></span></div></div><div class="contactList"><div ng-show="groupLoading" class="text-center"><div class="loadingSpinner basic marginTop"></div></div><div ng-hide="groupLoading"><ul class="list-unstyled no-margins" ng-show="selectedContacts.length"><li class="vAlignParent full-width" ng-repeat="contact in filteredSelectedContacts = (selectedContacts | filter: { name: searchSelectedContacts })"><div class="vAlign avatarColumn"><span class="circlePhoto med contacts" ng-class="{\'noPhoto\': !contact.avatarURL}" style="background-image:url(\'{{contact.avatarURL}}\')"></span></div><div class="vAlign">{{ contact.name }}</div><div class="vAlign text-right"><a class="circleButton red" ng-click="removeFromGroup(contact);" uib-tooltip="Remove {{ contact.name }} from group"><i class="ico ico-cross"></i></a></div></li></ul><p ng-show="selectedContacts.length && !filteredSelectedContacts.length">No contacts matching that search in this group.</p></div></div></div><div class="col-xs-12 gutterMarginTop text-right"><a class="btn btn-outline" ng-class="{\'btn-disabled\': !changesToSave, \'btn-green\': changesToSave}" ng-disabled="!changesToSave" ng-click="saveGroup()"><i class="ico ico-tick"></i> Save</a></div></div></div></section>'),$templateCache.put("contacts/views/invite-contacts.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Invite contacts" type="contacts"></section-header></section><div class="findContacts"><div class="row"><div class="tiles full-width"><section class="col-xs-12 col-sm-6 noPadding wrap messages"><div class="sectionContent"><h2>Invite your friends and clients by email</h2><div ng-show="findContactsLoading" class="text-center"><div class="loadingSpinner wink whiteBG"></div></div><div class="form-group" ng-class="{\'has-error\': errorMessage || invalidEmails.length}" ng-show="!findContactsLoading && inviteStep == 1"><div ng-if="newContacts.length" class="gutterMarginBottom"><div class="bigger">Great news! you are now contacts with&nbsp;<name-list items="newContacts"></name-list></div>Add a few more if you like...</div><div ng-if="sent.length" class="gutterMarginBottom"><div class="bigger">OK! {{ sent.length }} invitation<span ng-show="sent.length > 1">s have </span><span ng-show="sent.length == 1">&nbsp;has </span>been sent!</div><name-list items="sent"></name-list><div ng-if="!invalidEmails.length" style="margin-top:10px">Add a few more if you like...</div></div><div ng-if="invalidEmails.length" class="error">Unfortunately the following email address<span ng-show="invalidEmails.length > 1">es are </span><span ng-show="invalidEmails.length == 1">&nbsp;is </span>invalid - please retry:</div><textarea class="form-control" ng-model="inviteTextBox" rows="10" placeholder="Add up to 50 email addresses here"></textarea><span class="help-block" ng-show="errorMessage">{{ errorMessage }}</span></div><div ng-show="!findContactsLoading && (inviteStep == 2)"><div ng-if="newContacts.length" class="gutterMarginBottom"><span class="bigger">Great news! you are now contacts with&nbsp;<name-list items="newContacts"></name-list></span></div><div class="bigger">OK! let\'s send a<span ng-show="possibleInvites.length > 1"> few</span> personal invitation<span ng-show="possibleInvites.length > 1">s</span>...</div><name-list items="possibleInvites"></name-list></div><div class="row noGutter no-margins" ng-show="!findContactsLoading && inviteStep == 1"><div class="col-xs-12 col-md-6 text-right pull-right"><button type="button" class="btn btn-white btn-block btn-outline hoverMessageColor" ng-click="findContacts()" ng-disabled="inviteTextBox == \'\'"><i class="ico ico-person-plus"></i>Send</button></div><div class="col-xs-12 col-md-6 pull-left"><p class="description">First, we\'ll check if these contacts are HulaHub members and connect you straight away, then send invitations to the rest.</p></div></div><div class="row noGutter marginTop" ng-show="!findContactsLoading && inviteStep == 2"><div class="col-xs-6 text-right pull-right"><button type="button" class="btn btn-white btn-block btn-outline hoverMessageColor" ng-click="sendInvites()"><i class="ico ico-person-plus"></i>Send invites</button></div><div class="col-xs-6 pull-left"><button type="button" class="btn btn-white btn-outline hoverMessageColor" ng-click="inviteBackStep()"><i class="ico ico-chevron-left"></i>Back</button></div></div></div></section><section class="col-xs-12 col-sm-6 noPadding wrap facebook" ng-class="{\'noBG\': facebookFeedback || facebookLoading}"><div class="sectionContent"><h2 ng-class="{\'extraSpacing\': !facebookFeedback && !facebookLoading }">Connect your Facebook friends</h2><div ng-show="facebookLoading" class="text-center"><div class="loadingSpinner basic whiteBG"></div></div><div ng-hide="facebookLoading" ng-show="facebookFeedback"><p ng-if="facebookFeedback != true">{{ facebookFeedback }}</p><div ng-if="contactsAdded.length"><span ng-show="contactsAdded.length <= 10">Great news! <span ng-repeat="contact in contactsAdded"><a ui-sref="contacts.public({userId: contact.id})">{{contact.name}}</a>{{$last ? \'\' : ($index == contactsAdded.length-2) ? \' and \' : \', \'}}</span><ng-pluralize count="contactsAdded.length" when="{ \'one\': \' has been added as a friend from Facebook\', \'other\': \' have been added as friends from Facebook\'}"></ng-pluralize></span><span ng-show="contactsAdded.length && contactsAdded.length > 10">Great news! {{ contactsAdded.length }} new friends have been added from Facebook, including: <span ng-repeat="contact in contactsAdded | limitTo: 5"><a ui-sref="contacts.public({userId: contact.id})">{{contact.name}}</a>{{$last ? \'\' : ($index == 3) ? \' and \' : \', \'}} </span></span>.</div><div class="row noGutter marginTop" ng-if="spreadWordButton"><div class="col-xs-12 text-right pull-right"><button type="button" class="btn btn-white btn-block btn-outline hoverFacebookColor" ng-click="shareFacebook()"><i class="ico ico-facebook"></i>Spread the word</button></div></div></div><div ng-hide="facebookLoading || facebookFeedback" class="row noGutter"><div class="col-xs-12 col-md-6 text-right pull-right"><button type="button" class="btn btn-white btn-block btn-outline hoverFacebookColor" ng-click="findOnFacebook()"><i class="ico ico-facebook"></i>Connect</button></div><div class="col-xs-12 col-md-6 pull-left"><p class="description">Privacy note: don\'t worry - this won\'t post anything to Facebook, we\'ll just connect your friends. Simple!</p></div></div></div></section></div></div></div>'),$templateCache.put("contacts/views/manage-groups.html",'<div ng-show="!isModal"><section class="row white-bg gutterMarginBottom"><section-header text="Manage groups" type="contacts"></section-header><div class="sectionContent withOffsetBorder"><include-with-scope template-path="manageGroupContent"></include-with-scope></div></section></div><div ng-show="isModal"><div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Add or edit groups</h1></div><div class="modal-body"><include-with-scope template-path="manageGroupContent"></include-with-scope></div><div class="modal-footer" ng-if="isModal"><button class="btn btn-green btn-outline pull-right" type="button" ng-click="$dismiss()"><i class="ico ico-tick"></i> OK</button></div></div><script type="text/ng-template" id="manageGroupContent"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div>\n    <div ng-show="!loading">\n        <form name="newGroupForm" class="row halfGutter" novalidate>\n            <div class="form-group col-xs-8" ng-class="{ \'has-error\' : validationRun && newGroupForm.newGroupName.$invalid }">\n                <input class="form-control" type="text" ng-model="newGroupName" name="newGroupName" placeholder="Add new group..." required />\n                <span class="help-block" ng-show="validationRun && newGroupForm.newGroupName.$invalid">A group name is required</span>\n            </div>\n            <div class="form-group col-xs-4">\n                <button type="submit" class="btn btn-contacts btn-block" ng-click="createGroup()"><i class="ico ico-plus fixedSize"></i>Add</button>\n            </div>\n        </form>\n\n        <div class="manageGroupList">\n            <p class="h3 no-margins text-center" ng-if="!allGroups.length">You haven\'t created any groups yet.</p>\n            <div ng-repeat="group in allGroups">\n                <div ng-show="!group.editing">\n                    <label>{{group.name}}</label>\n                    <div class="pull-right">\n                        <a class="contact" ng-click="setEditing(group, true)" uib-tooltip="Rename group" tooltip-placement="left" tooltip-append-to-body="false"><i class="ico ico-edit"></i></a>\n                        <a class="contact" ng-click="removeGroup(group)" uib-tooltip="Remove group" tooltip-placement="left" tooltip-append-to-body="false"><i class="ico ico-cross"></i></a>\n                    </div>\n                </div>\n                <form novalidate ng-show="group.editing" class="row noGutter">\n                    <div class="form-group no-margins col-xs-8" ng-class="{ \'has-error\' : group.name == \'\' }">\n                        <input class="form-control" type="text" id="group_{{group.id}}" ng-model="group.name" />\n                        <span class="help-block" ng-show="group.name == \'\'">A group name is required</span>\n                    </div>\n                    <div class="col-xs-4 text-right">\n                        <button type="submit" class="circleButton green" ng-click="renameGroup(group)" ng-disabled="group.name == \'\'" ng-class="{\'disabled\' : group.name == \'\'}"><i class="ico ico-tick"></i></button>\n                        <a class="circleButton red" ng-click="setEditing(group, false)"><i class="ico ico-cross"></i></a>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div></script>'),$templateCache.put("contacts/views/my-contacts.html",'<section class="row white-bg gutterMarginBottom"><section-header text="My contacts" type="contacts"><a ng-if="auth.currentUser.emailVerified" style="margin-right: 10px" class="btn btn-contacts btn-outline" ui-sref="contacts.invites"><i class="ico ico-person-plus noSpacingXS"></i><span class="hidden-xxs">Invite contacts</span></a> <a class="btn btn-facebook btn-outline" ng-click="shareFacebook()"><i class="ico ico-facebook noSpacingXS"></i><span class="hidden-xs">Spread the word</span></a></section-header><div class="sectionContent withOffsetBorder noPaddingBottom"><my-contact-filters></my-contact-filters></div></section><section class="row contactsRow" ng-show="!loading"><div class="column col-xs-12 col-sm-6 col-md-4" ng-repeat="user in contacts"><profile-card user="user"></profile-card></div><section class="white-bg marginTop" ng-show="!contacts.length"><div ng-if="!hasSearched" class="sectionContent"><div class="noContent contacts">Hint: <a ui-sref="contacts.find">find contacts</a>. HulaHub is all about having fun with friends old and new, so go ahead and find them!</div></div><span ng-if="hasSearched" class="h2 show sectionContent text-center">No users found. Adjust your search criteria and try again.</span></section></section><div class="row gutterMarginTop" ng-show="!loading && contacts.length"><div class="vAlignParent full-width"><div class="col-xs-4 vAlign"><a ng-show="pagination.currentPage > 1" ng-click="pagination.prevPage()" class="btn btn-textcolour btn-outline"><i class="ico ico-chevron-left"></i> Back</a></div><div ng-show="pagination.totalPages > 0" class="col-xs-4 vAlign text-center"><span>Page {{ pagination.currentPage }} of {{ pagination.totalPages }}</span></div><div class="col-xs-4 vAlign text-right"><a ng-show="pagination.currentPage < pagination.totalPages" ng-click="pagination.nextPage()" class="btn btn-textcolour btn-outline iconRight">Next <i class="ico ico-chevron-right"></i></a></div></div></div><div ng-show="loading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div>'),$templateCache.put("contacts/views/my-invites.html",'<section class="row white-bg"><section-header text="Contact invites" type="contacts"><a class="btn btn-contacts btn-outline" ui-sref="contacts.find"><i class="ico ico-search"></i>Find contacts</a></section-header><div class="sectionContent withOffsetBorder"><div ng-show="busy" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!busy"><p class="marginTop h2 text-center" ng-hide="invites.length">You have not invited anyone to join HulaHub.<br><br><a ui-sref="contacts.find" class="contact underlinedLink">Find contacts</a>. HulaHub is all about having fun with friends old and new, so go ahead and find them!</p><table ng-show="invites.length" class="simpleTable contacts" cellspacing="0" cellpadding="0" border="0"><tr><th width="150">Date invited</th><th class="text-left">Email address</th></tr><tr ng-repeat="invite in invites"><td>{{ invite.created | dateFormat:\'DD/MM/YY\' }}</td><td class="text-left" ng-show="!invite.user">{{ invite.recipient }}</td><td class="text-left" ng-show="invite.user"><a class="contact underlinedLink" ng-click="viewProfile(invite.user)">{{ invite.recipient }}</a></td></tr></table></div></div></section>'),$templateCache.put("contacts/views/profile.html",'<div class="row alert alert-warning" ng-if="auth.currentUser && !auth.currentUser.emailVerified && viewingSelf">Please verify your email address to make your profile public.</div><div class="row alert alert-warning" ng-if="auth.currentUser && !auth.currentUser.emailVerified && !viewingSelf && !user.friend">Please verify your email address to connect with other members.</div><section class="white-bg row gutterMarginBottom" ng-if="!user"><div class="sectionContent"><div class="h2 show text-center">This profile does not exist.</div></div></section><div ng-show="user"><section class="row gutterMarginBottom"><div class="profileBackground bgFade" style="background-image: url({{ user.coverPhotoURL || \'/img/landing/lrg/A62-2.jpg\' }})"><div class="topLayer"><span ng-show="viewingSelf && auth.currentUser.registrationType === \'host\'" class="label contacts abs topLeft jsButton" ng-click="showProfileScoreModal()">Profile score: {{ auth.currentUser.profile.score }}/10 <i class="far fa-question-circle" style="margin-left: 5px"></i></span> <a class="btn btn-white abs topRight" ng-show="!viewingSelf || (viewingSelf && auth.currentUser.emailVerified)" ng-click="shareProfile()"><i class="fas fa-share-alt"></i> Share</a> <a class="circleButton profile abs bottomRight visible-sm visible-xs" ng-show="viewingSelf" ng-click="changeCoverPicture()"><i class="ico ico-edit"></i></a> <a class="abs bottomRight btn btn-profile hidden-xs hidden-sm" ng-show="viewingSelf" ng-click="changeCoverPicture()"><i class="ico ico-edit"></i>Edit cover photo</a><div class="profileName hidden-xs hidden-sm"><div class="h1">{{ user.firstName }} {{ user.lastName }}</div><div ng-show="!viewingSelf && user.businessName">{{ user.businessName }}</div><div class="clickable" ng-show="viewingSelf && !editingBusinessName" ng-click="editingBusinessName = true"><span ng-if="user.businessName">{{ user.businessName }}</span> <em class="profileColour" ng-if="!user.businessName">Business name</em> <i class="ico ico-edit marginLeft half profileColour"></i></div><div class="form-inline" ng-show="editingBusinessName"><input type="text" class="form-control" ng-model="user.businessName"><a class="btn btn-profile marginLeft" ng-click="saveBusinessName()">Save</a></div></div><span class="circlePhoto xx-lrg {{ theme }}" ng-class="{\'noPhoto\': !user.avatarURL, \'editable\': viewingSelf}" ng-click="changeProfilePicture()" style="background-image:url(\'{{ user.avatarURL }}\')"><i class="ico ico-edit" ng-if="viewingSelf"></i></span></div></div><div class="gutterMarginBottom" style="margin-top: 5px"><div class="row"><div class="col-xs-12 col-md-6"><div class="profileReviewContainer text-xs-center text-md-left"><div class="visible-xs visible-sm" style="margin-top:40px"><div class="h1">{{ user.firstName }} {{ user.lastName }}</div><div ng-if="!viewingSelf && user.businessName">{{ user.businessName }}</div><div ng-show="viewingSelf && !editingBusinessName" ng-click="editingBusinessName = true"><span ng-if="user.businessName">{{ user.businessName }}</span> <em class="profileColour" ng-if="!user.businessName">Business name</em> <i class="ico ico-edit marginLeft half profileColour"></i></div><div class="form-inline" ng-show="editingBusinessName"><input type="text" class="form-control" ng-model="user.businessName"><a class="btn btn-profile marginLeft" ng-click="saveBusinessName()">Save</a></div></div><div class="reviewLink clickable inlineBlock" ng-click="goToReviews()" ng-show="user.ratings.totalCount > 0"><review-stars theme="contacts" value="user.ratings.overall"></review-stars><a>{{ ::user.ratings.totalCount }} reviews</a></div></div></div><div class="col-md-6 hidden-xs hidden-sm text-right" style="margin-top: 5px"><span class="label grey" ng-show="!user.dateVerified">Joined on {{ ::user.memberSince }}</span> <span class="label green" ng-show="user.dateVerified">Verified since {{ user.dateVerified }}</span></div></div></div><uib-tabset active="activeTab" id="profileTabs" class="white-bg" ng-class="{\'profileTheme\': viewingSelf, \'contactsTheme\': !viewingSelf}"><uib-tab index="\'about\'" ng-if="viewingSelf || user.personalStatement || (user.gender && user.gender != \'u\') || user.dateOfBirth"><uib-tab-heading>About<i class="fas fa-exclamation-circle marginLeft half" ng-if="viewingSelf && (!user.personalStatement || user.personalStatement.length <= 200)"></i></uib-tab-heading><div class="sectionContent"><div class="visible-xs visible-sm text-right gutterMarginBottom"><span class="mutedText" ng-show="!user.dateVerified">Joined on {{ ::user.memberSince }}</span> <span class="greenColour" ng-show="user.dateVerified">Verified since {{ user.dateVerified }}</span></div><div ng-show="!viewingSelf"><div class="hidden-xs" ng-show="user.personalStatement" ng-bind-html="user.personalStatement | nl2br | sanitize"></div><div class="visible-xs" ng-show="user.personalStatement" read-more content="{{ user.personalStatement | nl2br | sanitize }}" limit="100" link-class="contacts"></div><div class="row noGutter" ng-class="{\'gutterMarginTop\': user.personalStatement}" ng-show="(user.gender && user.gender != \'u\') || user.dateOfBirth"><div class="col-xs-6"><strong class="marginRight" ng-if="(user.gender && user.gender != \'u\')"><i class="ico ico-gender contactsColour marginRight"></i>{{ user.gender | genderDisplay }}</strong></div><div class="col-xs-6 text-right" ng-if="user.dateOfBirth"><strong><i class="ico ico-cake contactsColour marginRight"></i>{{ user.dateOfBirth | ageFromBirthday }}</strong></div></div></div><form ng-show="viewingSelf" name="aboutForm" class="row halfGutter" ng-submit="aboutForm.$valid && formData.dateOfBirth.valid(true) && saveAbout(aboutForm)" novalidate><div class="form-group col-xs-12"><p ng-show="!user.personalStatement || user.personalStatement.length <= 200" class="contactsColour">To progress towards unlocking marketing tools, add at least 200 characters about yourself</p><textarea rows="10" class="form-control" name="personalStatement" ng-model="formData.personalStatement" placeholder="Write a short bio about yourself" maxlength="1000"></textarea><character-count max="1000" text="aboutForm.personalStatement.$viewValue"></character-count></div><div class="form-group gutterMarginBottomXSOnly col-xs-12 col-sm-3 col-md-3"><label class="visible-xs-block visible-sm-inline-block visible-md-inline-block visible-lg-inline-block"><i class="ico ico-gender fixedSize marginRight profileColour"></i><span class="visible-xs-inline">Gender</span></label><span class="inlineBlock"><select class="form-control" ng-model="formData.gender.value" ng-options="option.id as option.name for option in formData.gender.options"></select></span></div><div class="form-group gutterMarginBottomXSOnly col-xs-12 col-sm-6 col-md-5" ng-class="{\'has-error\': aboutForm.$submitted && !formData.dateOfBirth.valid(true)}"><label class="visible-xs-block visible-sm-inline-block visible-md-inline-block visible-lg-inline-block"><i class="ico ico-cake fixedSize marginRight profileColour"></i><span class="visible-xs-inline">Date of birth</span></label><span class="inlineDropdowns"><select class="form-control" ng-model="formData.dateOfBirth.value.day" ng-options="day as day for day in formData.dateOfBirth.options.days"><option value="" disabled="disabled">Day</option></select><select class="form-control" ng-model="formData.dateOfBirth.value.month" ng-options="month as month for month in formData.dateOfBirth.options.months"><option value="" disabled="disabled">Month</option></select><select class="form-control" ng-model="formData.dateOfBirth.value.year" ng-options="year as year for year in formData.dateOfBirth.options.years"><option value="" disabled="disabled">Year</option></select></span><a ng-show="formData.dateOfBirth.value.day || formData.dateOfBirth.value.month || formData.dateOfBirth.value.year" ng-click="formData.dateOfBirth.clear();aboutForm.$setDirty()" class="textColour h3"><i class="fas fa-times-circle"></i></a> <span class="help-block" ng-show="aboutForm.$submitted && !formData.dateOfBirth.valid(true)">This is not a valid date</span></div><div class="form-group no-margins col-xs-12 col-sm-3 col-md-4 text-sm-right"><button type="submit" class="btn btn-block-xs" ng-class="{\'btn-green\': aboutForm.$dirty, \'btn-disabled\': !aboutForm.$dirty}" ng-disabled="!aboutForm.$dirty"><i class="ico ico-tick"></i>Save changes</button></div></form></div></uib-tab><uib-tab index="\'locations\'" select="drawLocationMap()" ng-if="viewingSelf || user.homeHub"><uib-tab-heading>Locations<i class="fas fa-exclamation-circle marginLeft half" ng-if="viewingSelf && !user.homeHub"></i></uib-tab-heading><div class="sectionContent"><div ng-show="viewingSelf && !user.homeHub" class="gutterMarginTop double text-center"><div class="h1 mutedText">You haven\'t added any locations</div><div class="marginBottom mutedText">Add a location you are based in and offer your activities</div><a class="btn btn-outline btn-profile" ng-click="editHomeHub()"><i class="ico ico-plus fixedSize"></i>Add a location</a><div class="contactsColour gutterMarginTop double">To progress towards unlocking marketing tool, add at least one location</div></div><div ng-show="user.homeHub" class="row"><div class="col-xs-12 col-sm-6 gutterMarginBottomXSOnly"><div class="h3" ng-class="{\'profileColour\': viewingSelf, \'contactsColour\': !viewingSelf}">{{ user.homeHub.name }}</div><em ng-show="viewingSelf"><a class="profile" ng-click="editHomeHub()"><i class="ico ico-form-edit"></i> Edit location</a></em></div><div class="col-xs-12 col-sm-6"><div id="locationMap" class="googleMap"></div></div></div></div></uib-tab><uib-tab index="\'specialisms\'" ng-if="user.isHostAccount && (viewingSelf || user.specialisms.length)"><uib-tab-heading>Specialisms<i class="fas fa-exclamation-circle marginLeft half" ng-if="viewingSelf && !user.specialisms.length"></i></uib-tab-heading><div class="sectionContent" ng-show="viewingSelf && !user.specialisms.length"><div class="gutterMarginTop double text-center"><div class="h1 mutedText">You haven\'t added any specialisms</div><div class="marginBottom mutedText">Add the types of activities you offer and their locations</div><a class="btn btn-outline btn-profile" ng-click="addSpecialism()"><i class="ico ico-plus fixedSize"></i>Add a specialism</a><div class="contactsColour gutterMarginTop double">To progress towards unlocking marketing tools, add at least one specialism</div></div></div><div class="sectionContent noPaddingTop" ng-show="!loadingSpecialisms && user.specialisms.length"><div class="row halfGutter"><div class="col-xs-12 col-sm-6 col-md-4 gutterMarginTop" ng-repeat="specialism in user.specialisms"><div class="specialismTile vAlignParent full-width"><div class="vAlign image" style="background-image: url({{ (\'/img/landing/lrg/A\' + specialism.interest.id + \'-1.jpg\') }})"></div><div class="vAlign"><h3 ng-class="{\'profileColour\': viewingSelf, \'contactsColour\': !viewingSelf}">{{ specialism.interest.name }}</h3><div class="truncate"><span>{{ specialism.locations }}</span></div></div><span class="dropdown" ng-if="viewingSelf"><a class="dropdown-toggle" data-toggle="dropdown"><i class="ico ico-form-edit"></i></a><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="editSpecialism(specialism.id)">Edit</a></li><li><a ng-click="deleteSpecialism(specialism.id)">Delete</a></li></ul></span></div></div><div class="col-xs-12 col-sm-6 col-md-4 gutterMarginTop" ng-if="viewingSelf"><a class="addSpecialismButton hidden-xs" ng-click="addSpecialism()"><i class="ico ico-plus fixedSize"></i>Add a specialism</a> <a class="btn btn-profile btn-outline btn-block visible-xs" ng-click="addSpecialism()"><i class="ico ico-plus fixedSize"></i>Add a specialism</a></div></div></div></uib-tab><uib-tab index="\'interests\'" class="{{user.isHostAccount ? \'hidden-xs hidden-sm\' : \'\'}}" heading="Interests" select="drawInterestMap()" ng-if="viewingSelf || user.interests.length"><div ng-show="viewingSelf && !user.interests.length" class="sectionContent"><div class="gutterMarginTop gutterMarginBottom double text-center"><div class="h1 mutedText">You haven\'t added any personal interests</div><div class="marginBottom mutedText">Add the types of activities and their locations that you are interesed in</div><a class="btn btn-outline btn-profile" ui-sref="interests.new"><i class="ico ico-plus fixedSize"></i>Add an interest</a></div></div><div ng-show="user.interests.length"><div id="interestMap" class="googleMap hidden-xs"></div><div class="sectionContent noPaddingTop"><div class="row halfGutter"><div class="col-xs-6 col-sm-3 col-md-2 gutterMarginTop" ng-repeat="interest in user.interests"><div class="interestTile" style="background-image: url(\'/img/landing/lrg/A{{ interest.interest.id }}-1.jpg\')"><div ng-if="viewingSelf" class="abs topRight dropdown"><a class="circleButton profile" data-toggle="dropdown"><i class="ico ico-form-edit"></i></a><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="editInterest(interest.id)">Edit</a></li><li><a ng-click="deleteInterest(interest)">Delete</a></li></ul></div><div class="details"><strong ng-class="{\'profileColour\': viewingSelf, \'contactsColour\': !viewingSelf}">{{ ::interest.interest.name }}</strong><div class="clearfix"><div class="pull-left"><i class="ico ico-level fixedSize"></i> <small>{{ ::interest.difficultyLevel|difficultyDisplay }}</small></div><div class="pull-right dropdown"><a class="dropdown-toggle textColour" data-toggle="dropdown"><i class="ico ico-pin fixedSize"></i></a><ul class="dropdown-menu dropdown-menu-right"><li ng-repeat="hub in interest.hubs"><a>{{ ::hub.name }}</a></li></ul></div></div></div></div></div><div class="col-xs-6 col-sm-3 col-md-2 gutterMarginTop" ng-if="viewingSelf"><a class="addInterestButton" ui-sref="interests.new"><i class="ico ico-plus fixedSize"></i>Add an interest</a></div></div></div></div></uib-tab><uib-tab index="\'contact\'" class="contactTab"><uib-tab-heading>Contact<i class="fas fa-exclamation-circle marginLeft half" ng-show="viewingSelf && user.isHostAccount && !user.phone"></i></uib-tab-heading><div class="sectionContent"><div ng-show="!viewingSelf" class="row"><div class="col-xs-12 visible-xs gutterMarginBottom gutterMarginTop" ng-show="user.isHostAccount && user.hasPhoneNumber"><a ng-show="!user.phone" ng-click="revealPhone()" class="btn btn-outline btn-messages btn-block h3 notBold"><i class="ico ico-phone"></i>Reveal phone number</a> <a ng-show="user.phone" href="tel:{{ user.phone }}" class="btn btn-outline btn-messages btn-block h3 notBold"><i class="ico ico-phone"></i>Call {{ user.phone }}</a></div><div class="col-xs-12 col-sm-8"><div class="textWithLine gutterMarginTop gutterMarginBottom half visible-xs"><span>Send message</span></div><form name="messageForm" ng-submit="messageForm.$valid && sendMessage(messageForm)" novalidate><div class="form-group"><label>Subject</label><input type="text" name="subject" ng-model="messageFormData.subject" class="form-control" required></div><div class="form-group"><label>Message</label><textarea name="message" ng-model="messageFormData.message" class="form-control" rows="5" required></textarea></div><div class="form-group no-margins text-right"><button type="submit" class="btn btn-block-xs" ng-class="{\'btn-green\': messageForm.$valid, \'btn-disabled\': !messageForm.$valid}" ng-disabled="!messageForm.$valid"><i class="ico ico-message-fly"></i>Send</button></div></form></div><div class="col-xs-12 col-sm-4"><div class="textWithLine marginTop marginBottom visible-xs" ng-if="user.websiteURL || user.socialLinks.length"><span>Social links</span></div><ul class="profileSocialLinks list-unstyled flexContainer spaceEvenly"><li class="hidden-xs" ng-if="user.isHostAccount && user.hasPhoneNumber"><a ng-show="!user.phone" ng-click="revealPhone()"><i class="ico ico-phone messages"></i><strong class="textColour h2">Reveal phone number</strong></a> <a ng-show="user.phone" href="tel:{{ user.phone }}"><i class="ico ico-phone messages"></i><strong class="textColour h2">{{ user.phone }}</strong></a></li><li ng-if="user.websiteURL"><a href="{{ user.websiteURL }}" target="_blank" ng-click="trackContact()"><i class="ico ico-globe contacts"></i><strong class="hidden-xs textColour">Website</strong></a></li><li ng-if="user.socialLinks.facebook"><a href="{{ user.socialLinks.facebook }}" target="_blank" ng-click="trackContact()"><i class="ico ico-facebook fixedSize facebook"></i><strong class="hidden-xs textColour">Facebook</strong></a></li><li ng-if="user.socialLinks.twitter"><a href="{{ user.socialLinks.twitter }}" target="_blank" ng-click="trackContact()"><i class="ico ico-twitter fixedSize twitter"></i><strong class="hidden-xs textColour">Twitter</strong></a></li><li ng-if="user.socialLinks.linkedin"><a href="{{ user.socialLinks.linkedin }}" target="_blank" ng-click="trackContact()"><i class="ico ico-linkedin fixedSize linkedin"></i><strong class="hidden-xs textColour">LinkedIn</strong></a></li><li ng-if="user.socialLinks.instagram"><a href="{{ user.socialLinks.instagram }}" target="_blank" ng-click="trackContact()"><i class="ico ico-instagram fixedSize instagram"></i><strong class="hidden-xs textColour">Instagram</strong></a></li></ul></div></div><form ng-show="viewingSelf" name="contactForm" ng-submit="contactForm.$valid && saveContact(contactForm)" novalidate><div class="row"><div class="form-group col-sm-6" ng-class="{\'col-xs-11 has-error\': contactForm.$submitted && contactForm.phoneNumber.$invalid, \'col-xs-12\': !contactForm.$submitted || contactForm.phoneNumber.$valid}"><div class="input-group"><span class="input-group-addon green"><i class="ico ico-phone"></i></span><telephone-number-input input-value="contactFormData.phoneNumber" placeholder="Add your phone number" input-name="phoneNumber" required="user.isHostAccount"></telephone-number-input></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.phoneNumber.$invalid">This is a required field</span></div><div class="col-xs-1 col-sm-6 noPadding" ng-show="contactForm.$submitted && contactForm.phoneNumber.$invalid"><i class="fas fa-exclamation-circle redColour h3" style="margin-top: 5px"></i></div></div><div class="row"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': contactForm.$submitted && contactForm.website.$invalid}"><div class="input-group"><span class="input-group-addon contacts"><i class="ico ico-globe"></i></span> <input type="text" ng-pattern="/^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/" name="website" ng-model="contactFormData.website" placeholder="Add your website address" class="form-control"></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.website.$invalid">This is not a valid URL</span></div></div><div class="row"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': contactForm.$submitted && contactForm.facebook.$invalid}"><div class="input-group"><span class="input-group-addon facebook"><i class="ico ico-facebook"></i></span> <input type="text" ng-pattern="/^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/" name="facebook" ng-model="contactFormData.facebook" placeholder="Add your Facebook profile address" class="form-control"></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.facebook.$invalid">This is not a valid URL</span></div></div><div class="row"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': contactForm.$submitted && contactForm.twitter.$invalid}"><div class="input-group"><span class="input-group-addon twitter"><i class="ico ico-twitter"></i></span> <input type="text" ng-pattern="/^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/" name="twitter" ng-model="contactFormData.twitter" placeholder="Add your Twitter profile address" class="form-control"></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.twitter.$invalid">This is not a valid URL</span></div></div><div class="row"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': contactForm.$submitted && contactForm.linkedin.$invalid}"><div class="input-group"><span class="input-group-addon linkedin"><i class="ico ico-linkedin"></i></span> <input type="text" ng-pattern="/^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/" name="linkedin" ng-model="contactFormData.linkedin" placeholder="Add your LinkedIn profile address" class="form-control"></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.linkedin.$invalid">This is not a valid URL</span></div></div><div class="row"><div class="form-group marginBottomXSOnly col-xs-12 col-sm-6" ng-class="{\'has-error\': contactForm.$submitted && contactForm.instagram.$invalid}"><div class="input-group"><span class="input-group-addon instagram"><i class="ico ico-instagram"></i></span> <input type="text" ng-pattern="/^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/" name="instagram" ng-model="contactFormData.instagram" placeholder="Add your Instagram profile address" class="form-control"></div><span class="help-block" ng-show="contactForm.$submitted && contactForm.instagram.$invalid">This is not a valid URL</span></div><div class="form-group no-margins col-xs-12 col-sm-6 text-sm-right"><button type="submit" class="btn btn-block-xs" ng-class="{\'btn-green\': contactForm.$dirty, \'btn-disabled\': !contactForm.$dirty}" ng-disabled="!contactForm.$dirty"><i class="ico ico-tick"></i>Save changes</button></div></div></form></div></uib-tab></uib-tabset></section><section class="row" ng-show="!viewingSelf && user.activities.length"><div class="gutterMarginBottom"><section-header text="{{ user.firstName | possessive }} upcoming activities" type="{{ theme }}"></section-header></div><div class="activitiesContainer gutterMarginBottom"><div class="row halfGutter gridLayout"><activity-card ng-repeat="activity in user.activities"></activity-card></div><div class="gutterMarginTop text-center"><a ui-sref="activities.find.browse({text: user.firstName + \' \' + user.lastName})" class="contacts">View all activities</a></div></div></section><section id="reviews" class="row white-bg gutterMarginBottom" ng-show="viewingSelf || user.reviews.length"><section-header text="{{ viewingSelf ? \'My\' : (user.firstName | possessive) }} reviews" type="{{ theme }}"><a ng-if="viewingSelf" class="btn btn-outline btn-profile" ui-sref="profile.reviewRequest"><i class="ico ico-star noSpacingXS"></i><span class="hidden-xs">Request a review</span></a></section-header><div class="sectionContent withOffsetBorder noPaddingBottom"><div class="text-center gutterMarginBottom" ng-show="viewingSelf && !user.reviews.length"><h3>You do not have any reviews yet</h3></div><div ng-show="user.reviews.length"><div class="totalRatingsPanel row noGutter"><div class="col-xs-12 col-sm-7 col-md-8"><div class="vAlignParent"><div class="{{ theme }}Colour overallNumber vAlign">{{ ::user.ratings.overall }}</div><div class="vAlign form-group"><review-stars value="user.ratings.overall" theme="{{ theme }}"></review-stars><span class="overallLabel hidden-xs hidden-sm {{ theme }}Colour">Overall rating <a uib-tooltip="Your overall rating is an average of all your reliability, expertise and enthusiasm ratings" tooltip-placement="right" class="help"><i class="ico fixedSize ico-question"></i></a></span><p class="no-margins"><strong>{{ ::user.ratings.totalCount }}</strong> reviews<span class="lastDaysLabel hidden-xs hidden-sm"><strong>{{ ::user.ratings.last30Days }}</strong> in last 30 days</span></p></div></div></div><div class="col-xs-12 col-sm-5 col-md-4"><ul class="individualRatingsList list-unstyled clearfix"><li><span>Reliability</span><review-stars value="user.ratings.reliability" theme="{{ theme }}"></review-stars></li><li><span>Expertise</span><review-stars value="user.ratings.expertise" theme="{{ theme }}"></review-stars></li><li><span>Enthusiasm</span><review-stars value="user.ratings.enthusiasm" theme="{{ theme }}"></review-stars></li></ul></div></div><div class="text-center marginTop marginBottom reviewDivider"><strong>Latest reviews</strong></div><div ng-repeat="review in user.reviews" class="profileReview gutterMarginBottom"><review data="review" theme="{{ theme }}"></review></div></div></div></section></div>'),
$templateCache.put("dashboard/views/dashboard.html",'<div class="row"><div class="row halfGutter flexContainer-sm"><div class="col-xs-12 col-sm-6 flexContainer-sm flexColumn"><div class="sectionContent rounded white-bg flexContainer-sm flexColumn flexGrow relative"><span class="dropdown abs topRight"><span class="dropdown-toggle jsButton" data-toggle="dropdown"><i class="fas fa-ellipsis-v fa-fw"></i></span><ul class="dropdown-menu dropdown-menu-right"><li><a ui-sref="profile">Profile</a></li><li><a ui-sref="profile({\'#\': \'reviews\'})">Reviews</a></li><li><a ui-sref="billing.subscriptionPlans">Subscription</a></li><li ng-show="auth.currentUser.subscriptionPlan !== \'FREE\'"><a ng-click="goToBenefits()">Benefits</a></li></ul></span><div class="flexContainer-sm flexColumn flexGrow"><h2>Welcome back, {{ ::auth.currentUser.profile.firstName }}</h2><div ng-show="auth.currentUser.profile.businessName">{{ ::auth.currentUser.profile.businessName }}</div><div ng-show="data.ratings.totalCount > 0" class="vAlignRow dashboardReviewStars jsButton" ui-sref="profile({\'#\': \'reviews\'})" style="align-self: flex-start"><review-stars theme="contacts" value="data.ratings.overall"></review-stars><span class="smallMarginLeft mutedText">{{ data.ratings.totalCount|number }} reviews</span></div></div><div class="gutterMarginTop"><div class="clearfix"><strong>Profile score:</strong> {{ ::auth.currentUser.profile.score }} <a ui-sref="profile" class="pull-right activities"><i class="fas fa-arrow-up smallMarginRight" ng-show="auth.currentUser.profile.score < 10"></i><span ng-show="auth.currentUser.profile.score < 10">Improve</span><span ng-show="auth.currentUser.profile.score === 10">View</span></a></div><div class="borderTop borderBottom gutterMarginTop gutterMarginBottom gutterPaddingTop gutterPaddingBottom half clearfix"><strong>Membership:</strong> <span ng-show="auth.currentUser.subscriptionPlan === \'FREE\'">Free plan</span> <span ng-show="auth.currentUser.subscriptionPlan === \'PERSONAL_MONTH\' || auth.currentUser.subscriptionPlan === \'PERSONAL_YEAR\'">Personal plan</span> <span ng-show="auth.currentUser.subscriptionPlan === \'PROFESSIONAL_MONTH\' || auth.currentUser.subscriptionPlan === \'PROFESSIONAL_YEAR\'">Professional plan</span> <span ng-show="auth.currentUser.subscriptionPlan === \'Professional_Month_Trial\' || auth.currentUser.subscriptionPlan === \'Professional_Year_Trial\'">Professional plan</span> <span ng-show="auth.currentUser.subscriptionPlan === \'PREMIUM_MONTH\' || auth.currentUser.subscriptionPlan === \'PREMIUM_YEAR\'">Premium plan</span> <a ui-sref="billing.subscriptionPlans" class="pull-right activities"><i class="fas fa-arrow-up smallMarginRight"></i>Upgrade</a></div><div class="clearfix"><strong>Benefits:</strong> <span ng-show="auth.currentUser.subscriptionPlan === \'FREE\'">Locked<a ui-sref="billing.subscriptionPlans" class="pull-right activities"><i class="fas fa-arrow-up smallMarginRight"></i>Upgrade</a></span> <span ng-show="auth.currentUser.subscriptionPlan !== \'FREE\'">Enabled<a ng-click="goToBenefits()" class="pull-right activities">View</a></span></div></div></div></div><div class="col-xs-12 col-sm-6 flexContainer-sm"><div ng-show="hintToShow === \'email_verification\'" class="colourBlockPanel wallet text-center gutterMarginTopXSOnly flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow flexCenterContent"><i class="fas fa-info-circle abs"></i><h2>Hi, your account is unverified.</h2><div>Re-send the verification email or to change your email go to <a ui-sref="settings.account" class="underlinedLink">account settings</a>.</div></div><footer class="text-right"><a ng-click="resendVerificationEmail()" class="small underlineOnHover text-uppercase">Re-send verification<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div><div ng-show="hintToShow === \'connect_stripe\'" class="colourBlockPanel wallet text-center gutterMarginTopXSOnly flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow flexCenterContent"><i class="fas fa-info-circle abs"></i><h2>Hi, you haven\'t linked your bank account.</h2><div>To receive booking payments please go to <a ui-sref="billing.settings" class="underlinedLink">my billing</a> to connect your bank account.</div></div><footer class="text-right"><a ui-sref="billing.settings" class="small underlineOnHover text-uppercase">Connect bank account<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div><div ng-show="hintToShow === \'specialisms\'" class="colourBlockPanel wallet text-center gutterMarginTopXSOnly flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow flexCenterContent"><i class="fas fa-info-circle abs"></i><h2>Hi, you haven\'t added any specialisms.</h2><div>Add specialisms that match the types of activities you offer and their locations to start sending personal intros.</div></div><footer class="text-right"><a ui-sref="profile({\'#\': \'specialisms\'})" class="small underlineOnHover text-uppercase">Add specialisms<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div><div ng-show="hintToShow === \'reviews\'" class="colourBlockPanel wallet text-center gutterMarginTopXSOnly flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow flexCenterContent"><i class="fas fa-info-circle abs"></i><h2>Hi, you haven\'t received any reviews.</h2><div>Let your reputation speak for itself and stand out from the crowd by requesting reviews from your clients.</div></div><footer class="text-right"><a ui-sref="profile.reviewRequest" class="small underlineOnHover text-uppercase">Request a review<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div><div ng-show="!hintToShow" class="colourBlockPanel wallet text-center gutterMarginTopXSOnly flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow flexCenterContent"><i class="fas fa-info-circle abs"></i><h2>Hi, we are here to help.</h2><div>If we have any problems, questions or just want to give us your feedback don\'t hesitate to get in touch.</div></div><footer class="text-right"><a ng-click="contactHulaHub()" class="small underlineOnHover text-uppercase">Get in touch<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div></div></div><div class="row halfGutter"><div class="col-xs-12 col-sm-6 col-md-3"><mini-stat-panel class="gutterMarginTop" title="Bookings" theme="activities" tooltip="Number of bookings of your activities by HulaHub members." tooltip-placement="left" latest-date="{{ data.booking.latest }}" total="{{ data.booking.total || 0 }}" last30="{{ data.booking.last30 || 0 }}" older30="{{ data.booking.older30 || 0 }}"></mini-stat-panel></div><div class="col-xs-12 col-sm-6 col-md-3"><mini-stat-panel class="gutterMarginTop" title="Revenue" theme="profile" tooltip="Value of all your activity bookings by HulaHub members." tooltip-placement="left" latest-date="{{ data.revenue.latest }}" total="&pound;{{ (data.revenue.total || 0)/100 | number:2 }}" last30="&pound;{{ (data.revenue.last30 || 0)/100 | number:2 }}" older30="&pound;{{ (data.revenue.older30 || 0)/100 | number:2 }}"></mini-stat-panel></div><div class="col-xs-12 col-sm-6 col-md-3"><mini-stat-panel class="gutterMarginTop" title="Activity page views" theme="messages" tooltip="Number of times your activity pages on HulaHub have been viewed." tooltip-placement="left" latest-date="{{ data.activityPageView.latest }}" total="{{ (data.activityPageView.total || 0) | number }}" last30="{{ (data.activityPageView.last30 || 0) | number }}" older30="{{ (data.activityPageView.older30 || 0) | number }}"></mini-stat-panel></div><div class="col-xs-12 col-sm-6 col-md-3"><mini-stat-panel class="gutterMarginTop" title="Profile page views" theme="contacts" tooltip="Number of times your HulaHub profile page has been viewed." tooltip-placement="left" latest-date="{{ data.profilePageView.latest }}" total="{{ (data.profilePageView.total || 0) | number }}" last30="{{ (data.profilePageView.last30 || 0) | number }}" older30="{{ (data.profilePageView.older30 || 0) | number }}"></mini-stat-panel></div></div><div class="row halfGutter flexContainer-sm"><div class="col-xs-12 col-sm-6 flexContainer-sm"><div class="dashboardTablePanel gutterMarginTop flexContainer-sm flexColumn flexGrow"><div class="sectionContent flexContainer-sm flexColumn flexGrow relative"><h2>Upcoming activities</h2><span class="dropdown abs topRight"><span class="dropdown-toggle jsButton" data-toggle="dropdown"><i class="fas fa-ellipsis-v fa-fw"></i></span><ul class="dropdown-menu dropdown-menu-right"><li><a ui-sref="activities.new">Create an activity</a></li><li><a ui-sref="activities.hosted">Manage activities</a></li></ul></span><div ng-show="!data.activities.length" class="text-center mutedText flexContainer-sm flexColumn flexGrow flexCenterContent"><h2>Hi, you haven\'t created any activities.</h2><div>Publish one-time, recurring or flexible activity in just a few moments and start growing your client-base.</div></div><table ng-show="data.activities.length" class="marginTop" cellpadding="0" cellspacing="0" border="0" width="100%"><tr class="borderBottom"><th>Activity</th><th class="text-right" width="80">Start date</th><th class="text-right hidden-xs" width="80">Joiners</th></tr><tr ng-repeat="activity in data.activities"><td><a ui-sref="activities.hosted.view({activityId: activity.id})" class="truncate activities"><span>{{ $index+1 }}. {{ ::activity.title }}</span></a></td><td class="text-right">{{ ::activity.startDate }}</td><td class="text-right hidden-xs">{{ ::activity.joiners }} / <i ng-if="!activity.groupSizeMax" class="far fa-infinity"></i><span ng-if="activity.groupSizeMax">{{ ::activity.groupSizeMax }}</span></td></tr></table></div><footer class="text-right"><a ng-show="!data.activities.length" ui-sref="activities.new" class="small activities text-uppercase">Create an activity<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a> <a ng-show="data.activities.length" ui-sref="activities.hosted" class="small activities text-uppercase">Manage activities<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div></div><div class="col-xs-12 col-sm-6 flexContainer-sm"><div ng-show="auth.currentUser.profile.score < 5" class="colourBlockPanel messages gutterMarginTop flexContainer-sm flexColumn"><div class="sectionContent relative flexContainer-sm flexColumn flexGrow"><i class="fas fa-info-circle abs"></i><h2>Personal intros</h2><div class="gutterMarginTop gutterMarginBottom double flexContainer-sm flexColumn flexGrow flexCenterContent"><div class="row text-center"><div class="col-xs-6"><div class="largeText">{{ ::auth.currentUser.profile.score }}</div><div class="small">Current</div><div class="small">profile score</div></div><div class="col-xs-6"><div class="largeText">{{ ::data.hostIntros.total.queue|number }}</div><div class="small">Matched</div><div class="small">members</div></div></div></div><div class="row noGutter"><div class="col-xs-12 col-sm-8 col-sm-offset-2 text-center">Improve your profile score to 5 or above to send personal intros to new clients</div></div></div><footer class="text-right"><a ui-sref="profile" class="small underlineOnHover text-uppercase">Improve profile<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div><div ng-show="auth.currentUser.profile.score >= 5" class="dashboardTablePanel gutterMarginTop flexContainer-sm flexColumn flexGrow"><div class="sectionContent flexGrow relative"><h2>Personal intros</h2><span class="dropdown abs topRight"><span class="dropdown-toggle jsButton" data-toggle="dropdown"><i class="fas fa-ellipsis-v fa-fw"></i></span><ul class="dropdown-menu dropdown-menu-right"><li><a ui-sref="profile({\'#\': \'specialisms\'})">Specialisms</a></li><li><a ui-sref="marketingTools">Marketing tools</a></li></ul></span><table class="marginTop" cellpadding="0" cellspacing="0" border="0" width="100%"><tr class="borderBottom"><th>Specialism</th><th class="text-right" width="80">Reach</th><th class="text-right" width="80">Queue</th></tr><tr class="borderBottom"><td>All specialisms</td><td class="text-right">{{ ::data.hostIntros.total.reach|number }}</td><td class="text-right">{{ ::data.hostIntros.total.queue|number }}</td></tr><tr ng-repeat="specialism in data.hostIntros.specialisms"><td>{{ $index+1 }}. {{ ::specialism.name }}</td><td class="text-right">{{ ::specialism.reach|number }}</td><td class="text-right">{{ ::specialism.queue|number }}</td></tr></table></div><footer class="text-right"><a ui-sref="marketingTools" class="small activities text-uppercase">View more<i class="ico ico-chevron-right fixedSize fixedTopOffset1 marginLeft"></i></a></footer></div></div></div></div>'),$templateCache.put("dashboard/views/marketing-tools.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Personal intros" type="activities"></section-header></section><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="row white-bg" ng-show="!loading && stats"><table class="statTable hidden-xs" cellspacing="0" cellpadding="0" width="100%" border="0"><tr><th>Specialisms</th><th class="clearfix"><span class="pull-left">Reach</span> <span uib-tooltip="{{ ::tooltips.reach }}" class="pull-right"><i class="far fa-question-circle"></i></span></th><th class="clearfix"><span class="pull-left">Queue</span> <span uib-tooltip="{{ ::tooltips.queue }}" class="pull-right"><i class="far fa-question-circle"></i></span></th><th class="clearfix"><span class="pull-left">Opens</span> <span uib-tooltip="{{ ::tooltips.opens }}" class="pull-right"><i class="far fa-question-circle"></i></span></th><th class="clearfix"><span class="pull-left">Engagement</span> <span uib-tooltip="{{ ::tooltips.engagement }}" class="pull-right"><i class="far fa-question-circle"></i></span></th><th class="clearfix"><span class="pull-left">Contacts</span> <span uib-tooltip="{{ ::tooltips.contacts }}" tooltip-placement="left" class="pull-right"><i class="far fa-question-circle"></i></span></th><th class="clearfix"><span class="pull-left">Bookings</span> <span uib-tooltip="{{ ::tooltips.bookings }}" tooltip-placement="left" class="pull-right"><i class="far fa-question-circle"></i></span></th></tr><tr class="totalRow noBorder"><td><strong>All Specialisms</strong></td><td align="right"><strong>{{ ::stats.total.reach|number }}</strong></td><td align="right"><strong>{{ ::stats.total.queue|number }}</strong></td><td align="right"><strong>{{ ::stats.total.opens|number }}%</strong></td><td align="right"><strong>{{ ::stats.total.engagement|number }}%</strong></td><td align="right"><strong>{{ ::stats.total.contacts|number }}</strong></td><td align="right"><strong>{{ ::stats.total.bookings|number }}</strong></td></tr><tbody ng-repeat="specialism in stats.specialisms"><tr><td ng-click="specialism.open = !specialism.open" class="jsButton"><i class="ico fixedSize" ng-class="{\'ico-chevron-down\': specialism.open, \'ico-chevron-right\': !specialism.open}"></i>{{ ::specialism.name }}</td><td align="right">{{ ::specialism.reach|number }}</td><td align="right">{{ ::specialism.queue|number }}</td><td align="right">{{ ::specialism.opens|number }}%</td><td align="right">{{ ::specialism.engagement|number }}%</td><td align="right">{{ ::specialism.contacts|number }}</td><td align="right">{{ ::specialism.bookings|number }}</td></tr><tr ng-repeat="hub in specialism.hubs" ng-show="specialism.open" class="greyRow"><td>{{ ::hub.name }}</td><td align="right">{{ ::hub.reach|number }}</td><td align="right">{{ ::hub.queue|number }}</td><td align="right">{{ ::hub.opens|number }}%</td><td align="right">{{ ::hub.engagement|number }}%</td><td align="right">{{ ::hub.contacts|number }}</td><td align="right">{{ ::hub.bookings|number }}</td></tr></tbody><tr><td colspan="7"><a ui-sref="profile({\'#\': \'specialisms\'})" class="activities">+ Add specialism</a></td></tr></table><table class="statTable visible-xs" cellspacing="0" cellpadding="0" width="100%" border="0"><tr><th colspan="2">Specialisms</th></tr><tr class="totalRow noBorder"><td colspan="2"><strong>All Specialisms</strong></td></tr><tr class="totalRow"><td>Reach<span class="marginLeft" uib-tooltip="{{ ::tooltips.reach }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.reach|number }}</td></tr><tr class="totalRow"><td>Queue<span class="marginLeft" uib-tooltip="{{ ::tooltips.queue }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.queue|number }}</td></tr><tr class="totalRow"><td>Opens<span class="marginLeft" uib-tooltip="{{ ::tooltips.opens }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.opens|number }}%</td></tr><tr class="totalRow"><td>Engagement<span class="marginLeft" uib-tooltip="{{ ::tooltips.engagement }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.engagement|number }}%</td></tr><tr class="totalRow"><td>Contacts<span class="marginLeft" uib-tooltip="{{ ::tooltips.contacts }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.contacts|number }}</td></tr><tr class="totalRow"><td>Bookings<span class="marginLeft" uib-tooltip="{{ ::tooltips.bookings }}" tooltip-placement="right"><i class="far fa-question-circle"></i></span></td><td align="right">{{ ::stats.total.bookings|number }}</td></tr><tbody ng-repeat="specialism in stats.specialisms"><tr><td colspan="2" ng-click="specialism.open = !specialism.open"><i class="ico fixedSize" ng-class="{\'ico-chevron-down\': specialism.open, \'ico-chevron-right\': !specialism.open}"></i>{{ ::specialism.name }}</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Reach</td><td align="right">{{ ::specialism.reach|number }}</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Queue</td><td align="right">{{ ::specialism.queue|number }}</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Opens</td><td align="right">{{ ::specialism.opens|number }}%</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Engagement</td><td align="right">{{ ::specialism.engagement|number }}%</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Contacts</td><td align="right">{{ ::specialism.contacts|number }}</td></tr><tr ng-show="specialism.open" class="greyRow"><td>Bookings</td><td align="right">{{ ::specialism.bookings|number }}</td></tr></tbody><tr><td colspan="2"><a ui-sref="profile({\'#\': \'specialisms\'})" class="activities">+ Add specialism</a></td></tr></table></div>'),$templateCache.put("dashboard/views/mini-stat-panel.html",'<div class="miniStatPanel"><header class="{{ theme }}"><i class="h2 notBold far fa-question-circle jsButton" uib-tooltip="{{ tooltip }}" tooltip-placement="{{ tooltipPlacement }}"></i><h2>{{ title }}</h2><small ng-class="{\'invisible\': !latestDate}">Latest {{ latestDate }}</small></header><div class="row noGutter noPadding text-center"><div class="col-xs-6"><div class="vAlignRow centered"><span class="h2">{{ last30 }}</span> <i class="fas fa-arrow-up" ng-if="older30 < last30"></i> <i class="fas fa-arrow-down" ng-if="older30 > last30"></i> <i class="fas fa-minus" ng-if="older30 == last30"></i></div><small>Last 30 days</small></div><div class="col-xs-6 borderLeft"><div class="h2">{{ total }}</div><small>Total</small></div></div></div>'),$templateCache.put("errors/views/not-found.html",'<div class="wrapper wrapper-content"><div class="row"><div class="col-lg-12"><div class="text-center m-t-lg"><h1>{{ pageTitle }}</h1><p>The page you are looking for could not be found.</p></div></div></div></div>'),$templateCache.put("interests/views/add-interest-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Add an interest</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><form ng-show="!loading" name="form" novalidate><div class="form-group" ng-class="{\'has-error\': (validationRun && form.$error.interest) || formErrors.interest}"><label>What activity do you want to do?</label><interest-search input-id="interestAutoComplete" data="formData.interest" theme="activities"></interest-search><span class="help-block" ng-show="(validationRun && form.$error.interest) || formErrors.interest">You must select a valid interest</span></div><div class="form-group sliderGroup"><label>What\'s your skill level?</label><slider-with-labels model="formData.difficultyLevel"></slider-with-labels></div><label class="outsideFormGroup">Where do you want to do it?</label><div class="vAlignParent full-width form-group" ng-if="savedHomeHub"><label class="notBold vAlign">{{ savedHomeHub.name.indexOf(\',\') > 0 ? savedHomeHub.name.substring(0, savedHomeHub.name.indexOf(\',\')) : savedHomeHub.name }} (Home location)</label><switch class="vAlign" ng-model="formData.useHomeHub"></switch></div><div id="interestHubList"><div ng-repeat="h in formData.hubs"><div class="vAlignParent full-width form-group"><label class="notBold vAlign">{{ h.name }}</label><div class="vAlign text-right"><a ng-click="removeLocation(h)"><i class="ico ico-trash"></i></a></div></div></div></div><div class="form-group no-margins" ng-class="{\'has-error\': validationRun && form.$error.hubs}"><location-search data="newLocation" placeholder="Add another location..."></location-search><span class="help-block" ng-show="validationRun && form.$error.hubs">At least one location is required</span></div></form></div><div class="modal-footer" ng-hide="loading"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="save()"><i class="ico ico-tick"></i>Save</button></div>'),$templateCache.put("interests/views/form.html",'<section class="row white-bg"><form name="form" novalidate><div id="map" class="angular-google-map-container hidden-xs" style="clear:left"></div><div class="sectionContent item withOffsetBorderXS"><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group" ng-class="{\'has-error\': (validationRun && form.$error.interest) || formErrors.interest}"><label>Which activity are you interested in?</label><interest-search input-id="interestAutoComplete" data="formData.interest" theme="profile"></interest-search><span class="help-block" ng-show="(validationRun && form.$error.interest) || formErrors.interest">You must select a valid interest</span></div><div class="form-group sliderGroup"><label>What\'s your skill level?</label><slider-with-labels model="formData.difficultyLevel"></slider-with-labels></div></div><div class="col-xs-12 col-sm-6"><label style="font-weight:normal; margin-bottom:10px">Add locations and distance</label><div class="form-group switchWithLabel clearfix" ng-if="savedHomeHub"><switch class="pull-left" ng-model="formData.useHomeHub"></switch><label class="pull-left">{{ savedHomeHub.distance }} miles of {{ savedHomeHub.name.indexOf(\',\') > 0 ? savedHomeHub.name.substring(0, savedHomeHub.name.indexOf(\',\')) : savedHomeHub.name }} (Home location)</label></div><div id="interestHubList"><div ng-repeat="m in markers"><div class="form-group sliderGroup" ng-if="!m.isHome"><label>{{ m.marker.name }}</label><div class="row halfGutter"><div class="col-xs-10"><div class="noUi-extended" ya-no-ui-slider="m.distance.value" ya-no-ui-slider-events="m.distance.events"></div></div><div class="col-xs-2 text-xs-center"><a ng-click="removeLocation(m)"><i class="ico ico-trash"></i></a></div></div></div></div></div><div class="form-group" ng-class="{\'has-error\': validationRun && form.$error.hubs}"><div class="input-group"><span class="input-group-addon"><i class="ico ico-pin"></i></span> <input googleplace ng-model="locationSearchBox" data="newLocation" placeholder="Add another location" type="text" class="form-control"></div><span class="help-block" ng-show="validationRun && form.$error.hubs">At least one location is required</span></div></div></div><div class="clearfix formActions"><a class="btn btn-red btn-outline" ng-click="cancel()"><i class="ico ico-cross"></i>Cancel</a> <a class="btn btn-green pull-right btn-outline" ng-click="save()"><i class="ico ico-tick"></i>Save</a></div></div></form></section>'),$templateCache.put("messages/views/list.html",'<section class="row white-bg gutterMarginBottom"><section-header text="{{ folder|capitalize }}" type="messages"><a class="btn btn-outline btn-messages" ng-click="newMessage()"><i class="ico ico-message"></i> New message</a></section-header><div class="sectionContent withOffsetBorder noPaddingBottom" ng-show="folder != \'sent\'"><message-filters></message-filters></div></section><div class="row"><ul class="messageList list-unstyled" ng-show="!loading"><li class="white-bg" ng-show="!messages.length"><span class="mainRow clearfix"><span class="clearfix text-center"><span class="h2 col-xs-12">No messages</span></span></span></li><li class="white-bg" ng-repeat="message in messages" ng-class="{\'read\' : folder == \'sent\' || message.read }" ng-click="loadMessage(message, folder == \'sent\')"><span class="vAlignParent"><span class="vAlign"><i ng-if="folder !== \'sent\' && !message.fromAvatar" class="ico pull-left messageTypeIcon" ng-class="message.category"></i> <i ng-if="folder !== \'sent\' && message.fromAvatar" class="ico pull-left messageTypeIcon circlePhoto messages" ng-class="{\'noPhoto\': !message.fromAvatar}" style="background-image: url(\'{{message.fromAvatar}}\')"></i> <i ng-if="folder == \'sent\'" class="ico pull-left messageTypeIcon circlePhoto messages" ng-class="{\'noPhoto\': !auth.currentUser.profile.avatarURL}" style="background-image: url(\'{{auth.currentUser.profile.avatarURL}}\')"></i> </span><span class="vAlign col-xs-8 col-sm-3"><span class="truncate boldUnread"><span ng-if="folder == \'sent\'"><span ng-repeat="nr in message.recipients">{{ nr.name }}{{$last ? \'\' : \', \'}}</span></span> <span ng-if="folder != \'sent\'">{{ message.from }}</span> </span><span class="visible-xs boldUnread">{{ message.subject }}</span> </span><span class="hidden-xs vAlign col-sm-5 boldUnread">{{ message.subject }}</span> <span class="vAlign col-xs-4 text-right boldUnread">{{ message.date }}</span></span></li></ul></div><div class="row gutterMarginTop" ng-show="!loading && messages"><div class="vAlignParent full-width"><div class="col-xs-4 vAlign"><a ng-show="pagination.currentPage > 1" ng-click="pagination.prevPage()" class="btn btn-textcolour btn-outline"><i class="ico ico-chevron-left"></i> Back</a></div><div ng-show="pagination.totalPages > 0" class="col-xs-4 vAlign text-center"><span>Page {{ pagination.currentPage }} of {{ pagination.totalPages }}</span></div><div class="col-xs-4 vAlign text-right"><a ng-show="pagination.currentPage < pagination.totalPages" ng-click="pagination.nextPage()" class="btn btn-textcolour btn-outline iconRight">Next <i class="ico ico-chevron-right"></i></a></div></div></div><div ng-show="loading" class="text-center"><div class="loadingSpinner wink marginTop"></div></div>'),$templateCache.put("messages/views/message.html",'<div class="row gutterMarginBottom clearfix"><a class="btn btn-outline btn-red pull-left" ng-click="back()"><i class="ico ico-chevron-left"></i> Back</a><div class="pull-right"><a class="btn btn-outline btn-messages" ng-show="!readOnly && (message.type == \'friend_message\' || message.type == \'activity_match\') && !message.deleted && !showReplyForm" ng-click="loadReplyForm()"><i class="ico ico-back"></i> Reply</a> <a class="btn btn-outline btn-messages" ng-show="!readOnly && !message.deleted" ng-click="delete()"><i class="ico ico-trash"></i> Trash</a> <a class="btn btn-outline btn-messages" ng-show="!readOnly && message.deleted" ng-click="undelete()"><i class="ico ico-untrash"></i> Un-Trash</a></div></div><section class="row"><div class="col-xs-12 white-bg sectionContent singleMessage"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div ng-hide="loading"><p class="text-right">{{ message.date }}</p><div class="messageDetails vAlignParent"><div class="vAlignParent vAlign" ng-hide="message.recipients"><i ng-if="!message.fromAvatar" class="vAlign ico messageTypeIcon" ng-class="message.category"></i> <i ng-if="message.fromAvatar" class="vAlign ico messageTypeIcon circlePhoto messages" ng-class="{\'noPhoto\': !message.fromAvatar}" style="background-image: url(\'{{message.fromAvatar}}\')"></i><p class="vAlign h2">{{ message.from }}</p></div><div class="vAlignParent vAlign" ng-show="message.recipients" ng-repeat="recipient in message.recipients"><i class="vAlign ico messageTypeIcon circlePhoto messages" ng-class="{\'noPhoto\': !recipient.avatar}" style="background-image: url(\'{{recipient.avatar}}\')"></i><p class="vAlign h2">{{ recipient.name }}</p></div></div><p class="h3 subject">{{ message.subject }}</p><div class="messageMessage" ng-bind-html="message.message | nl2br | formatEmailMessage:true"></div></div></div></section><section id="replyForm" class="row marginTop" ng-show="showReplyForm"><div class="col-xs-12 white-bg sectionContent"><form name="form" novalidate><div class="form-group" ng-class="{ \'has-error\': validationRun && !formData.message}"><label>Your reply</label><textarea id="replyMessage" class="form-control" rows="5" ng-model="formData.message" placeholder="Your reply" required></textarea><span class="help-block" ng-show="validationRun && !formData.message">The message text is required</span></div><div class="clearfix"><a class="btn btn-red btn-outline pull-left" ng-click="hideReplyForm()"><i class="ico ico-cross"></i>Cancel</a> <a class="btn btn-messages btn-outline pull-right" ng-click="sendReply()"><i class="ico ico-tick"></i>Send</a></div></form></div></section>'),$templateCache.put("messages/views/new-message-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Send a message</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><form ng-show="!loading" name="form" novalidate><div class="alert alert-danger" ng-show="sendError">{{ sendError }}</div><div class="form-group" ng-class="{\'has-error\': validationRun && form.$error.recipientCount}"><label>To</label><tags-input class="messages" ng-model="formData.recipients" display-property="name" key-property="id" placeholder="Search contacts and groups..." replace-spaces-with-dashes="false" add-from-autocomplete-only="true" on-tag-added="tagAdded($tag)" on-tag-removed="tagRemoved($tag)"><auto-complete source="loadTags($query)" highlight-matched-text="false" template="core/partials/autocomplete-contact-and-group.html" min-length="1"></auto-complete></tags-input><span class="help-block" ng-show="validationRun && form.$error.recipientCount">There must be at least one recipient</span></div><div class="form-group" ng-class="{\'has-error\': validationRun && !formData.subject}"><label>Subject</label><input class="form-control" ng-model="formData.subject" type="text" required> <span class="help-block" ng-show="validationRun && !formData.subject">Subject is required</span></div><div class="form-group" ng-class="{\'has-error\': validationRun && !formData.message}"><label>Message</label><textarea class="form-control" rows="5" ng-model="formData.message" required></textarea><span class="help-block" ng-show="validationRun && !formData.message">The message text is required</span></div></form></div><div class="modal-footer" ng-hide="loading"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="send()"><i class="ico ico-tick"></i>Send</button></div>'),
$templateCache.put("messages/views/widget.html",'<section class="messages white-bg"><section-header text="Inbox" type="messages" badge-count="{{$root.unreadMessageCount}}" help-text="{{ helpText }}"></section-header><div class="sectionContent tabular"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><span class="row noGutter tableRow" ng-show="!loading && !messages.length"><div class="col-xs-12"><strong>You have no messages</strong></div></span><a class="row noGutter tableRow" ng-repeat="message in messages" ng-click="loadMessage(message)" ng-mouseenter="hover=true" ng-mouseleave="hover=false" ng-hide="loading"><div class="col-sm-3 col-xs-4"><strong>{{ message.from }}</strong></div><div class="col-sm-7 col-xs-6">{{ message.subject }}</div><div class="col-xs-2 text-right"><i class="ico messageTypeIcon {{ message.category }}" ng-class="{\'inverse\': !hover}"></i></div></a></div></section>'),$templateCache.put("payment/views/payment-form-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Add a new card</h1></div><div class="modal-body"><div class="alert alert-danger" ng-show="errorMessage">{{ errorMessage }}</div><payment-card-form button-theme="profile" button-text="Save Card" button-icon="ico-payment-card" on-submit="saveCard" on-back="$dismiss()" back-button-icon="ico-cross" back-button-text="Cancel" back-button-class="btn-red"></payment-card-form></div>'),$templateCache.put("payment/views/payment-methods.html",'<div class="sectionContent noPaddingBottom withOffsetBorder"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading"><ul class="existingCards list-unstyled"><li ng-repeat="card in existingCards"><span class="defaultLabel" ng-if="card.default">Default</span> <span class="actions" ng-if="!card.default"><a ng-click="setDefault(card.stripeCardId)">Set as default</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a ng-click="remove(card.stripeCardId, card.paymentsDue)">Remove</a></span> <span class="cardNumber">XXXX-XXXX-XXXX-{{ card.last4 }}</span> <span class="brand ico ico-{{ card.brand.split(\' \').join(\'\') | lowercase }}"></span> <span class="expiry">Expires: {{ card.expiryMonth }} / {{ card.expiryYear }}</span></li><li class="addNew" ng-click="showPaymentForm()"><span class="cardNumber"><i class="ico ico-plus"></i> Add a new card</span></li></ul></div></div>'),$templateCache.put("profile/views/edit-homehub-modal.html",'<div class="modal-header"><a class="close" ng-show="!loading" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title" ng-show="!auth.currentUser.homeHub">Add home location</h1><h1 class="modal-title" ng-show="auth.currentUser.homeHub">Edit home location</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div class="profileEditModal" ng-show="!loading"><div><form name="homeHubForm" class="row halfGutter"><div class="col-xs-12 form-group" ng-class="{\'has-error\': (validationRun && homeHubForm.homeHub.$invalid)}"><label>Location<a uib-tooltip="This is the approximate location where you mostly do your activities" tooltip-placement="right" class="help"><i class="ico fixedSize ico-question"></i></a></label><div class="input-group"><span class="input-group-addon clickable" ng-click="useCurrentLocation()"><i class="ico ico-pin"></i></span> <input googleplace replace="true" ng-model="formData.locationSearchBox" data="formData.homeHub" placeholder="{{ locationPlaceholder }}" type="text" class="form-control" name="homeHub" required="auth.currentUser.registrationType == \'host\'"></div><span class="help-block" ng-show="(validationRun && homeHubForm.homeHub.$invalid)">This is a required field</span></div></form></div></div></div><div class="modal-footer" ng-show="!loading && !editing"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="save()"><i class="ico ico-tick"></i>Save</button></div>'),$templateCache.put("profile/views/profile-score-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Profile score</h1></div><div class="modal-body"><h3 class="gutterMarginBottom">Your score: {{ auth.currentUser.profile.score }}/10</h3><p>Your profile score is calculated based on the information you provide about yourself.</p><p>You will receive one point for each Essential and Additional profile element completed, but points for completing the Additional elements are not awarded until all five of the Essential ones are done.</p><p class="marginBottom">Once you have provided all five of the Essential profile elements your account will be verified and you will gain access to the HulaHub marketing tools.</p><h4 class="gutterMarginBottom half">Essential profile elements</h4><ul class="list-unstyled marginBottom"><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasNameAndNumber, \'mutedText\': !score.hasNameAndNumber}"></i>Name and phone number<a class="pull-right contacts" ng-if="!score.hasNameAndNumber" ng-click="addMissingData(\'phoneNumber\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasAvatar, \'mutedText\': !score.hasAvatar}"></i>Profile picture<a class="pull-right contacts" ng-if="!score.hasAvatar" ng-click="addMissingData(\'avatar\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasShortBio, \'mutedText\': !score.hasShortBio}"></i>Short bio<a class="pull-right contacts" ng-if="!score.hasShortBio" ng-click="addMissingData(\'personalStatement\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasHomeHub, \'mutedText\': !score.hasHomeHub}"></i>Business location<a class="pull-right contacts" ng-if="!score.hasHomeHub" ng-click="addMissingData(\'homeHub\')">+ Add</a></li><li class="clearfix"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasSpecialism, \'mutedText\': !score.hasSpecialism}"></i>Specialism<a class="pull-right contacts" ng-if="!score.hasSpecialism" ng-click="addMissingData(\'specialism\')">+ Add</a></li></ul><h4 class="gutterMarginBottom half">Additional profile elements</h4><ul class="list-unstyled no-margins"><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasCoverPhoto, \'mutedText\': !score.hasCoverPhoto}"></i>Background picture<a class="pull-right contacts" ng-if="!score.hasCoverPhoto" ng-click="addMissingData(\'coverPhoto\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasDOB, \'mutedText\': !score.hasDOB}"></i>Date of birth<a class="pull-right contacts" ng-if="!score.hasDOB" ng-click="addMissingData(\'dateOfBirth\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasGender, \'mutedText\': !score.hasGender}"></i>Gender<a class="pull-right contacts" ng-if="!score.hasGender" ng-click="addMissingData(\'gender\')">+ Add</a></li><li class="clearfix gutterMarginBottom half"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasBusinessName, \'mutedText\': !score.hasBusinessName}"></i>Business name<a class="pull-right contacts" ng-if="!score.hasBusinessName" ng-click="addMissingData(\'businessName\')">+ Add</a></li><li class="clearfix"><i class="fas fa-check-circle h2 marginRight" ng-class="{\'greenColour\': score.hasSocialLink, \'mutedText\': !score.hasSocialLink}"></i>Social links<a class="pull-right contacts" ng-if="!score.hasSocialLink" ng-click="addMissingData(\'socialLinks\')">+ Add</a></li></ul></div>'),$templateCache.put("reviews/views/form.html",'<div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><section class="row white-bg gutterMarginBottom" ng-show="!loading"><section-header ng-show="auth.isLoggedIn" text="Review a host" type="contacts"></section-header><h1 ng-show="!auth.isLoggedIn" class="sectionContent text-center walletColour">Leave a review</h1><div class="profileBackground bgFade" style="background-image: url(\'/img/landing/lrg/A62-2.jpg\')"><div class="topLayer"><span class="h2 hidden-xs">{{ ::user.name }}<span ng-if="user.businessName"> ({{ ::user.businessName }})</span></span> <span class="circlePhoto xx-lrg {{ $state.current.data.theme }}" ng-class="{\'noPhoto\': !user.avatarURL}" style="background-image:url(\'{{ ::user.avatarURL }}\')"></span></div></div><div class="profileExtraInfo text-xs-center text-sm-left"><p class="h1 visible-xs"><strong>{{ ::user.name }}</strong></p><p class="h2 visible-xs" ng-if="user.businessName">({{ ::user.businessName }})</p><p class="h2">{{ ::user.homeHub.name }}</p></div><div class="sectionContent reviewForm"><form name="form" novalidate><div class="row"><div class="col-xs-12"><div class="form-group" ng-class="{\'has-error\': validationRun && (form.$error.reliability || form.$error.expertise || form.$error.enthusiasm)}"><label>Your rating</label><span class="help-block gutterMarginBottom" ng-show="validationRun && (form.$error.reliability || form.$error.expertise || form.$error.enthusiasm)">Please select a rating for all areas</span><ul class="list-unstyled ratingList {{ $state.current.data.theme }}"><rating-control score="formData.reliability" label="Reliability" tooltip="Did they turn up on time? Was the activity as you expected? Was communication good?" has-error="validationRun && form.$error.reliability"></rating-control><rating-control score="formData.expertise" label="Expertise" tooltip="Did your host have the right level of experience? Would you recommend them to a friend?" has-error="validationRun && form.$error.expertise"></rating-control><rating-control score="formData.enthusiasm" label="Enthusiasm" tooltip="Did they motivate the group and create a positive atmosphere? Did you enjoy yourself?" has-error="validationRun && form.$error.enthusiasm"></rating-control></ul></div></div></div><div class="row"><div class="col-xs-12 form-group" ng-class="{\'has-error\': (validationRun && form.headline.$invalid) || formErrors.headline}"><label>Your comments</label><input class="form-control" ng-model="formData.headline" name="headline" placeholder="Write a headline..." type="text" required maxlength="100"> <span class="help-block" ng-show="(validationRun && form.headline.$invalid) || formErrors.headline">This is a required field</span></div><div class="col-xs-12 form-group"><textarea class="form-control" rows="4" ng-model="formData.text" placeholder="Add more detail (optional)..."></textarea></div></div><div class="row formActions"><div class="col-xs-12"><button type="button" class="btn btn-green pull-right btn-outline" ng-click="submitReview()"><i class="ico ico-tick"></i>Submit</button> <button type="button" class="btn btn-red pull-left btn-outline" ng-click="cancel()"><i class="ico ico-cross"></i>Cancel</button></div></div></form></div></section>'),$templateCache.put("reviews/views/request.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Request a review" type="profile"></section-header><div class="sectionContent withOffsetBorder"><form name="form" novalidate><div class="row"><div class="col-xs-12 col-sm-8 col-md-6"><div class="form-group" ng-class="{ \'has-error\': validationRun && form.$error.recipientCount}"><label>Send review requests via HulaHub</label><tags-input class="profile" ng-model="formData.recipients" display-property="name" key-property="id" placeholder="Search contacts and groups..." replace-spaces-with-dashes="false" add-from-autocomplete-only="true" on-tag-added="tagAdded($tag)" on-tag-removed="tagRemoved($tag)"><auto-complete source="loadTags($query)" highlight-matched-text="false" template="core/partials/autocomplete-contact-and-group.html" min-length="1"></auto-complete></tags-input></div></div></div><div class="row"><div class="col-xs-12 col-sm-8 col-md-6"><div class="form-group" ng-class="{ \'has-error\': (validationRun && form.$error.recipientCount) || invalidEmails.length}"><label>Send review requests via email</label><textarea class="form-control" rows="4" ng-model="formData.external" placeholder="Enter comma-seperated email addresses of your contacts..."></textarea><span class="help-block" ng-show="validationRun && form.$error.recipientCount">You must enter at least one recipient</span> <span class="help-block" ng-show="invalidEmails.length">Unfortunately the following email address<span ng-show="invalidEmails.length > 1">es are </span><span ng-show="invalidEmails.length == 1">&nbsp;is </span>invalid</span></div></div></div><div class="divider gutterMarginBottom"></div><div class="row"><div class="col-xs-12"><div class="form-group"><label>Personalise your request message (optional)</label><textarea class="form-control" rows="4" ng-model="formData.comments" placeholder="Write your personalised message here that will be included in your request..."></textarea></div></div></div><div class="row formActions"><div class="col-xs-12"><button class="btn btn-green pull-right btn-outline" ng-click="sendRequests()"><i class="ico ico-message-fly"></i> Send requests</button> <button class="btn btn-red pull-left btn-outline" ui-sref="profile"><i class="ico ico-chevron-left"></i> Back</button></div></div></form></div></section><section class="row white-bg"><section-header text="Review requests sent" type="profile"><a class="btn btn-profile btn-outline" ui-sref="profile({\'#\':\'reviews\'})"><i class="ico ico-star noSpacingXS"></i><span class="hidden-xs">My reviews</span></a></section-header><div class="sectionContent withOffsetBorder"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading && !requests.length"><p class="h2 text-center">You have not sent any review requests.</p></div><div class="simpleTableLayout profile" ng-show="!loading && requests.length"><div class="row tableHeading hidden-xs hidden-sm no-margins"><div class="col-sm-8 col-md-9 col-lg-10"><div class="row halfGutter"><div class="col-sm-3">Date</div><div class="col-sm-5 col-md-6">Recipient</div><div class="col-sm-4 col-md-3">Status</div></div></div></div><div class="row tableRow no-margins" ng-repeat="request in requests" ng-class="{\'first\': $first}"><div class="col-xs-9 col-lg-10"><div class="row halfGutter"><div class="col-xs-12 col-md-3 dateColumn">{{ request.created | dateFormat:\'DD/MM/YY\' }}</div><div class="col-xs-12 col-md-6 wordWrap"><span ng-show="!request.recipient">{{ request.emailAddress }}</span> <a ng-show="request.recipient" class="profile underlinedLink" ng-click="viewProfile(request.recipient.id)">{{ request.recipient.name }}</a></div><div class="col-xs-12 col-md-3"><span ng-if="!request.complete && !request.rejected">Pending</span> <span ng-if="request.complete">Left review</span> <span ng-if="request.rejected">Rejected</span></div></div></div><div class="col-xs-3 col-lg-2 text-right"><div ng-show="!request.complete && !request.rejected" class="dropdown"><button class="btn btn-profile btn-outline dropdown-toggle" type="button" data-toggle="dropdown"><i class="ico ico-cog noSpacingXXS"></i><span class="hidden-xxs">Options</span> <span class="caret no-margins"></span></button><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="resendRequest(request.id)">Re-send</a></li><li><a ng-click="deleteRequest(request)">Remove</a></li></ul></div><a ng-show="request.complete" class="btn btn-profile btn-outline" ng-click="viewReview(request)"><i class="ico ico-star noSpacingXXS"></i><span class="hidden-xxs">View</span></a> <a ng-show="request.rejected" class="btn btn-red btn-outline" ng-click="deleteRequest(request)"><i class="ico ico-trash noSpacingXXS"></i><span class="hidden-xxs">Remove</span></a></div></div></div></div></section>'),$templateCache.put("settings/views/account.html",'<section class="row white-bg gutterMarginBottom"><section-header text="Account settings" type="profile"></section-header><div class="sectionContent withOffsetBorder" ng-show="!editing"><div class="vAlignParent full-width profileEditRow"><div class="vAlign col-xs-8 noPadding"><div class="row noGutter"><div class="col-xs-12 col-sm-4 col-md-3"><strong>Full name</strong></div><div class="col-xs-12 col-sm-8 col-md-9">{{ auth.currentUser.profile.firstName }} {{ auth.currentUser.profile.lastName }}</div></div></div><div class="vAlign text-right col-xs-4 noPadding clearfix"><a class="underlineOnHover profile editButton pull-right" ng-click="edit(\'name\')"><i class="ico ico-edit"></i> Edit</a> <span class="pull-right" uib-tooltip="Visible to other HulaHub members" tooltip-placement="left"><i class="ico ico-globe"></i></span></div></div><div class="divider gutterMarginTop gutterMarginBottom"></div><div class="vAlignParent full-width profileEditRow"><div class="vAlign col-xs-8 noPadding"><div class="row noGutter"><div class="col-xs-12 col-sm-4 col-md-3"><strong>Email address</strong></div><div class="col-xs-12 col-sm-8 col-md-9 wordBreakAll">{{ auth.currentUser.email }}</div></div></div><div class="vAlign text-right col-xs-4 noPadding clearfix"><a class="underlineOnHover profile editButton pull-right" ng-click="edit(\'email\')"><i class="ico ico-edit"></i> Edit</a> <span class="pull-right" uib-tooltip="Not visible to other HulaHub members" tooltip-placement="left"><i class="ico ico-lock"></i></span></div></div><div class="divider gutterMarginTop gutterMarginBottom" ng-show="!auth.currentUser.oAuthUserId"></div><div class="vAlignParent full-width profileEditRow" ng-show="!auth.currentUser.oAuthUserId"><div class="vAlign col-xs-8 noPadding"><div class="row noGutter"><div class="col-xs-12 col-sm-4 col-md-3"><strong>Password</strong></div><div class="col-xs-12 col-sm-8 col-md-9">Use a strong password that you don\'t use elsewhere</div></div></div><div class="vAlign text-right col-xs-4 noPadding"><a class="underlineOnHover profile" ng-click="edit(\'password\')"><i class="ico ico-edit"></i> Edit</a></div></div><div class="divider gutterMarginTop gutterMarginBottom"></div><div class="vAlignParent full-width profileEditRow"><div class="vAlign col-xs-8 noPadding"><div class="row noGutter"><div class="col-xs-12 col-sm-4 col-md-3"><strong>Account status</strong></div><div class="col-xs-12 col-sm-8 col-md-9">Active</div></div></div><div class="vAlign text-right col-xs-4 noPadding"><a class="underlineOnHover profile" ng-click="edit(\'status\')"><i class="ico ico-edit"></i> Edit</a></div></div></div><div class="sectionContent withOffsetBorder myAccountForm" ng-show="editing"><form name="nameForm" class="row halfGutter" ng-show="editing == \'name\'"><div class="col-xs-12 col-sm-6 form-group" ng-class="{\'has-error\': (validationRun[\'nameForm\'] && nameForm.firstName.$invalid) || formErrors.firstName}"><label>First name</label><input class="form-control" ng-model="formData.firstName" name="firstName" placeholder="First name" type="text" required> <span class="help-block" ng-show="(validationRun[\'nameForm\'] && nameForm.firstName.$invalid) || formErrors.firstName">This is a required field</span></div><div class="col-xs-12 col-sm-6 form-group" ng-class="{\'has-error\': (validationRun[\'nameForm\'] && nameForm.lastName.$invalid) || formErrors.lastName}"><label>Last name</label><input class="form-control" ng-model="formData.lastName" name="lastName" placeholder="Last name" type="text" required> <span class="help-block" ng-show="(validationRun[\'nameForm\'] && nameForm.lastName.$invalid) || formErrors.lastName">This is a required field</span></div><p class="col-xs-12 gutterMarginBottom"><strong>Please note:</strong> Your name is always public.</p></form><form name="emailForm" class="row halfGutter" ng-show="editing == \'email\'"><div class="col-xs-12 col-md-6 form-group" ng-class="{\'has-error\': (validationRun[\'emailForm\'] && emailForm.email.$invalid) || formErrors.email}"><label>Email address</label><input class="form-control email" ng-model="formData.email" placeholder="Email address" type="email" name="email" required> <span class="help-block" ng-show="(validationRun[\'emailForm\'] && emailForm.email.$invalid) || formErrors.email">{{ formErrors.email || \'This email address is not valid\' }}</span></div><p class="col-xs-12 gutterMarginBottom"><strong>Please note:</strong> Your email address is always private and will never be shared with other people.</p></form><form name="passwordForm" class="row halfGutter" ng-show="editing == \'password\'"><div class="col-xs-12 col-sm-4 form-group" ng-class="{\'has-error\': (validationRun[\'passwordForm\'] && passwordForm.currentPassword.$invalid) || formErrors.currentPassword}"><input class="form-control" ng-model="formData.currentPassword" name="currentPassword" placeholder="Current password" type="password" autocomplete="off" required> <span class="help-block" ng-show="formErrors.currentPassword">{{ formErrors.currentPassword || \'The current password is incorrect\' }}</span><div ng-messages="validationRun[\'passwordForm\'] && passwordForm.currentPassword.$error"><span class="help-block" ng-message="required">Your current password is required</span></div></div><div class="col-xs-12 col-sm-4 form-group" ng-class="{\'has-error\': (validationRun[\'passwordForm\'] && passwordForm.newPassword.$invalid) || formErrors.newPassword}"><input class="form-control" ng-model="formData.newPassword" name="newPassword" placeholder="New password" type="password" required> <span class="help-block" ng-show="formErrors.newPassword">{{ formErrors.newPassword }}</span><div ng-messages="validationRun[\'passwordForm\'] && passwordForm.newPassword.$error"><span class="help-block" ng-message="required">A new password is required</span></div></div><div class="col-xs-12 col-sm-4 form-group" ng-class="{\'has-error\': (validationRun[\'passwordForm\'] && passwordForm.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword}"><input class="form-control" ng-model="formData.confirmPassword" name="confirmPassword" placeholder="Confirm new password" type="password" compare-to="formData.newPassword" required> <span class="help-block" ng-show="(validationRun[\'passwordForm\'] && passwordForm.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword">{{ formErrors.confirmPassword || \'The passwords do not match\' }}</span></div></form><form name="statusForm" class="row" ng-show="editing == \'status\'"><div class="col-xs-12"><p><strong>Account status:</strong> Active</p><p class="gutterMarginBottom">Closing your account will disable your profile and remove your name and photo from most things that you\'ve shared on HulaHub. Some information will still be visible to others, such as invoices and messages that you\'ve sent. <a href="{{ env.knowledgehub }}/account/closing-your-account/closing-you-account" target="_blank" class="underlinedLink profile">Learn more</a></p><div class="checkbox gutterMarginBottom"><label><input type="checkbox" ng-model="formData.closeAccount"> Close my account</label></div></div></form><div class="clearfix"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="cancel()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green btn-outline pull-right" type="button" ng-click="save()"><i class="ico ico-tick"></i>Save</button></div></div></section>'),$templateCache.put("settings/views/messages.html",'<section class="row"><section-header text="Message settings" type="profile"></section-header><div class="sectionContent white-bg withOffsetBorder"><div class="messageSettingsList gutterMarginBottom double"><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6"><i class="ico messageTypeIcon contacts"></i><strong>My contacts</strong></div><div class="vAlign col-xs-6 text-right"><label>Email</label></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Message me</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.friend_message.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Join HulaHub</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.friend_join_hulahub.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Invite to activities</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.friend_invite.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Contact requests</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.friend_request.email"></switch></div></div></div></div><div class="messageSettingsList gutterMarginBottom double"><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6"><i class="ico messageTypeIcon activities"></i><strong>My activities</strong></div><div class="vAlign col-xs-6 text-right"><label>Email</label></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Activity updates</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="alwaysOn" disabled="true"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Discussion board updates</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.discussion_board.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Media gallery updates</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.media_gallery.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Rating updates</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.ratings.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Personal intro emails</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.activity_match.email"></switch></div></div></div></div><div class="messageSettingsList"><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6"><i class="ico messageTypeIcon hulahub"></i><strong>HulaHub</strong></div><div class="vAlign col-xs-6 text-right"><label>Email</label></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Have hints and tips</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.hq_hints_tips.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Suggest contacts</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.hq_suggest_friend.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Suggest interests</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.hq_suggest_interests.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Would like feedback</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.hq_feedback.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Have news for me</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="settings.hq_news.email"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Have payment updates</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="alwaysOn" disabled="true"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Answer my question</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="alwaysOn" disabled="true"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Update my account</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="alwaysOn" disabled="true"></switch></div></div></div><div class="row noGutter vAlignParent full-width"><div class="vAlign col-xs-6">Update terms or policies</div><div class="vAlign col-xs-6 text-right"><div class="switchContainer"><switch ng-model="alwaysOn" disabled="true"></switch></div></div></div></div></div></section>'),$templateCache.put("specialisms/views/specialism-modal.html",'<div class="modal-header"><a class="close" ng-show="!loading" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title" ng-show="!editMode">Add a specialism</h1><h1 class="modal-title" ng-show="editMode">Edit specialism</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><form name="form" novalidate ng-show="!loading"><div class="gutterMarginBottom">Enter a specialism and a location, then choose one of the options from the dropdowns.</div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.$error.interest) || formErrors.interest}"><label>What type of activity do you offer?</label><interest-search input-id="interestAutoComplete" data="formData.interest" theme="profile" placeholder="Enter a specialism"></interest-search><span class="help-block" ng-show="(validationRun && form.$error.interest) || formErrors.interest">You must select a valid specialism</span></div><label class="outsideFormGroup">Where do you offer it?</label><div class="vAlignParent full-width form-group" ng-if="savedHomeHub"><label class="notBold vAlign">{{ savedHomeHub.name.indexOf(\',\') > 0 ? savedHomeHub.name.substring(0, savedHomeHub.name.indexOf(\',\')) : savedHomeHub.name }} (Home location)</label><switch class="vAlign" ng-model="formData.useHomeHub"></switch></div><div id="interestHubList"><div ng-repeat="h in formData.hubs"><div class="vAlignParent full-width form-group"><label class="notBold vAlign">{{ h.name }}</label><div class="vAlign text-right"><a ng-click="removeLocation(h)"><i class="ico ico-trash"></i></a></div></div></div></div><div class="form-group no-margins" ng-class="{\'has-error\': validationRun && form.$error.hubs}"><location-search data="newLocation" placeholder="Add another location..."></location-search><span class="help-block" ng-show="validationRun && form.$error.hubs">At least one location is required</span></div></form></div><div class="modal-footer" ng-show="!loading"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="save()"><i class="ico ico-tick"></i>Save</button></div>'),$templateCache.put("users/views/activate-account.html",'<div class="row"><section class="noPadding col-sm-6 col-sm-offset-3"><section-header type="profile" text="Verify your email address"></section-header><div class="sectionContent white-bg withOffsetBorder"><p>An email has been sent with a link to verify your email address.</p><p>If you do not receive it within 1 minute; <a class="underlinedLink profile" ng-click="resend()">Click here</a> to re-send.</p><div class="alert alert-success white marginTop" ng-show="resent">Activation email has been re-sent</div><h3 class="marginTop gutterMarginBottom half profileColour">Not receiving emails?</h3><p class="no-margins">Please add \'noreply@hulahub.com\' to your address list as this will unblock your spam filter.</p></div></section></div>'),
$templateCache.put("users/views/complete-profile.html",'<div class="row extraLargeMarginTop"><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><section class="white-bg bordered"><h1 class="sectionContent text-center" ng-class="{\'profileColour\': auth.currentUser.registrationType != \'host\', \'activityColour\': auth.currentUser.registrationType == \'host\'}"><span ng-show="auth.currentUser.subscriptionPlan == \'FREE\'">Create free account</span> <span ng-show="auth.currentUser.subscriptionPlan == \'PERSONAL_MONTH\' || auth.currentUser.subscriptionPlan == \'PERSONAL_YEAR\'">Create personal account</span> <span ng-show="auth.currentUser.subscriptionPlan == \'Professional_Month_Trial\' || auth.currentUser.subscriptionPlan == \'Professional_Year_Trial\'">Create professional account</span></h1><div class="sectionContent"><form name="form" novalidate autocomplete="off"><div class="row halfGutter"><div class="col-xs-12 col-sm-6 form-group" ng-class="{\'has-error\': (validationRun && form.firstName.$invalid) || formErrors.firstName}"><label>First name</label><input class="form-control" ng-model="formData.firstName" name="firstName" placeholder="First name" type="text" required> <span class="help-block" ng-show="(validationRun && form.firstName.$invalid) || formErrors.firstName">This is a required field</span></div><div class="col-xs-12 col-sm-6 form-group" ng-class="{\'has-error\': (validationRun && form.lastName.$invalid) || formErrors.lastName}"><label>Last name</label><input class="form-control" ng-model="formData.lastName" name="lastName" placeholder="Last name" type="text" required> <span class="help-block" ng-show="(validationRun && form.lastName.$invalid) || formErrors.lastName">This is a required field</span></div></div><div class="row halfGutter"><div class="col-xs-12 col-sm-6 form-group" ng-class="{\'has-error\': (validationRun && form.phoneNumber.$invalid) || formErrors.phoneNumber}"><label>Phone number <span ng-if="auth.currentUser.registrationType == \'joiner\'">(optional)</span></label><telephone-number-input input-value="formData.phoneNumber" input-name="phoneNumber" required="auth.currentUser.registrationType == \'host\'"></telephone-number-input><span class="help-block" ng-show="(validationRun && form.phoneNumber.$invalid) || formErrors.phoneNumber">This is a required field</span></div><div class="col-xs-12 col-sm-6 form-group" ng-show="auth.currentUser.registrationType == \'host\'"><label>Business name (optional)</label><input class="form-control" ng-model="formData.businessName" name="businessName" type="text"></div><div class="col-xs-12 form-group" ng-show="auth.currentUser.registrationType == \'host\'" ng-class="{\'has-error\': formErrors.websiteURL}"><label>Website (optional)</label><input class="form-control" ng-model="formData.websiteURL" name="websiteURL" type="text"> <span class="help-block" ng-show="formErrors.websiteURL">This is not a valid URL</span></div><div class="col-xs-12 col-sm-6 form-group" ng-show="auth.currentUser.registrationType != \'host\'"><label>Gender (optional)</label><select class="form-control" ng-model="formData.gender.value" ng-options="option.id as option.name for option in formData.gender.options"><option value="" disabled="disabled">- Select one -</option></select></div></div><div class="row halfGutter" ng-show="auth.currentUser.registrationType != \'host\'"><div class="col-xs-12 form-group"><label>Date of birth (optional)</label><p>To sign up you must be 18 or older. Other people won\'t see your date of birth.</p><div class="row halfGutter"><div class="col-xs-4"><select class="form-control" ng-model="formData.dateOfBirth.value.day" ng-options="day as day for day in formData.dateOfBirth.options.days"><option value="" disabled="disabled">Day</option></select></div><div class="col-xs-4"><select class="form-control" ng-model="formData.dateOfBirth.value.month" ng-options="month as month for month in formData.dateOfBirth.options.months"><option value="" disabled="disabled">Month</option></select></div><div class="col-xs-4"><select class="form-control" ng-model="formData.dateOfBirth.value.year" ng-options="year as year for year in formData.dateOfBirth.options.years"><option value="" disabled="disabled">Year</option></select></div></div></div></div><div class="row halfGutter" ng-show="auth.currentUser.registrationType == \'joiner\'"><div class="col-xs-12 form-group"><label>Home location (optional)</label><div class="input-group"><span class="input-group-addon clickable" ng-click="useCurrentLocation()"><i class="ico ico-pin"></i></span> <input googleplace replace="true" ng-model="formData.locationSearchBox" data="formData.homeHub" placeholder="{{ locationPlaceholder }}" type="text" class="form-control"></div></div></div></form><div ng-show="auth.currentUser.subscriptionPlan != \'FREE\'"><div class="divider marginBottom"></div><p class="h3 gutterMarginBottom"><strong>1. Choose {{ selectedPlan.title }} plan subscription</strong></p><div ng-show="auth.currentUser.registrationType == \'host\'" class="gutterMarginBottom">Your no obligation 30-day free trial will start immediately on upgrade and can be cancelled at any point during that period whereupon your will revert to free Essential plan.</div><div class="planSelection marginBottom" ng-class="{\'profile\': auth.currentUser.registrationType != \'host\', \'activity\': auth.currentUser.registrationType == \'host\'}"><div class="row"><div class="col-xs-12"><div class="row halfGutter"><div class="col-xs-6" ng-click="formData.selectedSubscription = selectedPlan.monthly.code"><div class="switchWithLabel radioButton no-margins" ng-class="{\'active\' : formData.selectedSubscription === selectedPlan.monthly.code, \'profile\': auth.currentUser.registrationType != \'host\', \'activities\': auth.currentUser.registrationType == \'host\'}"><div class="vAlignParent full-width"><div class="vAlign"><div class="radio hidden-xs hidden-sm"></div></div><div class="vAlign text-xs-center text-sm-right"><label class="h2"><strong>{{ selectedPlan.monthly.cost | currencyDisplay:\'GBP\':false }}</strong><span class="small">/month</span></label></div></div></div></div><div class="col-xs-6" ng-click="formData.selectedSubscription = selectedPlan.annual.code"><div class="switchWithLabel radioButton no-margins" ng-class="{\'active\' : formData.selectedSubscription === selectedPlan.annual.code, \'profile\': auth.currentUser.registrationType != \'host\', \'activities\': auth.currentUser.registrationType == \'host\'}"><div class="vAlignParent full-width"><div class="vAlign"><div class="radio hidden-xs hidden-sm"></div></div><div class="vAlign text-xs-center text-sm-right"><label class="h2"><strong>{{ selectedPlan.annual.cost | currencyDisplay:\'GBP\':false }}</strong><span class="small">/year</span></label></div></div></div></div></div></div></div><div class="form-group gutterMarginTop"><label class="notBold">Add a promotional code<a class="helpButton" ng-click="showPromoCodePopup()"><i class="ico ico-question fixedSize"></i></a></label><div class="vAlignParent"><div class="vAlign" style="padding-right: 10px"><input ng-model="formData.promoCode.value" type="text" class="form-control"></div><div class="vAlign"><button type="button" class="btn" ng-class="{\'btn-profile\': auth.currentUser.registrationType != \'host\', \'btn-activities\': auth.currentUser.registrationType == \'host\'}" ng-click="validatePromoCode()" ng-disabled="!formData.promoCode.value">Apply</button></div></div><div class="gutterMarginTop half" ng-show="formErrors.promoCode || (formData.promoCode.value && formData.promoCode.verified && !formData.promoCode.valid)"><strong class="redColour">Sorry!</strong> You need a valid promotional code.</div><div class="gutterMarginTop half" ng-show="formData.promoCode.value && formData.promoCode.verified && formData.promoCode.valid"><strong class="greenColour">Success!</strong> {{ formData.promoCode.validMessage }}</div></div></div><p class="h3 gutterMarginBottom"><strong>2. Enter payment details</strong></p><div class="row"><div class="col-xs-12"><payment-card-form show-save-button="false" submission-handler="paymentFormSubmissionHandler" on-submit="savePaymentDetails"></payment-card-form></div></div></div><button ng-show="auth.currentUser.registrationType == \'host\'" class="btn btn-block btn-activities" type="button" ng-click="save()"><i class="ico ico-tick"></i>Start FREE 30-day trial</button> <button ng-show="auth.currentUser.registrationType != \'host\'" class="btn btn-block btn-profile" type="button" ng-click="save()"><i class="ico ico-tick"></i>Create an account</button><div class="gutterMarginTop text-center thinFont">Need help? Contact us at <a href="mailto:support@hulahub.com" class="underlineOnHover" ng-class="{\'activity\': auth.currentUser.registrationType == \'host\', \'profile\': auth.currentUser.registrationType != \'host\'}">support@hulahub.com</a></div></div></section></div></div>'),$templateCache.put("users/views/forgotten-password.html",'<div class="row extraLargeMarginTop"><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><section class="white-bg bordered"><h1 ng-show="!checkEmail" class="sectionHeaderAlt" ng-class="{\'profile\': registrationType != \'host\', \'activities\': registrationType == \'host\'}">Forgotten password</h1><h1 ng-show="checkEmail" class="sectionHeaderAlt" ng-class="{\'profile\': registrationType != \'host\', \'activities\': registrationType == \'host\'}">Reset link sent</h1><div class="sectionContent"><div ng-show="checkEmail" class="text-center"><p>You will receive a reset password link within a few minutes if the email address provided is registered with HulaHub.</p><p class="no-margins"><a ng-click="send(true)" class="underlinedLink" ng-class="{\'profileColour\': registrationType != \'host\', \'activityColour\': registrationType == \'host\'}">Click here</a> to re-send - please check your spam folder first.</p></div><form name="form" autocomplete="off" novalidate ng-show="!checkEmail"><fieldset><div class="form-group" ng-class="{\'has-error\': (validationRun && form.email.$invalid) || formErrors.email}"><label>Email address</label><input class="form-control email" ng-model="formData.email" placeholder="Enter your email address" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" autofocus required> <span class="help-block" ng-show="(validationRun && form.email.$invalid) || formErrors.email">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="clearfix"><a class="pull-left btn btn-red btn-outline" ui-sref="login"><i class="ico ico-chevron-left"></i> Back to log in</a> <button class="pull-right btn btn-green btn-outline" type="submit" ng-click="send()"><i class="ico ico-tick"></i> Request reset</button></div></fieldset></form></div></section></div></div>'),$templateCache.put("users/views/login.html",'<div class="row"><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><div class="alert alert-success" ng-show="pageLoadAlertMessage" compile="pageLoadAlertMessage"></div><section class="white-bg bordered"><h1 class="sectionHeaderAlt" ng-class="{\'profile\': formData.registrationType != \'host\', \'activities\': formData.registrationType == \'host\'}">Log in<small>&nbsp;&nbsp;or&nbsp;&nbsp;<a ui-sref="hostSignup" class="underlinedLink" ng-if="formData.registrationType == \'host\'">Sign up</a><a ui-sref="register" class="underlinedLink" ng-if="formData.registrationType != \'host\'">Sign up</a></small></h1><div class="sectionContent"><div class="marginBottom" ng-show="formData.registrationType != \'host\'">Welcome back! Log in regularly to discover new and exciting things to do, see what\'s going on in your area and catch up on your messages.</div><div class="marginBottom" ng-show="formData.registrationType == \'host\'">Welcome back! Log in regularly to see your messages, read your reviews, see who\'s joined your activites and keep your contact details up to date.</div><div class="row"><div class="col-xs-12 col-sm-10 col-sm-offset-1"><form name="form" autocomplete="off" novalidate><fieldset><div class="alert alert-danger" ng-show="loginError">{{ loginError }}</div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.email.$invalid) || formErrors.email}"><label>Email address</label><input tabindex="1" class="form-control email" ng-model="formData.email" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required> <span class="help-block" ng-show="form.email.$valid && formErrors.email == \'locked\'">This account is closed. <span ng-hide="resent"><a ng-click="resend()" class="wallet underlinedLink">Click here</a> to send re-activation email.</span><span ng-show="resent">Re-activation email has been sent.</span></span> <span class="help-block" ng-show="(validationRun && form.email.$invalid) || (formErrors.email && formErrors.email != \'locked\')">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.password.$invalid)}"><label class="pull-right notBold"><a ng-class="{\'profile\': formData.registrationType != \'host\', \'activities\': formData.registrationType == \'host\'}" ui-sref="resetPassword" tabindex="4">Forgot password?</a></label><label>Password</label><input tabindex="2" class="form-control" ng-model="formData.password" type="password" name="password" required> <span class="help-block" ng-show="(validationRun && form.password.$invalid)">This is a required field</span></div><button class="btn btn-block" ng-class="{\'btn-profile\': formData.registrationType != \'host\', \'btn-activities\': formData.registrationType == \'host\'}" type="submit" ng-click="login()" tabindex="3"><i class="ico ico-power fixedSize"></i> Log in</button></fieldset><div class="text-center"><p class="textWithLine"><span>or</span></p><button class="btn btn-facebook btn-block" type="button" ng-click="facebookLogin()"><i class="ico ico-facebook"></i>Log in with Facebook</button></div></form></div></div></div><div class="sectionContent signupTestimonial text-center"><review-stars theme="contacts" value="5"></review-stars><em ng-show="formData.registrationType != \'host\'">"HulaHub helped me find a great mountaineering trip that I absolutely loved!"</em> <em ng-show="formData.registrationType == \'host\'">"HulaHub makes bookings and payments for my martial arts classes super simple and easy."</em></div><div class="row noGutter signupFeatures" ng-show="!closedAccount"><div class="col-xxs-12 col-xs-4 text-sm-center gutterMarginBottomXSOnly"><i class="ico ico-tick"></i>100% free to join</div><div class="col-xxs-12 col-xs-4 text-sm-center gutterMarginBottomXSOnly"><i class="ico ico-tick"></i>Quick and easy</div><div class="col-xxs-12 col-xs-4 text-sm-center" ng-show="formData.registrationType != \'host\'"><i class="ico ico-tick"></i>1000s of activities</div><div class="col-xxs-12 col-xs-4 text-sm-center" ng-show="formData.registrationType == \'host\'"><i class="ico ico-tick"></i>National coverage</div></div></section></div></div>'),$templateCache.put("users/views/masquerade.html",'<div class="row" ng-show="errorMessage"><div class="alert alert-danger">{{ errorMessage }}</div></div>'),$templateCache.put("users/views/reset-password.html",'<div class="row extraLargeMarginTop"><div class="row"><div class="alert alert-danger wallet" ng-show="tokenExpired">The reset token has expired. <a ui-sref="resetPassword">Click here to request a new one.</a></div></div><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><section class="wallet white-bg bordered"><h1 class="sectionHeaderAlt wallet">Set a new password</h1><div class="sectionContent"><form name="form" autocomplete="off" novalidate><fieldset><div class="form-group" ng-class="{\'has-error\': (validationRun && form.password.$invalid) || formErrors.password}"><label>New password</label><input class="form-control" ng-model="formData.password" name="password" placeholder="New password" type="password" required autofocus minlength="6"> <span class="help-block" ng-show="(validationRun && form.password.$error.required) || formErrors.password">{{ formErrors.password || \'This is a required field\' }}</span> <span class="help-block" ng-show="(validationRun && (form.password.$error.minlength))">Password must be at least six characters long</span></div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword}"><label>Confirm new password</label><input class="form-control" ng-model="formData.confirmPassword" name="confirmPassword" placeholder="Confirm new password" type="password" compare-to="formData.password" required> <span class="help-block" ng-show="(validationRun && form.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword">{{ formErrors.confirmPassword || \'The passwords do not match\' }}</span></div><div class="text-center"><button class="btn btn-wallet btn-outline" type="submit" ng-click="save()">Save password</button></div></fieldset></form></div></section></div></div>'),$templateCache.put("users/views/set-password.html",'<div class="row"><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><section class="wallet white-bg bordered"><div class="sectionContent"><p>To finish activating your account, you need to set a password</p><form name="form" autocomplete="off" novalidate><fieldset><div class="form-group" ng-class="{\'has-error\': (validationRun && form.password.$invalid) || formErrors.password}"><label>Password</label><input class="form-control" ng-model="formData.password" name="password" placeholder="New password" type="password" required autofocus minlength="6"> <span class="help-block" ng-show="(validationRun && form.password.$error.required) || formErrors.password">{{ formErrors.password || \'This is a required field\' }}</span> <span class="help-block" ng-show="(validationRun && (form.password.$error.minlength))">Password must be at least six characters long</span></div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword}"><label>Confirm password</label><input class="form-control" ng-model="formData.confirmPassword" name="confirmPassword" placeholder="Confirm new password" type="password" compare-to="formData.password" required> <span class="help-block" ng-show="(validationRun && form.confirmPassword.$error.compareTo == true) || formErrors.confirmPassword">{{ formErrors.confirmPassword || \'The passwords do not match\' }}</span></div><div class="text-center"><button class="btn btn-wallet btn-outline" type="submit" ng-click="save()">Save password</button></div></fieldset></form></div></section></div></div>'),$templateCache.put("users/views/signup.html",'<div class="row"><div class="noPadding col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"><div class="alert alert-success" ng-show="pageLoadAlertMessage" compile="pageLoadAlertMessage"></div><section class="white-bg bordered"><h1 class="sectionHeaderAlt" ng-class="{\'profile\': formData.registrationType != \'host\', \'activities\': formData.registrationType == \'host\'}">Sign up<small>&nbsp;&nbsp;or&nbsp;&nbsp;<a ui-sref="login" class="underlinedLink">Log in</a></small></h1><div class="sectionContent" ng-show="!closedAccount"><div class="marginBottom" ng-show="formData.registrationType != \'host\'">Join us to book activities and get access to exclusive offers and alerts. Plus inspiration, tips and ideas to fill your leisure life.</div><div class="marginBottom" ng-show="formData.registrationType == \'host\'">Join us to create unlimited activities, collect payments automatically and manage your bookings anytime, anywhere on any device!</div><div class="row"><div class="col-xs-12 col-sm-10 col-sm-offset-1"><form name="form" autocomplete="off" novalidate><fieldset><div class="form-group" ng-class="{\'has-error\': (validationRun && form.email.$invalid) || formErrors.email}"><label>Email address</label><input class="form-control email" ng-model="formData.email" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required> <span class="help-block" ng-show="(validationRun && form.email.$invalid) || formErrors.email">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="form-group" ng-class="{\'has-error\': (validationRun && form.password.$invalid) || formErrors.password}"><label>Choose a password</label><input autocomplete="new-password" class="form-control" ng-model="formData.password" type="password" name="password" required> <span class="help-block" ng-show="(validationRun && form.password.$invalid) || formErrors.password">{{ formErrors.password || \'This is a required field\' }}</span></div><button ng-show="formData.registrationType == \'host\'" class="btn btn-block btn-activities" type="submit" ng-click="register()"><i class="ico ico-arrow-right-circle fixedSize"></i> Start FREE 30-day trial</button> <button ng-show="formData.registrationType != \'host\'" class="btn btn-block btn-profile" type="submit" ng-click="register()"><i class="ico ico-arrow-right-circle fixedSize"></i> Sign up</button></fieldset><div class="text-center"><p class="textWithLine"><span>or</span></p><button type="button" class="btn btn-facebook btn-block" ng-click="facebookRegister()"><i class="ico ico-facebook"></i>Sign up with Facebook</button></div><div class="text-center gutterMarginTop small col-xs-12 noFloat">By clicking on the Sign up button, you agree to our <a href="{{ env.public }}/terms" target="_blank" class="underlineOnHover" ng-class="{\'profile\': formData.registrationType != \'host\', \'activities\': formData.registrationType == \'host\'}">Terms of use</a></div></form></div></div></div><div class="sectionContent signupTestimonial text-center" ng-show="!closedAccount"><review-stars theme="contacts" value="5"></review-stars><em ng-show="formData.registrationType != \'host\'">"HulaHub helped me find a great mountaineering trip that I absolutely loved!"</em> <em ng-show="formData.registrationType == \'host\'">"HulaHub makes bookings and payments for my martial arts classes super simple and easy."</em></div><div class="row noGutter signupFeatures" ng-show="!closedAccount"><div class="col-xxs-12 col-xs-4 text-sm-center gutterMarginBottomXSOnly"><i class="ico ico-tick"></i>100% free to join</div><div class="col-xxs-12 col-xs-4 text-sm-center gutterMarginBottomXSOnly"><i class="ico ico-tick"></i>Quick and easy</div><div class="col-xxs-12 col-xs-4 text-sm-center" ng-show="formData.registrationType != \'host\'"><i class="ico ico-tick"></i>1000s of activities</div><div class="col-xxs-12 col-xs-4 text-sm-center" ng-show="formData.registrationType == \'host\'"><i class="ico ico-tick"></i>National coverage</div></div><div class="sectionContent" ng-show="closedAccount"><h3 class="walletColour gutterMarginBottom half">Account closed</h3><p class="no-margins">This account is closed. <a class="underlinedLink wallet" ng-click="resend()">Click here</a> to send re-activation email.</p><div class="alert alert-success white marginTop" ng-show="resent">Activation email has been re-sent</div><h3 class="marginTop walletColour gutterMarginBottom half">Not receiving emails?</h3><p class="no-margins">Please add \'noreply@hulahub.com\' to your address list as this will unblock your spam filter.</p></div></section></div></div>'),$templateCache.put("core/layouts/default.html",'<div ng-if="auth.isLoggedIn" ng-include="\'core/partials/header.html\'"></div><div ng-if="!auth.isLoggedIn" ng-include="\'core/partials/header-no-navigation.html\'"></div><div ng-include="\'core/partials/navigation.html\'"></div><div id="page-wrapper" class="pageWrapper" ng-class="{\'loggedIn\': auth.isLoggedIn}"><div id="main" class="container animated fadeIn"><div ui-view name="content"></div></div></div><div ng-include="\'core/partials/footer.html\'"></div>'),$templateCache.put("core/layouts/no-navigation.html",'<div ng-include="\'core/partials/header-no-navigation.html\'"></div><div id="page-wrapper" class="pageWrapper"><div id="main" class="container animated fadeIn"><div ui-view name="content"></div></div></div><div ng-include="\'core/partials/footer.html\'"></div>'),$templateCache.put("core/partials/autocomplete-contact-and-group.html",'<span ng-show="data.noResults">No contacts or groups found</span><div ng-show="!data.noResults" class="vAlignParent"><div class="vAlign autocompleteIcon"><i ng-show="data.isGroup" class="ico ico-group"></i> <span ng-show="!data.isGroup" class="circlePhoto sml" ng-class="{\'noPhoto\': !data.avatarURL}" style="background-image:url(\'{{data.avatarURL}}\')"></span></div><div class="vAlign"><span ng-bind-html="$highlight($getDisplayText())"></span></div></div>'),$templateCache.put("core/partials/contact-hulahub-form.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()" ng-hide="sending"><span>&times;</span></a><h1 class="modal-title">Contact us</h1></div><div class="modal-body noPaddingBottom"><form class="text-left" name="contactForm" autocomplete="off" novalidate><fieldset class="row halfGutter"><div class="form-group col-xs-12"><label>Subject</label><input class="form-control" type="text" required ng-model="formData.subject" name="subjecy"></div></fieldset><fieldset class="row halfGutter"><div class="form-group col-xs-12"><label>Message</label><textarea class="form-control" ng-model="formData.message" name="message" rows="6" required></textarea></div></fieldset></form></div><div class="modal-footer"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn pull-right" type="submit" ng-class="{\'btn-green\': contactForm.$valid, \'btn-disabled\': contactForm.$invalid}" ng-disabled="contactForm.$invalid" ng-click="send()"><i class="ico ico-tick"></i>Send</button></div>'),$templateCache.put("core/partials/enterprise-contact-form.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()" ng-hide="sending"><span>&times;</span></a><h1 class="modal-title">Contact us</h1></div><div class="modal-body noPaddingBottom"><div ng-show="sending" class="text-center"><div class="loadingSpinner wink"></div></div><div class="alert alert-success" ng-show="successMessage" style="padding:10px">{{ successMessage }}</div><form ng-hide="sending || successMessage" class="text-left" name="contactForm" autocomplete="off" novalidate><fieldset class="row halfGutter"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': validationRun && contactForm.firstName.$invalid}"><label>First name</label><input class="form-control" type="text" required ng-model="formData.firstName" name="firstName"> <span class="help-block" ng-show="validationRun && contactForm.firstName.$invalid">This is a required field</span></div><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': validationRun && contactForm.lastName.$invalid}"><label>Last name</label><input class="form-control" type="text" required ng-model="formData.lastName" name="lastName"> <span class="help-block" ng-show="validationRun && contactForm.lastName.$invalid">This is a required field</span></div></fieldset><fieldset class="row halfGutter"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': (validationRun && contactForm.phoneNumber.$invalid) || (formErrors && formErrors.phoneNumber)}"><label>Phone number</label><telephone-number-input input-value="formData.phoneNumber" input-name="phoneNumber" required="true"></telephone-number-input><div ng-messages="contactForm.phoneNumber.$error" ng-if="validationRun && !formErrors"><div ng-message="required"><span class="help-block">This is a required field</span></div><div ng-message="minlength"><span class="help-block">This is not a valid phone number</span></div></div><span class="help-block" ng-show="formErrors && formErrors.phoneNumber">This is not a valid phone number</span></div><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': (validationRun && (contactForm.email.$error.required || contactForm.email.$error.pattern)) || (formErrors && formErrors.email) }"><label>Email address</label><input class="form-control email" type="email" ng-model="formData.email" name="email" required="true" ng-pattern="/^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$/"><div ng-messages="contactForm.email.$error" ng-if="validationRun"><div ng-message="required"><span class="help-block">This is a required field</span></div><div ng-message="pattern"><span class="help-block">This is not a valid email address</span></div></div><span class="help-block" ng-show="formErrors && formErrors.email">This is not a valid email address</span></div></fieldset><fieldset class="row halfGutter"><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': validationRun && contactForm.businessName.$invalid}"><label>Business name</label><input class="form-control" type="text" required ng-model="formData.businessName" name="businessName"> <span class="help-block" ng-show="validationRun && contactForm.businessName.$invalid">This is a required field</span></div><div class="form-group col-xs-12 col-sm-6" ng-class="{\'has-error\': validationRun && contactForm.businessRegNumber.$invalid}"><label>Company registration number</label><input class="form-control" type="text" required ng-model="formData.businessRegNumber" name="businessRegNumber"> <span class="help-block" ng-show="validationRun && contactForm.businessRegNumber.$invalid">This is a required field</span></div></fieldset><fieldset class="row halfGutter"><div class="form-group col-xs-12 col-sm-6"><label>Business website (optional)</label><input class="form-control" type="text" ng-model="formData.website" name="website"></div><div class="form-group col-xs-12 col-sm-6"><label>Number of employees (optional)</label><select class="form-control" ng-model="formData.employeeCount"><option value="" disabled="disabled">Please select...</option><option>1-5</option><option>6-10</option><option>11-20</option><option>21-50</option><option>51-100</option><option>100+</option></select></div></fieldset><fieldset class="row halfGutter"><div class="form-group col-xs-12"><label>Message (optional)</label><textarea class="form-control" ng-model="formData.message" name="message" rows="6"></textarea></div></fieldset></form></div><div class="modal-footer" ng-hide="sending || successMessage"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="send()"><i class="ico ico-tick"></i>Send</button></div><div class="modal-footer" ng-show="successMessage"><button class="btn btn-green btn-outline pull-right" type="button" ng-click="$dismiss()"><i class="ico ico-tick"></i> OK</button></div>'),$templateCache.put("core/partials/footer.html",'<div class="footer vAlignParent" ng-class="{\'hidden-xs\': auth.isLoggedIn}"><div class="vAlign">HulaHub&nbsp;&copy;&nbsp;<footer-date></footer-date></div><div class="vAlign clearfix"><div class="vAlignParent pull-right"><span class="vAlign hidden-xs"><a href="{{ env.public }}/about-us" target="|_blank">About us</a><a href="{{ env.knowledgehub }}" target="_blank">Knowledge hub</a><a href="{{ env.public }}/terms" target="|_blank">Terms</a></span><ul class="socialLinks vAlign"><li><a class="facebook ico ico-facebook" href="https://www.facebook.com/HulaHubHQ" target="_blank"></a></li><li><a class="twitter ico ico-twitter" href="https://twitter.com/HulaHubHQ" target="_blank"></a></li><li><a class="linkedin ico ico-linkedin" href="https://www.linkedin.com/company/hulahub" target="_blank"></a></li></ul></div></div></div>'),
$templateCache.put("core/partials/header-no-navigation.html",'<div ng-controller="HeaderController"><nav class="navbar navbar-fixed-top headerRow"><div class="container-fluid"><div class="vAlignParent full-width"><div class="vAlign"><a ng-click="logoClicked()" class="logo"><img src="/img/hh_logo.svg"></a><span class="strapline hidden-xs" ng-show="registrationType == \'joiner\'">your leisure-life!</span><span class="strapline hidden-xs" ng-show="registrationType == \'host\'">your business!</span></div><div ng-show="auth.isLoggedIn && auth.currentUser.missingProfileData" class="vAlign text-right accountNav"><a ui-sref="logout"><span ng-if="!auth.isMasquerading()">Log out</span><span ng-if="auth.isMasquerading()">Exit masquerade</span></a></div><div ng-show="!auth.isLoggedIn" class="vAlign text-right accountNav"><div ng-show="($state.current.name == \'register\' || $state.current.name == \'hostSignup\')">Already have an account? <a ui-sref="login" class="underlineOnHover" ng-class="{\'profile\': registrationType == \'joiner\', \'activities\': registrationType == \'host\'}">Log in</a></div><div ng-show="$state.current.name == \'login\'">Don\'t have an account? <a ui-sref="register" class="underlineOnHover profile" ng-show="registrationType != \'host\'">Sign up</a><a ui-sref="hostSignup" class="underlineOnHover activities" ng-show="registrationType == \'host\'">Sign up</a></div></div></div></div></nav><div class="breadcrumbRow" ng-class="{\'forceActivityColour\': $state.current.name == \'register.completeProfile\' && registrationType == \'host\'}" style="padding-left:0"><div class="container clearfix" ng-class="{\'noTitle\' : !title}"><div class="h3 pull-left">{{ title }}</div></div></div></div>'),$templateCache.put("core/partials/header.html",'<div ng-controller="HeaderController"><nav class="navbar navbar-fixed-top headerRow"><div class="container-fluid"><div class="row noGutter"><div class="col-xs-4 col-md-2"><a ng-click="logoClicked()" class="logo"><img src="/img/hh_logo.svg"></a></div><div class="col-xs-8 visible-xs clearfix accountNav"><div class="vAlignParent pull-right"><div class="vAlign"><profile-photo id="showOffCanvasNav"></profile-photo></div></div></div><div class="hidden-xs col-sm-8 col-md-10 clearfix accountNav"><div class="vAlignParent pull-right"><ul class="mainNav vAlign hidden-xs"><li class="activitiesLine" ng-class="{\'active\': $state.includes(\'activities.find\') || $state.current.name == \'activities.view.info\'}"><a ui-sref="activities.find"><i class="ico ico-search fixedSize"></i>Find activities</a></li><li ng-show="auth.currentUser.registrationType == \'host\'" class="activitiesLine" ng-class="{\'active\': $state.includes(\'dashboard\')}"><a ui-sref="dashboard"><i class="ico ico-settings fixedSize"></i>Dashboard</a></li><li class="messagesLine" ng-class="{\'active\': $state.includes(\'messages\')}"><a ui-sref="messages.inbox"><span ng-class="{\'withAlertItem\': unreadMessageCount}"><i class="ico ico-message fixedSize"></i>Messages<span class="alertItem" ng-show="unreadMessageCount"></span></span></a></li><li class="infoLine"><a href="{{ env.knowledgehub }}" target="_blank"><i class="ico ico-question fixedSize"></i>Help</a></li></ul><div class="vAlign"><div class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown"><profile-photo></profile-photo></a><ul class="dropdown-menu dropdown-menu-right"><li><a ui-sref="activities.find">Find activities</a></li><li><a ui-sref="activities.joined">Joined activities</a></li><li class="divider no-margins"></li><li><a ui-sref="activities.hosted">Hosted activities</a></li><li><a ui-sref="activities.new">Create an activity</a></li><li class="divider no-margins"></li><li><a ui-sref="profile">Profile</a></li><li ng-show="auth.currentUser.registrationType == \'host\'"><a ui-sref="profile({\'#\': \'specialisms\'})">Specialisms</a></li><li ng-show="auth.currentUser.registrationType != \'host\'"><a ui-sref="profile({\'#\': \'interests\'})">Interests</a></li><li><a ui-sref="contacts">Contacts</a></li><li class="divider no-margins"></li><li><a ui-sref="billing">Billing &amp; transactions</a></li><li><a ui-sref="settings">Settings</a></li><li ng-show="auth.currentUser.subscriptionPlan !== \'FREE\'"><a ng-click="goToBenefits()">My benefits</a></li><li class="divider no-margins"></li><li><a ui-sref="logout"><span ng-if="!auth.isMasquerading()">Log out</span><span ng-if="auth.isMasquerading()">Exit masquerade</span></a></li></ul></div></div></div></div></div></div></nav><div class="breadcrumbRow"><div class="container clearfix"><div class="h3 text-xs-center pull-left-sm pull-left-md pull-left-lg">{{ title }}</div><ul class="pull-right no-margins list-inline list-unstyled" ng-show="subNav" ng-class="{\'hidden-xs\': $state.current.data.hideMobileTabBar}"><li class="tabs4" ng-show="subNav == \'billing\'"><a ui-sref="billing.transactions" ui-sref-active="active"><i class="ico ico-coins"></i>Transactions</a></li><li class="tabs4" ng-show="subNav == \'billing\'"><a ui-sref="billing.subscriptionPlans" ui-sref-active="active"><i class="ico ico-wallet"></i>Subscription</a></li><li class="tabs4" ng-show="subNav == \'billing\'"><a ui-sref="billing.settings" ui-sref-active="active"><i class="ico ico-payment-card"></i><span class="hidden-xs">Payment settings</span><span class="visible-xs">Payment</span></a></li><li class="tabs4" ng-show="subNav == \'billing\'"><a ui-sref="billing.resolutionCentre" ui-sref-active="active"><i class="ico ico-hq"></i><span class="hidden-xs">Resolution centre</span><span class="visible-xs">Resolution</span></a></li><li class="tabs3" ng-show="subNav == \'find-activities\'"><a ui-sref="activities.find.inspire" ui-sref-active="active"><i class="ico ico-clover"></i>Inspire me</a></li><li class="tabs3" ng-show="subNav == \'find-activities\'"><a ui-sref="activities.find.matches" ui-sref-active="active"><i class="ico ico-super-man"></i>My matches</a></li><li class="tabs3" ng-show="subNav == \'find-activities\'"><a ui-sref="activities.find.browse" ng-class="{\'active\': $state.current.name == \'activities.find.browse\' || $state.current.name == \'activities.view.info\' || $state.current.name == \'activities.viewExternal\'}"><i class="ico ico-search"></i><span class="hidden-xs">Browse all activities</span><span class="visible-xs">Browse all</span></a></li><li class="tabs2" ng-show="subNav == \'hosted-activities\'"><a ui-sref="activities.hosted" ui-sref-active="active" ng-class="{\'subNavHighlight\': subNavHighlight == \'hosted\'}"><i class="ico ico-super-man"></i>Hosted<span class="hidden-xs"> activities</span></a></li><li class="tabs2" ng-show="subNav == \'hosted-activities\'"><a ui-sref="offers" ui-sref-active="active"><i class="ico ico-offer-tag"></i>Offers</a></li><li class="tabs2" ng-show="subNav == \'invite-contacts\'"><a ui-sref="contacts.invites.send" ui-sref-active="active"><i class="ico ico-message-draft"></i>Invite contacts</a></li><li class="tabs2" ng-show="subNav == \'invite-contacts\'"><a ui-sref="contacts.invites.sent" ui-sref-active="active"><i class="ico ico-message-fly"></i>Invites sent</a></li><li class="tabs3" ng-show="subNav == \'contacts\'"><a ui-sref="contacts" ng-class="{\'active\': $state.current.name == \'contacts.mine\' || ($state.current.name == \'contacts.public\' && $previousState.name == \'contacts.mine\')}"><i class="ico ico-people"></i>My contacts</a></li><li class="tabs3 hidden-xs" ng-show="subNav == \'contacts\'"><a ui-sref="contacts.groups" ui-sref-active="active"><i class="ico ico-group"></i>Groups</a></li><li class="tabs3 visible-xs" ng-show="subNav == \'contacts\'"><a ui-sref="contacts.groups.manage" ui-sref-active="active"><i class="ico ico-group"></i>Manage Groups</a></li><li class="tabs3" ng-show="subNav == \'contacts\'"><a ui-sref="contacts.find" ng-class="{\'active\': $state.current.name == \'contacts.find\' || ($state.current.name == \'contacts.public\' && $previousState.name == \'contacts.find\')}"><i class="ico ico-search"></i>Find contacts</a></li><li class="tabs3" ng-show="subNav == \'messages\'"><a ui-sref="messages.inbox" ui-sref-active="active"><i class="ico ico-envelopes"></i>Inbox</a></li><li class="tabs3" ng-show="subNav == \'messages\'"><a ui-sref="messages.sent" ui-sref-active="active"><i class="ico ico-message-fly"></i>Sent</a></li><li class="tabs3" ng-show="subNav == \'messages\'"><a ui-sref="messages.trash" ui-sref-active="active"><i class="ico ico-trash"></i>Trash</a></li><li class="tabs2" ng-show="subNav == \'settings\'"><a ui-sref="settings.account" ui-sref-active="active"><i class="ico ico-cog"></i>Account settings</a></li><li class="tabs2" ng-show="subNav == \'settings\'"><a ui-sref="settings.messages" ui-sref-active="active"><i class="ico ico-message"></i>Message settings</a></li></ul></div></div></div>'),$templateCache.put("core/partials/navigation.html",'<nav class="navmenu-default navmenu-fixed-right offCanvasNav visible-xs visible-sm" ng-controller="NavigationController" ng-show="auth.isLoggedIn"><ul class="list-unstyled"><li ng-show="auth.currentUser.registrationType == \'host\'"><a ui-sref="dashboard">Dashboard</a></li><li ng-show="auth.currentUser.registrationType == \'host\'" class="divider no-margins"></li><li><a ui-sref="activities.find">Find activities</a></li><li><a ui-sref="activities.joined">Joined activities</a></li><li class="divider no-margins"></li><li><a ui-sref="activities.hosted">Hosted activities</a></li><li><a ui-sref="activities.new">Create an activity</a></li><li class="divider no-margins"></li><li><a ui-sref="profile">Profile</a></li><li ng-show="auth.currentUser.registrationType == \'host\'"><a ui-sref="profile({\'#\': \'specialisms\'})">Specialisms</a></li><li ng-show="auth.currentUser.registrationType != \'host\'"><a ui-sref="profile({\'#\': \'interests\'})">Interests</a></li><li><a ui-sref="contacts">Contacts</a></li><li><a ui-sref="messages">Messages<span class="alertItem" ng-show="unreadMessageCount"></span></a></li><li class="divider no-margins"></li><li><a ui-sref="billing">Billing &amp; transactions</a></li><li><a ui-sref="settings">Settings</a></li><li ng-show="auth.currentUser.subscriptionPlan !== \'FREE\'"><a ng-click="goToBenefits()">My benefits</a></li><li class="divider no-margins"></li><li><a href="{{ env.knowledgehub }}" target="_blank">Help</a></li><li class="divider no-margins"></li><li><a ui-sref="logout"><span ng-if="!auth.isMasquerading()">Log out</span><span ng-if="auth.isMasquerading()">Exit masquerade</span></a></li></ul></nav>'),$templateCache.put("core/partials/photo-upload-modal.html",'<div class="modal-header"><a class="close" ng-show="!loading" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">{{ title }}</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner wink"></div></div><div ng-show="!loading" class="{{ cropPreviewClass }}"><div class="alert alert-danger" ng-show="uploadError">{{ uploadError }}</div><div ng-show="!selectedImage" class="text-center noImageUploaded"><a class="btn btn-{{ theme }} btn-outline" ngf-select ng-model="selectedImage" ngf-pattern="\'image/jpg,image/jpeg,image/png\'" ngf-accept="\'image/jpg,image/jpeg,image/png\'" ngf-change="change($files, $file)"><i class="ico ico-picture-plus"></i>Upload a photo</a></div><div ng-show="selectedImage" class="imageUploadPreview"><img class="imageCropping" ngf-src="selectedImage"> <a class="btn btn-red" ng-click="clearPicture()" ng-class="{\'hideWords\': !deleteConfirm}"><i class="ico ico-trash"></i><span>Delete</span></a></div><div ng-show="selectedImage" class="imageUploadToolbar gutterMarginTop text-center"><div class="toolbarRow gutterMarginBottom"><div class="btn-group"><a class="btn btn-{{ theme }}" ng-click="zoom(0.1)" uib-tooltip="Zoom in"><i class="fas fa-search-plus fa-fw"></i></a> <a class="btn btn-{{ theme }}" ng-click="zoom(-0.1)" uib-tooltip="Zoom out"><i class="fas fa-search-minus fa-fw"></i></a></div><div class="btn-group"><a class="btn btn-{{ theme }}" ng-click="rotate(-45)" uib-tooltip="Rotate left"><i class="fas fa-undo-alt fa-fw"></i></a> <a class="btn btn-{{ theme }}" ng-click="rotate(45)" uib-tooltip="Rotate right"><i class="fas fa-redo-alt fa-fw"></i></a></div></div><div class="toolbarRow"><div class="btn-group"><a class="btn btn-{{ theme }}" ng-click="flipX()" uib-tooltip="Flip horizontally"><i class="fas fa-arrows-alt-h fa-fw"></i></a> <a class="btn btn-{{ theme }}" ng-click="flipY()" uib-tooltip="Flip vertically"><i class="fas fa-arrows-alt-v fa-fw"></i></a></div><div class="btn-group"><a class="btn btn-{{ theme }}" ng-click="reset()" uib-tooltip="Reset"><i class="fas fa-sync-alt fa-fw"></i></a></div></div></div></div></div><div class="modal-footer" ng-show="!loading"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i> Cancel</button> <button class="btn btn-green btn-outline pull-right" type="submit" ng-click="save()"><i class="ico ico-tick"></i>Save</button></div>'),$templateCache.put("core/partials/section-header.html",'<header class="sectionHeader {{ type }}" ng-class="{\'draggable\' : draggable, \'xsPaddingForButton\': xsPadding}"><div ng-if="link"><div class="h3"><a ui-sref="{{ link }}">{{ text }}</a></div></div><div ng-if="!link"><div class="h3">{{ text }}</div></div><div class="info vAlignParent"><div class="vAlign"><ng-transclude></ng-transclude></div></div></header>'),$templateCache.put("core/partials/share-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">{{ title }}</h1></div><div class="modal-body modalList"><div><i class="ico ico-facebook"></i><a ng-click="shareFacebook()" class="profile underlineOnHover">Facebook</a></div><div class="divider marginTop marginBottom"></div><div><i class="ico ico-twitter"></i><a ng-click="sendIntercomShareEvent(\'twitter\')" ng-href="https://twitter.com/intent/tweet?text={{twitterText|encodeURI}}&url={{url|encodeURI}}&related=HulaHubHQ" class="profile underlineOnHover">Twitter</a></div><div class="divider marginTop marginBottom"></div><div><i class="ico ico-message"></i><a ng-click="sendIntercomShareEvent(\'email\')" href="mailto:?subject={{emailSubject}}&body={{emailBody|encodeURI}}" class="profile underlineOnHover">Email</a></div><div class="divider marginTop marginBottom"></div><div><i class="ico ico-documents"></i><a ngclipboard data-clipboard-text="{{url}}" ngclipboard-success="onClipboardSuccess(e)" class="profile underlineOnHover"><span ng-if="linkCopiedToClipboard">Link copied</span><span ng-if="!linkCopiedToClipboard">Copy link</span></a></div></div>'),$templateCache.put("core/partials/time-picker.html",'<table class="uib-timepicker"><tbody><tr><td class="form-group uib-time hours"><select class="form-control" ng-model="value.hour" ng-options="h.id as h.value for h in hours" ng-change="onChange()"></select></td><td class="uib-separator">:</td><td class="form-group uib-time minutes"><select class="form-control" ng-model="value.minute" ng-options="m.id as m.value for m in minutes" ng-change="onChange()"></select></td></tr></tbody></table>'),$templateCache.put("activities/views/offers/form.html",'<section class="row white-bg"><section-header text="{{ newOffer ? \'Add discounts for multiple bookings\' : \'Edit offer\' }}" type="activities"></section-header><form name="form" novalidate><div class="sectionContent withOffsetBorder"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading" class="row"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>Choose type of offer</label><div class="row noGutter"><div class="col-xs-12 col-md-6"><div class="clearfix radioButton activities inCols" ng-class="{\'active\' : formData.type == 0}" ng-click="formData.type=0"><div class="pull-left radio"></div><label class="pull-left">Percentage discount</label></div></div><div class="col-xs-12 col-md-6"><div class="clearfix radioButton activities" ng-class="{\'active\' : formData.type == 1}" ng-click="formData.type=1"><div class="pull-left radio"></div><label class="pull-left">Cash discount</label></div></div></div></div><div class="form-group" ng-class="{ \'has-error\' : validationRun && !formData.threshold}"><label>Enter minimum number of bookings to get the offer</label><input class="form-control" ng-model="formData.threshold" number-only-input type="text" required> <span class="help-block" ng-show="validationRun && !formData.threshold">This is a required field</span></div><div class="form-group" ng-class="{ \'has-error\' : form.amount.$error.max || (validationRun && !formData.amount.model) }"><label>Enter discount to be applied</label><input class="form-control" name="amount" ng-model="formData.amount.model" number-only-input type="number" ng-min="0.01" ng-max="formData.type == 0 ? 100 : null" required> <span class="help-block" ng-show="form.amount.$error.max">This cannot be larger than 100%</span> <span class="help-block" ng-show="!form.amount.$error.max && validationRun && !formData.amount.model">An amount is required</span></div></div><div class="col-xs-12 col-sm-5 col-sm-offset-1"><div class="form-group no-margins"><label>Offer preview</label></div><div class="joinOfferPanel sectionContent noPaddingBottom marginBottom" style="border: 1px solid #d1d3d4"><h3 class="infoColour"><i class="ico ico-offer-tag"></i> Offer</h3><div class="gutterPaddingTop gutterPaddingBottom"><strong>Book {{ formData.threshold||0 }}</strong> spots or more<br><strong ng-show="formData.type == 0" class="infoColour">and get {{ formData.amount.model||0 }}% off</strong> <strong ng-show="formData.type == 1" class="infoColour">and get {{ (formData.amount.value()||0) | currencyDisplay:\'GBP\':true:false }} off</strong></div></div></div></div><div ng-show="!loading" class="clearfix formActions"><a class="btn btn-red btn-outline" ng-click="cancel()"><i class="ico ico-cross"></i>Cancel</a> <a class="btn btn-green pull-right btn-outline" ng-click="save()"><i class="ico ico-tick"></i>Save</a></div></div></form></section>'),$templateCache.put("activities/views/offers/list.html",'<section class="row"><section-header text="Offers" type="activities"><a class="btn btn-outline btn-activities" ui-sref="offers.add"><i class="ico ico-plus"></i> Add an offer</a></section-header><div class="sectionContent white-bg withOffsetBorder">Any activity offers will automatically be added to all qualifying activities you host. Any edits to existing offers or adding new offers will not affect users that have already joined an activity.</div><div class="white-bg gutterMarginTop"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!loading && !offers.length" class="sectionContent text-center"><h3 class="marginBottom">You haven\'t created any offers yet</h3><a class="btn btn-outline btn-activities" ui-sref="offers.add">Add an offer</a></div><ul ng-show="!loading && offers.length" class="list-unstyled no-margins offerList"><li ng-repeat="offer in offers" class="tabularContentRow vAlignParent full-width"><h3 ng-if="offer.type == 0" class="vAlign"><strong>Book {{ ::offer.threshold }}</strong> spots or more <strong>and get {{ ::offer.amount/100 }}% off</strong></h3><h3 ng-if="offer.type == 1" class="vAlign"><strong>Book {{ ::offer.threshold }}</strong> spots or more <strong>and get {{ ::offer.amount | currencyDisplay:\'GBP\':true:false }} off</strong></h3><span class="vAlign text-right"><a ui-sref="offers.edit({\'offerId\': offer.id})" class="circleButton activities" uib-tooltip="Edit offer"><i class="ico ico-edit"></i></a> <a ng-click="delete(offer, $event)" class="circleButton red" uib-tooltip="Delete offer"><i class="ico ico-trash"></i></a></span></li></ul></div></section>'),$templateCache.put("activities/views/partials/activity-calendar.html",'<section class="row"><div class="activityCalendar col-xs-12 white-bg"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="row calendarHeader" ng-show="!loading"><div class="vAlignParent full-width"><div class="col-xs-3 noPadding vAlign"><a ng-click="changeMonth(\'previous\')" class="underlineOnHover"><i class="ico ico-chevron-left prev"></i><span class="hidden-xs">Previous</span></a></div><div class="col-xs-6 vAlign text-center"><a ng-click="showCurrentMonth()" class="underlineOnHover">{{ calendarTitle }}</a></div><div class="col-xs-3 noPadding vAlign text-right"><a ng-click="changeMonth(\'next\')" class="underlineOnHover"><span class="hidden-xs">Next</span><i class="ico ico-chevron-right next"></i></a></div></div></div><div class="row halfGutter calendar gutterMarginTop" ng-show="!loading"><div class="names clearfix"><div class="col-md-6 col-lg-4 noPadding"><div class="week"><div class="name">Mon</div><div class="name">Tue</div><div class="name">Wed</div><div class="name">Thu</div><div class="name">Fri</div><div class="name profileColour">Sat</div><div class="name profileColour">Sun</div></div></div><div class="col-md-6 col-lg-4 hidden-sm hidden-xs noPadding"><div class="week"><div class="name">Mon</div><div class="name">Tue</div><div class="name">Wed</div><div class="name">Thu</div><div class="name">Fri</div><div class="name profileColour">Sat</div><div class="name profileColour">Sun</div></div></div><div class="col-lg-4 hidden-md hidden-sm hidden-xs noPadding"><div class="week"><div class="name">Mon</div><div class="name">Tue</div><div class="name">Wed</div><div class="name">Thu</div><div class="name">Fri</div><div class="name profileColour">Sat</div><div class="name profileColour">Sun</div></div></div></div><div class="dates clearfix"><div class="col-md-6 col-lg-4 noPadding" ng-repeat="week in weeks"><div class="week"><div ng-repeat="day in week" class="date" ng-class="{\'today\': day.today, \'greyed\': !day.currentMonth, \'hasActivity\': hasActivities(day), \'selected\': day.selected }" ng-click="selectDate(day)"><span>{{ ::day.day }}</span></div></div></div></div></div><div class="row calendarFooter marginTop" ng-show="!loading"><a ng-click="changeMonth(\'current\')" class="activities underlineOnHover">Current month</a></div></div></section>'),$templateCache.put("activities/views/partials/activity-card.html",'<section class="col-xs-12 col-sm-6 col-md-4"><div class="activityCard" ng-click="viewActivity(activity)"><div class="img" style="background-image: url(\'{{ activity.bannerImage }}\')"><h5 class="abs topLeft label contacts text-uppercase notBold dropShadow small" ng-if="activity.featured">Featured</h5><span class="abs bottomRight label transparent" ng-if="activity.budget.perPerson == null">TBC</span> <span class="abs bottomRight label transparent" ng-if="activity.budget.perPerson != null">{{ activity.budget.perPerson | currencyDisplay:activity.budget.currency }}</span></div><div class="sectionContent halfPadding white-bg"><div class="details"><h3 class="smallMargin">{{ activity.title }}</h3><div class="mutedText">in {{ activity.startLocation }}<span ng-if="activity.distance >= 1"> ({{ activity.distance|number }} mi)</span></div><div class="hostRating" ng-show="activity.host.rating > 0"><review-stars theme="contacts" value="activity.host.rating"></review-stars></div></div><div class="dateCalendar text-center"><div class="top text-uppercase" ng-show="activity.flexible">Date</div><div class="bottom" ng-show="activity.flexible">Flexi</div><div class="top text-uppercase" ng-show="!activity.flexible">{{ activity.startDate | dateFormat:\'MMM\' }}</div><div class="bottom" ng-show="!activity.flexible">{{ activity.startDate | dateFormat:\'DD\' }}</div></div></div></div></section>'),$templateCache.put("activities/views/partials/activity-list.html",'<div><div class="heading h3 vAlignParent full-width {{ theme }}"><div class="vAlign text-left"><a class="collapseButton" ng-click="hideList = !hideList"><i class="ico" ng-class="{\'ico-chevron-down\': hideList, \'ico-chevron-up\': !hideList}"></i></a></div><div class="vAlign text-center">{{ title }}</div><div class="vAlign text-right"></div></div><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div ng-show="!hideList && !loading" class="list-{{ theme }}"><div class="text-center gutterMarginTop half mutedText" ng-show="!activities.length">{{ emptyText }}</div><div ng-show="activities.length"><div ng-repeat="activity in activities" class="activity activity-{{ activity.id }}" ng-class="{\'selected\': selectedActivity.id == activity.id }" ng-click="selectActivity(activity)" ng-show="!hiddenStatus || selectedActivity.id == activity.id || (activity.status !== hiddenStatus || showHidden)"><div class="vAlignParent full-width"><div class="vAlign col-xxs-4 col-xs-3 noPadding" ng-if="!activity.days"><span class="date">{{ activity.startDate | dateFormat:\'ddd D MMM\' }}</span> <span ng-switch="isSingleDayEvent(activity)"><span ng-switch-when="true">{{ activity.startDate | dateFormat:\'HH:mm\' }} - {{ activity.endDate | dateFormat:\'HH:mm\' }}</span> <span ng-switch-when="false">Starts: {{ ::activity.startDate | dateFormat:\'HH:mm\' }}</span></span></div><div class="vAlign col-xxs-4 col-xs-3 noPadding" ng-if="activity.days"><span class="date"><span ng-class="{\'mutedText\': activity.days[0] == null}">M</span> <span ng-class="{\'mutedText\': activity.days[1] == null}">T</span> <span ng-class="{\'mutedText\': activity.days[2] == null}">W</span> <span ng-class="{\'mutedText\': activity.days[3] == null}">T</span> <span ng-class="{\'mutedText\': activity.days[4] == null}">F</span> <span ng-class="{\'mutedText\': activity.days[5] == null}">S</span> <span ng-class="{\'mutedText\': activity.days[6] == null}">S</span> </span><span ng-if="activity.times != \'various\'">{{ activity.times }}</span> <span ng-if="activity.times == \'various\'">Various times</span></div><div class="vAlign col-xxs-7 col-xs-8"><i ng-if="activity.type === \'BookingRequest\' && activity.status === \'declined\'" class="fas fa-exclamation-circle redColour" style="margin-right:5px" uib-tooltip="Declined"></i> <i ng-if="activity.private" class="ico ico-lock fixedSize fixedTopOffset marginRight" uib-tooltip="Private"></i>{{ ::activity.title }} <span ng-if="activity.type === \'ActivityInvite\'" class="show small infoColour">Activity invite from {{ ::activity.invite.referrer }}</span> <span ng-if="activity.type === \'BookingRequest\' && activity.view === \'host\'" class="show small infoColour">Booking request from {{ ::activity.from.name }}</span></div><div class="vAlign col-xs-1 noPadding text-right noFontSize"><span class="statusTrafficLight" ng-class="activity.status" uib-tooltip="{{ activity.status|capitalize }}" tooltip-placement="left"></span></div></div></div></div><div ng-show="hiddenActivities.length" class="small text-center jsButton gutterMarginTop half" ng-click="toggleHidden()"><span ng-show="!showHidden">Show</span><span ng-show="showHidden">Hide</span> {{ ::hiddenText }}</div></div></div>'),$templateCache.put("activities/views/partials/activity-panel.html",'<section class="activityPanel white-bg"><div class="img bgFade activities clickable" ng-click="viewActivity()" style="background-image: url({{ activity.bannerImage }})"><i ng-if="!activity.bannerImage" class="ico ico-picture noPhotoIcon"></i><div class="topLayer"><div class="abs bottomNoSpace"><div class="truncate hidden-sm hidden-xs"><span class="h3"><i ng-if="activity.private" class="ico ico-lock fixedSize fixedTopOffset marginRight" uib-tooltip="Private"></i>{{ ::activity.title }}</span></div><div class="greyBar row noGutter text-center"><div class="col-xs-4"><i class="ico ico-gender fixedSize"></i> {{ ::activity.gender | genderDisplay }}</div><div class="col-xs-4"><i class="ico ico-cake fixedSize"></i> {{ ::activity.ageMin | ageDisplay:activity.ageMax }}</div><div class="col-xs-4"><i class="ico ico-level fixedSize"></i> {{ ::activity.difficultyLevel | difficultyDisplay }}</div></div></div><h3 class="abs topLeft label activities hidden-sm hidden-xs">{{ ::activity.interests[0].name }}</h3><span class="abs topRight price hidden-sm hidden-xs" ng-if="activity.budget.totalPerPerson != null">{{ ::activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</span></div></div><div class="sectionContent quickDetails"><ul class="list-unstyled iconBulletList"><li class="visible-sm visible-xs"><i class="ico ico-coins fixedSize"></i><span>Price: {{ ::activity.budget.totalPerPerson | currencyDisplay:activity.budget.currency }}</span></li><li ng-if="activity.flexible" class="hidden-sm hidden-xs"><i class="ico ico-calendar"></i><span>Days: <span ng-class="{\'mutedText\': activity.availableDays.days[0] == null}">M</span> <span ng-class="{\'mutedText\': activity.availableDays.days[1] == null}">T</span> <span ng-class="{\'mutedText\': activity.availableDays.days[2] == null}">W</span> <span ng-class="{\'mutedText\': activity.availableDays.days[3] == null}">T</span> <span ng-class="{\'mutedText\': activity.availableDays.days[4] == null}">F</span> <span ng-class="{\'mutedText\': activity.availableDays.days[5] == null}">S</span> <span ng-class="{\'mutedText\': activity.availableDays.days[6] == null}">S</span> </span></li><li ng-if="activity.flexible" class="hidden-sm hidden-xs"><i class="ico ico-clock fixedSize"></i><span>Time: {{ ::activity.availableDays.times|capitalize }}</span></li><li class="hidden-sm hidden-xs" ng-if="!activity.flexible && isSingleDayEvent()"><i class="ico ico-calendar"></i><span>Date: {{ activity.startDate | dateFormat:\'DD/MM/YYYY\' }}</span></li><li class="hidden-sm hidden-xs" ng-if="!activity.flexible && isSingleDayEvent()"><i class="ico ico-clock fixedSize"></i><span>Time: {{ activity.startDate | dateFormat:\'HH:mm\' }} - {{ activity.endDate | dateFormat:\'HH:mm\' }}</span></li><li class="hidden-sm hidden-xs" ng-if="!activity.flexible && !isSingleDayEvent()"><i class="ico ico-calendar"></i><span>Start: {{ ::activity.startDate | dateFormat:\'DD/MM/YYYY [at] HH:mm\' }}</span></li><li class="hidden-sm hidden-xs" ng-if="!activity.flexible && !isSingleDayEvent()"><i class="ico ico-calendar"></i><span>End: {{ ::activity.endDate | dateFormat:\'DD/MM/YYYY [at] HH:mm\' }}</span></li><li ng-show="!isHost && activity.flexibleLocationDistance"><i class="ico ico-pin fixedSize"></i><span>{{ ::activity.startLocation.locality }} (<a class="activities" ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">contact host</a>)</span></li><li ng-show="(isHost || !activity.flexibleLocationDistance) && !activity.endLocation"><i class="ico ico-pin fixedSize"></i><span>{{ ::activity.startLocation.name }}<i ng-if="activity.meetingPoint === \'private\'" class="ico ico-lock fixedSize marginLeft" style="position:relative; top: -2px" uib-tooltip="Private"></i></span></li><li ng-show="activity.endLocation"><i class="ico ico-pin fixedSize"></i><span>From: {{ ::activity.startLocation.name }}<i ng-if="activity.meetingPoint === \'private\'" class="ico ico-lock fixedSize marginLeft" style="position:relative; top: -2px" uib-tooltip="Private"></i></span></li><li ng-show="activity.endLocation"><i class="ico ico-pin fixedSize"></i><span>To: {{ ::activity.endLocation.name }}<i ng-if="activity.meetingPoint === \'private\'" class="ico ico-lock fixedSize marginLeft" style="position:relative; top: -2px" uib-tooltip="Private"></i></span></li><li ng-if="isHost && activity.flexible && !activity.groupSizeMax && activity.groupSizeMin == 1"><i class="ico ico-group fixedSize"></i><span>Available spots: Unlimited</span></li><li ng-if="isHost && activity.flexible && !activity.groupSizeMax && activity.groupSizeMin > 1"><i class="ico ico-group fixedSize"></i><span>Available spots: {{ ::activity.groupSizeMin }}+ per booking</span></li><li ng-if="isHost && activity.flexible && activity.groupSizeMax"><i class="ico ico-group fixedSize"></i><span>Available spots: {{ ::activity.groupSizeMin }}-{{ ::activity.groupSizeMax }} per booking</span></li><li ng-if="isHost && !activity.flexible"><i class="ico ico-group fixedSize"></i><span>Spots taken: {{ ::activity.spotsTaken }}<span ng-if="activity.groupSizeMax && !activity.confirmedFlexibleBooking">/{{ ::activity.groupSizeMax }}</span></span></li><li ng-if="!isHost"><i class="ico ico-group fixedSize"></i><span>Spots booked: {{ ::activity.spotsBooked }}</span></li><li ng-if="(activity.status !== \'draft\' && !activity.confirmedFlexibleBooking) || (activity.confirmedFlexibleBooking && activity.status === \'cancelled\')"><i class="ico ico-super-man fixedSize"></i><span>Status: {{ activity.status|capitalize }}</span></li></ul><div ng-show="activity.external" class="btn-group"><button type="button" class="btn btn-activities" ng-click="viewActivity()">View activity</button></div><div ng-show="activity.invite" class="btn-group"><button type="button" ng-if="activity.flexible" class="btn btn-green marginRight" ui-sref="activities.view({activityId: activity.id})"><i class="ico ico-tick no-margins"></i></button> <button type="button" ng-if="!activity.flexible" class="btn btn-green marginRight" ng-click="joinActivity()"><i class="ico ico-tick no-margins"></i></button> <button type="button" class="btn btn-red" ng-click="declineInvite(activity.invite.id)"><i class="ico ico-cross no-margins"></i></button></div><div ng-show="activity.bookingRequest && activity.bookingRequest.view === \'joiner\'" class="btn-group" ng-class="{\'dropup\': dropupMenu}"><div ng-show="!activity.bookingRequest.declinedDueToPayment"><button ng-show="activity.bookingRequest.status !== \'declined\'" type="button" class="btn btn-activities dropdown-toggle" data-toggle="dropdown"><i class="visible-xs ico ico-cog noSpacingXS"></i><span class="hidden-xs">Manage request</span><span class="caret"></span></button> <button ng-show="activity.bookingRequest.status === \'declined\'" type="button" class="btn btn-red dropdown-toggle" data-toggle="dropdown"><i class="visible-xs ico ico-exclamation noSpacingXS"></i><span class="hidden-xs">Manage request</span><span class="caret"></span></button><ul class="dropdown-menu dropdown-menu-right"><li><a ng-click="changeBookingRequest()">Change date</a></li><li><a ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Contact host</a></li><li class="divider"></li><li><a ng-click="cancelBookingRequest()">Cancel request</a></li></ul></div><button ng-show="activity.bookingRequest.declinedDueToPayment" type="button" class="btn btn-red" ng-click="deleteBookingRequest()"><i class="ico ico-cross"></i> Delete request</button></div><div ng-show="activity.bookingRequest && activity.bookingRequest.view === \'host\'" class="btn-group"><button ng-show="activity.bookingRequest.status !== \'declined\'" type="button" class="btn btn-green marginRight" ng-click="manageBookingRequest(\'accept\')"><i class="ico ico-tick no-margins"></i></button> <button ng-show="activity.bookingRequest.status !== \'declined\'" type="button" class="btn btn-red" ng-click="manageBookingRequest(\'decline\')"><i class="ico ico-cross no-margins"></i></button> <button ng-show="activity.bookingRequest.status === \'declined\'" type="button" class="btn btn-red" ng-click="deleteBookingRequest()"><i class="ico ico-cross"></i> Delete</button></div><div ng-show="!activity.external && !activity.invite && !activity.bookingRequest" class="btn-group" ng-class="{\'dropup\': dropupMenu}"><button type="button" class="btn btn-activities dropdown-toggle" data-toggle="dropdown"><i class="visible-xs ico ico-cog noSpacingXS"></i><span class="hidden-xs">Manage <span ng-if="isHost">activity</span><span ng-if="!isHost">booking</span></span><span class="caret"></span></button><ul ng-show="isHost" class="dropdown-menu dropdown-menu-right"><li ng-show="activity.status != \'draft\'"><a ng-click="viewActivity()">View activity</a></li><li ng-show="activity.editable && !activity.confirmedFlexibleBooking"><a ng-click="editActivity()">Edit activity</a></li><li ng-show="activity.status == \'open\' && !activity.confirmedFlexibleBooking"><a ng-click="sendInvites()">Send invites</a></li><li ng-show="activity.joiners.length"><a ng-click="newMessage(activity.joiners, activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Message joiners</a></li><li ng-show="activity.status != \'draft\'"><a ng-click="discussionBoard()">Discussion board</a></li><li><a ng-click="copyActivity()">Copy activity</a></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'" class="divider"></li><li ng-show="activity.status != \'draft\' && activity.status != \'cancelled\' && activity.status != \'completed\'"><a ng-click="cancelActivity()">Cancel activity</a></li><li ng-show="activity.deletable" class="divider"></li><li ng-show="activity.deletable"><a ng-click="deleteActivity()">Delete activity</a></li></ul><ul ng-show="!isHost" class="dropdown-menu dropdown-menu-right"><li><a ng-click="viewActivity()">View activity</a></li><li><a ng-click="shareActivity()">Share activity</a></li><li><a ng-click="newMessage([activity.host], activity.title + \' on \' + (activity.startDate | dateFormat:\'DD/MM/YYYY\'))">Contact host</a></li><li><a ng-click="discussionBoard()">Discussion board</a></li></ul></div></div><div class="sectionContent" ng-show="activity.summary && !activity.bookingRequest"><p><strong>Summary</strong></p><div ng-bind-html="activity.summary | nl2br | sanitize | limitTo: 300" class="no-margins" style="display: inline"></div></div><div class="sectionContent" ng-show="activity.bookingRequest && activity.bookingRequest.view === \'host\' && (activity.bookingRequest.status === \'declined\' || activity.bookingRequest.joinerMessage)"><div ng-show="activity.bookingRequest.status !== \'declined\'"><p><strong>Message</strong></p><div><a class="activities" ui-sref="contacts.public({ userId: activity.bookingRequest.from.id })"><strong>{{ activity.bookingRequest.from.name }}</strong></a>: <span ng-bind-html="activity.bookingRequest.joinerMessage | nl2br | sanitize" class="no-margins" style="display: inline"></span></div></div><div ng-show="activity.bookingRequest.status === \'declined\'"><p><strong>Declined</strong></p><div ng-if="!activity.bookingRequest.paymentError"><a class="activities" ui-sref="profile"><strong>{{ activity.host.name }}</strong></a>: <span ng-bind-html="activity.bookingRequest.hostMessage | nl2br | sanitize" class="no-margins" style="display: inline"></span></div><div ng-if="activity.bookingRequest.paymentError"><span ng-bind-html="activity.bookingRequest.joinerMessage | nl2br | sanitize" class="no-margins" style="display: inline"></span></div></div></div><div class="sectionContent" ng-show="activity.bookingRequest && activity.bookingRequest.view === \'joiner\'"><div ng-show="activity.bookingRequest.status !== \'declined\'"><p><strong>Waiting for a host to accept your request</strong></p><div>Note, <span ng-if="activity.budget.totalPerPerson > 0">you wont be charged for this activity until it has been accepted by the host. O</span><span ng-if="activity.budget.totalPerPerson == 0">o</span>nce the booking is confirmed you will be able to see it under the Confirmed bookings section.</div></div><div ng-show="activity.bookingRequest.status === \'declined\'"><p><strong>Your request has been declined</strong></p><div ng-if="!activity.bookingRequest.paymentError"><a class="activities" ui-sref="contacts.public({ userId: activity.host.id })"><strong>{{ activity.host.name }}</strong></a>: <span ng-bind-html="activity.bookingRequest.hostMessage | nl2br | sanitize" class="no-margins" style="display: inline"></span></div><div ng-if="activity.bookingRequest.paymentError"><span ng-bind-html="activity.bookingRequest.hostMessage | nl2br | sanitize" class="no-margins" style="display: inline"></span></div></div></div></section>'),
$templateCache.put("activities/views/partials/browse-filters.html",'<div class="filterPanel white-bg {{ filterTheme }}"><div class="filterPanelHeader"><a class="btn btn-green" ng-disabled="!inMemoryData.filters.price.valid() || !inMemoryData.filters.age.valid()" ng-click="(inMemoryData.filters.price.valid() && inMemoryData.filters.age.valid()) && applyFilter()"><i class="ico ico-tick"></i>Apply</a><div class="flexGrow marginLeft" ng-show="inMemoryData.filters.hasFilters()"><a ng-click="inMemoryData.filters.clearAll()">Clear filters</a></div><div class="flexGrow text-right"><a ng-click="$close()"><i class="ico ico-cross"></i></a></div></div><div class="collapsableHeading walletColour" collapsable open="openFilters.date">Date</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'all\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'all\')">All dates</a></li><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'thisWeek\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'thisWeek\')">This week</a></li><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'nextWeek\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'nextWeek\')">Next week</a></li><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'thisMonth\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'thisMonth\')">This month</a></li><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'nextMonth\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'nextMonth\')">Next month</a></li><li ng-class="{\'selected\': inMemoryData.filters.date.selectedRange == \'custom\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.date.setValue(\'custom\')">Custom dates</a></li></ul><div class="customOption gutterMarginTop" ng-show="inMemoryData.filters.date.selectedRange == \'custom\'"><div class="iconInput"><i class="ico ico-calendar"></i> <input date-range-picker class="form-control date-picker hideReadOnly" type="text" ng-model="inMemoryData.filters.date.model" options="formData.filters.date.options" readonly="readonly"></div></div></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.time">Time of day</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.time.selectedRange == \'all\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.time.setValue(\'all\')">All times</a></li><li ng-class="{\'selected\': inMemoryData.filters.time.selectedRange == \'morning\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.time.setValue(\'morning\')">Morning</a><small class="mutedText marginLeft">(Starts before 12pm)</small></li><li ng-class="{\'selected\': inMemoryData.filters.time.selectedRange == \'afternoon\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.time.setValue(\'afternoon\')">Afternoon</a><small class="mutedText marginLeft">(Starts after 12pm)</small></li><li ng-class="{\'selected\': inMemoryData.filters.time.selectedRange == \'evening\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.time.setValue(\'evening\')">Evening</a><small class="mutedText marginLeft">(Starts after 6pm)</small></li><li ng-class="{\'selected\': inMemoryData.filters.time.selectedRange == \'custom\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.time.setValue(\'custom\')">Custom range</a></li></ul><div class="customOption gutterMarginTop" ng-show="inMemoryData.filters.time.selectedRange == \'custom\'"><div class="vAlignParent"><div class="vAlign fixedWidth"><select class="form-control" ng-options="option.key as option.value for option in formData.filters.time.options | filter:formData.filters.time.hideMidnight" ng-model="inMemoryData.filters.time.model.min"></select></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign fixedWidth"><select class="form-control" ng-options="option.key as option.value for option in formData.filters.time.options | filter:maxTimeOptionShouldShow" ng-model="inMemoryData.filters.time.model.max"></select></div></div></div></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.price">Price</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.price.selectedRange == \'all\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.price.setValue(\'all\')">All prices</a></li><li ng-class="{\'selected\': inMemoryData.filters.price.selectedRange == \'free\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.price.setValue(\'free\')">Free</a></li><li ng-class="{\'selected\': inMemoryData.filters.price.selectedRange == \'custom\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.price.setValue(\'custom\'); inMemoryData.filters.price.model.min = 1; inMemoryData.filters.price.model.max = null;">Paid</a></li></ul><div class="customOption gutterMarginTop" ng-show="inMemoryData.filters.price.selectedRange == \'custom\'"><div class="vAlignParent"><div class="vAlign"><div class="input-group fixedWidth"><span class="input-group-addon">&pound;</span> <input class="form-control" type="text" placeholder="Min" ng-model="inMemoryData.filters.price.model.min" number-only-input></div></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign"><div class="input-group fixedWidth"><span class="input-group-addon">&pound;</span> <input class="form-control" type="text" placeholder="Max" ng-model="inMemoryData.filters.price.model.max" number-only-input></div></div></div></div></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.age">Age</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.age.selectedRange == \'all\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.age.setValue(\'all\')">All ages</a></li><li ng-class="{\'selected\': inMemoryData.filters.age.selectedRange == \'adults\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.age.setValue(\'adults\')">Adults only</a></li><li ng-class="{\'selected\': inMemoryData.filters.age.selectedRange == \'children\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.age.setValue(\'children\')">Child friendly</a></li><li ng-class="{\'selected\': inMemoryData.filters.age.selectedRange == \'custom\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.age.setValue(\'custom\')">Custom range</a></li></ul><div class="customOption gutterMarginTop" ng-show="inMemoryData.filters.age.selectedRange == \'custom\'"><div class="vAlignParent"><div class="vAlign"><div class="input-group fixedWidth"><input class="form-control" type="text" placeholder="Min" ng-model="inMemoryData.filters.age.model.min" integer-only-input maxlength="3"> <span class="input-group-addon">yrs</span></div></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign"><div class="input-group fixedWidth"><input class="form-control" type="text" placeholder="Max" ng-model="inMemoryData.filters.age.model.max" integer-only-input maxlength="3"> <span class="input-group-addon">yrs</span></div></div></div></div></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.gender">Gender</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.gender.value == \'u\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.gender.value=\'u\'">Any</a></li><li ng-class="{\'selected\': inMemoryData.filters.gender.value == \'f\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.gender.value=\'f\'">Female only</a></li><li ng-class="{\'selected\': inMemoryData.filters.gender.value == \'m\'}"><a class="underlineOnHover" ng-click="inMemoryData.filters.gender.value=\'m\'">Male only</a></li></ul></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.difficultyLevel">Skill level</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': inMemoryData.filters.difficultyLevel.value == 0}"><a class="underlineOnHover" ng-click="inMemoryData.filters.difficultyLevel.value=0">All levels</a></li><li ng-class="{\'selected\': inMemoryData.filters.difficultyLevel.value == 1}"><a class="underlineOnHover" ng-click="inMemoryData.filters.difficultyLevel.value=1">Beginner</a></li><li ng-class="{\'selected\': inMemoryData.filters.difficultyLevel.value == 2}"><a class="underlineOnHover" ng-click="inMemoryData.filters.difficultyLevel.value=2">Intermediate</a></li><li ng-class="{\'selected\': inMemoryData.filters.difficultyLevel.value == 3}"><a class="underlineOnHover" ng-click="inMemoryData.filters.difficultyLevel.value=3">Advanced</a></li></ul></div><div class="separator"></div><div class="collapsableHeading walletColour" collapsable open="openFilters.other">Other</div><div class="collapsableContent"><ul class="list-unstyled no-margins"><li ng-class="{\'selected\': !inMemoryData.filters.other.value.unique}"><a class="underlineOnHover" ng-click="inMemoryData.filters.other.value.unique=false">All activities</a></li><li ng-class="{\'selected\': inMemoryData.filters.other.value.unique}"><a class="underlineOnHover" ng-click="inMemoryData.filters.other.value.unique=true">Featured</a></li></ul></div></div>'),$templateCache.put("activities/views/partials/cancel-form.html",'<div class="modal-body"><form name="form" class="paymentForm" novalidate autocomplete="off" ng-show="activity.joiners > 0"><div class="form-group" ng-class="{ \'has-error\': validationRun && form.reason.$invalid, \'no-margins\': activity.seriesDates <= 1}"><label>What is the reason for cancelling this activity</label><textarea class="form-control" rows="5" ng-model="formData.reason" name="reason" placeholder="Enter a reason to send to your joiners" ng-required="true"></textarea><span class="help-block" ng-show="validationRun && form.reason.$invalid">We need a reason for the cancellation</span></div></form><div ng-if="activity.seriesDates == 1 && activity.joiners == 0">Are you sure you want to cancel {{ activity.title }}?</div><div ng-if="activity.seriesDates > 1">{{ activity.title }} is part of a series. Do you want to cancel this activity and all future activities, or just this activity?</div></div><div class="modal-footer" ng-show="activity.seriesDates == 1"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green" type="button" ng-click="cancelActivity(false)"><i class="ico ico-tick"></i>Confirm</button></div><div class="modal-footer" ng-show="activity.seriesDates > 1"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-activities pull-right" type="button" ng-click="cancelActivity(true)">All future activities</button> <button class="btn btn-activities pull-right" type="button" ng-click="cancelActivity(false)">Just this activity</button></div>'),$templateCache.put("activities/views/partials/definition-help-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">{{ title }}</h1></div><div class="modal-body removeLastPMargin"><div ng-if="content==\'activity_visibility\'"><p><strong>Public activities</strong> appear in search results and are suggested to HulaHub members that might find them interesting. If you are looking to attract new clients and get more bookings you should make your activity public.</p><p><strong>Private activities</strong> are not visible to anyone by default, they can only be joined by people who have received an invite to that activity from you or another invitee. So, if you are organising a private trip, or an event only for a selected group of people, set your activity to private and send activity invitations via our system.</p></div><div ng-if="content==\'activity_tags\'"><p>You can choose a tag from the dropdown that will appear as you start typing or simply select the term you have entered to add it.</p><p>You can add up to 10 activity tags so make sure you use words and phrases that people are most likely to use when searching for the type of activity you are hosting.</p></div><div ng-if="content==\'activity_title\'"><p>A great title is appealing, clear and as self-explanatory as possible. Try to include keywords that highlight what the activity is about, e.g. Beginner\'s Salsa Class for all ages at Bicester Town Hall.</p><p>Use terms like class, session, course, workshop or trip. Don\'t worry if the Title seems too straight forward or descriptive, as it will help the users understand what it is about. You can use creative imagery to help it stand out in later steps.</p></div><div ng-if="content==\'activity_description\'"><p>The activity description is where the full details of the activity are entered.</p><p>Give an outline of what people can expect and always try and set expectations appropriately as it is important people know what they\'re getting into!</p><p>Be as specific as possible if the activity is technical in nature, like a workshop or tutorial and don\'t be afraid to get into the detail. People want to know exactly what they\'re going to be getting.</p><p>Add as many sections as you need to appropriately describe the activity and set expectations accurately.</p><p>Please do not include any phone numbers, email addresses or website links in the activity description, as these are already accessible to people on your profile page.</p></div><div ng-if="content==\'activity_overview\'"><p>Try to highlight all the important and interesting details about your activity in 150 characters. This is your chance to shine and inspire people to join the activity so make it exciting and eye catching e.g. \'Body Combat is an intense, high energy workout so come prepared with lots of enthusiasm and be prepared to work really hard!</p></div><div ng-if="content==\'what_we\\\'ll_do\'"><p>Try and communicate to people the key things they should expect during your activity.</p><p>For example, "We\'ll be diving down to 20 metres, which will take about 15 minutes. We\'ll then spend 30 mins exploring the reef before practising a controlled ascent, stopping at 10 metres depth for a few minutes to get used to decompression stops on ascents.</p></div><div ng-if="content==\'attachments\'"><p>Add any additional attachments containing information about the location, equipment check lists, maps or any forms that joiners will need to fill in before attending your activity.</p><p>If your activity requires a certain level of fitness you may want to add a fitness questionnaire that will need to be filled in prior to the activity.</p><p>Make sure to use descriptive file names so that people know what they are.</p></div><div ng-if="content==\'activity_cover_photo\'"><p>People love looking at photos! Show what your activity is all about by adding a photo that really showcases the activity, make sure it is high quality, attractive and in focus!</p><p><strong>For best results:</strong></p><ul class="no-margins list-unstyled" style="line-height: 200%"><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Go with active, candid images</li><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Mix it up with photos of people, places, and things</li><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Try to take the photo in a well-lit space</li><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Photos cannot be larger than 2MB</li><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Don\'t use a flash or heavy filters</li><li><i class="ico ico-tick"></i>&nbsp;&nbsp;Don\'t upload blurry or distorted images</li></ul></div><div ng-if="content==\'photo_gallery\'"><p>Add more photos that are relevant to your activity. For example, you may wish to show participants engaging in the activity, a photo of you leading the activity, a picture of the location where the activity will take place, etc."</p><p>Note: activities with 4 or more high quality photos attract more attention and get a better booking rate.</p></div><div ng-if="content==\'spots_available\'"><p>The lower limit is useful if a minimum number of people are needed to run an activity, for example, if you need 8 people for a rafting trip, or 4 people to crew a yacht. Leaving the upper limit as no limit means that any number of people will be able to join your activity.</p><p>You may choose to automatically cancel an activity if the number of spots booked fails to reach your lower limit by the closing date in which case joiners will be notified and any payments refunded.</p></div><div ng-if="content==\'age_limits\'"><p>All activities are set to default age of 18+, however, you can specify specific age requirements for the activity, e.g. a baby swim class for 3-6 month olds or a game night for over 65s, by adding the min and max age number in either years or months.</p><p>Note: Anyone can book an activity on someone else\'s behalf, so adults can book places on childrenâs activities, for example.</p></div><div ng-if="content==\'who_is_this_activity_aimed_at?\'"><p>Some people like to enjoy activities on their own, others thrive from interacting with likeminded individuals so let people know who this activity is aimed at and if any prior experience is needed.</p><p>For example, "This experience is aimed at the over 50\'s with some prior experience of surfing. You will need to be a strong swimmer and able to tolerate being in cold water for more than an hour at a time."</p></div><div ng-if="content==\'activity_location\'"><p><strong>Fixed location</strong> means the activity has a specific start point, e.g. a museum for a tour, the entrance gate to a park for a run or a residential address for a cookery class.</p><p><strong>Flexible location</strong> allows for activities that do not necessarily have a fixed start location, for example a personal trainer may be willing to travel up to 5 miles from their home location.</p></div><div ng-if="content==\'activity_address\'"><p>To add your activity address start typing in the box below and choose a suggested location from the dropdown. You must choose a location to be able to create an activity.</p><p>If your activity ends somewhere different to where it started, click the \'My activity ends in a different location\' switch and enter the end location in the box that appears.</p><p>For example, if you are hosting a cycle ride that starts in one town and ends in another, use the switch to enter both locations.</p><p>If there are any additional instructions for joiners they can be added in the free text box, for example "I\'ll be wearing a blue shirt and red shorts and wait for you by the park entrance."</p></div><div ng-if="content==\'flexible_activity_location\'"><p>To set the flexible location first enter an address, city, town or general area and select from the dropdown, then set a distance you are willing to travel using the slider.</p><p>If there are any additional instructions for joiners they can be added in the free text box, for example "I\'ll be wearing a blue shirt and red shorts and wait for you by the park entrance."</p></div><div ng-if="content==\'address_privacy\'"><p><strong>Public addresses</strong> are accessible to all external visitors and users of HulaHub before an activity booking has been made. Use this option if, for example, your activity takes place in a location you don\'t mind people knowing about before a booking has been made, e.g. a park or museum etc.</p><p><strong>Private addresses</strong> will only be displayed once the booking has been made, the general activity pages will just show an approximate location. Use this option if, for example, your activity takes place in someone\'s house and you don\'t wish to share the exact address before a booking is made.</p></div><div ng-if="content==\'how_is_your_activity_scheduled?\'"><p>A <strong>one-off activity</strong> only occurs once at a specific time and date and then ends, for example, a 5k running race at 6pm on the 12th June 2018.</p><p>A <strong>repeating activity</strong> recurs multiple times either daily, weekly or monthly at the same time and may (or may not) have a specific end date, for example, a 9am Saturday morning run in the local park commencing the 30th June 2018 continuing indefinitely.</p><p>A <strong>flexible activity</strong> does not have a fixed start or end date, instead it can occur within a range of dates and times defined by the activity host and the exact date and time is confirmed later. For example, a mountaineering trip that could be any weekend between the 1st June and the 30th June 2018.</p></div><div ng-if="content==\'activity_date_and_time\'"><p>Choose a specific start and end date and time for an activity. Note, an activity can span across multiple days.</p><p>For example, you can create a badminton lesson that starts at 6pm on the 7th June and ends at 7pm on the 7th June, or a multi-day hiking trip that starts at 9am on the 1st July and ends at 10pm on the 7th July.</p></div><div ng-if="content==\'activity_initial_date_and_time\'"><p>Choose the date and time for the first activity in the series. For example, a badminton lesson that starts at 6pm on the 7th June and ends at 7pm on the 7th June.</p></div><div ng-if="content==\'activity_repeat_pattern\'"><p>Choose when you would like the activity to repeat. For example daily, weekly or monthly using the dropdown and use the switches to select the days of the week as appropriate. If you set an "Ends" date the activity series will finish on this date, otherwise it will continue indefinitely.</p></div><div ng-if="content==\'closing_time_for_joining\'"><p>Here you can choose how far in advance joiners have to book. This is particularly useful if there is a lead time associated with providing the right quantity of equipment or transport.</p></div><div ng-if="content==\'activity_duration\'"><p>Use the dropdowns to specify the duration of your activity, so how long in hours and minutes the activity will last, e.g. 2 hours and 30 minutes.</p></div><div ng-if="content==\'specify_your_availability\'"><p>Use the switches to turn the days of the week on and off and the sliders to specify the hours of the day within which the activity will be available. For example, you can set your availability from Monday to Wednesday between 9:30am and 3pm.</p></div><div ng-if="content==\'availability_time_period\'"><p>Specify a start and end date for the availability period of your activity.</p><p>Keep the end date unspecified if you want your activity to be available indefinitely or set it to a specific date if, for example, the activity availability changes between winter and summer, in which case two flexible availability periods can be created for each, with different start and end dates.</p></div><div ng-if="content==\'set_a_price_per_spot\'"><p>This is the standard price per spot on the activity that a joiner would pay, before any discounts or special offers you may have created. Leave the box empty if your activity is free, otherwise add any value in pounds and pence, e.g. &pound;14.32.</p></div><div ng-if="content==\'service_charges\'"><p>The HulaHub service charge is calculated as a percentage of a booking\'s total value, and covers the cost of payment processing.</p><p><strong>Service charges:</strong></p><ul class="gutterMarginBottom half list-unstyled"><li>Your standard service charge is {{ auth.currentUser.standardFee }}% for clients that connect via HulaHub.</li><li>Your reduced service charge is {{ auth.currentUser.discountedFee }}% for bookings made by your existing clients that you invite via HulaHub.</li><li>The minimum service charge is &pound;1.50</li></ul><p>Service charges can be reduced by upgrading your subscription plan. For more information please read the <a href="{{ env.knowledgehub }}/account/billing/understanding-the-service-charge" target="_blank" class="activities">Understanding the service charge</a> article.</p></div><div ng-if="content==\'booking_platforms\'"><p><strong>HulaHub booking platform</strong><br>We offer an integrated booking platform that allows people to book activities, view & manage their booking and contact the host. The HulaHub platform automatically takes payment as soon as a booking is made and deposits it into the activity host\'s bank account via Stripe. A host must connect their bank account to receive payments and to confirm the booking.</p><p><strong>Benefits</strong>: We handle everything for you including all the admin, invoices, VAT and payments. You will dramatically free up your time by simply and easily managing all of your bookings and communication with your activity joiners using our platform.</p><p><strong>Your own booking platform</strong><br>This option will take the joiner to your own booking platform or to a third party booking platform. Simply enter the url in the textbox that you want the users to go to book the activity.</p><p><strong>Benefits</strong>: If you already have your own booking and/or payments system in place and you don\'t want bookings to clash, linking through to your platform is simple and seamless.</p></div></div>'),$templateCache.put("activities/views/partials/flexible-day-control.html",'<div class="row halfGutter"><div class="hidden-xs col-sm-1 h3">{{ label | limitTo:3 }}</div><div class="col-xs-12 col-sm-10"><div class="visible-xs gutterMarginBottom"><div class="vAlignParent full-width"><div class="vAlign h3">{{ label }}</div><div class="vAlign noFontSize text-right"><switch ng-model="day.enabled"></switch></div></div></div><div class="noUi-extended" ya-no-ui-slider="day" ya-no-ui-slider-disabled="!day.enabled"></div><div class="text-center" ng-if="!day.enabled">Day off</div></div><div class="hidden-xs col-sm-1 text-right noFontSize"><switch ng-model="day.enabled"></switch></div></div>'),$templateCache.put("activities/views/partials/pricing-calculator.html",'<div class="pricingCalculator sectionContent"><h4 class="text-center gutterMarginBottom">Pricing calculator</h4><div class="row"><div class="col-xs-6">Price per spot</div><div class="col-xs-6 text-right">{{ perSpot.value() | currencyDisplay: currency:true:false:true }}</div></div><div class="row noMarginBottom"><div class="col-xs-9" style="margin-top: 7px">Number of joiners</div><div class="col-xs-3 text-right"><input class="form-control text-right" ng-model="pricingCalculator.joiners" integer-only-input type="number" min="0"></div></div><hr><div class="row"><div class="col-xs-6">Total price</div><div class="col-xs-6 text-right">{{ pricingCalculator.subTotal() | currencyDisplay: currency:true:false:true }}</div></div><div class="row"><div class="col-xs-6">Discount applied</div><div class="col-xs-6 text-right"><span ng-if="!pricingCalculator.appliedOffer">0%</span> <span ng-if="pricingCalculator.appliedOffer.type==0">{{ pricingCalculator.appliedOffer.amount/100 }}%</span> <span ng-if="pricingCalculator.appliedOffer.type==1">{{ pricingCalculator.appliedOffer.amount | currencyDisplay: currency:true:false:true }}</span></div></div><div class="row halfGutter"><div class="col-xs-7"><span class="withHelpIcon">Service charge<a class="helpIcon ico ico-question" ng-click="showHelp({label: \'service_charges\'})"></a></span></div><div class="col-xs-5 text-right">{{ pricingCalculator.serviceCharge }}%</div></div><div class="row noMarginBottom"><div class="col-xs-7"><strong>You will receive</strong></div><div class="col-xs-5 text-right"><strong>{{ pricingCalculator.total() | currencyDisplay: currency:true:false:true }}</strong></div></div></div>'),$templateCache.put("activities/views/partials/remove-joiner-form.html",'<div class="modal-header"><h1 class="modal-title">Remove joiner from this activity</h1></div><div class="modal-body"><form name="form" class="paymentForm" novalidate autocomplete="off"><div class="form-group" ng-class="{ \'has-error\': validationRun && form.reason.$invalid, \'no-margins\': !activity.series}"><label>What is the reason for removing {{ joiner.name }}?</label><textarea class="form-control" rows="5" ng-model="formData.reason" name="reason" placeholder="Enter a reason to send to {{ joiner.name }}" ng-required="true"></textarea><span class="help-block" ng-show="validationRun && form.reason.$invalid">We need a reason for the removal</span></div></form><small style="display:block; margin-top:10px">Please note that if the person has paid for this activity already they will receive a refund and you may have to pay the service charge.</small><div class="gutterMarginTop" ng-if="activity.series">{{ activity.title }} is part of a series. Do you want to remove {{ joiner.name }} from this activity and all future activities, or just this activity?</div></div><div class="modal-footer"><div ng-show="!activity.series" class="clearfix"><button class="pull-left btn btn-red btn-outline" type="button" ng-click="$dismiss()">Cancel</button> <button class="pull-right btn btn-activities" type="button" ng-click="remove(false)">Confirm</button></div><div ng-show="activity.series" class="clearfix"><button class="pull-left btn btn-red btn-outline" type="button" ng-click="$dismiss()">Cancel</button><div class="pull-right"><button class="btn btn-activities" type="button" ng-click="remove(false)">Just this activity</button> <button class="btn btn-activities" type="button" ng-click="remove(true)">All future activities</button></div></div></div>'),$templateCache.put("activities/views/partials/repeat-activity-booking-form.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Select date and time</h1></div><div class="modal-body"><div ng-show="loadingDates" class="text-center"><div class="loadingSpinner basic"></div></div><form name="form" novalidate autocomplete="off" ng-show="!loadingDates"><div class="form-group"><div ng-if="!loadingDates" uib-datepicker class="inPageCalendar" ng-model="booking.datePicker.date" datepicker-options="booking.datePicker.options" template-url="core/partials/uib-datepicker/datepicker.html"></div></div><strong>Availability for {{ booking.datePicker.date | dateFormat:\'ddd, D MMM YYYY\' }}</strong><div class="vAlignParent full-width borderTop marginTop paddingTop" ng-repeat="time in booking.availableTimes"><div class="vAlign" ng-show="!time.spotsLeft">Sorry, this date is been fully booked</div><div class="vAlign" ng-show="time.spotsLeft"><span class="label grey notBold gutterMarginBottom half" ng-show="time.spacesLeft !== \'Unlimited\' && time.spotsLeft <= 3">{{ time.spotsLeft }} spots left</span><p class="h3 notBold">{{ time.startDate | dateFormat:\'HH:mm\' }} - {{ time.endDate | dateFormat:\'HH:mm\' }}</p><div>{{ booking.budget.perPerson | currencyDisplay:booking.budget.currency }}<span ng-if="booking.budget.perPerson > 0"> per person</span></div><div>{{ time.startLocation }}</div></div><div class="vAlign col-xs-4 noPadding text-right" ng-show="time.spotsLeft"><a class="btn btn-profile" ng-click="joinActivity(time.id)"><i class="ico ico-calendar"></i>Book now</a></div></div></form></div>'),$templateCache.put("activities/views/partials/single-layout.html",'<div ng-if="loading" class="text-center"><div class="loadingSpinner basic"></div></div><section class="white-bg row gutterMarginBottom" ng-if="!loading && notFound"><div class="sectionContent"><div class="h2 show text-center">This activity does not exist, or has been removed.</div></div></section><div ui-view name="activityContent" ng-if="!loading && !notFound"></div>'),
$templateCache.put("activities/views/partials/suggest-activity-modal.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()"><span>&times;</span></a><h1 class="modal-title">Suggest an activity</h1></div><form name="form" novalidate><div class="modal-body"><div class="form-group"><label>What activity do you want to do? *</label><input class="form-control" ng-model="formData.activity" placeholder="Enter a type of activity you are interested in" type="text" name="activity" required></div><div class="form-group"><label>Where do you want to do it? *</label><input class="form-control" ng-model="formData.location" placeholder="Enter a postcode, town or area you are interested in" type="text" name="location" required></div><div class="form-group"><label>Any other comments?</label><textarea class="form-control" rows="4" ng-model="formData.description" placeholder="Add a little more detail if you like..." name="description"></textarea></div><div class="form-group"><label>Your name *</label><input class="form-control" ng-model="formData.name" placeholder="Enter your full name" type="text" name="name" required></div><div class="form-group no-margins"><label>Your email address *</label><input class="form-control email" ng-model="formData.email" placeholder="Enter your email and we will let you know when the activity has been added" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required></div></div><div class="modal-footer"><button class="btn btn-red btn-outline pull-left" type="button" ng-click="$dismiss()"><i class="ico ico-cross"></i>Cancel</button> <button class="btn btn-green" type="submit" ng-click="submitSuggestion()" ng-disabled="form.$invalid"><i class="ico ico-tick"></i>Submit</button></div></form>'),$templateCache.put("billing/views/partials/decline-refund-form.html",'<div class="modal-header"><h1 class="modal-title">Decline refund</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="alert alert-danger" ng-show="!loading && errorMessage">{{ errorMessage }}</div><form name="form" class="paymentForm" novalidate autocomplete="off" ng-hide="loading"><div class="form-group" ng-class="{\'has-error\': validationRun && form.comments.$invalid}"><textarea class="form-control" ng-model="formData.comments" name="comments" placeholder="Reason for decline..." rows="5" cols="50" ng-required="true"></textarea><span class="help-block" ng-show="validationRun && form.comments.$invalid">This is a required field</span></div><div class="form-group no-margins"><div class="clearfix formActions"><button class="btn btn-green pull-right btn-outline" type="button" ng-click="send()"><i class="ico ico-tick"></i> Send</button> <button class="btn btn-red pull-left btn-outline" type="button" ng-click="cancel()"><i class="ico ico-cross"></i> Cancel</button></div></div></form></div>'),$templateCache.put("billing/views/partials/partial-refund-form.html",'<div class="modal-header"><h1 class="modal-title"><span ng-show="isHost">Offer partial refund</span><span ng-hide="isHost">Counter offer</span></h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="alert alert-danger" ng-show="!loading && errorMessage">{{ errorMessage }}</div><form name="form" class="paymentForm" novalidate autocomplete="off" ng-hide="loading"><div class="form-group" ng-class="{\'has-error\': validationRun && (form.amount.$invalid || form.$error.amount)}"><label>Amount <span ng-show="isHost">to refund</span><span ng-hide="isHost">you would like</span> (maximum {{ (maxAmount/100) | number: 2 }})</label><input class="form-control" number-only-input autofocus ng-model="formData.amount" name="amount" placeholder="0.00" type="text" size="15" ng-required="true"> <span class="help-block" ng-show="validationRun && form.amount.$invalid">You must enter an amount</span> <span class="help-block" ng-show="validationRun && form.$error.amount">The amount entered higher than the original payment</span></div><div class="form-group" ng-class="{\'has-error\': validationRun && form.comments.$invalid}"><label>Comments</label><textarea class="form-control" ng-model="formData.comments" name="comments" placeholder="Additional comments..." rows="5" cols="50" ng-required="true"></textarea><span class="help-block" ng-show="validationRun && form.comments.$invalid">This is a required field</span></div><div class="form-group no-margins"><div class="clearfix formActions"><button class="btn btn-green pull-right btn-outline" type="button" ng-click="sendOffer()"><i class="ico ico-tick"></i> Send offer</button> <button class="btn btn-red pull-left btn-outline" type="button" ng-click="cancel()"><i class="ico ico-cross"></i> Cancel</button></div></div></form></div>'),$templateCache.put("billing/views/partials/refund-escalation-form.html",'<div class="modal-header"><h1 class="modal-title">Escalate to HulaHub</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="alert alert-danger" ng-show="!loading && errorMessage">{{ errorMessage }}</div><form name="form" class="paymentForm" novalidate autocomplete="off" ng-hide="loading"><div class="form-group" ng-class="{\'has-error\': (validationRun && form.email.$invalid) || formErrors.email}"><label>Email address</label><input class="form-control email" ng-model="formData.email" placeholder="Email address" type="email" name="email" pattern="^[a-zA-Z0-9.!#$%&â*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)+$" required> <span class="help-block" ng-show="(validationRun && form.email.$invalid) || formErrors.email">{{ formErrors.email || \'This email address is not valid\' }}</span></div><div class="form-group" ng-class="{\'has-error\': validationRun && form.phoneNumber.$invalid}"><label>Phone number</label><telephone-number-input input-value="formData.phoneNumber" input-name="phoneNumber" required="true"></telephone-number-input><span class="help-block" ng-show="(validationRun && form.phoneNumber.$invalid)">We need a contact number for you</span></div><div class="form-group" ng-class="{ \'has-error\': validationRun && form.comments.$invalid}"><label>Comments</label><textarea class="form-control" rows="5" ng-model="formData.comments" name="comments" placeholder="Reason for escalation" required></textarea><span class="help-block" ng-show="validationRun && form.comments.$invalid">We will need more information to process your request</span></div><div class="form-group no-margins"><div class="clearfix formActions"><button class="btn btn-green pull-right btn-outline" type="button" ng-click="sendRequest()"><i class="ico ico-tick"></i> Send</button> <button class="btn btn-red pull-left btn-outline" type="button" ng-click="cancel()"><i class="ico ico-cross"></i> Cancel</button></div></div></form></div>'),$templateCache.put("billing/views/partials/request-refund-form.html",'<div class="modal-header"><h1 class="modal-title">Request refund</h1></div><div class="modal-body"><div ng-show="loading" class="text-center"><div class="loadingSpinner basic"></div></div><div class="alert alert-danger" ng-show="!loading && errorMessage">{{ errorMessage }}</div><form name="form" class="paymentForm" novalidate autocomplete="off" ng-hide="loading"><div class="form-group" ng-class="{ \'has-error\': validationRun && form.reason.$invalid}"><label>Reason for refund</label><select class="form-control" ng-model="formData.reason" name="reason" required><option value="">Select a reason for the refund...</option><option>Host did not turn up</option><option>I did not enjoy the activity</option><option value="other">Other (please specify below)</option></select><span class="help-block" ng-show="validationRun && form.reason.$invalid">A reason for the refund is required</span></div><div class="form-group" ng-class="{ \'has-error\': validationRun && form.additional.$invalid}"><label>Additional details</label><textarea class="form-control" rows="5" ng-model="formData.additional" name="additional" placeholder="Enter any additional details" ng-required="formData.reason == \'other\'"></textarea><span class="help-block" ng-show="validationRun && form.additional.$invalid">We will need more information to process your request</span></div><div class="form-group no-margins"><div class="clearfix formActions"><button class="btn btn-green pull-right btn-outline" type="button" ng-click="sendRequest()"><i class="ico ico-tick"></i> Send request</button> <button class="btn btn-red pull-left btn-outline" type="button" ng-click="cancel()"><i class="ico ico-cross"></i> Cancel</button></div></div></form></div>'),$templateCache.put("contacts/views/partials/my-filters.html",'<form name="form" novalidate autocomplete="off" class="row filterForm halfGutter"><div class="form-group col-xs-12 col-sm-6 col-md-2"><label>Name</label><input type="text" placeholder="Search by name..." ng-model="filterForm.name" class="form-control inlineControlMobile"></div><div class="form-group col-xs-12 col-sm-6 col-md-3"><label>Location</label><div class="iconInput defaultCursor inlineControlMobile"><i class="ico ico-pin" style="cursor: default"></i> <input googleplace ng-model="filterForm.locationSearchBox" data="filterForm.location" placeholder="Home location..." type="text" class="form-control"></div></div><div class="form-group col-xs-12 col-sm-6 col-md-3"><label>Interest</label><interest-search input-id="interestAutoComplete" placeholder="Search by interest..." data="filterForm.interests" theme="contacts"></interest-search></div><div class="form-group col-xs-12 col-sm-6 col-md-2"><label>Group</label><select class="inlineControlMobile form-control" ng-model="filterForm.group" ng-options="g.id as g.name for g in filterForm.allGroups"><option value="">All groups</option></select></div><div class="form-group col-xs-12 col-md-2"><label class="hidden-xs hidden-sm">&nbsp;</label><button class="btn btn-outline btn-contacts btn-block" ng-click="filterForm.update()"><i class="ico ico-search"></i> Update</button></div></form>'),$templateCache.put("contacts/views/partials/name-list.html",'<span class="nameList"><span ng-if="items.length > 10">{{ items.length }} people, including: <span ng-repeat="item in items | limitTo: 5"><a ui-sref="contacts.public({userId: item.id})" ng-if="item.name">{{ item.name }}</a><span ng-if="!item.name">{{ item }}</span>{{$last ? \'\' : ($index == 3) ? \' and \' : \', \'}}</span>... </span><span ng-if="items.length <= 10"><span ng-repeat="item in items"><a ui-sref="contacts.public({userId: item.id})" ng-if="item.name">{{ item.name }}</a><span ng-if="!item.name">{{ item }}</span>{{$last ? \'\' : ($index == items.length-2) ? \' and \' : \', \'}}</span>. </span></span>'),$templateCache.put("contacts/views/partials/profile-card.html",'<div class="profileCard white-bg" ng-class="{\'receivedContactRequest\': user.hulaReceived}"><span class="dropdown" ng-show="currentUser.emailVerified"><a class="dropdown-toggle" data-toggle="dropdown"><i class="ico ico-cog"></i></a><ul class="dropdown-menu dropdown-menu-right"><li ng-show="!user.friend && !user.hulaReceived"><a ng-click="sendContactRequest()">Send contact request</a></li><li><a ng-click="newMessage(user)">Message</a></li><li ng-show="user.friend"><a ng-click="addToGroup()">Add to group</a></li><li ng-show="user.friend" class="divider no-margins"></li><li ng-show="user.friend"><a ng-click="removeContact()">Remove contact</a></li></ul></span><div class="sectionContent"><div class="clearfix" style="margin-bottom:10px"><div class="pull-left"><span ui-sref="contacts.public({ userId: user.id })" class="circlePhoto contacts med" ng-class="{\'noPhoto\': !user.avatarURL}" style="background-image:url(\'{{user.avatarURL}}\')"></span></div><div class="contactDetails"><div class="truncate"><a ui-sref="contacts.public({ userId: user.id })" class="block h1">{{ user.firstName }} {{ user.lastName }}</a></div><div class="truncate" ng-show="user.businessName"><span>{{ user.businessName }}</span></div><div class="truncate"><span>{{ user.homeHub.name || \'&nbsp;\' }}</span></div><div ng-show="!user.businessName">&nbsp;</div></div></div><div class="vAlignParent"><div class="vAlign"><div class="truncate"><span ng-if="user.friendGroups" title="{{ user.friendGroups }}"><i class="ico ico-group"></i> {{ user.friendGroups }}</span></div></div><div class="vAlign text-right availableActions"><ul class="list-unstyled list-inline noPadding no-margins"><li ng-show="user.hulaReceived"><a class="circleButton green" uib-tooltip="Accept contact request" ng-click="acceptContactRequest()"><i class="ico ico-tick"></i></a></li><li ng-show="user.hulaReceived"><a class="circleButton red" uib-tooltip="Decline contact request" ng-click="declineContactRequest()"><i class="ico ico-cross"></i></a></li><li ng-show="(currentUser.emailVerified && !user.hulaReceived) || user.friend"><a ng-click="newMessage(user)" class="circleButton messages" uib-tooltip="Send a message to {{ user.firstName }}"><i class="ico ico-message"></i></a></li><li ng-show="user.friend"><a class="circleButton contacts" uib-tooltip="Add to group" ng-click="addToGroup()"><i class="ico ico-group"></i></a></li><li ng-show="currentUser.emailVerified && !user.friend && !user.hulaSent && !user.hulaReceived"><a ng-click="sendContactRequest()" class="circleButton contacts" uib-tooltip="Send a contact request"><i class="ico ico-person-plus"></i></a></li><li ng-show="!user.friend && user.hulaSent && !user.hulaReceived"><a class="circleButton contacts disabled" uib-tooltip="Contact request sent"><i class="ico ico-person-plus"></i></a></li></ul></div></div></div><div class="profileCardFooter"><div class="truncate"><span><span class="footerItem"><i class="ico ico-people"></i>{{user.friendCount}}</span> <span class="footerItem" ng-if="user.activitiesJoined"><i class="ico ico-person-plus"></i>Joined: {{user.activitiesJoined}}</span> <span class="footerItem" ng-if="user.activitiesHosted"><i class="ico ico-super-man"></i>Hosted: {{user.activitiesHosted}}</span></span></div></div></div>'),$templateCache.put("contacts/views/partials/search-filters.html",'<form name="form" novalidate autocomplete="off" class="row filterForm halfGutter"><div class="form-group col-xs-12 col-sm-6 col-md-3"><label>Name</label><input type="text" placeholder="First or full name..." ng-model="filterForm.name" class="form-control inlineControlMobile"></div><div class="form-group col-xs-12 col-sm-6 col-md-3"><label>Location</label><div class="iconInput defaultCursor inlineControlMobile"><i class="ico ico-pin" style="cursor: default"></i> <input googleplace ng-model="filterForm.locationSearchBox" data="filterForm.location" placeholder="Within 10 miles of..." type="text" class="form-control"></div></div><div class="form-group col-xs-12 col-sm-6 col-md-3"><label>Interest</label><interest-search input-id="interestAutoComplete" placeholder="Search by interest..." data="filterForm.interests" theme="contacts"></interest-search></div><div class="form-group col-xs-12 col-sm-6 col-md-3"><label class="hidden-xs">&nbsp;</label><button class="btn btn-outline btn-contacts btn-block" ng-click="filterForm.update()"><i class="ico ico-search"></i> Search</button></div></form>'),$templateCache.put("messages/views/partials/filters.html",'<form name="form" novalidate autocomplete="off" class="row filterForm halfGutter"><div class="form-group col-xs-12 col-sm-3"><label>From</label><div class="iconInput inlineControlMobile"><i class="ico ico-calendar" ng-click="filterForm.dateRange.open(\'start\', true)"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="filterForm.dateRange.startDate.date" datepicker-options="filterForm.dateRange.options" is-open="filterForm.dateRange.startDate.isOpen" show-button-bar="false" ng-focus="filterForm.dateRange.open(\'start\', true)" datepicker-append-to-body="true"></div></div><div class="form-group col-xs-12 col-sm-3"><label>To</label><div class="iconInput inlineControlMobile"><i class="ico ico-calendar" ng-click="filterForm.dateRange.open(\'end\')"></i> <input type="text" placeholder="Select date..." onkeydown="return false" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="filterForm.dateRange.endDate.date" datepicker-options="filterForm.dateRange.options" is-open="filterForm.dateRange.endDate.isOpen" show-button-bar="false" ng-focus="filterForm.dateRange.open(\'end\')" datepicker-append-to-body="true"></div></div><div class="form-group col-xs-12 col-sm-3"><label>Category</label><select class="inlineControlMobile form-control" ng-model="filterForm.category" ng-options="s.id as s.label for s in filterForm.categories"></select></div><div class="form-group col-xs-12 col-sm-3"><label class="hidden-xs">&nbsp;</label><button class="btn btn-outline btn-messages btn-block" ng-click="filterForm.update()"><i class="ico ico-search"></i> Update</button></div></form>'),$templateCache.put("payment/views/partials/payment-form.html",'<form name="form" class="paymentForm" novalidate autocomplete="off"><div class="form-group" ng-class="{\'has-error\': validationRun && form.ccNumber.$invalid}"><label>Card number</label><div ng-class="{\'input-group\' : form.ccNumber.$ccEagerType && !form.ccNumber.$error.ccNumberType}"><input class="form-control" ng-model="formData.card.number" name="ccNumber" cc-number cc-type="[\'Visa\', \'American Express\', \'MasterCard\']" cc-eager-type cc-format placeholder="Type number on the card" type="text" size="20" ng-required="true"> <span class="input-group-addon" ng-show="form.ccNumber.$ccEagerType && !form.ccNumber.$error.ccNumberType"><i class="ico ico-{{ form.ccNumber.$ccEagerType.split(\' \').join(\'\') | lowercase }}"></i></span></div><span class="help-block" ng-show="validationRun && (form.ccNumber.$error.ccNumber || form.ccNumber.$error.required)">You must enter a valid card number</span> <span class="help-block" ng-show="validationRun && !form.ccNumber.$error.ccNumber && form.ccNumber.$error.ccNumberType">We can only accept Visa, MasterCard or American Express cards</span></div><div class="row halfGutter"><div class="col-xs-12 col-md-5"><div class="form-group" ng-class="{\'has-error\': validationRun && form.ccName.$invalid}"><label>Card holder\'s name</label><input class="form-control" ng-model="formData.card.name" name="ccName" placeholder="As shown on the card" type="text" ng-required="true"> <span class="help-block" ng-show="validationRun && form.ccName.$invalid">This is a required field</span></div></div><div class="col-xs-6 col-md-3" style="width:auto"><div class="form-group" ng-class="{\'has-error\': validationRun && (form.$error.ccExp.length || form.ccExpMonth.$invalid || form.ccExpYear.$invalid || form.$error.ccExpiryBeforeActivity)}"><div cc-exp><label class="show">Expiration</label><input class="form-control extraSmall inline" ng-model="formData.card.exp_month" name="ccExpMonth" cc-exp-month placeholder="MM" type="text" size="2" ng-required="true"> <span>/ </span><input class="form-control extraSmall inline" ng-model="formData.card.exp_year" name="ccExpYear" cc-exp-year placeholder="YY" type="text" size="2" ng-required="true"></div><span class="help-block" ng-show="validationRun && (form.$error.ccExp.length || form.ccExpMonth.$invalid || form.ccExpYear.$invalid)">Invalid expiry date</span> <span class="help-block" ng-show="validationRun && !(form.$error.ccExp.length || form.ccExpMonth.$invalid || form.ccExpYear.$invalid) && form.$error.ccExpiryBeforeActivity">Card expires before payment is due</span></div></div><div class="col-xs-6 col-md-3" ng-class="{\'has-error\': validationRun && form.ccCvc.$invalid}"><div class="form-group"><label class="show">Security code</label><input class="form-control small inline" ng-model="formData.card.cvc" cc-cvc cc-type="form.ccNumber.$ccType" name="ccCvc" placeholder="CVC" type="text" size="4" ng-required="true"> <a tooltip-append-to-body="false" tooltip-placement="left" uib-tooltip-html="\'Where can I find the security code?<br/>On the reverse of your card you should find your payment card number followed by a special 3-digit code (4-digit for on American Express).\'" class="help"><i class="ico ico-question fixedSize"></i></a> <span class="help-block" ng-show="validationRun && form.ccCvc.$invalid">Invalid CVC</span></div></div></div><div ng-show="showSaveButton || showBackButton" class="form-group no-margins"><div class="clearfix formActions"><button ng-show="showBackButton" class="btn {{ backButtonClass }} pull-left btn-outline" type="button" ng-click="onBack()"><i class="ico {{ backButtonIcon }}"></i> {{ backButtonText }}</button> <button ng-show="showSaveButton" class="btn btn-green pull-right {{ buttonClass }}" ng-click="submitForm()"><i class="ico ico-tick"></i> {{ buttonText }}</button></div></div></form>'),$templateCache.put("reviews/views/partials/rating-control.html",'<li ng-class="{\'errorStars\': hasError}"><label>{{ label }} <a uib-tooltip="{{ tooltip }}" tooltip-placement="right" class="help"><i class="ico fixedSize ico-question"></i></a></label><span class="stars" ng-mouseleave="resetScore()" ng-click="saveScore()"><i ng-class="{\'far fa-star\': score < 1, \'fas fa-star\': score >= 1}" ng-mouseenter="hover(1)"></i> <i ng-class="{\'far fa-star\': score < 2, \'fas fa-star\': score >= 2}" ng-mouseenter="hover(2)"></i> <i ng-class="{\'far fa-star\': score < 3, \'fas fa-star\': score >= 3}" ng-mouseenter="hover(3)"></i> <i ng-class="{\'far fa-star\': score < 4, \'fas fa-star\': score >= 4}" ng-mouseenter="hover(4)"></i> <i ng-class="{\'far fa-star\': score < 5, \'fas fa-star\': score >= 5}" ng-mouseenter="hover(5)"></i> </span><span ng-class="{\'grey\': score == 0}">{{ textualRating }}</span></li>'),$templateCache.put("reviews/views/partials/review.html",'<div class="userReview {{ theme }}"><div class="row noGutter"><div class="col-xxs-12 col-xs-6"><div class="vAlignParent"><a ng-click="profileClick()" class="vAlign"><span class="circlePhoto {{ theme }}" ng-class="{\'noPhoto\' : !data.reviewedBy.avatar}" style="background-image:url(\'{{ ::data.reviewedBy.avatar }}\')"></span></a><div class="vAlign"><a ng-click="profileClick()" class="name {{ theme }}">{{ ::data.reviewedBy.name }}</a><p class="no-margins">{{ ::data.created | dateFormat:\'DD MMMM YYYY\' }}</p></div></div></div><div class="col-xxs-12 col-xs-6"><ul class="individualRatingsList list-unstyled clearfix"><li><span>Reliability</span><review-stars value="data.reliability" theme="{{ theme }}"></review-stars></li><li><span>Expertise</span><review-stars value="data.expertise" theme="{{ theme }}"></review-stars></li><li><span>Enthusiasm</span><review-stars value="data.enthusiasm" theme="{{ theme }}"></review-stars></li></ul></div></div><p class="marginTop" ng-class="{\'noMarginBottom\': !data.text}"><strong>{{ data.headline }}</strong></p><p class="no-margins additionalText" ng-show="data.text" read-more content="{{ data.text | nl2br | sanitize }}" limit="75" link-class="{{ theme }}"></p></div>'),$templateCache.put("core/partials/uib-datepicker/datepicker.html",'<div class="uib-datepicker" ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)"><uib-daypicker ng-switch-when="day" tabindex="0" template-url="core/partials/uib-datepicker/day.html"></uib-daypicker><uib-monthpicker ng-switch-when="month" tabindex="0"></uib-monthpicker><uib-yearpicker ng-switch-when="year" tabindex="0"></uib-yearpicker></div>'),$templateCache.put("core/partials/uib-datepicker/day.html",'<table class="uib-daypicker" role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}"><thead><tr><td colspan="7"><table cellspacing="0" cellpadding="0" border="0" width="100%"><tr><th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-class="{\'invisible\': \'\' + activeDt.date.getMonth() + activeDt.date.getFullYear() === \'\' + datepickerOptions.minDate.getMonth() + datepickerOptions.minDate.getFullYear() }" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th><th width="70%"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th><th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-class="{\'invisible\': \'\' + activeDt.date.getMonth() + activeDt.date.getFullYear() === \'\' + datepickerOptions.maxDate.getMonth() + datepickerOptions.maxDate.getFullYear() }" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th></tr></table></td></tr></thead><tbody><tr><th ng-if="showWeeks" class="text-center"></th><th ng-repeat="label in ::labels track by $index" class="text-center"><small aria-label="{{::label.full}}">{{::label.abbr}}</small></th></tr><tr class="uib-weeks" ng-repeat="row in rows track by $index"><td ng-if="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td><td ng-repeat="dt in row" class="uib-day text-center" role="gridcell" id="{{::dt.uid}}" ng-class="::dt.customClass"><button ng-hide="dt.secondary" type="button" class="btn btn-default btn-sm" uib-is-class="\'btn-info\' for selectedDt, \'active\' for activeDt on dt" ng-click="select(dt.date)" ng-disabled="::dt.disabled || weeksDisabled.indexOf(weekNumbers[$parent.$index]) != -1" tabindex="-1"><span ng-class="::{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{::dt.label}}</span></button></td></tr></tbody></table>'),$templateCache.put("activities/views/partials/filters/age.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.selectedRange == \'all\', \'btn-{{ ::theme }}\': data.selectedRange != \'all\'}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'all\'}" ng-click="inMemoryData.setValue(\'all\')"><div class="pull-left radio"></div><label class="pull-left">All ages</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'adults\'}" ng-click="inMemoryData.setValue(\'adults\')"><div class="pull-left radio"></div><label class="pull-left">Adults only</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'children\'}" ng-click="inMemoryData.setValue(\'children\')"><div class="pull-left radio"></div><label class="pull-left">Child friendly</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'custom\'}" ng-click="inMemoryData.setValue(\'custom\')"><div class="pull-left radio"></div><label class="pull-left">Custom range</label></div><div class="customOption" ng-show="inMemoryData.selectedRange === \'custom\'"><div class="vAlignParent"><div class="vAlign"><div class="input-group fixedWidth"><input class="form-control" type="text" placeholder="Min" ng-model="inMemoryData.model.min" integer-only-input maxlength="3"> <span class="input-group-addon">yrs</span></div></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign"><div class="input-group fixedWidth"><input class="form-control" type="text" placeholder="Max" ng-model="inMemoryData.model.max" integer-only-input maxlength="3"> <span class="input-group-addon">yrs</span></div></div></div></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.selectedRange !== \'all\'" ng-click="inMemoryData.selectedRange = \'all\';applyFilter()">Clear</a> <a class="pull-right profile" ng-show="inMemoryData.valid()" ng-click="applyFilter()">Apply</a></div></div></div>'),$templateCache.put("activities/views/partials/filters/date.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.selectedRange == \'all\', \'btn-{{ ::theme }}\': data.selectedRange != \'all\'}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" id="dateFilterPopup" uib-dropdown-menu ng-click="$event.stopPropagation()"><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'all\'}" ng-click="inMemoryData.setValue(\'all\')"><div class="pull-left radio"></div><label class="pull-left">All dates</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'thisWeek\'}" ng-click="inMemoryData.setValue(\'thisWeek\')"><div class="pull-left radio"></div><label class="pull-left">This week</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'nextWeek\'}" ng-click="inMemoryData.setValue(\'nextWeek\')"><div class="pull-left radio"></div><label class="pull-left">Next week</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'thisMonth\'}" ng-click="inMemoryData.setValue(\'thisMonth\')"><div class="pull-left radio"></div><label class="pull-left">This month</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'nextMonth\'}" ng-click="inMemoryData.setValue(\'nextMonth\')"><div class="pull-left radio"></div><label class="pull-left">Next month</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'custom\'}" ng-click="inMemoryData.setValue(\'custom\')"><div class="pull-left radio"></div><label class="pull-left">Custom range</label></div><div class="customOption" ng-show="inMemoryData.selectedRange === \'custom\'"><div class="iconInput"><i class="ico ico-calendar"></i> <input date-range-picker class="form-control date-picker hideReadOnly" type="text" ng-model="inMemoryData.model" options="data.options" readonly="readonly"></div></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.selectedRange !== \'all\'" ng-click="inMemoryData.selectedRange = \'all\';applyFilter()">Clear</a> <a class="pull-right profile" ng-click="applyFilter()">Apply</a></div></div></div>'),$templateCache.put("activities/views/partials/filters/difficultyLevel.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.value == 0, \'btn-{{ ::theme }}\': data.value != 0}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === 0}" ng-click="inMemoryData.value = 0"><div class="pull-left radio"></div><label class="pull-left">All levels</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === 1}" ng-click="inMemoryData.value = 1"><div class="pull-left radio"></div><label class="pull-left">Beginner</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === 2}" ng-click="inMemoryData.value = 2"><div class="pull-left radio"></div><label class="pull-left">Intermediate</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === 3}" ng-click="inMemoryData.value = 3"><div class="pull-left radio"></div><label class="pull-left">Advanced</label></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.value !== 0" ng-click="inMemoryData.value = 0;applyFilter()">Clear</a> <a class="pull-right profile" ng-click="applyFilter()">Apply</a></div></div></div>'),
$templateCache.put("activities/views/partials/filters/gender.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.value == \'u\', \'btn-{{ ::theme }}\': data.value != \'u\'}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === \'u\'}" ng-click="inMemoryData.value = \'u\'"><div class="pull-left radio"></div><label class="pull-left">Any</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === \'f\'}" ng-click="inMemoryData.value = \'f\'"><div class="pull-left radio"></div><label class="pull-left">Female only</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value === \'m\'}" ng-click="inMemoryData.value = \'m\'"><div class="pull-left radio"></div><label class="pull-left">Male only</label></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.value !== \'u\'" ng-click="inMemoryData.value = \'u\';applyFilter()">Clear</a> <a class="pull-right profile" ng-click="applyFilter()">Apply</a></div></div></div>'),$templateCache.put("activities/views/partials/filters/other.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.value.unique == false, \'btn-{{ ::theme }}\': data.value.unique != false}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup rightAlign" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value.unique === false}" ng-click="inMemoryData.value.unique = false"><div class="pull-left radio"></div><label class="pull-left">All activities</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.value.unique === true}" ng-click="inMemoryData.value.unique = true"><div class="pull-left radio"></div><label class="pull-left">Featured</label></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.value.unique !== false" ng-click="inMemoryData.value.unique = false;applyFilter()">Clear</a> <a class="pull-right profile" ng-click="applyFilter()">Apply</a></div></div></div>'),$templateCache.put("activities/views/partials/filters/price.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.selectedRange == \'all\', \'btn-{{ ::theme }}\': data.selectedRange != \'all\'}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'all\'}" ng-click="inMemoryData.setValue(\'all\')"><div class="pull-left radio"></div><label class="pull-left">All prices</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'free\'}" ng-click="inMemoryData.setValue(\'free\')"><div class="pull-left radio"></div><label class="pull-left">Free</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'custom\'}" ng-click="inMemoryData.setValue(\'custom\'); inMemoryData.model.min = 1; inMemoryData.model.max = null;"><div class="pull-left radio"></div><label class="pull-left">Paid</label></div><div class="customOption" ng-show="inMemoryData.selectedRange === \'custom\'"><div class="vAlignParent"><div class="vAlign"><div class="input-group fixedWidth"><span class="input-group-addon">&pound;</span> <input class="form-control" type="text" placeholder="Min" ng-model="inMemoryData.model.min" number-only-input></div></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign"><div class="input-group fixedWidth"><span class="input-group-addon">&pound;</span> <input class="form-control" type="text" placeholder="Max" ng-model="inMemoryData.model.max" number-only-input></div></div></div></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.selectedRange !== \'all\'" ng-click="inMemoryData.selectedRange = \'all\';applyFilter()">Clear</a> <a class="pull-right profile" ng-show="inMemoryData.valid()" ng-click="applyFilter()">Apply</a></div></div></div>'),$templateCache.put("activities/views/partials/filters/time.html",'<div class="btn-group" uib-dropdown is-open="isOpen" on-toggle="toggled(open)" auto-close="outsideClick"><button type="button" class="btn" ng-class="{\'btn-filter\': data.selectedRange == \'all\', \'btn-{{ ::theme }}\': data.selectedRange != \'all\'}" uib-dropdown-toggle>{{ data.getLabel() }} <span class="caret"></span></button><div class="dropdown-menu filterPopup" uib-dropdown-menu><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'all\'}" ng-click="inMemoryData.setValue(\'all\')"><div class="pull-left radio"></div><label class="pull-left">All times</label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'morning\'}" ng-click="inMemoryData.setValue(\'morning\')"><div class="pull-left radio"></div><label class="pull-left">Morning<small class="show mutedText">Starts before 12pm</small></label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'afternoon\'}" ng-click="inMemoryData.setValue(\'afternoon\')"><div class="pull-left radio"></div><label class="pull-left">Afternoon<small class="show mutedText">Starts after 12pm</small></label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'evening\'}" ng-click="inMemoryData.setValue(\'evening\')"><div class="pull-left radio"></div><label class="pull-left">Evening<small class="show mutedText">Starts after 6pm</small></label></div><div class="radioButton clearfix profile gutterMarginBottom half" ng-class="{\'active\': inMemoryData.selectedRange === \'custom\'}" ng-click="inMemoryData.setValue(\'custom\')"><div class="pull-left radio"></div><label class="pull-left">Custom range</label></div><div class="customOption" ng-show="inMemoryData.selectedRange === \'custom\'"><div class="vAlignParent"><div class="vAlign fixedWidth"><select class="form-control" ng-options="option.key as option.value for option in data.options | filter:data.hideMidnight" ng-model="inMemoryData.model.min"></select></div><span class="vAlign inputRangeHyphen">-</span><div class="vAlign fixedWidth"><select class="form-control" ng-options="option.key as option.value for option in data.options | filter:maxTimeOptionShouldShow" ng-model="inMemoryData.model.max"></select></div></div></div><div class="clearfix gutterMarginTop"><a class="pull-left textColour" ng-show="data.selectedRange !== \'all\'" ng-click="inMemoryData.selectedRange = \'all\';applyFilter()">Clear</a> <a class="pull-right profile" ng-click="applyFilter()">Apply</a></div></div></div>')}]);